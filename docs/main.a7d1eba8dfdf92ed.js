"use strict";(self.webpackChunkrick_and_morty=self.webpackChunkrick_and_morty||[]).push([[179],{2962:(jt,Be,V)=>{V.d(Be,{D:()=>ye});var M=V(1135),fe=V(7579),De=V(2722),Re=V(9300),Me=V(4671),Ee=V(4482),Ve=V(5403);function dt(Le,Ae){return Le===Ae}var Ze=V(4478),me=V(2504);let ye=(()=>{class Le{constructor(Ct){this.router=Ct,this._isLoading=new M.X(!1),this.destroyed$=new fe.x,this.router.events.pipe((0,De.R)(this.destroyed$),(0,Re.h)(Zt=>Zt instanceof Ze.OD)).subscribe(()=>{this.isLoading=!0})}set isLoading(Ct){this._isLoading.next(Ct)}get isLoading$(){return this._isLoading.asObservable().pipe((0,De.R)(this.destroyed$),function Dt(Le,Ae=Me.y){return Le=Le??dt,(0,Ee.e)((Ct,Zt)=>{let ht,an=!0;Ct.subscribe((0,Ve.x)(Zt,Pn=>{const zn=Ae(Pn);(an||!Le(ht,zn))&&(an=!1,ht=zn,Zt.next(Pn))}))})}())}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}return Le.\u0275fac=function(Ct){return new(Ct||Le)(me.LFG(Ze.F0))},Le.\u0275prov=me.Yz7({token:Le,factory:Le.\u0275fac,providedIn:"root"}),Le})()},1130:(jt,Be,V)=>{var M=V(2504),fe=V(4478),De=V(4755);let Re=(()=>{class c{constructor(){this.isOpenMenu=!1}toggleMenu(){this.isOpenMenu=!this.isOpenMenu}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=M.Xpm({type:c,selectors:[["app-header"]],standalone:!0,features:[M.jDz],decls:48,vars:2,consts:[[1,"container"],[1,"navbar","navbar-expand-lg","navbar-light","bg-light"],[1,"container-fluid"],["routerLink","",1,"navbar-brand"],["ngSrc","./assets/logo-image.png","priority","true","alt","rick-and-morty","height","151","width","557",1,"logo-img"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","/characters",1,"nav-link"],["routerLink","/locations",1,"nav-link"],["routerLink","/episodes",1,"nav-link"],["routerLink","/favorites",1,"nav-link"],["routerLink","/statistics",1,"nav-link"],["type","button",1,"open-menu-btn",3,"click"],["width","50","height","50",1,"menu-icon"],["href","./assets/sprite.svg#icon-menu"],[1,"backdrop"],[1,"mob-menu-wrap"],[1,"mob-menu"],["type","button",1,"close-btn",3,"click"],["width","30","height","30",1,"close-icon"],["href","./assets/sprite.svg#icon-close"],[1,"mob-nav-list"],[1,"mob-nav-item"],["routerLink","/characters",1,"mob-nav-link",3,"click"],["routerLink","/locations",1,"mob-nav-link",3,"click"],["routerLink","/episodes",1,"mob-nav-link",3,"click"],["routerLink","/favorites",1,"mob-nav-link",3,"click"],["routerLink","/statistics",1,"mob-nav-link",3,"click"]],template:function(t,s){1&t&&(M.TgZ(0,"header")(1,"div",0)(2,"nav",1)(3,"div",2)(4,"a",3),M._UZ(5,"img",4),M.qZA(),M.TgZ(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),M._uU(10,"Characters"),M.qZA()(),M.TgZ(11,"li",7)(12,"a",9),M._uU(13,"Locations"),M.qZA()(),M.TgZ(14,"li",7)(15,"a",10),M._uU(16,"Episodes"),M.qZA()(),M.TgZ(17,"li",7)(18,"a",11),M._uU(19,"Favorite"),M.qZA()(),M.TgZ(20,"li",7)(21,"a",12),M._uU(22,"Statistics"),M.qZA()()()(),M.TgZ(23,"button",13),M.NdJ("click",function(){return s.toggleMenu()}),M.O4$(),M.TgZ(24,"svg",14),M._UZ(25,"use",15),M.qZA()()()()(),M.kcU(),M.TgZ(26,"div",16)(27,"div",17)(28,"div",18)(29,"button",19),M.NdJ("click",function(){return s.toggleMenu()}),M.O4$(),M.TgZ(30,"svg",20),M._UZ(31,"use",21),M.qZA()(),M.kcU(),M.TgZ(32,"ul",22)(33,"li",23)(34,"a",24),M.NdJ("click",function(){return s.toggleMenu()}),M._uU(35,"Characters"),M.qZA()(),M.TgZ(36,"li",23)(37,"a",25),M.NdJ("click",function(){return s.toggleMenu()}),M._uU(38,"Locations"),M.qZA()(),M.TgZ(39,"li",23)(40,"a",26),M.NdJ("click",function(){return s.toggleMenu()}),M._uU(41,"Episodes"),M.qZA()(),M.TgZ(42,"li",23)(43,"a",27),M.NdJ("click",function(){return s.toggleMenu()}),M._uU(44,"Favorite"),M.qZA()(),M.TgZ(45,"li",23)(46,"a",28),M.NdJ("click",function(){return s.toggleMenu()}),M._uU(47,"Statistics"),M.qZA()()()()()()()),2&t&&(M.xp6(26),M.ekj("visible",s.isOpenMenu))},dependencies:[De.ez,fe.rH,De.Zd],styles:[".container[_ngcontent-%COMP%]{width:100%;margin:0 auto;padding:0 16px;display:flex;flex-direction:column;flex:1}@media (min-width: 375px){.container[_ngcontent-%COMP%]{width:375px}}@media (min-width: 768px){.container[_ngcontent-%COMP%]{padding:0 32px;width:768px}}@media (min-width: 1200px){.container[_ngcontent-%COMP%]{padding:0 40px;width:1200px}}.navbar[_ngcontent-%COMP%]{padding:20px 0}.container-fluid[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar-nav[_ngcontent-%COMP%]{display:flex;list-style:none;gap:20px}.navbar-collapse[_ngcontent-%COMP%]{display:none}@media (min-width: 1200px){.navbar-collapse[_ngcontent-%COMP%]{display:block;margin-left:auto}}.logo-img[_ngcontent-%COMP%]{width:200px}@media (min-width: 768px){.logo-img[_ngcontent-%COMP%]{width:280px}}@media (min-width: 1200px){.logo-img[_ngcontent-%COMP%]{width:300px}}.nav-link[_ngcontent-%COMP%]{font-size:22px;color:#87f54e;padding:10px 0;transition:color .25s linear}.nav-link[_ngcontent-%COMP%]:hover, .nav-link[_ngcontent-%COMP%]:focus{color:#11b0c8}.open-menu-btn[_ngcontent-%COMP%]{width:50px;height:50px;background-color:transparent;margin-left:auto;padding:0;border:none;display:block}@media (min-width: 1200px){.open-menu-btn[_ngcontent-%COMP%]{display:none}}.menu-icon[_ngcontent-%COMP%]{fill:#87f54e;transition:.25s linear}.menu-icon[_ngcontent-%COMP%]:hover, .menu-icon[_ngcontent-%COMP%]:focus{fill:#11b0c8}.backdrop[_ngcontent-%COMP%]{background-color:#0006;position:fixed;top:0;right:0;width:100vw;height:100vh;opacity:0;visibility:hidden;z-index:5;transition:.4s linear}@media (min-width: 768px){.backdrop[_ngcontent-%COMP%]{transition:.25s linear}}.backdrop.visible[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:rotate(720deg) scale(1)}@media (min-width: 768px){.backdrop.visible[_ngcontent-%COMP%]{transform:none}}.mob-menu-wrap[_ngcontent-%COMP%]{width:100vw;height:100vh;padding-top:100px;background-color:#000;position:fixed;top:0;right:0;background-image:url(background-image.57a7128de4add091.png)}@media (min-width: 768px){.mob-menu-wrap[_ngcontent-%COMP%]{width:50vw;transform:translate(100%);transition:.25s linear}}@media (min-width: 1200px){.mob-menu-wrap[_ngcontent-%COMP%]{display:none}}.backdrop.visible[_ngcontent-%COMP%]   .mob-menu-wrap[_ngcontent-%COMP%]{transform:translate(0)}.close-btn[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;background-color:transparent;width:40px;height:40px;border:none}.close-icon[_ngcontent-%COMP%]{fill:#fff}.mob-nav-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.mob-nav-item[_ngcontent-%COMP%]:not(:last-child){margin-bottom:20px}.mob-nav-link[_ngcontent-%COMP%]{font-size:20px;padding:20px 0;color:#87f54e;text-align:center;transition:.25s linear}@media (min-width: 768px){.mob-nav-link[_ngcontent-%COMP%]{font-size:22px}}.mob-nav-link[_ngcontent-%COMP%]:hover, .mob-nav-link[_ngcontent-%COMP%]:focus{color:#11b0c8}"]}),c})();var Me=V(4004),Ee=V(3099),Ve=V(590),Dt=V(3144),dt=V(6550);let Ze=(()=>{class c{constructor(t,s){this.http=t,this.sanitizer=s}getIcon(t,s=""){return this.http.get(t,{responseType:"text"}).pipe((0,Me.U)(o=>(s&&(o=o.replace("<svg",`<svg fill="${s}"`)),this.sanitizer.bypassSecurityTrustHtml(o))),(0,Ee.B)(),(0,Ve.P)())}}return c.\u0275fac=function(t){return new(t||c)(M.LFG(Dt.eN),M.LFG(dt.H7))},c.\u0275prov=M.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})(),me=(()=>{class c{constructor(t){this.iconService=t,this.githubIcon=this.iconService.getIcon("./assets/github.svg","white")}}return c.\u0275fac=function(t){return new(t||c)(M.Y36(Ze))},c.\u0275cmp=M.Xpm({type:c,selectors:[["app-footer"]],standalone:!0,features:[M._Bn([Ze]),M.jDz],decls:18,vars:0,consts:[[1,"footer"],[1,"container"],[1,"row"],[1,"col"],[1,"link-title"],[1,"developers-links"],["href","https://github.com/waridesu","target","_blank",1,"link"],["width","30","height","30",1,"gh-icon"],["href","./assets/sprite.svg#icon-github"],["href","https://github.com/OliaChuzhdiuk","target","_blank",1,"link"],["href","https://github.com/AntoninaHoncharenko","target","_blank",1,"link"]],template:function(t,s){1&t&&(M.TgZ(0,"footer",0)(1,"div",1)(2,"div",2)(3,"p",3),M._uU(4,"\xa9 2023 Rick and Morty Adventure. All rights reserved."),M.qZA(),M.TgZ(5,"div")(6,"p",4),M._uU(7,"Developers Github"),M.qZA(),M.TgZ(8,"div",5)(9,"a",6),M.O4$(),M.TgZ(10,"svg",7),M._UZ(11,"use",8),M.qZA()(),M.kcU(),M.TgZ(12,"a",9),M.O4$(),M.TgZ(13,"svg",7),M._UZ(14,"use",8),M.qZA()(),M.kcU(),M.TgZ(15,"a",10),M.O4$(),M.TgZ(16,"svg",7),M._UZ(17,"use",8),M.qZA()()()()()()())},dependencies:[De.ez],styles:[".footer[_ngcontent-%COMP%]{height:80px;background-color:#272727b3}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{height:80px;display:flex;justify-content:space-between;align-items:center}.container[_ngcontent-%COMP%]{width:100%;margin:0 auto;padding:0 16px;display:flex;flex-direction:column;flex:1}@media (min-width: 375px){.container[_ngcontent-%COMP%]{width:375px}}@media (min-width: 768px){.container[_ngcontent-%COMP%]{padding:0 32px;width:768px}}@media (min-width: 1200px){.container[_ngcontent-%COMP%]{padding:0 40px;width:1200px}}.col[_ngcontent-%COMP%]{color:#fff;font-size:12px}@media (min-width: 768px){.col[_ngcontent-%COMP%]{font-size:14px}}@media (min-width: 1200px){.col[_ngcontent-%COMP%]{font-size:16px}}.gh-icon[_ngcontent-%COMP%]{fill:#fff;transition:.25s linear}.gh-icon[_ngcontent-%COMP%]:hover{fill:#11b0c8}.link-title[_ngcontent-%COMP%]{color:#fff;margin-bottom:8px;display:none}@media (min-width: 768px){.link-title[_ngcontent-%COMP%]{display:block;font-size:14px}}@media (min-width: 1200px){.link-title[_ngcontent-%COMP%]{font-size:16px}}.developers-links[_ngcontent-%COMP%]{width:100px;display:flex;justify-content:space-around}@media (min-width: 768px){.developers-links[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0}),c})();function ye(c,e,t,s,o,l,d){try{var h=c[l](d),p=h.value}catch(m){return void t(m)}h.done?e(p):Promise.resolve(p).then(s,o)}const ge=1,gt=2,He=3,ke=0,it=1,Ut=2,pn=0,Vn=0,st=1,Kt=2,$i=0,Ai=1,Ln=2,ls=3,Zn=4,Os=5,Qn=301,xn=302,Tr=306,ji=1001,li=1003,vi=1006,ce=1008,ue=1009,Ie=1014,tt=1015,Qe=1016,mn=1020,mi=1023,qr=1026,Zr=1027,un=3001,pr=0,gn="srgb",er="srgb-linear",Fo="display-p3",ko="300 es";class oa{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const s=this._listeners;void 0===s[e]&&(s[e]=[]),-1===s[e].indexOf(t)&&s[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const s=this._listeners;return void 0!==s[e]&&-1!==s[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const o=this._listeners[e];if(void 0!==o){const l=o.indexOf(t);-1!==l&&o.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const s=this._listeners[e.type];if(void 0!==s){e.target=this;const o=s.slice(0);for(let l=0,d=o.length;l<d;l++)o[l].call(this,e);e.target=null}}}const Fr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Ts=Math.PI/180,la=180/Math.PI;function Kr(){const c=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(Fr[255&c]+Fr[c>>8&255]+Fr[c>>16&255]+Fr[c>>24&255]+"-"+Fr[255&e]+Fr[e>>8&255]+"-"+Fr[e>>16&15|64]+Fr[e>>24&255]+"-"+Fr[63&t|128]+Fr[t>>8&255]+"-"+Fr[t>>16&255]+Fr[t>>24&255]+Fr[255&s]+Fr[s>>8&255]+Fr[s>>16&255]+Fr[s>>24&255]).toLowerCase()}function tr(c,e,t){return Math.max(e,Math.min(t,c))}function ca(c,e,t){return(1-t)*c+t*e}function ql(c){return 0==(c&c-1)&&0!==c}function Xc(c){return Math.pow(2,Math.floor(Math.log(c)/Math.LN2))}function Hi(c,e){switch(e.constructor){case Float32Array:return c;case Uint16Array:return c/65535;case Uint8Array:return c/255;case Int16Array:return Math.max(c/32767,-1);case Int8Array:return Math.max(c/127,-1);default:throw new Error("Invalid component type.")}}function En(c,e){switch(e.constructor){case Float32Array:return c;case Uint16Array:return Math.round(65535*c);case Uint8Array:return Math.round(255*c);case Int16Array:return Math.round(32767*c);case Int8Array:return Math.round(127*c);default:throw new Error("Invalid component type.")}}class Ke{constructor(e=0,t=0){Ke.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,s=this.y,o=e.elements;return this.x=o[0]*t+o[3]*s+o[6],this.y=o[1]*t+o[4]*s+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(t,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const s=this.dot(e)/t;return Math.acos(tr(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,s=this.y-e.y;return t*t+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const s=Math.cos(t),o=Math.sin(t),l=this.x-e.x,d=this.y-e.y;return this.x=l*s-d*o+e.x,this.y=l*o+d*s+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Wn{constructor(){Wn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,s,o,l,d,h,p,m){const _=this.elements;return _[0]=e,_[1]=o,_[2]=h,_[3]=t,_[4]=l,_[5]=p,_[6]=s,_[7]=d,_[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,s=e.elements;return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],this}extractBasis(e,t,s){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const s=e.elements,o=t.elements,l=this.elements,d=s[0],h=s[3],p=s[6],m=s[1],_=s[4],S=s[7],b=s[2],C=s[5],R=s[8],N=o[0],P=o[3],I=o[6],H=o[1],U=o[4],$=o[7],X=o[2],J=o[5],re=o[8];return l[0]=d*N+h*H+p*X,l[3]=d*P+h*U+p*J,l[6]=d*I+h*$+p*re,l[1]=m*N+_*H+S*X,l[4]=m*P+_*U+S*J,l[7]=m*I+_*$+S*re,l[2]=b*N+C*H+R*X,l[5]=b*P+C*U+R*J,l[8]=b*I+C*$+R*re,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],s=e[1],o=e[2],l=e[3],d=e[4],h=e[5],p=e[6],m=e[7],_=e[8];return t*d*_-t*h*m-s*l*_+s*h*p+o*l*m-o*d*p}invert(){const e=this.elements,t=e[0],s=e[1],o=e[2],l=e[3],d=e[4],h=e[5],p=e[6],m=e[7],_=e[8],S=_*d-h*m,b=h*p-_*l,C=m*l-d*p,R=t*S+s*b+o*C;if(0===R)return this.set(0,0,0,0,0,0,0,0,0);const N=1/R;return e[0]=S*N,e[1]=(o*m-_*s)*N,e[2]=(h*s-o*d)*N,e[3]=b*N,e[4]=(_*t-o*p)*N,e[5]=(o*l-h*t)*N,e[6]=C*N,e[7]=(s*p-m*t)*N,e[8]=(d*t-s*l)*N,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,s,o,l,d,h){const p=Math.cos(l),m=Math.sin(l);return this.set(s*p,s*m,-s*(p*d+m*h)+d+e,-o*m,o*p,-o*(-m*d+p*h)+h+t,0,0,1),this}scale(e,t){return this.premultiply(ua.makeScale(e,t)),this}rotate(e){return this.premultiply(ua.makeRotation(-e)),this}translate(e,t){return this.premultiply(ua.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,-s,0,s,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,s=e.elements;for(let o=0;o<9;o++)if(t[o]!==s[o])return!1;return!0}fromArray(e,t=0){for(let s=0;s<9;s++)this.elements[s]=e[s+t];return this}toArray(e=[],t=0){const s=this.elements;return e[t]=s[0],e[t+1]=s[1],e[t+2]=s[2],e[t+3]=s[3],e[t+4]=s[4],e[t+5]=s[5],e[t+6]=s[6],e[t+7]=s[7],e[t+8]=s[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const ua=new Wn;function da(c){for(let e=c.length-1;e>=0;--e)if(c[e]>=65535)return!0;return!1}function Oa(c){return document.createElementNS("http://www.w3.org/1999/xhtml",c)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const fa={};function $s(c){c in fa||(fa[c]=!0,console.warn(c))}function Vo(c){return c<.04045?.0773993808*c:Math.pow(.9478672986*c+.0521327014,2.4)}function Go(c){return c<.0031308?12.92*c:1.055*Math.pow(c,.41666)-.055}const Kl=(new Wn).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Jl=(new Wn).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Yc={[er]:c=>c,[gn]:c=>c.convertSRGBToLinear(),[Fo]:function al(c){return c.convertSRGBToLinear().applyMatrix3(Jl)}},td={[er]:c=>c,[gn]:c=>c.convertLinearToSRGB(),[Fo]:function Uh(c){return c.applyMatrix3(Kl).convertLinearToSRGB()}},Ds={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(c){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!c},get workingColorSpace(){return er},set workingColorSpace(c){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(c,e,t){if(!1===this.enabled||e===t||!e||!t)return c;const s=Yc[e],o=td[t];if(void 0===s||void 0===o)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return o(s(c))},fromWorkingColorSpace:function(c,e){return this.convert(c,this.workingColorSpace,e)},toWorkingColorSpace:function(c,e){return this.convert(c,e,this.workingColorSpace)}};let yo;class ll{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===yo&&(yo=Oa("canvas")),yo.width=e.width,yo.height=e.height;const s=yo.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),t=yo}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Oa("canvas");t.width=e.width,t.height=e.height;const s=t.getContext("2d");s.drawImage(e,0,0,e.width,e.height);const o=s.getImageData(0,0,e.width,e.height),l=o.data;for(let d=0;d<l.length;d++)l[d]=255*Vo(l[d]/255);return s.putImageData(o,0,0),t}if(e.data){const t=e.data.slice(0);for(let s=0;s<t.length;s++)t[s]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Vo(t[s]/255)):Vo(t[s]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Wo{constructor(e=null){this.isSource=!0,this.uuid=Kr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const s={uuid:this.uuid,url:""},o=this.data;if(null!==o){let l;if(Array.isArray(o)){l=[];for(let d=0,h=o.length;d<h;d++)l.push(Ql(o[d].isDataTexture?o[d].image:o[d]))}else l=Ql(o);s.url=l}return t||(e.images[this.uuid]=s),s}}function Ql(c){return typeof HTMLImageElement<"u"&&c instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&c instanceof ImageBitmap?ll.getDataURL(c):c.data?{data:Array.from(c.data),width:c.width,height:c.height,type:c.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let cl=0,js=(()=>{class c extends oa{constructor(t=c.DEFAULT_IMAGE,s=c.DEFAULT_MAPPING,o=ji,l=ji,d=vi,h=ce,p=mi,m=ue,_=c.DEFAULT_ANISOTROPY,S=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:cl++}),this.uuid=Kr(),this.name="",this.source=new Wo(t),this.mipmaps=[],this.mapping=s,this.channel=0,this.wrapS=o,this.wrapT=l,this.magFilter=d,this.minFilter=h,this.anisotropy=_,this.format=p,this.internalFormat=null,this.type=m,this.offset=new Ke(0,0),this.repeat=new Ke(1,1),this.center=new Ke(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Wn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof S?this.colorSpace=S:($s("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=S===un?gn:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const s=void 0===t||"string"==typeof t;if(!s&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const o={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),s||(t.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case ji:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case ji:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return $s("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===gn?un:3e3}set encoding(t){$s("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===un?gn:""}}return c.DEFAULT_IMAGE=null,c.DEFAULT_MAPPING=300,c.DEFAULT_ANISOTROPY=1,c})();class Ei{constructor(e=0,t=0,s=0,o=1){Ei.prototype.isVector4=!0,this.x=e,this.y=t,this.z=s,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,s,o){return this.x=e,this.y=t,this.z=s,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,s=this.y,o=this.z,l=this.w,d=e.elements;return this.x=d[0]*t+d[4]*s+d[8]*o+d[12]*l,this.y=d[1]*t+d[5]*s+d[9]*o+d[13]*l,this.z=d[2]*t+d[6]*s+d[10]*o+d[14]*l,this.w=d[3]*t+d[7]*s+d[11]*o+d[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,s,o,l;const p=e.elements,m=p[0],_=p[4],S=p[8],b=p[1],C=p[5],R=p[9],N=p[2],P=p[6],I=p[10];if(Math.abs(_-b)<.01&&Math.abs(S-N)<.01&&Math.abs(R-P)<.01){if(Math.abs(_+b)<.1&&Math.abs(S+N)<.1&&Math.abs(R+P)<.1&&Math.abs(m+C+I-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const U=(m+1)/2,$=(C+1)/2,X=(I+1)/2,J=(_+b)/4,re=(S+N)/4,le=(R+P)/4;return U>$&&U>X?U<.01?(s=0,o=.707106781,l=.707106781):(s=Math.sqrt(U),o=J/s,l=re/s):$>X?$<.01?(s=.707106781,o=0,l=.707106781):(o=Math.sqrt($),s=J/o,l=le/o):X<.01?(s=.707106781,o=.707106781,l=0):(l=Math.sqrt(X),s=re/l,o=le/l),this.set(s,o,l,t),this}let H=Math.sqrt((P-R)*(P-R)+(S-N)*(S-N)+(b-_)*(b-_));return Math.abs(H)<.001&&(H=1),this.x=(P-R)/H,this.y=(S-N)/H,this.z=(b-_)/H,this.w=Math.acos((m+C+I-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(t,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this.z=e.z+(t.z-e.z)*s,this.w=e.w+(t.w-e.w)*s,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ro extends oa{constructor(e=1,t=1,s={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ei(0,0,e,t),this.scissorTest=!1,this.viewport=new Ei(0,0,e,t);const o={width:e,height:t,depth:1};void 0!==s.encoding&&($s("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),s.colorSpace=s.encoding===un?gn:""),this.texture=new js(o,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==s.generateMipmaps&&s.generateMipmaps,this.texture.internalFormat=void 0!==s.internalFormat?s.internalFormat:null,this.texture.minFilter=void 0!==s.minFilter?s.minFilter:vi,this.depthBuffer=void 0===s.depthBuffer||s.depthBuffer,this.stencilBuffer=void 0!==s.stencilBuffer&&s.stencilBuffer,this.depthTexture=void 0!==s.depthTexture?s.depthTexture:null,this.samples=void 0!==s.samples?s.samples:0}setSize(e,t,s=1){(this.width!==e||this.height!==t||this.depth!==s)&&(this.width=e,this.height=t,this.depth=s,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=s,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Wo(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ec extends js{constructor(e=null,t=1,s=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:s,depth:o},this.magFilter=li,this.minFilter=li,this.wrapR=ji,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class tc extends js{constructor(e=null,t=1,s=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:s,depth:o},this.magFilter=li,this.minFilter=li,this.wrapR=ji,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ur{constructor(e=0,t=0,s=0,o=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=s,this._w=o}static slerpFlat(e,t,s,o,l,d,h){let p=s[o+0],m=s[o+1],_=s[o+2],S=s[o+3];const b=l[d+0],C=l[d+1],R=l[d+2],N=l[d+3];if(0===h)return e[t+0]=p,e[t+1]=m,e[t+2]=_,void(e[t+3]=S);if(1===h)return e[t+0]=b,e[t+1]=C,e[t+2]=R,void(e[t+3]=N);if(S!==N||p!==b||m!==C||_!==R){let P=1-h;const I=p*b+m*C+_*R+S*N,H=I>=0?1:-1,U=1-I*I;if(U>Number.EPSILON){const X=Math.sqrt(U),J=Math.atan2(X,I*H);P=Math.sin(P*J)/X,h=Math.sin(h*J)/X}const $=h*H;if(p=p*P+b*$,m=m*P+C*$,_=_*P+R*$,S=S*P+N*$,P===1-h){const X=1/Math.sqrt(p*p+m*m+_*_+S*S);p*=X,m*=X,_*=X,S*=X}}e[t]=p,e[t+1]=m,e[t+2]=_,e[t+3]=S}static multiplyQuaternionsFlat(e,t,s,o,l,d){const h=s[o],p=s[o+1],m=s[o+2],_=s[o+3],S=l[d],b=l[d+1],C=l[d+2],R=l[d+3];return e[t]=h*R+_*S+p*C-m*b,e[t+1]=p*R+_*b+m*S-h*C,e[t+2]=m*R+_*C+h*b-p*S,e[t+3]=_*R-h*S-p*b-m*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,s,o){return this._x=e,this._y=t,this._z=s,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const s=e._x,o=e._y,l=e._z,d=e._order,h=Math.cos,p=Math.sin,m=h(s/2),_=h(o/2),S=h(l/2),b=p(s/2),C=p(o/2),R=p(l/2);switch(d){case"XYZ":this._x=b*_*S+m*C*R,this._y=m*C*S-b*_*R,this._z=m*_*R+b*C*S,this._w=m*_*S-b*C*R;break;case"YXZ":this._x=b*_*S+m*C*R,this._y=m*C*S-b*_*R,this._z=m*_*R-b*C*S,this._w=m*_*S+b*C*R;break;case"ZXY":this._x=b*_*S-m*C*R,this._y=m*C*S+b*_*R,this._z=m*_*R+b*C*S,this._w=m*_*S-b*C*R;break;case"ZYX":this._x=b*_*S-m*C*R,this._y=m*C*S+b*_*R,this._z=m*_*R-b*C*S,this._w=m*_*S+b*C*R;break;case"YZX":this._x=b*_*S+m*C*R,this._y=m*C*S+b*_*R,this._z=m*_*R-b*C*S,this._w=m*_*S-b*C*R;break;case"XZY":this._x=b*_*S-m*C*R,this._y=m*C*S-b*_*R,this._z=m*_*R+b*C*S,this._w=m*_*S+b*C*R;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const s=t/2,o=Math.sin(s);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,s=t[0],o=t[4],l=t[8],d=t[1],h=t[5],p=t[9],m=t[2],_=t[6],S=t[10],b=s+h+S;if(b>0){const C=.5/Math.sqrt(b+1);this._w=.25/C,this._x=(_-p)*C,this._y=(l-m)*C,this._z=(d-o)*C}else if(s>h&&s>S){const C=2*Math.sqrt(1+s-h-S);this._w=(_-p)/C,this._x=.25*C,this._y=(o+d)/C,this._z=(l+m)/C}else if(h>S){const C=2*Math.sqrt(1+h-s-S);this._w=(l-m)/C,this._x=(o+d)/C,this._y=.25*C,this._z=(p+_)/C}else{const C=2*Math.sqrt(1+S-s-h);this._w=(d-o)/C,this._x=(l+m)/C,this._y=(p+_)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let s=e.dot(t)+1;return s<Number.EPSILON?(s=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=s):(this._x=0,this._y=-e.z,this._z=e.y,this._w=s)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=s),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(tr(this.dot(e),-1,1)))}rotateTowards(e,t){const s=this.angleTo(e);if(0===s)return this;const o=Math.min(1,t/s);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const s=e._x,o=e._y,l=e._z,d=e._w,h=t._x,p=t._y,m=t._z,_=t._w;return this._x=s*_+d*h+o*m-l*p,this._y=o*_+d*p+l*h-s*m,this._z=l*_+d*m+s*p-o*h,this._w=d*_-s*h-o*p-l*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const s=this._x,o=this._y,l=this._z,d=this._w;let h=d*e._w+s*e._x+o*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=d,this._x=s,this._y=o,this._z=l,this;const p=1-h*h;if(p<=Number.EPSILON){const C=1-t;return this._w=C*d+t*this._w,this._x=C*s+t*this._x,this._y=C*o+t*this._y,this._z=C*l+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),_=Math.atan2(m,h),S=Math.sin((1-t)*_)/m,b=Math.sin(t*_)/m;return this._w=d*S+this._w*b,this._x=s*S+this._x*b,this._y=o*S+this._y*b,this._z=l*S+this._z*b,this._onChangeCallback(),this}slerpQuaternions(e,t,s){return this.copy(e).slerp(t,s)}random(){const e=Math.random(),t=Math.sqrt(1-e),s=Math.sqrt(e),o=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(o),s*Math.sin(l),s*Math.cos(l),t*Math.sin(o))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class K{constructor(e=0,t=0,s=0){K.prototype.isVector3=!0,this.x=e,this.y=t,this.z=s}set(e,t,s){return void 0===s&&(s=this.z),this.x=e,this.y=t,this.z=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(F.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(F.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,s=this.y,o=this.z,l=e.elements;return this.x=l[0]*t+l[3]*s+l[6]*o,this.y=l[1]*t+l[4]*s+l[7]*o,this.z=l[2]*t+l[5]*s+l[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,s=this.y,o=this.z,l=e.elements,d=1/(l[3]*t+l[7]*s+l[11]*o+l[15]);return this.x=(l[0]*t+l[4]*s+l[8]*o+l[12])*d,this.y=(l[1]*t+l[5]*s+l[9]*o+l[13])*d,this.z=(l[2]*t+l[6]*s+l[10]*o+l[14])*d,this}applyQuaternion(e){const t=this.x,s=this.y,o=this.z,l=e.x,d=e.y,h=e.z,p=e.w,m=p*t+d*o-h*s,_=p*s+h*t-l*o,S=p*o+l*s-d*t,b=-l*t-d*s-h*o;return this.x=m*p+b*-l+_*-h-S*-d,this.y=_*p+b*-d+S*-l-m*-h,this.z=S*p+b*-h+m*-d-_*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,s=this.y,o=this.z,l=e.elements;return this.x=l[0]*t+l[4]*s+l[8]*o,this.y=l[1]*t+l[5]*s+l[9]*o,this.z=l[2]*t+l[6]*s+l[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(t,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this.z=e.z+(t.z-e.z)*s,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const s=e.x,o=e.y,l=e.z,d=t.x,h=t.y,p=t.z;return this.x=o*p-l*h,this.y=l*d-s*p,this.z=s*h-o*d,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const s=e.dot(this)/t;return this.copy(e).multiplyScalar(s)}projectOnPlane(e){return w.copy(this).projectOnVector(e),this.sub(w)}reflect(e){return this.sub(w.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const s=this.dot(e)/t;return Math.acos(tr(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,s=this.y-e.y,o=this.z-e.z;return t*t+s*s+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,s){const o=Math.sin(t)*e;return this.x=o*Math.sin(s),this.y=Math.cos(t)*e,this.z=o*Math.cos(s),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,s){return this.x=e*Math.sin(t),this.y=s,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),s=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=s,this.z=o,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,s=Math.sqrt(1-e**2);return this.x=s*Math.cos(t),this.y=s*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const w=new K,F=new Ur;class A{constructor(e=new K(1/0,1/0,1/0),t=new K(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,s=e.length;t<s;t+=3)this.expandByPoint(Y.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,s=e.count;t<s;t++)this.expandByPoint(Y.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,s=e.length;t<s;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const s=Y.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(s),this.max.copy(e).add(s),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),ve.copy(e.boundingBox),ve.applyMatrix4(e.matrixWorld),this.union(ve);else{const o=e.geometry;if(void 0!==o)if(t&&void 0!==o.attributes&&void 0!==o.attributes.position){const l=o.attributes.position;for(let d=0,h=l.count;d<h;d++)Y.fromBufferAttribute(l,d).applyMatrix4(e.matrixWorld),this.expandByPoint(Y)}else null===o.boundingBox&&o.computeBoundingBox(),ve.copy(o.boundingBox),ve.applyMatrix4(e.matrixWorld),this.union(ve)}const s=e.children;for(let o=0,l=s.length;o<l;o++)this.expandByObject(s[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Y),Y.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,s;return e.normal.x>0?(t=e.normal.x*this.min.x,s=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,s=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,s+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,s+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,s+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,s+=e.normal.z*this.min.z),t<=-e.constant&&s>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Di),Nn.subVectors(this.max,Di),Te.subVectors(e.a,Di),Wt.subVectors(e.b,Di),Hn.subVectors(e.c,Di),qn.subVectors(Wt,Te),Fn.subVectors(Hn,Wt),bn.subVectors(Te,Hn);let t=[0,-qn.z,qn.y,0,-Fn.z,Fn.y,0,-bn.z,bn.y,qn.z,0,-qn.x,Fn.z,0,-Fn.x,bn.z,0,-bn.x,-qn.y,qn.x,0,-Fn.y,Fn.x,0,-bn.y,bn.x,0];return!(!Jr(t,Te,Wt,Hn,Nn)||(t=[1,0,0,0,1,0,0,0,1],!Jr(t,Te,Wt,Hn,Nn)))&&(qi.crossVectors(qn,Fn),t=[qi.x,qi.y,qi.z],Jr(t,Te,Wt,Hn,Nn))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Y).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Y).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(k[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),k[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),k[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),k[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),k[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),k[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),k[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),k[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(k)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const k=[new K,new K,new K,new K,new K,new K,new K,new K],Y=new K,ve=new A,Te=new K,Wt=new K,Hn=new K,qn=new K,Fn=new K,bn=new K,Di=new K,Nn=new K,qi=new K,Xt=new K;function Jr(c,e,t,s,o){for(let l=0,d=c.length-3;l<=d;l+=3){Xt.fromArray(c,l);const h=o.x*Math.abs(Xt.x)+o.y*Math.abs(Xt.y)+o.z*Math.abs(Xt.z),p=e.dot(Xt),m=t.dot(Xt),_=s.dot(Xt);if(Math.max(-Math.max(p,m,_),Math.min(p,m,_))>h)return!1}return!0}const pa=new A,Cr=new K,Ki=new K;class Ar{constructor(e=new K,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const s=this.center;void 0!==t?s.copy(t):pa.setFromPoints(e).getCenter(s);let o=0;for(let l=0,d=e.length;l<d;l++)o=Math.max(o,s.distanceToSquared(e[l]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const s=this.center.distanceToSquared(e);return t.copy(e),s>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Cr.subVectors(e,this.center);const t=Cr.lengthSq();if(t>this.radius*this.radius){const s=Math.sqrt(t),o=.5*(s-this.radius);this.center.addScaledVector(Cr,o/s),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Ki.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Cr.copy(e.center).add(Ki)),this.expandByPoint(Cr.copy(e.center).sub(Ki))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ur=new K,$o=new K,nc=new K,_o=new K,id=new K,qc=new K,Zc=new K;class et{constructor(e=new K,t=new K(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ur)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const s=t.dot(this.direction);return s<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ur.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ur.copy(this.origin).addScaledVector(this.direction,t),ur.distanceToSquared(e))}distanceSqToSegment(e,t,s,o){$o.copy(e).add(t).multiplyScalar(.5),nc.copy(t).sub(e).normalize(),_o.copy(this.origin).sub($o);const l=.5*e.distanceTo(t),d=-this.direction.dot(nc),h=_o.dot(this.direction),p=-_o.dot(nc),m=_o.lengthSq(),_=Math.abs(1-d*d);let S,b,C,R;if(_>0)if(S=d*p-h,b=d*h-p,R=l*_,S>=0)if(b>=-R)if(b<=R){const N=1/_;S*=N,b*=N,C=S*(S+d*b+2*h)+b*(d*S+b+2*p)+m}else b=l,S=Math.max(0,-(d*b+h)),C=-S*S+b*(b+2*p)+m;else b=-l,S=Math.max(0,-(d*b+h)),C=-S*S+b*(b+2*p)+m;else b<=-R?(S=Math.max(0,-(-d*l+h)),b=S>0?-l:Math.min(Math.max(-l,-p),l),C=-S*S+b*(b+2*p)+m):b<=R?(S=0,b=Math.min(Math.max(-l,-p),l),C=b*(b+2*p)+m):(S=Math.max(0,-(d*l+h)),b=S>0?l:Math.min(Math.max(-l,-p),l),C=-S*S+b*(b+2*p)+m);else b=d>0?-l:l,S=Math.max(0,-(d*b+h)),C=-S*S+b*(b+2*p)+m;return s&&s.copy(this.origin).addScaledVector(this.direction,S),o&&o.copy($o).addScaledVector(nc,b),C}intersectSphere(e,t){ur.subVectors(e.center,this.origin);const s=ur.dot(this.direction),o=ur.dot(ur)-s*s,l=e.radius*e.radius;if(o>l)return null;const d=Math.sqrt(l-o),h=s-d,p=s+d;return p<0?null:this.at(h<0?p:h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const s=-(this.origin.dot(e.normal)+e.constant)/t;return s>=0?s:null}intersectPlane(e,t){const s=this.distanceToPlane(e);return null===s?null:this.at(s,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let s,o,l,d,h,p;const m=1/this.direction.x,_=1/this.direction.y,S=1/this.direction.z,b=this.origin;return m>=0?(s=(e.min.x-b.x)*m,o=(e.max.x-b.x)*m):(s=(e.max.x-b.x)*m,o=(e.min.x-b.x)*m),_>=0?(l=(e.min.y-b.y)*_,d=(e.max.y-b.y)*_):(l=(e.max.y-b.y)*_,d=(e.min.y-b.y)*_),s>d||l>o||((l>s||isNaN(s))&&(s=l),(d<o||isNaN(o))&&(o=d),S>=0?(h=(e.min.z-b.z)*S,p=(e.max.z-b.z)*S):(h=(e.max.z-b.z)*S,p=(e.min.z-b.z)*S),s>p||h>o)||((h>s||s!=s)&&(s=h),(p<o||o!=o)&&(o=p),o<0)?null:this.at(s>=0?s:o,t)}intersectsBox(e){return null!==this.intersectBox(e,ur)}intersectTriangle(e,t,s,o,l){id.subVectors(t,e),qc.subVectors(s,e),Zc.crossVectors(id,qc);let h,d=this.direction.dot(Zc);if(d>0){if(o)return null;h=1}else{if(!(d<0))return null;h=-1,d=-d}_o.subVectors(this.origin,e);const p=h*this.direction.dot(qc.crossVectors(_o,qc));if(p<0)return null;const m=h*this.direction.dot(id.cross(_o));if(m<0||p+m>d)return null;const _=-h*_o.dot(Zc);return _<0?null:this.at(_/d,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class kt{constructor(){kt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,s,o,l,d,h,p,m,_,S,b,C,R,N,P){const I=this.elements;return I[0]=e,I[4]=t,I[8]=s,I[12]=o,I[1]=l,I[5]=d,I[9]=h,I[13]=p,I[2]=m,I[6]=_,I[10]=S,I[14]=b,I[3]=C,I[7]=R,I[11]=N,I[15]=P,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new kt).fromArray(this.elements)}copy(e){const t=this.elements,s=e.elements;return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],this}copyPosition(e){const t=this.elements,s=e.elements;return t[12]=s[12],t[13]=s[13],t[14]=s[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,s){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(e,t,s){return this.set(e.x,t.x,s.x,0,e.y,t.y,s.y,0,e.z,t.z,s.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,s=e.elements,o=1/Fa.setFromMatrixColumn(e,0).length(),l=1/Fa.setFromMatrixColumn(e,1).length(),d=1/Fa.setFromMatrixColumn(e,2).length();return t[0]=s[0]*o,t[1]=s[1]*o,t[2]=s[2]*o,t[3]=0,t[4]=s[4]*l,t[5]=s[5]*l,t[6]=s[6]*l,t[7]=0,t[8]=s[8]*d,t[9]=s[9]*d,t[10]=s[10]*d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,s=e.x,o=e.y,l=e.z,d=Math.cos(s),h=Math.sin(s),p=Math.cos(o),m=Math.sin(o),_=Math.cos(l),S=Math.sin(l);if("XYZ"===e.order){const b=d*_,C=d*S,R=h*_,N=h*S;t[0]=p*_,t[4]=-p*S,t[8]=m,t[1]=C+R*m,t[5]=b-N*m,t[9]=-h*p,t[2]=N-b*m,t[6]=R+C*m,t[10]=d*p}else if("YXZ"===e.order){const b=p*_,C=p*S,R=m*_,N=m*S;t[0]=b+N*h,t[4]=R*h-C,t[8]=d*m,t[1]=d*S,t[5]=d*_,t[9]=-h,t[2]=C*h-R,t[6]=N+b*h,t[10]=d*p}else if("ZXY"===e.order){const b=p*_,C=p*S,R=m*_,N=m*S;t[0]=b-N*h,t[4]=-d*S,t[8]=R+C*h,t[1]=C+R*h,t[5]=d*_,t[9]=N-b*h,t[2]=-d*m,t[6]=h,t[10]=d*p}else if("ZYX"===e.order){const b=d*_,C=d*S,R=h*_,N=h*S;t[0]=p*_,t[4]=R*m-C,t[8]=b*m+N,t[1]=p*S,t[5]=N*m+b,t[9]=C*m-R,t[2]=-m,t[6]=h*p,t[10]=d*p}else if("YZX"===e.order){const b=d*p,C=d*m,R=h*p,N=h*m;t[0]=p*_,t[4]=N-b*S,t[8]=R*S+C,t[1]=S,t[5]=d*_,t[9]=-h*_,t[2]=-m*_,t[6]=C*S+R,t[10]=b-N*S}else if("XZY"===e.order){const b=d*p,C=d*m,R=h*p,N=h*m;t[0]=p*_,t[4]=-S,t[8]=m*_,t[1]=b*S+N,t[5]=d*_,t[9]=C*S-R,t[2]=R*S-C,t[6]=h*_,t[10]=N*S+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(zi,e,rd)}lookAt(e,t,s){const o=this.elements;return Qr.subVectors(e,t),0===Qr.lengthSq()&&(Qr.z=1),Qr.normalize(),Xs.crossVectors(s,Qr),0===Xs.lengthSq()&&(1===Math.abs(s.z)?Qr.x+=1e-4:Qr.z+=1e-4,Qr.normalize(),Xs.crossVectors(s,Qr)),Xs.normalize(),Cs.crossVectors(Qr,Xs),o[0]=Xs.x,o[4]=Cs.x,o[8]=Qr.x,o[1]=Xs.y,o[5]=Cs.y,o[9]=Qr.y,o[2]=Xs.z,o[6]=Cs.z,o[10]=Qr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const s=e.elements,o=t.elements,l=this.elements,d=s[0],h=s[4],p=s[8],m=s[12],_=s[1],S=s[5],b=s[9],C=s[13],R=s[2],N=s[6],P=s[10],I=s[14],H=s[3],U=s[7],$=s[11],X=s[15],J=o[0],re=o[4],le=o[8],G=o[12],te=o[1],Pe=o[5],qe=o[9],_e=o[13],Ce=o[2],Fe=o[6],ft=o[10],ut=o[14],at=o[3],mt=o[7],St=o[11],Yt=o[15];return l[0]=d*J+h*te+p*Ce+m*at,l[4]=d*re+h*Pe+p*Fe+m*mt,l[8]=d*le+h*qe+p*ft+m*St,l[12]=d*G+h*_e+p*ut+m*Yt,l[1]=_*J+S*te+b*Ce+C*at,l[5]=_*re+S*Pe+b*Fe+C*mt,l[9]=_*le+S*qe+b*ft+C*St,l[13]=_*G+S*_e+b*ut+C*Yt,l[2]=R*J+N*te+P*Ce+I*at,l[6]=R*re+N*Pe+P*Fe+I*mt,l[10]=R*le+N*qe+P*ft+I*St,l[14]=R*G+N*_e+P*ut+I*Yt,l[3]=H*J+U*te+$*Ce+X*at,l[7]=H*re+U*Pe+$*Fe+X*mt,l[11]=H*le+U*qe+$*ft+X*St,l[15]=H*G+U*_e+$*ut+X*Yt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],s=e[4],o=e[8],l=e[12],d=e[1],h=e[5],p=e[9],m=e[13],_=e[2],S=e[6],b=e[10],C=e[14];return e[3]*(+l*p*S-o*m*S-l*h*b+s*m*b+o*h*C-s*p*C)+e[7]*(+t*p*C-t*m*b+l*d*b-o*d*C+o*m*_-l*p*_)+e[11]*(+t*m*S-t*h*C-l*d*S+s*d*C+l*h*_-s*m*_)+e[15]*(-o*h*_-t*p*S+t*h*b+o*d*S-s*d*b+s*p*_)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,s){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=t,o[14]=s),this}invert(){const e=this.elements,t=e[0],s=e[1],o=e[2],l=e[3],d=e[4],h=e[5],p=e[6],m=e[7],_=e[8],S=e[9],b=e[10],C=e[11],R=e[12],N=e[13],P=e[14],I=e[15],H=S*P*m-N*b*m+N*p*C-h*P*C-S*p*I+h*b*I,U=R*b*m-_*P*m-R*p*C+d*P*C+_*p*I-d*b*I,$=_*N*m-R*S*m+R*h*C-d*N*C-_*h*I+d*S*I,X=R*S*p-_*N*p-R*h*b+d*N*b+_*h*P-d*S*P,J=t*H+s*U+o*$+l*X;if(0===J)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const re=1/J;return e[0]=H*re,e[1]=(N*b*l-S*P*l-N*o*C+s*P*C+S*o*I-s*b*I)*re,e[2]=(h*P*l-N*p*l+N*o*m-s*P*m-h*o*I+s*p*I)*re,e[3]=(S*p*l-h*b*l-S*o*m+s*b*m+h*o*C-s*p*C)*re,e[4]=U*re,e[5]=(_*P*l-R*b*l+R*o*C-t*P*C-_*o*I+t*b*I)*re,e[6]=(R*p*l-d*P*l-R*o*m+t*P*m+d*o*I-t*p*I)*re,e[7]=(d*b*l-_*p*l+_*o*m-t*b*m-d*o*C+t*p*C)*re,e[8]=$*re,e[9]=(R*S*l-_*N*l-R*s*C+t*N*C+_*s*I-t*S*I)*re,e[10]=(d*N*l-R*h*l+R*s*m-t*N*m-d*s*I+t*h*I)*re,e[11]=(_*h*l-d*S*l-_*s*m+t*S*m+d*s*C-t*h*C)*re,e[12]=X*re,e[13]=(_*N*o-R*S*o+R*s*b-t*N*b-_*s*P+t*S*P)*re,e[14]=(R*h*o-d*N*o-R*s*p+t*N*p+d*s*P-t*h*P)*re,e[15]=(d*S*o-_*h*o+_*s*p-t*S*p-d*s*b+t*h*b)*re,this}scale(e){const t=this.elements,s=e.x,o=e.y,l=e.z;return t[0]*=s,t[4]*=o,t[8]*=l,t[1]*=s,t[5]*=o,t[9]*=l,t[2]*=s,t[6]*=o,t[10]*=l,t[3]*=s,t[7]*=o,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,s){return this.set(1,0,0,e,0,1,0,t,0,0,1,s,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),s=Math.sin(e);return this.set(1,0,0,0,0,t,-s,0,0,s,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,0,s,0,0,1,0,0,-s,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,-s,0,0,s,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const s=Math.cos(t),o=Math.sin(t),l=1-s,d=e.x,h=e.y,p=e.z,m=l*d,_=l*h;return this.set(m*d+s,m*h-o*p,m*p+o*h,0,m*h+o*p,_*h+s,_*p-o*d,0,m*p-o*h,_*p+o*d,l*p*p+s,0,0,0,0,1),this}makeScale(e,t,s){return this.set(e,0,0,0,0,t,0,0,0,0,s,0,0,0,0,1),this}makeShear(e,t,s,o,l,d){return this.set(1,s,l,0,e,1,d,0,t,o,1,0,0,0,0,1),this}compose(e,t,s){const o=this.elements,l=t._x,d=t._y,h=t._z,p=t._w,m=l+l,_=d+d,S=h+h,b=l*m,C=l*_,R=l*S,N=d*_,P=d*S,I=h*S,H=p*m,U=p*_,$=p*S,X=s.x,J=s.y,re=s.z;return o[0]=(1-(N+I))*X,o[1]=(C+$)*X,o[2]=(R-U)*X,o[3]=0,o[4]=(C-$)*J,o[5]=(1-(b+I))*J,o[6]=(P+H)*J,o[7]=0,o[8]=(R+U)*re,o[9]=(P-H)*re,o[10]=(1-(b+N))*re,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,t,s){const o=this.elements;let l=Fa.set(o[0],o[1],o[2]).length();const d=Fa.set(o[4],o[5],o[6]).length(),h=Fa.set(o[8],o[9],o[10]).length();this.determinant()<0&&(l=-l),e.x=o[12],e.y=o[13],e.z=o[14],ps.copy(this);const m=1/l,_=1/d,S=1/h;return ps.elements[0]*=m,ps.elements[1]*=m,ps.elements[2]*=m,ps.elements[4]*=_,ps.elements[5]*=_,ps.elements[6]*=_,ps.elements[8]*=S,ps.elements[9]*=S,ps.elements[10]*=S,t.setFromRotationMatrix(ps),s.x=l,s.y=d,s.z=h,this}makePerspective(e,t,s,o,l,d){const h=this.elements,m=2*l/(s-o),_=(t+e)/(t-e),S=(s+o)/(s-o),b=-(d+l)/(d-l),C=-2*d*l/(d-l);return h[0]=2*l/(t-e),h[4]=0,h[8]=_,h[12]=0,h[1]=0,h[5]=m,h[9]=S,h[13]=0,h[2]=0,h[6]=0,h[10]=b,h[14]=C,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,s,o,l,d){const h=this.elements,p=1/(t-e),m=1/(s-o),_=1/(d-l),S=(t+e)*p,b=(s+o)*m,C=(d+l)*_;return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-S,h[1]=0,h[5]=2*m,h[9]=0,h[13]=-b,h[2]=0,h[6]=0,h[10]=-2*_,h[14]=-C,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,s=e.elements;for(let o=0;o<16;o++)if(t[o]!==s[o])return!1;return!0}fromArray(e,t=0){for(let s=0;s<16;s++)this.elements[s]=e[s+t];return this}toArray(e=[],t=0){const s=this.elements;return e[t]=s[0],e[t+1]=s[1],e[t+2]=s[2],e[t+3]=s[3],e[t+4]=s[4],e[t+5]=s[5],e[t+6]=s[6],e[t+7]=s[7],e[t+8]=s[8],e[t+9]=s[9],e[t+10]=s[10],e[t+11]=s[11],e[t+12]=s[12],e[t+13]=s[13],e[t+14]=s[14],e[t+15]=s[15],e}}const Fa=new K,ps=new kt,zi=new K(0,0,0),rd=new K(1,1,1),Xs=new K,Cs=new K,Qr=new K,ul=new kt,Kc=new Ur;let sd=(()=>{class c{constructor(t=0,s=0,o=0,l=c.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=s,this._z=o,this._order=l}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,s,o,l=this._order){return this._x=t,this._y=s,this._z=o,this._order=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,s=this._order,o=!0){const l=t.elements,d=l[0],h=l[4],p=l[8],m=l[1],_=l[5],S=l[9],b=l[2],C=l[6],R=l[10];switch(s){case"XYZ":this._y=Math.asin(tr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-S,R),this._z=Math.atan2(-h,d)):(this._x=Math.atan2(C,_),this._z=0);break;case"YXZ":this._x=Math.asin(-tr(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(p,R),this._z=Math.atan2(m,_)):(this._y=Math.atan2(-b,d),this._z=0);break;case"ZXY":this._x=Math.asin(tr(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(-b,R),this._z=Math.atan2(-h,_)):(this._y=0,this._z=Math.atan2(m,d));break;case"ZYX":this._y=Math.asin(-tr(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(C,R),this._z=Math.atan2(m,d)):(this._x=0,this._z=Math.atan2(-h,_));break;case"YZX":this._z=Math.asin(tr(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-S,_),this._y=Math.atan2(-b,d)):(this._x=0,this._y=Math.atan2(p,R));break;case"XZY":this._z=Math.asin(-tr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(C,_),this._y=Math.atan2(p,d)):(this._x=Math.atan2(-S,R),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+s)}return this._order=s,!0===o&&this._onChangeCallback(),this}setFromQuaternion(t,s,o){return ul.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ul,s,o)}setFromVector3(t,s=this._order){return this.set(t.x,t.y,t.z,s)}reorder(t){return Kc.setFromEuler(this),this.setFromQuaternion(Kc,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],s=0){return t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return c.DEFAULT_ORDER="XYZ",c})();class ic{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Gr=0;const Mo=new K,jo=new Ur,es=new kt,Ys=new K,rc=new K,kh=new K,Bh=new Ur,Hh=new K(1,0,0),dl=new K(0,1,0),sc=new K(0,0,1),od={type:"added"},oc={type:"removed"};let ms=(()=>{class c extends oa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Gr++}),this.uuid=Kr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=c.DEFAULT_UP.clone();const t=new K,s=new sd,o=new Ur,l=new K(1,1,1);s._onChange(function d(){o.setFromEuler(s,!1)}),o._onChange(function h(){s.setFromQuaternion(o,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:s},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new kt},normalMatrix:{value:new Wn}}),this.matrix=new kt,this.matrixWorld=new kt,this.matrixAutoUpdate=c.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=c.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new ic,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,s){this.quaternion.setFromAxisAngle(t,s)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,s){return jo.setFromAxisAngle(t,s),this.quaternion.multiply(jo),this}rotateOnWorldAxis(t,s){return jo.setFromAxisAngle(t,s),this.quaternion.premultiply(jo),this}rotateX(t){return this.rotateOnAxis(Hh,t)}rotateY(t){return this.rotateOnAxis(dl,t)}rotateZ(t){return this.rotateOnAxis(sc,t)}translateOnAxis(t,s){return Mo.copy(t).applyQuaternion(this.quaternion),this.position.add(Mo.multiplyScalar(s)),this}translateX(t){return this.translateOnAxis(Hh,t)}translateY(t){return this.translateOnAxis(dl,t)}translateZ(t){return this.translateOnAxis(sc,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(es.copy(this.matrixWorld).invert())}lookAt(t,s,o){t.isVector3?Ys.copy(t):Ys.set(t,s,o);const l=this.parent;this.updateWorldMatrix(!0,!1),rc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?es.lookAt(rc,Ys,this.up):es.lookAt(Ys,rc,this.up),this.quaternion.setFromRotationMatrix(es),l&&(es.extractRotation(l.matrixWorld),jo.setFromRotationMatrix(es),this.quaternion.premultiply(jo.invert()))}add(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(od)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const s=this.children.indexOf(t);return-1!==s&&(t.parent=null,this.children.splice(s,1),t.dispatchEvent(oc)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const s=this.children[t];s.parent=null,s.dispatchEvent(oc)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),es.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),es.multiply(t.parent.matrixWorld)),t.applyMatrix4(es),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,s){if(this[t]===s)return this;for(let o=0,l=this.children.length;o<l;o++){const h=this.children[o].getObjectByProperty(t,s);if(void 0!==h)return h}}getObjectsByProperty(t,s){let o=[];this[t]===s&&o.push(this);for(let l=0,d=this.children.length;l<d;l++){const h=this.children[l].getObjectsByProperty(t,s);h.length>0&&(o=o.concat(h))}return o}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rc,t,kh),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rc,Bh,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const s=this.matrixWorld.elements;return t.set(s[8],s[9],s[10]).normalize()}raycast(){}traverse(t){t(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].traverseVisible(t)}traverseAncestors(t){const s=this.parent;null!==s&&(t(s),s.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const s=this.children;for(let o=0,l=s.length;o<l;o++){const d=s[o];(!0===d.matrixWorldAutoUpdate||!0===t)&&d.updateMatrixWorld(t)}}updateWorldMatrix(t,s){const o=this.parent;if(!0===t&&null!==o&&!0===o.matrixWorldAutoUpdate&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===s){const l=this.children;for(let d=0,h=l.length;d<h;d++){const p=l[d];!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!1,!0)}}}toJSON(t){const s=void 0===t||"string"==typeof t,o={};s&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const l={};function d(p,m){return void 0===p[m.uuid]&&(p[m.uuid]=m.toJSON(t)),m.uuid}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),!0===this.castShadow&&(l.castShadow=!0),!0===this.receiveShadow&&(l.receiveShadow=!0),!1===this.visible&&(l.visible=!1),!1===this.frustumCulled&&(l.frustumCulled=!1),0!==this.renderOrder&&(l.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),l.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(l.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?l.background=this.background.toJSON():this.background.isTexture&&(l.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(l.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){l.geometry=d(t.geometries,this.geometry);const p=this.geometry.parameters;if(void 0!==p&&void 0!==p.shapes){const m=p.shapes;if(Array.isArray(m))for(let _=0,S=m.length;_<S;_++)d(t.shapes,m[_]);else d(t.shapes,m)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(d(t.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const p=[];for(let m=0,_=this.material.length;m<_;m++)p.push(d(t.materials,this.material[m]));l.material=p}else l.material=d(t.materials,this.material);if(this.children.length>0){l.children=[];for(let p=0;p<this.children.length;p++)l.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){l.animations=[];for(let p=0;p<this.animations.length;p++)l.animations.push(d(t.animations,this.animations[p]))}if(s){const p=h(t.geometries),m=h(t.materials),_=h(t.textures),S=h(t.images),b=h(t.shapes),C=h(t.skeletons),R=h(t.animations),N=h(t.nodes);p.length>0&&(o.geometries=p),m.length>0&&(o.materials=m),_.length>0&&(o.textures=_),S.length>0&&(o.images=S),b.length>0&&(o.shapes=b),C.length>0&&(o.skeletons=C),R.length>0&&(o.animations=R),N.length>0&&(o.nodes=N)}return o.object=l,o;function h(p){const m=[];for(const _ in p){const S=p[_];delete S.metadata,m.push(S)}return m}}clone(t){return(new this.constructor).copy(this,t)}copy(t,s=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===s)for(let o=0;o<t.children.length;o++)this.add(t.children[o].clone());return this}}return c.DEFAULT_UP=new K(0,1,0),c.DEFAULT_MATRIX_AUTO_UPDATE=!0,c.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,c})();const As=new K,qs=new K,ac=new K,oo=new K,Xo=new K,ma=new K,Jc=new K,ad=new K,ld=new K,kr=new K;let xo=!1;class oi{constructor(e=new K,t=new K,s=new K){this.a=e,this.b=t,this.c=s}static getNormal(e,t,s,o){o.subVectors(s,t),As.subVectors(e,t),o.cross(As);const l=o.lengthSq();return l>0?o.multiplyScalar(1/Math.sqrt(l)):o.set(0,0,0)}static getBarycoord(e,t,s,o,l){As.subVectors(o,t),qs.subVectors(s,t),ac.subVectors(e,t);const d=As.dot(As),h=As.dot(qs),p=As.dot(ac),m=qs.dot(qs),_=qs.dot(ac),S=d*m-h*h;if(0===S)return l.set(-2,-1,-1);const b=1/S,C=(m*p-h*_)*b,R=(d*_-h*p)*b;return l.set(1-C-R,R,C)}static containsPoint(e,t,s,o){return this.getBarycoord(e,t,s,o,oo),oo.x>=0&&oo.y>=0&&oo.x+oo.y<=1}static getUV(e,t,s,o,l,d,h,p){return!1===xo&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),xo=!0),this.getInterpolation(e,t,s,o,l,d,h,p)}static getInterpolation(e,t,s,o,l,d,h,p){return this.getBarycoord(e,t,s,o,oo),p.setScalar(0),p.addScaledVector(l,oo.x),p.addScaledVector(d,oo.y),p.addScaledVector(h,oo.z),p}static isFrontFacing(e,t,s,o){return As.subVectors(s,t),qs.subVectors(e,t),As.cross(qs).dot(o)<0}set(e,t,s){return this.a.copy(e),this.b.copy(t),this.c.copy(s),this}setFromPointsAndIndices(e,t,s,o){return this.a.copy(e[t]),this.b.copy(e[s]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,t,s,o){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,s),this.c.fromBufferAttribute(e,o),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return As.subVectors(this.c,this.b),qs.subVectors(this.a,this.b),.5*As.cross(qs).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return oi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return oi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,s,o,l){return!1===xo&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),xo=!0),oi.getInterpolation(e,this.a,this.b,this.c,t,s,o,l)}getInterpolation(e,t,s,o,l){return oi.getInterpolation(e,this.a,this.b,this.c,t,s,o,l)}containsPoint(e){return oi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return oi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const s=this.a,o=this.b,l=this.c;let d,h;Xo.subVectors(o,s),ma.subVectors(l,s),ad.subVectors(e,s);const p=Xo.dot(ad),m=ma.dot(ad);if(p<=0&&m<=0)return t.copy(s);ld.subVectors(e,o);const _=Xo.dot(ld),S=ma.dot(ld);if(_>=0&&S<=_)return t.copy(o);const b=p*S-_*m;if(b<=0&&p>=0&&_<=0)return d=p/(p-_),t.copy(s).addScaledVector(Xo,d);kr.subVectors(e,l);const C=Xo.dot(kr),R=ma.dot(kr);if(R>=0&&C<=R)return t.copy(l);const N=C*m-p*R;if(N<=0&&m>=0&&R<=0)return h=m/(m-R),t.copy(s).addScaledVector(ma,h);const P=_*R-C*S;if(P<=0&&S-_>=0&&C-R>=0)return Jc.subVectors(l,o),h=(S-_)/(S-_+(C-R)),t.copy(o).addScaledVector(Jc,h);const I=1/(P+N+b);return d=N*I,h=b*I,t.copy(s).addScaledVector(Xo,d).addScaledVector(ma,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let y=0;class E extends oa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:y++}),this.uuid=Kr(),this.name="",this.type="Material",this.blending=1,this.side=ke,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const s=e[t];if(void 0===s){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const o=this[t];void 0!==o?o&&o.isColor?o.set(s):o&&o.isVector3&&s&&s.isVector3?o.copy(s):this[t]=s:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const s={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function o(l){const d=[];for(const h in l){const p=l[h];delete p.metadata,d.push(p)}return d}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),void 0!==this.roughness&&(s.roughness=this.roughness),void 0!==this.metalness&&(s.metalness=this.metalness),void 0!==this.sheen&&(s.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(s.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(s.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(s.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(s.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(s.shininess=this.shininess),void 0!==this.clearcoat&&(s.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(s.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(s.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(s.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(s.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(e).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(e).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(e).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(e).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(e).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(s.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(s.combine=this.combine)),void 0!==this.envMapIntensity&&(s.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(s.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(s.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(s.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(s.size=this.size),null!==this.shadowSide&&(s.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(s.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(s.blending=this.blending),this.side!==ke&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),!0===this.transparent&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.colorWrite=this.colorWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(s.rotation=this.rotation),!0===this.polygonOffset&&(s.polygonOffset=!0),0!==this.polygonOffsetFactor&&(s.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(s.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(s.linewidth=this.linewidth),void 0!==this.dashSize&&(s.dashSize=this.dashSize),void 0!==this.gapSize&&(s.gapSize=this.gapSize),void 0!==this.scale&&(s.scale=this.scale),!0===this.dithering&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(s.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(s.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(s.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(s.wireframe=this.wireframe),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(s.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(s.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(s.flatShading=this.flatShading),!1===this.visible&&(s.visible=!1),!1===this.toneMapped&&(s.toneMapped=!1),!1===this.fog&&(s.fog=!1),Object.keys(this.userData).length>0&&(s.userData=this.userData),t){const l=o(e.textures),d=o(e.images);l.length>0&&(s.textures=l),d.length>0&&(s.images=d)}return s}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let s=null;if(null!==t){const o=t.length;s=new Array(o);for(let l=0;l!==o;++l)s[l]=t[l].clone()}return this.clippingPlanes=s,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const v={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},D={h:0,s:0,l:0},O={h:0,s:0,l:0};function W(c,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?c+6*(e-c)*t:t<.5?e:t<2/3?c+6*(e-c)*(2/3-t):c}class B{constructor(e,t,s){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===s?this.set(e):this.setRGB(e,t,s)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=gn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Ds.toWorkingColorSpace(this,t),this}setRGB(e,t,s,o=Ds.workingColorSpace){return this.r=e,this.g=t,this.b=s,Ds.toWorkingColorSpace(this,o),this}setHSL(e,t,s,o=Ds.workingColorSpace){if(e=function jl(c,e){return(c%e+e)%e}(e,1),t=tr(t,0,1),s=tr(s,0,1),0===t)this.r=this.g=this.b=s;else{const l=s<=.5?s*(1+t):s+t-s*t,d=2*s-l;this.r=W(d,l,e+1/3),this.g=W(d,l,e),this.b=W(d,l,e-1/3)}return Ds.toWorkingColorSpace(this,o),this}setStyle(e,t=gn){function s(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const h=o[2];switch(o[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return s(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,t);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return s(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,t);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return s(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=o[1],d=l.length;if(3===d)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,t);if(6===d)return this.setHex(parseInt(l,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=gn){const s=v[e.toLowerCase()];return void 0!==s?this.setHex(s,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Vo(e.r),this.g=Vo(e.g),this.b=Vo(e.b),this}copyLinearToSRGB(e){return this.r=Go(e.r),this.g=Go(e.g),this.b=Go(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=gn){return Ds.fromWorkingColorSpace(se.copy(this),e),65536*Math.round(tr(255*se.r,0,255))+256*Math.round(tr(255*se.g,0,255))+Math.round(tr(255*se.b,0,255))}getHexString(e=gn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ds.workingColorSpace){Ds.fromWorkingColorSpace(se.copy(this),t);const s=se.r,o=se.g,l=se.b,d=Math.max(s,o,l),h=Math.min(s,o,l);let p,m;const _=(h+d)/2;if(h===d)p=0,m=0;else{const S=d-h;switch(m=_<=.5?S/(d+h):S/(2-d-h),d){case s:p=(o-l)/S+(o<l?6:0);break;case o:p=(l-s)/S+2;break;case l:p=(s-o)/S+4}p/=6}return e.h=p,e.s=m,e.l=_,e}getRGB(e,t=Ds.workingColorSpace){return Ds.fromWorkingColorSpace(se.copy(this),t),e.r=se.r,e.g=se.g,e.b=se.b,e}getStyle(e=gn){Ds.fromWorkingColorSpace(se.copy(this),e);const t=se.r,s=se.g,o=se.b;return e!==gn?`color(${e} ${t.toFixed(3)} ${s.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*s)},${Math.round(255*o)})`}offsetHSL(e,t,s){return this.getHSL(D),D.h+=e,D.s+=t,D.l+=s,this.setHSL(D.h,D.s,D.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,s){return this.r=e.r+(t.r-e.r)*s,this.g=e.g+(t.g-e.g)*s,this.b=e.b+(t.b-e.b)*s,this}lerpHSL(e,t){this.getHSL(D),e.getHSL(O);const s=ca(D.h,O.h,t),o=ca(D.s,O.s,t),l=ca(D.l,O.l,t);return this.setHSL(s,o,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,s=this.g,o=this.b,l=e.elements;return this.r=l[0]*t+l[3]*s+l[6]*o,this.g=l[1]*t+l[4]*s+l[7]*o,this.b=l[2]*t+l[5]*s+l[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const se=new B;B.NAMES=v;class ot extends E{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new B(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Vn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Vi=new K,Yo=new Ke;class Gi{constructor(e,t,s=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=s,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,s){e*=this.itemSize,s*=t.itemSize;for(let o=0,l=this.itemSize;o<l;o++)this.array[e+o]=t.array[s+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,s=this.count;t<s;t++)Yo.fromBufferAttribute(this,t),Yo.applyMatrix3(e),this.setXY(t,Yo.x,Yo.y);else if(3===this.itemSize)for(let t=0,s=this.count;t<s;t++)Vi.fromBufferAttribute(this,t),Vi.applyMatrix3(e),this.setXYZ(t,Vi.x,Vi.y,Vi.z);return this}applyMatrix4(e){for(let t=0,s=this.count;t<s;t++)Vi.fromBufferAttribute(this,t),Vi.applyMatrix4(e),this.setXYZ(t,Vi.x,Vi.y,Vi.z);return this}applyNormalMatrix(e){for(let t=0,s=this.count;t<s;t++)Vi.fromBufferAttribute(this,t),Vi.applyNormalMatrix(e),this.setXYZ(t,Vi.x,Vi.y,Vi.z);return this}transformDirection(e){for(let t=0,s=this.count;t<s;t++)Vi.fromBufferAttribute(this,t),Vi.transformDirection(e),this.setXYZ(t,Vi.x,Vi.y,Vi.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Hi(t,this.array)),t}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Hi(t,this.array)),t}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Hi(t,this.array)),t}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Hi(t,this.array)),t}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,s){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),s=En(s,this.array)),this.array[e+0]=t,this.array[e+1]=s,this}setXYZ(e,t,s,o){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),s=En(s,this.array),o=En(o,this.array)),this.array[e+0]=t,this.array[e+1]=s,this.array[e+2]=o,this}setXYZW(e,t,s,o,l){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),s=En(s,this.array),o=En(o,this.array),l=En(l,this.array)),this.array[e+0]=t,this.array[e+1]=s,this.array[e+2]=o,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class xv extends Gi{constructor(e,t,s){super(new Uint16Array(e),t,s)}}class kp extends Gi{constructor(e,t,s){super(new Uint32Array(e),t,s)}}class rn extends Gi{constructor(e,t,s){super(new Float32Array(e),t,s)}}let cd=0;const ao=new kt,lc=new ms,Ua=new K,ts=new A,ud=new A,Ir=new K;class Kn extends oa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:cd++}),this.uuid=Kr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(da(e)?kp:xv)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,s=0){this.groups.push({start:e,count:t,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const s=this.attributes.normal;if(void 0!==s){const l=(new Wn).getNormalMatrix(e);s.applyNormalMatrix(l),s.needsUpdate=!0}const o=this.attributes.tangent;return void 0!==o&&(o.transformDirection(e),o.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return ao.makeRotationFromQuaternion(e),this.applyMatrix4(ao),this}rotateX(e){return ao.makeRotationX(e),this.applyMatrix4(ao),this}rotateY(e){return ao.makeRotationY(e),this.applyMatrix4(ao),this}rotateZ(e){return ao.makeRotationZ(e),this.applyMatrix4(ao),this}translate(e,t,s){return ao.makeTranslation(e,t,s),this.applyMatrix4(ao),this}scale(e,t,s){return ao.makeScale(e,t,s),this.applyMatrix4(ao),this}lookAt(e){return lc.lookAt(e),lc.updateMatrix(),this.applyMatrix4(lc.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ua).negate(),this.translate(Ua.x,Ua.y,Ua.z),this}setFromPoints(e){const t=[];for(let s=0,o=e.length;s<o;s++){const l=e[s];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new rn(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new A);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new K(-1/0,-1/0,-1/0),new K(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)ts.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Ir.addVectors(this.boundingBox.min,ts.min),this.boundingBox.expandByPoint(Ir),Ir.addVectors(this.boundingBox.max,ts.max),this.boundingBox.expandByPoint(Ir)):(this.boundingBox.expandByPoint(ts.min),this.boundingBox.expandByPoint(ts.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Ar);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new K,1/0);if(e){const s=this.boundingSphere.center;if(ts.setFromBufferAttribute(e),t)for(let l=0,d=t.length;l<d;l++)ud.setFromBufferAttribute(t[l]),this.morphTargetsRelative?(Ir.addVectors(ts.min,ud.min),ts.expandByPoint(Ir),Ir.addVectors(ts.max,ud.max),ts.expandByPoint(Ir)):(ts.expandByPoint(ud.min),ts.expandByPoint(ud.max));ts.getCenter(s);let o=0;for(let l=0,d=e.count;l<d;l++)Ir.fromBufferAttribute(e,l),o=Math.max(o,s.distanceToSquared(Ir));if(t)for(let l=0,d=t.length;l<d;l++){const h=t[l],p=this.morphTargetsRelative;for(let m=0,_=h.count;m<_;m++)Ir.fromBufferAttribute(h,m),p&&(Ua.fromBufferAttribute(e,m),Ir.add(Ua)),o=Math.max(o,s.distanceToSquared(Ir))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const s=e.array,o=t.position.array,l=t.normal.array,d=t.uv.array,h=o.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Gi(new Float32Array(4*h),4));const p=this.getAttribute("tangent").array,m=[],_=[];for(let te=0;te<h;te++)m[te]=new K,_[te]=new K;const S=new K,b=new K,C=new K,R=new Ke,N=new Ke,P=new Ke,I=new K,H=new K;function U(te,Pe,qe){S.fromArray(o,3*te),b.fromArray(o,3*Pe),C.fromArray(o,3*qe),R.fromArray(d,2*te),N.fromArray(d,2*Pe),P.fromArray(d,2*qe),b.sub(S),C.sub(S),N.sub(R),P.sub(R);const _e=1/(N.x*P.y-P.x*N.y);isFinite(_e)&&(I.copy(b).multiplyScalar(P.y).addScaledVector(C,-N.y).multiplyScalar(_e),H.copy(C).multiplyScalar(N.x).addScaledVector(b,-P.x).multiplyScalar(_e),m[te].add(I),m[Pe].add(I),m[qe].add(I),_[te].add(H),_[Pe].add(H),_[qe].add(H))}let $=this.groups;0===$.length&&($=[{start:0,count:s.length}]);for(let te=0,Pe=$.length;te<Pe;++te){const qe=$[te],_e=qe.start;for(let Fe=_e,ft=_e+qe.count;Fe<ft;Fe+=3)U(s[Fe+0],s[Fe+1],s[Fe+2])}const X=new K,J=new K,re=new K,le=new K;function G(te){re.fromArray(l,3*te),le.copy(re);const Pe=m[te];X.copy(Pe),X.sub(re.multiplyScalar(re.dot(Pe))).normalize(),J.crossVectors(le,Pe);const _e=J.dot(_[te])<0?-1:1;p[4*te]=X.x,p[4*te+1]=X.y,p[4*te+2]=X.z,p[4*te+3]=_e}for(let te=0,Pe=$.length;te<Pe;++te){const qe=$[te],_e=qe.start;for(let Fe=_e,ft=_e+qe.count;Fe<ft;Fe+=3)G(s[Fe+0]),G(s[Fe+1]),G(s[Fe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let s=this.getAttribute("normal");if(void 0===s)s=new Gi(new Float32Array(3*t.count),3),this.setAttribute("normal",s);else for(let b=0,C=s.count;b<C;b++)s.setXYZ(b,0,0,0);const o=new K,l=new K,d=new K,h=new K,p=new K,m=new K,_=new K,S=new K;if(e)for(let b=0,C=e.count;b<C;b+=3){const R=e.getX(b+0),N=e.getX(b+1),P=e.getX(b+2);o.fromBufferAttribute(t,R),l.fromBufferAttribute(t,N),d.fromBufferAttribute(t,P),_.subVectors(d,l),S.subVectors(o,l),_.cross(S),h.fromBufferAttribute(s,R),p.fromBufferAttribute(s,N),m.fromBufferAttribute(s,P),h.add(_),p.add(_),m.add(_),s.setXYZ(R,h.x,h.y,h.z),s.setXYZ(N,p.x,p.y,p.z),s.setXYZ(P,m.x,m.y,m.z)}else for(let b=0,C=t.count;b<C;b+=3)o.fromBufferAttribute(t,b+0),l.fromBufferAttribute(t,b+1),d.fromBufferAttribute(t,b+2),_.subVectors(d,l),S.subVectors(o,l),_.cross(S),s.setXYZ(b+0,_.x,_.y,_.z),s.setXYZ(b+1,_.x,_.y,_.z),s.setXYZ(b+2,_.x,_.y,_.z);this.normalizeNormals(),s.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,s=e.count;t<s;t++)Ir.fromBufferAttribute(e,t),Ir.normalize(),e.setXYZ(t,Ir.x,Ir.y,Ir.z)}toNonIndexed(){function e(h,p){const m=h.array,_=h.itemSize,S=h.normalized,b=new m.constructor(p.length*_);let C=0,R=0;for(let N=0,P=p.length;N<P;N++){C=h.isInterleavedBufferAttribute?p[N]*h.data.stride+h.offset:p[N]*_;for(let I=0;I<_;I++)b[R++]=m[C++]}return new Gi(b,_,S)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Kn,s=this.index.array,o=this.attributes;for(const h in o){const m=e(o[h],s);t.setAttribute(h,m)}const l=this.morphAttributes;for(const h in l){const p=[],m=l[h];for(let _=0,S=m.length;_<S;_++){const C=e(m[_],s);p.push(C)}t.morphAttributes[h]=p}t.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let h=0,p=d.length;h<p;h++){const m=d[h];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const s=this.attributes;for(const p in s)e.data.attributes[p]=s[p].toJSON(e.data);const o={};let l=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],_=[];for(let S=0,b=m.length;S<b;S++)_.push(m[S].toJSON(e.data));_.length>0&&(o[p]=_,l=!0)}l&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const h=this.boundingSphere;return null!==h&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const s=e.index;null!==s&&this.setIndex(s.clone(t));const o=e.attributes;for(const m in o)this.setAttribute(m,o[m].clone(t));const l=e.morphAttributes;for(const m in l){const _=[],S=l[m];for(let b=0,C=S.length;b<C;b++)_.push(S[b].clone(t));this.morphAttributes[m]=_}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let m=0,_=d.length;m<_;m++){const S=d[m];this.addGroup(S.start,S.count,S.materialIndex)}const h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Bp=new kt,Rr=new et,dd=new Ar,eu=new K,ka=new K,hl=new K,Ba=new K,tu=new K,hd=new K,nu=new Ke,iu=new Ke,ru=new Ke,zh=new K,Hp=new K,su=new K,qo=new K,fd=new K;class ns extends ms{constructor(e=new Kn,t=new ot){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,s=Object.keys(t);if(s.length>0){const o=t[s[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=o.length;l<d;l++){const h=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}getVertexPosition(e,t){const s=this.geometry,l=s.morphAttributes.position,d=s.morphTargetsRelative;t.fromBufferAttribute(s.attributes.position,e);const h=this.morphTargetInfluences;if(l&&h){hd.set(0,0,0);for(let p=0,m=l.length;p<m;p++){const _=h[p];0!==_&&(tu.fromBufferAttribute(l[p],e),hd.addScaledVector(d?tu:tu.sub(t),_))}t.add(hd)}return t}raycast(e,t){const s=this.geometry,l=this.matrixWorld;void 0!==this.material&&(null===s.boundingSphere&&s.computeBoundingSphere(),dd.copy(s.boundingSphere),dd.applyMatrix4(l),Rr.copy(e.ray).recast(e.near),(!1!==dd.containsPoint(Rr.origin)||!(null===Rr.intersectSphere(dd,eu)||Rr.origin.distanceToSquared(eu)>(e.far-e.near)**2))&&(Bp.copy(l).invert(),Rr.copy(e.ray).applyMatrix4(Bp),(null===s.boundingBox||!1!==Rr.intersectsBox(s.boundingBox))&&this._computeIntersections(e,t)))}_computeIntersections(e,t){let s;const o=this.geometry,l=this.material,d=o.index,h=o.attributes.position,p=o.attributes.uv,m=o.attributes.uv1,_=o.attributes.normal,S=o.groups,b=o.drawRange;if(null!==d)if(Array.isArray(l))for(let C=0,R=S.length;C<R;C++){const N=S[C],P=l[N.materialIndex];for(let U=Math.max(N.start,b.start),$=Math.min(d.count,Math.min(N.start+N.count,b.start+b.count));U<$;U+=3){const X=d.getX(U),J=d.getX(U+1),re=d.getX(U+2);s=va(this,P,e,Rr,p,m,_,X,J,re),s&&(s.faceIndex=Math.floor(U/3),s.face.materialIndex=N.materialIndex,t.push(s))}}else for(let N=Math.max(0,b.start),P=Math.min(d.count,b.start+b.count);N<P;N+=3){const I=d.getX(N),H=d.getX(N+1),U=d.getX(N+2);s=va(this,l,e,Rr,p,m,_,I,H,U),s&&(s.faceIndex=Math.floor(N/3),t.push(s))}else if(void 0!==h)if(Array.isArray(l))for(let C=0,R=S.length;C<R;C++){const N=S[C],P=l[N.materialIndex];for(let U=Math.max(N.start,b.start),$=Math.min(h.count,Math.min(N.start+N.count,b.start+b.count));U<$;U+=3)s=va(this,P,e,Rr,p,m,_,U,U+1,U+2),s&&(s.faceIndex=Math.floor(U/3),s.face.materialIndex=N.materialIndex,t.push(s))}else for(let N=Math.max(0,b.start),P=Math.min(h.count,b.start+b.count);N<P;N+=3)s=va(this,l,e,Rr,p,m,_,N,N+1,N+2),s&&(s.faceIndex=Math.floor(N/3),t.push(s))}}function va(c,e,t,s,o,l,d,h,p,m){c.getVertexPosition(h,ka),c.getVertexPosition(p,hl),c.getVertexPosition(m,Ba);const _=function zp(c,e,t,s,o,l,d,h){let p;if(p=e.side===it?s.intersectTriangle(d,l,o,!0,h):s.intersectTriangle(o,l,d,e.side===ke,h),null===p)return null;fd.copy(h),fd.applyMatrix4(c.matrixWorld);const m=t.ray.origin.distanceTo(fd);return m<t.near||m>t.far?null:{distance:m,point:fd.clone(),object:c}}(c,e,t,s,ka,hl,Ba,qo);if(_){o&&(nu.fromBufferAttribute(o,h),iu.fromBufferAttribute(o,p),ru.fromBufferAttribute(o,m),_.uv=oi.getInterpolation(qo,ka,hl,Ba,nu,iu,ru,new Ke)),l&&(nu.fromBufferAttribute(l,h),iu.fromBufferAttribute(l,p),ru.fromBufferAttribute(l,m),_.uv1=oi.getInterpolation(qo,ka,hl,Ba,nu,iu,ru,new Ke),_.uv2=_.uv1),d&&(zh.fromBufferAttribute(d,h),Hp.fromBufferAttribute(d,p),su.fromBufferAttribute(d,m),_.normal=oi.getInterpolation(qo,ka,hl,Ba,zh,Hp,su,new K),_.normal.dot(s.direction)>0&&_.normal.multiplyScalar(-1));const S={a:h,b:p,c:m,normal:new K,materialIndex:0};oi.getNormal(ka,hl,Ba,S.normal),_.face=S}return _}class cc extends Kn{constructor(e=1,t=1,s=1,o=1,l=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:s,widthSegments:o,heightSegments:l,depthSegments:d};const h=this;o=Math.floor(o),l=Math.floor(l),d=Math.floor(d);const p=[],m=[],_=[],S=[];let b=0,C=0;function R(N,P,I,H,U,$,X,J,re,le,G){const te=$/re,Pe=X/le,qe=$/2,_e=X/2,Ce=J/2,Fe=re+1,ft=le+1;let ut=0,at=0;const mt=new K;for(let St=0;St<ft;St++){const Yt=St*Pe-_e;for(let Vt=0;Vt<Fe;Vt++)mt[N]=(Vt*te-qe)*H,mt[P]=Yt*U,mt[I]=Ce,m.push(mt.x,mt.y,mt.z),mt[N]=0,mt[P]=0,mt[I]=J>0?1:-1,_.push(mt.x,mt.y,mt.z),S.push(Vt/re),S.push(1-St/le),ut+=1}for(let St=0;St<le;St++)for(let Yt=0;Yt<re;Yt++){const ze=b+Yt+Fe*(St+1),pt=b+(Yt+1)+Fe*(St+1),Lt=b+(Yt+1)+Fe*St;p.push(b+Yt+Fe*St,ze,Lt),p.push(ze,pt,Lt),at+=6}h.addGroup(C,at,G),C+=at,b+=ut}R("z","y","x",-1,-1,s,t,e,d,l,0),R("z","y","x",1,-1,s,t,-e,d,l,1),R("x","z","y",1,1,e,s,t,o,d,2),R("x","z","y",1,-1,e,s,-t,o,d,3),R("x","y","z",1,-1,e,t,s,o,l,4),R("x","y","z",-1,-1,e,t,-s,o,l,5),this.setIndex(p),this.setAttribute("position",new rn(m,3)),this.setAttribute("normal",new rn(_,3)),this.setAttribute("uv",new rn(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function fl(c){const e={};for(const t in c){e[t]={};for(const s in c[t]){const o=c[t][s];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?o.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][s]=null):e[t][s]=o.clone():e[t][s]=Array.isArray(o)?o.slice():o}}return e}function Wr(c){const e={};for(let t=0;t<c.length;t++){const s=fl(c[t]);for(const o in s)e[o]=s[o]}return e}function Vh(c){return null===c.getRenderTarget()?c.outputColorSpace:er}const Gh={clone:fl,merge:Wr};class Zs extends E{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=fl(e.uniforms),this.uniformsGroups=function Sv(c){const e=[];for(let t=0;t<c.length;t++)e.push(c[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const o in this.uniforms){const d=this.uniforms[o].value;t.uniforms[o]=d&&d.isTexture?{type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?{type:"c",value:d.getHex()}:d&&d.isVector2?{type:"v2",value:d.toArray()}:d&&d.isVector3?{type:"v3",value:d.toArray()}:d&&d.isVector4?{type:"v4",value:d.toArray()}:d&&d.isMatrix3?{type:"m3",value:d.toArray()}:d&&d.isMatrix4?{type:"m4",value:d.toArray()}:{value:d}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const s={};for(const o in this.extensions)!0===this.extensions[o]&&(s[o]=!0);return Object.keys(s).length>0&&(t.extensions=s),t}}class pd extends ms{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new kt,this.projectionMatrix=new kt,this.projectionMatrixInverse=new kt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Pr extends pd{constructor(e=50,t=1,s=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=s,this.far=o,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*la*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ts*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*la*Math.atan(Math.tan(.5*Ts*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,s,o,l,d){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=s,this.view.offsetY=o,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ts*this.fov)/this.zoom,s=2*t,o=this.aspect*s,l=-.5*o;const d=this.view;if(null!==this.view&&this.view.enabled){const p=d.fullWidth,m=d.fullHeight;l+=d.offsetX*o/p,t-=d.offsetY*s/m,o*=d.width/p,s*=d.height/m}const h=this.filmOffset;0!==h&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+o,t,t-s,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class bv extends ms{constructor(e,t,s){super(),this.type="CubeCamera",this.renderTarget=s;const o=new Pr(-90,1,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(1,0,0),this.add(o);const l=new Pr(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(-1,0,0),this.add(l);const d=new Pr(-90,1,e,t);d.layers=this.layers,d.up.set(0,0,-1),d.lookAt(0,1,0),this.add(d);const h=new Pr(-90,1,e,t);h.layers=this.layers,h.up.set(0,0,1),h.lookAt(0,-1,0),this.add(h);const p=new Pr(-90,1,e,t);p.layers=this.layers,p.up.set(0,1,0),p.lookAt(0,0,1),this.add(p);const m=new Pr(-90,1,e,t);m.layers=this.layers,m.up.set(0,1,0),m.lookAt(0,0,-1),this.add(m)}update(e,t){null===this.parent&&this.updateMatrixWorld();const s=this.renderTarget,[o,l,d,h,p,m]=this.children,_=e.getRenderTarget(),S=e.toneMapping,b=e.xr.enabled;e.toneMapping=$i,e.xr.enabled=!1;const C=s.texture.generateMipmaps;s.texture.generateMipmaps=!1,e.setRenderTarget(s,0),e.render(t,o),e.setRenderTarget(s,1),e.render(t,l),e.setRenderTarget(s,2),e.render(t,d),e.setRenderTarget(s,3),e.render(t,h),e.setRenderTarget(s,4),e.render(t,p),s.texture.generateMipmaps=C,e.setRenderTarget(s,5),e.render(t,m),e.setRenderTarget(_),e.toneMapping=S,e.xr.enabled=b,s.texture.needsPMREMUpdate=!0}}class Wh extends js{constructor(e,t,s,o,l,d,h,p,m,_){super(e=void 0!==e?e:[],t=void 0!==t?t:Qn,s,o,l,d,h,p,m,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class $_ extends ro{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const s={width:e,height:e,depth:1},o=[s,s,s,s,s,s];void 0!==t.encoding&&($s("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===un?gn:""),this.texture=new Wh(o,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:vi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s_uniforms={tEquirect:{value:null}},s_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",s_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new cc(5,5,5),l=new Zs({name:"CubemapFromEquirect",uniforms:fl(s_uniforms),vertexShader:s_vertexShader,fragmentShader:s_fragmentShader,side:it,blending:pn});l.uniforms.tEquirect.value=t;const d=new ns(o,l),h=t.minFilter;return t.minFilter===ce&&(t.minFilter=vi),new bv(1,10,this).update(e,d),t.minFilter=h,d.geometry.dispose(),d.material.dispose(),this}clear(e,t,s,o){const l=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(t,s,o);e.setRenderTarget(l)}}const Vp=new K,j_=new K,X_=new Wn;class hc{constructor(e=new K(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,s,o){return this.normal.set(e,t,s),this.constant=o,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,s){const o=Vp.subVectors(s,t).cross(j_.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const s=e.delta(Vp),o=this.normal.dot(s);if(0===o)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/o;return l<0||l>1?null:t.copy(e.start).addScaledVector(s,l)}intersectsLine(e){const t=this.distanceToPoint(e.start),s=this.distanceToPoint(e.end);return t<0&&s>0||s<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const s=t||X_.getNormalMatrix(e),o=this.coplanarPoint(Vp).applyMatrix4(e),l=this.normal.applyMatrix3(s).normalize();return this.constant=-o.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const So=new Ar,$h=new K;class Gp{constructor(e=new hc,t=new hc,s=new hc,o=new hc,l=new hc,d=new hc){this.planes=[e,t,s,o,l,d]}set(e,t,s,o,l,d){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(s),h[3].copy(o),h[4].copy(l),h[5].copy(d),this}copy(e){const t=this.planes;for(let s=0;s<6;s++)t[s].copy(e.planes[s]);return this}setFromProjectionMatrix(e){const t=this.planes,s=e.elements,o=s[0],l=s[1],d=s[2],h=s[3],p=s[4],m=s[5],_=s[6],S=s[7],b=s[8],C=s[9],R=s[10],N=s[11],P=s[12],I=s[13],H=s[14],U=s[15];return t[0].setComponents(h-o,S-p,N-b,U-P).normalize(),t[1].setComponents(h+o,S+p,N+b,U+P).normalize(),t[2].setComponents(h+l,S+m,N+C,U+I).normalize(),t[3].setComponents(h-l,S-m,N-C,U-I).normalize(),t[4].setComponents(h-d,S-_,N-R,U-H).normalize(),t[5].setComponents(h+d,S+_,N+R,U+H).normalize(),this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),So.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),So.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(So)}intersectsSprite(e){return So.center.set(0,0,0),So.radius=.7071067811865476,So.applyMatrix4(e.matrixWorld),this.intersectsSphere(So)}intersectsSphere(e){const t=this.planes,s=e.center,o=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(s)<o)return!1;return!0}intersectsBox(e){const t=this.planes;for(let s=0;s<6;s++){const o=t[s];if($h.x=o.normal.x>0?e.max.x:e.min.x,$h.y=o.normal.y>0?e.max.y:e.min.y,$h.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint($h)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let s=0;s<6;s++)if(t[s].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Sr(){let c=null,e=!1,t=null,s=null;function o(l,d){t(l,d),s=c.requestAnimationFrame(o)}return{start:function(){!0!==e&&null!==t&&(s=c.requestAnimationFrame(o),e=!0)},stop:function(){c.cancelAnimationFrame(s),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){c=l}}}function wv(c,e){const t=e.isWebGL2,s=new WeakMap;return{get:function d(m){return m.isInterleavedBufferAttribute&&(m=m.data),s.get(m)},remove:function h(m){m.isInterleavedBufferAttribute&&(m=m.data);const _=s.get(m);_&&(c.deleteBuffer(_.buffer),s.delete(m))},update:function p(m,_){if(m.isGLBufferAttribute){const b=s.get(m);return void((!b||b.version<m.version)&&s.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const S=s.get(m);void 0===S?s.set(m,function o(m,_){const S=m.array,b=m.usage,C=c.createBuffer();let R;if(c.bindBuffer(_,C),c.bufferData(_,S,b),m.onUploadCallback(),S instanceof Float32Array)R=c.FLOAT;else if(S instanceof Uint16Array)if(m.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");R=c.HALF_FLOAT}else R=c.UNSIGNED_SHORT;else if(S instanceof Int16Array)R=c.SHORT;else if(S instanceof Uint32Array)R=c.UNSIGNED_INT;else if(S instanceof Int32Array)R=c.INT;else if(S instanceof Int8Array)R=c.BYTE;else if(S instanceof Uint8Array)R=c.UNSIGNED_BYTE;else{if(!(S instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+S);R=c.UNSIGNED_BYTE}return{buffer:C,type:R,bytesPerElement:S.BYTES_PER_ELEMENT,version:m.version}}(m,_)):S.version<m.version&&(function l(m,_,S){const b=_.array,C=_.updateRange;c.bindBuffer(S,m),-1===C.count?c.bufferSubData(S,0,b):(t?c.bufferSubData(S,C.offset*b.BYTES_PER_ELEMENT,b,C.offset,C.count):c.bufferSubData(S,C.offset*b.BYTES_PER_ELEMENT,b.subarray(C.offset,C.offset+C.count)),C.count=-1),_.onUploadCallback()}(S.buffer,m,_),S.version=m.version)}}}class Zo extends Kn{constructor(e=1,t=1,s=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:s,heightSegments:o};const l=e/2,d=t/2,h=Math.floor(s),p=Math.floor(o),m=h+1,_=p+1,S=e/h,b=t/p,C=[],R=[],N=[],P=[];for(let I=0;I<_;I++){const H=I*b-d;for(let U=0;U<m;U++)R.push(U*S-l,-H,0),N.push(0,0,1),P.push(U/h),P.push(1-I/p)}for(let I=0;I<p;I++)for(let H=0;H<h;H++){const $=H+m*(I+1),X=H+1+m*(I+1),J=H+1+m*I;C.push(H+m*I,$,J),C.push($,X,J)}this.setIndex(C),this.setAttribute("position",new rn(R,3)),this.setAttribute("normal",new rn(N,3)),this.setAttribute("uv",new rn(P,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zo(e.width,e.height,e.widthSegments,e.heightSegments)}}const $n={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_NORMALMAP_TANGENTSPACE\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Ft={common:{diffuse:{value:new B(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Wn},alphaMap:{value:null},alphaMapTransform:{value:new Wn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Wn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Wn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Wn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Wn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Wn},normalScale:{value:new Ke(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Wn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Wn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Wn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Wn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new B(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new B(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Wn}},sprite:{diffuse:{value:new B(16777215)},opacity:{value:1},center:{value:new Ke(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Wn},alphaMap:{value:null},alphaTest:{value:0}}},bo={basic:{uniforms:Wr([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.fog]),vertexShader:$n.meshbasic_vert,fragmentShader:$n.meshbasic_frag},lambert:{uniforms:Wr([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.fog,Ft.lights,{emissive:{value:new B(0)}}]),vertexShader:$n.meshlambert_vert,fragmentShader:$n.meshlambert_frag},phong:{uniforms:Wr([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.fog,Ft.lights,{emissive:{value:new B(0)},specular:{value:new B(1118481)},shininess:{value:30}}]),vertexShader:$n.meshphong_vert,fragmentShader:$n.meshphong_frag},standard:{uniforms:Wr([Ft.common,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.roughnessmap,Ft.metalnessmap,Ft.fog,Ft.lights,{emissive:{value:new B(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$n.meshphysical_vert,fragmentShader:$n.meshphysical_frag},toon:{uniforms:Wr([Ft.common,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.gradientmap,Ft.fog,Ft.lights,{emissive:{value:new B(0)}}]),vertexShader:$n.meshtoon_vert,fragmentShader:$n.meshtoon_frag},matcap:{uniforms:Wr([Ft.common,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.fog,{matcap:{value:null}}]),vertexShader:$n.meshmatcap_vert,fragmentShader:$n.meshmatcap_frag},points:{uniforms:Wr([Ft.points,Ft.fog]),vertexShader:$n.points_vert,fragmentShader:$n.points_frag},dashed:{uniforms:Wr([Ft.common,Ft.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$n.linedashed_vert,fragmentShader:$n.linedashed_frag},depth:{uniforms:Wr([Ft.common,Ft.displacementmap]),vertexShader:$n.depth_vert,fragmentShader:$n.depth_frag},normal:{uniforms:Wr([Ft.common,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,{opacity:{value:1}}]),vertexShader:$n.meshnormal_vert,fragmentShader:$n.meshnormal_frag},sprite:{uniforms:Wr([Ft.sprite,Ft.fog]),vertexShader:$n.sprite_vert,fragmentShader:$n.sprite_frag},background:{uniforms:{uvTransform:{value:new Wn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:$n.background_vert,fragmentShader:$n.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:$n.backgroundCube_vert,fragmentShader:$n.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:$n.cube_vert,fragmentShader:$n.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$n.equirect_vert,fragmentShader:$n.equirect_frag},distanceRGBA:{uniforms:Wr([Ft.common,Ft.displacementmap,{referencePosition:{value:new K},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$n.distanceRGBA_vert,fragmentShader:$n.distanceRGBA_frag},shadow:{uniforms:Wr([Ft.lights,Ft.fog,{color:{value:new B(0)},opacity:{value:1}}]),vertexShader:$n.shadow_vert,fragmentShader:$n.shadow_frag}};bo.physical={uniforms:Wr([bo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Wn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Wn},clearcoatNormalScale:{value:new Ke(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Wn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Wn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Wn},sheen:{value:0},sheenColor:{value:new B(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Wn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Wn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Wn},transmissionSamplerSize:{value:new Ke},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Wn},attenuationDistance:{value:0},attenuationColor:{value:new B(0)},specularColor:{value:new B(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Wn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Wn}}]),vertexShader:$n.meshphysical_vert,fragmentShader:$n.meshphysical_frag};const pl={r:0,b:0,g:0};function hu(c,e,t,s,o,l,d){const h=new B(0);let m,_,p=!0===l?0:1,S=null,b=0,C=null;function N(P,I){P.getRGB(pl,Vh(c)),s.buffers.color.setClear(pl.r,pl.g,pl.b,I,d)}return{getClearColor:function(){return h},setClearColor:function(P,I=1){h.set(P),p=I,N(h,p)},getClearAlpha:function(){return p},setClearAlpha:function(P){p=P,N(h,p)},render:function R(P,I){let H=!1,U=!0===I.isScene?I.background:null;switch(U&&U.isTexture&&(U=(I.backgroundBlurriness>0?t:e).get(U)),null===U?N(h,p):U&&U.isColor&&(N(U,1),H=!0),c.xr.getEnvironmentBlendMode()){case"opaque":H=!0;break;case"additive":s.buffers.color.setClear(0,0,0,1,d),H=!0;break;case"alpha-blend":s.buffers.color.setClear(0,0,0,0,d),H=!0}(c.autoClear||H)&&c.clear(c.autoClearColor,c.autoClearDepth,c.autoClearStencil),U&&(U.isCubeTexture||U.mapping===Tr)?(void 0===_&&(_=new ns(new cc(1,1,1),new Zs({name:"BackgroundCubeMaterial",uniforms:fl(bo.backgroundCube.uniforms),vertexShader:bo.backgroundCube.vertexShader,fragmentShader:bo.backgroundCube.fragmentShader,side:it,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(J,re,le){this.matrixWorld.copyPosition(le.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(_)),_.material.uniforms.envMap.value=U,_.material.uniforms.flipEnvMap.value=U.isCubeTexture&&!1===U.isRenderTargetTexture?-1:1,_.material.uniforms.backgroundBlurriness.value=I.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,_.material.toneMapped=U.colorSpace!==gn,(S!==U||b!==U.version||C!==c.toneMapping)&&(_.material.needsUpdate=!0,S=U,b=U.version,C=c.toneMapping),_.layers.enableAll(),P.unshift(_,_.geometry,_.material,0,0,null)):U&&U.isTexture&&(void 0===m&&(m=new ns(new Zo(2,2),new Zs({name:"BackgroundMaterial",uniforms:fl(bo.background.uniforms),vertexShader:bo.background.vertexShader,fragmentShader:bo.background.fragmentShader,side:ke,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(m)),m.material.uniforms.t2D.value=U,m.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,m.material.toneMapped=U.colorSpace!==gn,!0===U.matrixAutoUpdate&&U.updateMatrix(),m.material.uniforms.uvTransform.value.copy(U.matrix),(S!==U||b!==U.version||C!==c.toneMapping)&&(m.material.needsUpdate=!0,S=U,b=U.version,C=c.toneMapping),m.layers.enableAll(),P.unshift(m,m.geometry,m.material,0,0,null))}}}function gm(c,e,t,s){const o=c.getParameter(c.MAX_VERTEX_ATTRIBS),l=s.isWebGL2?null:e.get("OES_vertex_array_object"),d=s.isWebGL2||null!==l,h={},p=P(null);let m=p,_=!1;function C(Ce){return s.isWebGL2?c.bindVertexArray(Ce):l.bindVertexArrayOES(Ce)}function R(Ce){return s.isWebGL2?c.deleteVertexArray(Ce):l.deleteVertexArrayOES(Ce)}function P(Ce){const Fe=[],ft=[],ut=[];for(let at=0;at<o;at++)Fe[at]=0,ft[at]=0,ut[at]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Fe,enabledAttributes:ft,attributeDivisors:ut,object:Ce,attributes:{},index:null}}function U(){const Ce=m.newAttributes;for(let Fe=0,ft=Ce.length;Fe<ft;Fe++)Ce[Fe]=0}function $(Ce){X(Ce,0)}function X(Ce,Fe){const ut=m.enabledAttributes,at=m.attributeDivisors;m.newAttributes[Ce]=1,0===ut[Ce]&&(c.enableVertexAttribArray(Ce),ut[Ce]=1),at[Ce]!==Fe&&((s.isWebGL2?c:e.get("ANGLE_instanced_arrays"))[s.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ce,Fe),at[Ce]=Fe)}function J(){const Ce=m.newAttributes,Fe=m.enabledAttributes;for(let ft=0,ut=Fe.length;ft<ut;ft++)Fe[ft]!==Ce[ft]&&(c.disableVertexAttribArray(ft),Fe[ft]=0)}function re(Ce,Fe,ft,ut,at,mt){!0!==s.isWebGL2||ft!==c.INT&&ft!==c.UNSIGNED_INT?c.vertexAttribPointer(Ce,Fe,ft,ut,at,mt):c.vertexAttribIPointer(Ce,Fe,ft,at,mt)}function qe(){_e(),_=!0,m!==p&&(m=p,C(m.object))}function _e(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function S(Ce,Fe,ft,ut,at){let mt=!1;if(d){const St=function N(Ce,Fe,ft){const ut=!0===ft.wireframe;let at=h[Ce.id];void 0===at&&(at={},h[Ce.id]=at);let mt=at[Fe.id];void 0===mt&&(mt={},at[Fe.id]=mt);let St=mt[ut];return void 0===St&&(St=P(function b(){return s.isWebGL2?c.createVertexArray():l.createVertexArrayOES()}()),mt[ut]=St),St}(ut,ft,Fe);m!==St&&(m=St,C(m.object)),mt=function I(Ce,Fe,ft,ut){const at=m.attributes,mt=Fe.attributes;let St=0;const Yt=ft.getAttributes();for(const Vt in Yt)if(Yt[Vt].location>=0){const pt=at[Vt];let Lt=mt[Vt];if(void 0===Lt&&("instanceMatrix"===Vt&&Ce.instanceMatrix&&(Lt=Ce.instanceMatrix),"instanceColor"===Vt&&Ce.instanceColor&&(Lt=Ce.instanceColor)),void 0===pt||pt.attribute!==Lt||Lt&&pt.data!==Lt.data)return!0;St++}return m.attributesNum!==St||m.index!==ut}(Ce,ut,ft,at),mt&&function H(Ce,Fe,ft,ut){const at={},mt=Fe.attributes;let St=0;const Yt=ft.getAttributes();for(const Vt in Yt)if(Yt[Vt].location>=0){let pt=mt[Vt];void 0===pt&&("instanceMatrix"===Vt&&Ce.instanceMatrix&&(pt=Ce.instanceMatrix),"instanceColor"===Vt&&Ce.instanceColor&&(pt=Ce.instanceColor));const Lt={};Lt.attribute=pt,pt&&pt.data&&(Lt.data=pt.data),at[Vt]=Lt,St++}m.attributes=at,m.attributesNum=St,m.index=ut}(Ce,ut,ft,at)}else{const St=!0===Fe.wireframe;(m.geometry!==ut.id||m.program!==ft.id||m.wireframe!==St)&&(m.geometry=ut.id,m.program=ft.id,m.wireframe=St,mt=!0)}null!==at&&t.update(at,c.ELEMENT_ARRAY_BUFFER),(mt||_)&&(_=!1,function le(Ce,Fe,ft,ut){if(!1===s.isWebGL2&&(Ce.isInstancedMesh||ut.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;U();const at=ut.attributes,mt=ft.getAttributes(),St=Fe.defaultAttributeValues;for(const Yt in mt){const Vt=mt[Yt];if(Vt.location>=0){let ze=at[Yt];if(void 0===ze&&("instanceMatrix"===Yt&&Ce.instanceMatrix&&(ze=Ce.instanceMatrix),"instanceColor"===Yt&&Ce.instanceColor&&(ze=Ce.instanceColor)),void 0!==ze){const pt=ze.normalized,Lt=ze.itemSize,Gt=t.get(ze);if(void 0===Gt)continue;const de=Gt.buffer,yn=Gt.type,Rn=Gt.bytesPerElement;if(ze.isInterleavedBufferAttribute){const It=ze.data,dn=It.stride,_t=ze.offset;if(It.isInstancedInterleavedBuffer){for(let Ye=0;Ye<Vt.locationSize;Ye++)X(Vt.location+Ye,It.meshPerAttribute);!0!==Ce.isInstancedMesh&&void 0===ut._maxInstanceCount&&(ut._maxInstanceCount=It.meshPerAttribute*It.count)}else for(let Ye=0;Ye<Vt.locationSize;Ye++)$(Vt.location+Ye);c.bindBuffer(c.ARRAY_BUFFER,de);for(let Ye=0;Ye<Vt.locationSize;Ye++)re(Vt.location+Ye,Lt/Vt.locationSize,yn,pt,dn*Rn,(_t+Lt/Vt.locationSize*Ye)*Rn)}else{if(ze.isInstancedBufferAttribute){for(let It=0;It<Vt.locationSize;It++)X(Vt.location+It,ze.meshPerAttribute);!0!==Ce.isInstancedMesh&&void 0===ut._maxInstanceCount&&(ut._maxInstanceCount=ze.meshPerAttribute*ze.count)}else for(let It=0;It<Vt.locationSize;It++)$(Vt.location+It);c.bindBuffer(c.ARRAY_BUFFER,de);for(let It=0;It<Vt.locationSize;It++)re(Vt.location+It,Lt/Vt.locationSize,yn,pt,Lt*Rn,Lt/Vt.locationSize*It*Rn)}}else if(void 0!==St){const pt=St[Yt];if(void 0!==pt)switch(pt.length){case 2:c.vertexAttrib2fv(Vt.location,pt);break;case 3:c.vertexAttrib3fv(Vt.location,pt);break;case 4:c.vertexAttrib4fv(Vt.location,pt);break;default:c.vertexAttrib1fv(Vt.location,pt)}}}}J()}(Ce,Fe,ft,ut),null!==at&&c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,t.get(at).buffer))},reset:qe,resetDefaultState:_e,dispose:function G(){qe();for(const Ce in h){const Fe=h[Ce];for(const ft in Fe){const ut=Fe[ft];for(const at in ut)R(ut[at].object),delete ut[at];delete Fe[ft]}delete h[Ce]}},releaseStatesOfGeometry:function te(Ce){if(void 0===h[Ce.id])return;const Fe=h[Ce.id];for(const ft in Fe){const ut=Fe[ft];for(const at in ut)R(ut[at].object),delete ut[at];delete Fe[ft]}delete h[Ce.id]},releaseStatesOfProgram:function Pe(Ce){for(const Fe in h){const ft=h[Fe];if(void 0===ft[Ce.id])continue;const ut=ft[Ce.id];for(const at in ut)R(ut[at].object),delete ut[at];delete ft[Ce.id]}},initAttributes:U,enableAttribute:$,disableUnusedAttributes:J}}function cf(c,e,t,s){const o=s.isWebGL2;let l;this.setMode=function d(m){l=m},this.render=function h(m,_){c.drawArrays(l,m,_),t.update(_,l,1)},this.renderInstances=function p(m,_,S){if(0===S)return;let b,C;if(o)b=c,C="drawArraysInstanced";else if(b=e.get("ANGLE_instanced_arrays"),C="drawArraysInstancedANGLE",null===b)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");b[C](l,m,_,S),t.update(_,l,S)}}function bd(c,e,t){let s;function l(re){if("highp"===re){if(c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.HIGH_FLOAT).precision>0&&c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_FLOAT).precision>0)return"highp";re="mediump"}return"mediump"===re&&c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.MEDIUM_FLOAT).precision>0&&c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===c.constructor.name;let h=void 0!==t.precision?t.precision:"highp";const p=l(h);p!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",p,"instead."),h=p);const m=d||e.has("WEBGL_draw_buffers"),_=!0===t.logarithmicDepthBuffer,S=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),b=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS),C=c.getParameter(c.MAX_TEXTURE_SIZE),R=c.getParameter(c.MAX_CUBE_MAP_TEXTURE_SIZE),N=c.getParameter(c.MAX_VERTEX_ATTRIBS),P=c.getParameter(c.MAX_VERTEX_UNIFORM_VECTORS),I=c.getParameter(c.MAX_VARYING_VECTORS),H=c.getParameter(c.MAX_FRAGMENT_UNIFORM_VECTORS),U=b>0,$=d||e.has("OES_texture_float");return{isWebGL2:d,drawBuffers:m,getMaxAnisotropy:function o(){if(void 0!==s)return s;if(!0===e.has("EXT_texture_filter_anisotropic")){const re=e.get("EXT_texture_filter_anisotropic");s=c.getParameter(re.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s},getMaxPrecision:l,precision:h,logarithmicDepthBuffer:_,maxTextures:S,maxVertexTextures:b,maxTextureSize:C,maxCubemapSize:R,maxAttributes:N,maxVertexUniforms:P,maxVaryings:I,maxFragmentUniforms:H,vertexTextures:U,floatFragmentTextures:$,floatVertexTextures:U&&$,maxSamples:d?c.getParameter(c.MAX_SAMPLES):0}}function vm(c){const e=this;let t=null,s=0,o=!1,l=!1;const d=new hc,h=new Wn,p={value:null,needsUpdate:!1};function _(S,b,C,R){const N=null!==S?S.length:0;let P=null;if(0!==N){if(P=p.value,!0!==R||null===P){const I=C+4*N,H=b.matrixWorldInverse;h.getNormalMatrix(H),(null===P||P.length<I)&&(P=new Float32Array(I));for(let U=0,$=C;U!==N;++U,$+=4)d.copy(S[U]).applyMatrix4(H,h),d.normal.toArray(P,$),P[$+3]=d.constant}p.value=P,p.needsUpdate=!0}return e.numPlanes=N,e.numIntersection=0,P}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(S,b){const C=0!==S.length||b||0!==s||o;return o=b,s=S.length,C},this.beginShadows=function(){l=!0,_(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(S,b){t=_(S,b,0)},this.setState=function(S,b,C){const R=S.clippingPlanes,N=S.clipIntersection,P=S.clipShadows,I=c.get(S);if(!o||null===R||0===R.length||l&&!P)l?_(null):function m(){p.value!==t&&(p.value=t,p.needsUpdate=s>0),e.numPlanes=s,e.numIntersection=0}();else{const H=l?0:s,U=4*H;let $=I.clippingState||null;p.value=$,$=_(R,b,U,C);for(let X=0;X!==U;++X)$[X]=t[X];I.clippingState=$,this.numIntersection=N?this.numPlanes:0,this.numPlanes+=H}}}function uf(c){let e=new WeakMap;function t(d,h){return 303===h?d.mapping=Qn:304===h&&(d.mapping=xn),d}function o(d){const h=d.target;h.removeEventListener("dispose",o);const p=e.get(h);void 0!==p&&(e.delete(h),p.dispose())}return{get:function s(d){if(d&&d.isTexture&&!1===d.isRenderTargetTexture){const h=d.mapping;if(303===h||304===h){if(e.has(d))return t(e.get(d).texture,d.mapping);{const p=d.image;if(p&&p.height>0){const m=new $_(p.height/2);return m.fromEquirectangularTexture(c,d),e.set(d,m),d.addEventListener("dispose",o),t(m.texture,d.mapping)}return null}}}return d},dispose:function l(){e=new WeakMap}}}class ml extends pd{constructor(e=-1,t=1,s=1,o=-1,l=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=s,this.bottom=o,this.near=l,this.far=d,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,s,o,l,d){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=s,this.view.offsetY=o,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),s=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let l=s-e,d=s+e,h=o+t,p=o-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=m*this.view.offsetX,d=l+m*this.view.width,h-=_*this.view.offsetY,p=h-_*this.view.height}this.projectionMatrix.makeOrthographic(l,d,h,p,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const df=[.125,.215,.35,.446,.526,.582],hf=new ml,ym=new B;let wd=null;const Ha=(1+Math.sqrt(5))/2,ya=1/Ha,Td=[new K(1,1,1),new K(-1,1,1),new K(1,1,-1),new K(-1,1,-1),new K(0,Ha,ya),new K(0,Ha,-ya),new K(ya,0,Ha),new K(-ya,0,Ha),new K(Ha,ya,0),new K(-Ha,ya,0)];class vl{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,s=.1,o=100){wd=this._renderer.getRenderTarget(),this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,s,o,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Mm(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Dd(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(wd),e.scissorTest=!1,ff(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Qn||e.mapping===xn?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),wd=this._renderer.getRenderTarget();const s=t||this._allocateTargets();return this._textureToCubeUV(e,s),this._applyPMREM(s),this._cleanup(s),s}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,s={magFilter:vi,minFilter:vi,generateMipmaps:!1,type:Qe,format:mi,colorSpace:er,depthBuffer:!1},o=_m(e,t,s);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=_m(e,t,s);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function yy(c){const e=[],t=[],s=[];let o=c;const l=c-4+1+df.length;for(let d=0;d<l;d++){const h=Math.pow(2,o);t.push(h);let p=1/h;d>c-4?p=df[d-c+4-1]:0===d&&(p=0),s.push(p);const m=1/(h-2),_=-m,S=1+m,b=[_,_,S,_,S,S,_,_,S,S,_,S],C=6,R=6,N=3,P=2,I=1,H=new Float32Array(N*R*C),U=new Float32Array(P*R*C),$=new Float32Array(I*R*C);for(let J=0;J<C;J++){const re=J%3*2/3-1,le=J>2?0:-1;H.set([re,le,0,re+2/3,le,0,re+2/3,le+1,0,re,le,0,re+2/3,le+1,0,re,le+1,0],N*R*J),U.set(b,P*R*J),$.set([J,J,J,J,J,J],I*R*J)}const X=new Kn;X.setAttribute("position",new Gi(H,N)),X.setAttribute("uv",new Gi(U,P)),X.setAttribute("faceIndex",new Gi($,I)),e.push(X),o>4&&o--}return{lodPlanes:e,sizeLods:t,sigmas:s}}(l)),this._blurMaterial=function _y(c,e,t){const s=new Float32Array(20),o=new K(0,1,0);return new Zs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${c}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:pn,depthTest:!1,depthWrite:!1})}(l,e,t)}return o}_compileMaterial(e){const t=new ns(this._lodPlanes[0],e);this._renderer.compile(t,hf)}_sceneToCubeUV(e,t,s,o){const h=new Pr(90,1,t,s),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],_=this._renderer,S=_.autoClear,b=_.toneMapping;_.getClearColor(ym),_.toneMapping=$i,_.autoClear=!1;const C=new ot({name:"PMREM.Background",side:it,depthWrite:!1,depthTest:!1}),R=new ns(new cc,C);let N=!1;const P=e.background;P?P.isColor&&(C.color.copy(P),e.background=null,N=!0):(C.color.copy(ym),N=!0);for(let I=0;I<6;I++){const H=I%3;0===H?(h.up.set(0,p[I],0),h.lookAt(m[I],0,0)):1===H?(h.up.set(0,0,p[I]),h.lookAt(0,m[I],0)):(h.up.set(0,p[I],0),h.lookAt(0,0,m[I]));const U=this._cubeSize;ff(o,H*U,I>2?U:0,U,U),_.setRenderTarget(o),N&&_.render(R,h),_.render(e,h)}R.geometry.dispose(),R.material.dispose(),_.toneMapping=b,_.autoClear=S,e.background=P}_textureToCubeUV(e,t){const s=this._renderer,o=e.mapping===Qn||e.mapping===xn;o?(null===this._cubemapMaterial&&(this._cubemapMaterial=Mm()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Dd());const l=o?this._cubemapMaterial:this._equirectMaterial,d=new ns(this._lodPlanes[0],l);l.uniforms.envMap.value=e;const p=this._cubeSize;ff(t,0,0,3*p,2*p),s.setRenderTarget(t),s.render(d,hf)}_applyPMREM(e){const t=this._renderer,s=t.autoClear;t.autoClear=!1;for(let o=1;o<this._lodPlanes.length;o++){const l=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]);this._blur(e,o-1,o,l,Td[(o-1)%Td.length])}t.autoClear=s}_blur(e,t,s,o,l){const d=this._pingPongRenderTarget;this._halfBlur(e,d,t,s,o,"latitudinal",l),this._halfBlur(d,e,s,s,o,"longitudinal",l)}_halfBlur(e,t,s,o,l,d,h){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==d&&"longitudinal"!==d&&console.error("blur direction must be either latitudinal or longitudinal!");const S=new ns(this._lodPlanes[o],m),b=m.uniforms,C=this._sizeLods[s]-1,R=isFinite(l)?Math.PI/(2*C):2*Math.PI/39,N=l/R,P=isFinite(l)?1+Math.floor(3*N):20;P>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${P} samples when the maximum is set to 20`);const I=[];let H=0;for(let re=0;re<20;++re){const le=re/N,G=Math.exp(-le*le/2);I.push(G),0===re?H+=G:re<P&&(H+=2*G)}for(let re=0;re<I.length;re++)I[re]=I[re]/H;b.envMap.value=e.texture,b.samples.value=P,b.weights.value=I,b.latitudinal.value="latitudinal"===d,h&&(b.poleAxis.value=h);const{_lodMax:U}=this;b.dTheta.value=R,b.mipInt.value=U-s;const $=this._sizeLods[o];ff(t,3*$*(o>U-4?o-U+4:0),4*(this._cubeSize-$),3*$,2*$),p.setRenderTarget(t),p.render(S,hf)}}function _m(c,e,t){const s=new ro(c,e,t);return s.texture.mapping=Tr,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function ff(c,e,t,s,o){c.viewport.set(e,t,s,o),c.scissor.set(e,t,s,o)}function Dd(){return new Zs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:pn,depthTest:!1,depthWrite:!1})}function Mm(){return new Zs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:pn,depthTest:!1,depthWrite:!1})}function Cd(c){let e=new WeakMap,t=null;function l(h){const p=h.target;p.removeEventListener("dispose",l);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function s(h){if(h&&h.isTexture){const p=h.mapping,m=303===p||304===p,_=p===Qn||p===xn;if(m||_){if(h.isRenderTargetTexture&&!0===h.needsPMREMUpdate){h.needsPMREMUpdate=!1;let S=e.get(h);return null===t&&(t=new vl(c)),S=m?t.fromEquirectangular(h,S):t.fromCubemap(h,S),e.set(h,S),S.texture}if(e.has(h))return e.get(h).texture;{const S=h.image;if(m&&S&&S.height>0||_&&S&&function o(h){let p=0;for(let _=0;_<6;_++)void 0!==h[_]&&p++;return 6===p}(S)){null===t&&(t=new vl(c));const b=m?t.fromEquirectangular(h):t.fromCubemap(h);return e.set(h,b),h.addEventListener("dispose",l),b.texture}return null}}}return h},dispose:function d(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function pf(c){const e={};function t(s){if(void 0!==e[s])return e[s];let o;switch(s){case"WEBGL_depth_texture":o=c.getExtension("WEBGL_depth_texture")||c.getExtension("MOZ_WEBGL_depth_texture")||c.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=c.getExtension("WEBGL_compressed_texture_s3tc")||c.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=c.getExtension("WEBGL_compressed_texture_pvrtc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=c.getExtension(s)}return e[s]=o,o}return{has:function(s){return null!==t(s)},init:function(s){s.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(s){const o=t(s);return null===o&&console.warn("THREE.WebGLRenderer: "+s+" extension not supported."),o}}}function xm(c,e,t,s){const o={},l=new WeakMap;function d(S){const b=S.target;null!==b.index&&e.remove(b.index);for(const R in b.attributes)e.remove(b.attributes[R]);b.removeEventListener("dispose",d),delete o[b.id];const C=l.get(b);C&&(e.remove(C),l.delete(b)),s.releaseStatesOfGeometry(b),!0===b.isInstancedBufferGeometry&&delete b._maxInstanceCount,t.memory.geometries--}function m(S){const b=[],C=S.index,R=S.attributes.position;let N=0;if(null!==C){const H=C.array;N=C.version;for(let U=0,$=H.length;U<$;U+=3){const X=H[U+0],J=H[U+1],re=H[U+2];b.push(X,J,J,re,re,X)}}else{N=R.version;for(let U=0,$=R.array.length/3-1;U<$;U+=3){const X=U+0,J=U+1,re=U+2;b.push(X,J,J,re,re,X)}}const P=new(da(b)?kp:xv)(b,1);P.version=N;const I=l.get(S);I&&e.remove(I),l.set(S,P)}return{get:function h(S,b){return!0===o[b.id]||(b.addEventListener("dispose",d),o[b.id]=!0,t.memory.geometries++),b},update:function p(S){const b=S.attributes;for(const R in b)e.update(b[R],c.ARRAY_BUFFER);const C=S.morphAttributes;for(const R in C){const N=C[R];for(let P=0,I=N.length;P<I;P++)e.update(N[P],c.ARRAY_BUFFER)}},getWireframeAttribute:function _(S){const b=l.get(S);if(b){const C=S.index;null!==C&&b.version<C.version&&m(S)}else m(S);return l.get(S)}}}function Em(c,e,t,s){const o=s.isWebGL2;let l,h,p;this.setMode=function d(b){l=b},this.setIndex=function m(b){h=b.type,p=b.bytesPerElement},this.render=function _(b,C){c.drawElements(l,C,h,b*p),t.update(C,l,1)},this.renderInstances=function S(b,C,R){if(0===R)return;let N,P;if(o)N=c,P="drawElementsInstanced";else if(N=e.get("ANGLE_instanced_arrays"),P="drawElementsInstancedANGLE",null===N)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");N[P](l,C,h,b*p,R),t.update(C,l,R)}}function Sm(c){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function o(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function s(l,d,h){switch(t.calls++,d){case c.TRIANGLES:t.triangles+=h*(l/3);break;case c.LINES:t.lines+=h*(l/2);break;case c.LINE_STRIP:t.lines+=h*(l-1);break;case c.LINE_LOOP:t.lines+=h*l;break;case c.POINTS:t.points+=h*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function _l(c,e){return c[0]-e[0]}function My(c,e){return Math.abs(e[1])-Math.abs(c[1])}function xy(c,e,t){const s={},o=new Float32Array(8),l=new WeakMap,d=new Ei,h=[];for(let m=0;m<8;m++)h[m]=[m,0];return{update:function p(m,_,S){const b=m.morphTargetInfluences;if(!0===e.isWebGL2){const C=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,R=void 0!==C?C.length:0;let N=l.get(_);if(void 0===N||N.count!==R){let Ce=function(){qe.dispose(),l.delete(_),_.removeEventListener("dispose",Ce)};void 0!==N&&N.texture.dispose();const H=void 0!==_.morphAttributes.position,U=void 0!==_.morphAttributes.normal,$=void 0!==_.morphAttributes.color,X=_.morphAttributes.position||[],J=_.morphAttributes.normal||[],re=_.morphAttributes.color||[];let le=0;!0===H&&(le=1),!0===U&&(le=2),!0===$&&(le=3);let G=_.attributes.position.count*le,te=1;G>e.maxTextureSize&&(te=Math.ceil(G/e.maxTextureSize),G=e.maxTextureSize);const Pe=new Float32Array(G*te*4*R),qe=new ec(Pe,G,te,R);qe.type=tt,qe.needsUpdate=!0;const _e=4*le;for(let Fe=0;Fe<R;Fe++){const ft=X[Fe],ut=J[Fe],at=re[Fe],mt=G*te*4*Fe;for(let St=0;St<ft.count;St++){const Yt=St*_e;!0===H&&(d.fromBufferAttribute(ft,St),Pe[mt+Yt+0]=d.x,Pe[mt+Yt+1]=d.y,Pe[mt+Yt+2]=d.z,Pe[mt+Yt+3]=0),!0===U&&(d.fromBufferAttribute(ut,St),Pe[mt+Yt+4]=d.x,Pe[mt+Yt+5]=d.y,Pe[mt+Yt+6]=d.z,Pe[mt+Yt+7]=0),!0===$&&(d.fromBufferAttribute(at,St),Pe[mt+Yt+8]=d.x,Pe[mt+Yt+9]=d.y,Pe[mt+Yt+10]=d.z,Pe[mt+Yt+11]=4===at.itemSize?d.w:1)}}N={count:R,texture:qe,size:new Ke(G,te)},l.set(_,N),_.addEventListener("dispose",Ce)}let P=0;for(let H=0;H<b.length;H++)P+=b[H];const I=_.morphTargetsRelative?1:1-P;S.getUniforms().setValue(c,"morphTargetBaseInfluence",I),S.getUniforms().setValue(c,"morphTargetInfluences",b),S.getUniforms().setValue(c,"morphTargetsTexture",N.texture,t),S.getUniforms().setValue(c,"morphTargetsTextureSize",N.size)}else{const C=void 0===b?0:b.length;let R=s[_.id];if(void 0===R||R.length!==C){R=[];for(let U=0;U<C;U++)R[U]=[U,0];s[_.id]=R}for(let U=0;U<C;U++){const $=R[U];$[0]=U,$[1]=b[U]}R.sort(My);for(let U=0;U<8;U++)U<C&&R[U][1]?(h[U][0]=R[U][0],h[U][1]=R[U][1]):(h[U][0]=Number.MAX_SAFE_INTEGER,h[U][1]=0);h.sort(_l);const N=_.morphAttributes.position,P=_.morphAttributes.normal;let I=0;for(let U=0;U<8;U++){const $=h[U],X=$[0],J=$[1];X!==Number.MAX_SAFE_INTEGER&&J?(N&&_.getAttribute("morphTarget"+U)!==N[X]&&_.setAttribute("morphTarget"+U,N[X]),P&&_.getAttribute("morphNormal"+U)!==P[X]&&_.setAttribute("morphNormal"+U,P[X]),o[U]=J,I+=J):(N&&!0===_.hasAttribute("morphTarget"+U)&&_.deleteAttribute("morphTarget"+U),P&&!0===_.hasAttribute("morphNormal"+U)&&_.deleteAttribute("morphNormal"+U),o[U]=0)}const H=_.morphTargetsRelative?1:1-I;S.getUniforms().setValue(c,"morphTargetBaseInfluence",H),S.getUniforms().setValue(c,"morphTargetInfluences",o)}}}}function Ey(c,e,t,s){let o=new WeakMap;function h(p){const m=p.target;m.removeEventListener("dispose",h),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function l(p){const m=s.render.frame,S=e.get(p,p.geometry);return o.get(S)!==m&&(e.update(S),o.set(S,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",h)&&p.addEventListener("dispose",h),t.update(p.instanceMatrix,c.ARRAY_BUFFER),null!==p.instanceColor&&t.update(p.instanceColor,c.ARRAY_BUFFER)),S},dispose:function d(){o=new WeakMap}}}const bm=new js,wm=new ec,Jo=new tc,Ml=new Wh,Tm=[],Dm=[],Cm=new Float32Array(16),Am=new Float32Array(9),Im=new Float32Array(4);function yc(c,e,t){const s=c[0];if(s<=0||s>0)return c;const o=e*t;let l=Tm[o];if(void 0===l&&(l=new Float32Array(o),Tm[o]=l),0!==e){s.toArray(l,0);for(let d=1,h=0;d!==e;++d)h+=t,c[d].toArray(l,h)}return l}function br(c,e){if(c.length!==e.length)return!1;for(let t=0,s=c.length;t<s;t++)if(c[t]!==e[t])return!1;return!0}function Lr(c,e){for(let t=0,s=e.length;t<s;t++)c[t]=e[t]}function Ad(c,e){let t=Dm[e];void 0===t&&(t=new Int32Array(e),Dm[e]=t);for(let s=0;s!==e;++s)t[s]=c.allocateTextureUnit();return t}function Sy(c,e){const t=this.cache;t[0]!==e&&(c.uniform1f(this.addr,e),t[0]=e)}function by(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;c.uniform2fv(this.addr,e),Lr(t,e)}}function Id(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(c.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(br(t,e))return;c.uniform3fv(this.addr,e),Lr(t,e)}}function _a(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;c.uniform4fv(this.addr,e),Lr(t,e)}}function fu(c,e){const t=this.cache,s=e.elements;if(void 0===s){if(br(t,e))return;c.uniformMatrix2fv(this.addr,!1,e),Lr(t,e)}else{if(br(t,s))return;Im.set(s),c.uniformMatrix2fv(this.addr,!1,Im),Lr(t,s)}}function Rm(c,e){const t=this.cache,s=e.elements;if(void 0===s){if(br(t,e))return;c.uniformMatrix3fv(this.addr,!1,e),Lr(t,e)}else{if(br(t,s))return;Am.set(s),c.uniformMatrix3fv(this.addr,!1,Am),Lr(t,s)}}function Pm(c,e){const t=this.cache,s=e.elements;if(void 0===s){if(br(t,e))return;c.uniformMatrix4fv(this.addr,!1,e),Lr(t,e)}else{if(br(t,s))return;Cm.set(s),c.uniformMatrix4fv(this.addr,!1,Cm),Lr(t,s)}}function Lm(c,e){const t=this.cache;t[0]!==e&&(c.uniform1i(this.addr,e),t[0]=e)}function MM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;c.uniform2iv(this.addr,e),Lr(t,e)}}function xM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;c.uniform3iv(this.addr,e),Lr(t,e)}}function EM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;c.uniform4iv(this.addr,e),Lr(t,e)}}function mf(c,e){const t=this.cache;t[0]!==e&&(c.uniform1ui(this.addr,e),t[0]=e)}function gf(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;c.uniform2uiv(this.addr,e),Lr(t,e)}}function SM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;c.uniform3uiv(this.addr,e),Lr(t,e)}}function bM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;c.uniform4uiv(this.addr,e),Lr(t,e)}}function Nm(c,e,t){const s=this.cache,o=t.allocateTextureUnit();s[0]!==o&&(c.uniform1i(this.addr,o),s[0]=o),t.setTexture2D(e||bm,o)}function wy(c,e,t){const s=this.cache,o=t.allocateTextureUnit();s[0]!==o&&(c.uniform1i(this.addr,o),s[0]=o),t.setTexture3D(e||Jo,o)}function Ty(c,e,t){const s=this.cache,o=t.allocateTextureUnit();s[0]!==o&&(c.uniform1i(this.addr,o),s[0]=o),t.setTextureCube(e||Ml,o)}function Dy(c,e,t){const s=this.cache,o=t.allocateTextureUnit();s[0]!==o&&(c.uniform1i(this.addr,o),s[0]=o),t.setTexture2DArray(e||wm,o)}function Om(c,e){c.uniform1fv(this.addr,e)}function Rd(c,e){const t=yc(e,this.size,2);c.uniform2fv(this.addr,t)}function Fm(c,e){const t=yc(e,this.size,3);c.uniform3fv(this.addr,t)}function vf(c,e){const t=yc(e,this.size,4);c.uniform4fv(this.addr,t)}function Ay(c,e){const t=yc(e,this.size,4);c.uniformMatrix2fv(this.addr,!1,t)}function gr(c,e){const t=yc(e,this.size,9);c.uniformMatrix3fv(this.addr,!1,t)}function Iy(c,e){const t=yc(e,this.size,16);c.uniformMatrix4fv(this.addr,!1,t)}function Ry(c,e){c.uniform1iv(this.addr,e)}function yf(c,e){c.uniform2iv(this.addr,e)}function Um(c,e){c.uniform3iv(this.addr,e)}function Py(c,e){c.uniform4iv(this.addr,e)}function Ly(c,e){c.uniform1uiv(this.addr,e)}function Ny(c,e){c.uniform2uiv(this.addr,e)}function Oy(c,e){c.uniform3uiv(this.addr,e)}function km(c,e){c.uniform4uiv(this.addr,e)}function wM(c,e,t){const s=this.cache,o=e.length,l=Ad(t,o);br(s,l)||(c.uniform1iv(this.addr,l),Lr(s,l));for(let d=0;d!==o;++d)t.setTexture2D(e[d]||bm,l[d])}function TM(c,e,t){const s=this.cache,o=e.length,l=Ad(t,o);br(s,l)||(c.uniform1iv(this.addr,l),Lr(s,l));for(let d=0;d!==o;++d)t.setTexture3D(e[d]||Jo,l[d])}function pu(c,e,t){const s=this.cache,o=e.length,l=Ad(t,o);br(s,l)||(c.uniform1iv(this.addr,l),Lr(s,l));for(let d=0;d!==o;++d)t.setTextureCube(e[d]||Ml,l[d])}function Si(c,e,t){const s=this.cache,o=e.length,l=Ad(t,o);br(s,l)||(c.uniform1iv(this.addr,l),Lr(s,l));for(let d=0;d!==o;++d)t.setTexture2DArray(e[d]||wm,l[d])}class Bm{constructor(e,t,s){this.id=e,this.addr=s,this.cache=[],this.setValue=function Cy(c){switch(c){case 5126:return Sy;case 35664:return by;case 35665:return Id;case 35666:return _a;case 35674:return fu;case 35675:return Rm;case 35676:return Pm;case 5124:case 35670:return Lm;case 35667:case 35671:return MM;case 35668:case 35672:return xM;case 35669:case 35673:return EM;case 5125:return mf;case 36294:return gf;case 36295:return SM;case 36296:return bM;case 35678:case 36198:case 36298:case 36306:case 35682:return Nm;case 35679:case 36299:case 36307:return wy;case 35680:case 36300:case 36308:case 36293:return Ty;case 36289:case 36303:case 36311:case 36292:return Dy}}(t.type)}}class Hm{constructor(e,t,s){this.id=e,this.addr=s,this.cache=[],this.size=t.size,this.setValue=function mu(c){switch(c){case 5126:return Om;case 35664:return Rd;case 35665:return Fm;case 35666:return vf;case 35674:return Ay;case 35675:return gr;case 35676:return Iy;case 5124:case 35670:return Ry;case 35667:case 35671:return yf;case 35668:case 35672:return Um;case 35669:case 35673:return Py;case 5125:return Ly;case 36294:return Ny;case 36295:return Oy;case 36296:return km;case 35678:case 36198:case 36298:case 36306:case 35682:return wM;case 35679:case 36299:case 36307:return TM;case 35680:case 36300:case 36308:case 36293:return pu;case 36289:case 36303:case 36311:case 36292:return Si}}(t.type)}}class zm{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,s){const o=this.seq;for(let l=0,d=o.length;l!==d;++l){const h=o[l];h.setValue(e,t[h.id],s)}}}const gu=/(\w+)(\])?(\[|\.)?/g;function _f(c,e){c.seq.push(e),c.map[e.id]=e}function Vm(c,e,t){const s=c.name,o=s.length;for(gu.lastIndex=0;;){const l=gu.exec(s);let h=l[1];const m=l[3];if("]"===l[2]&&(h|=0),void 0===m||"["===m&&gu.lastIndex+2===o){_f(t,void 0===m?new Bm(h,c,e):new Hm(h,c,e));break}{let S=t.map[h];void 0===S&&(S=new zm(h),_f(t,S)),t=S}}}class vu{constructor(e,t){this.seq=[],this.map={};const s=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<s;++o){const l=e.getActiveUniform(t,o);Vm(l,e.getUniformLocation(t,l.name),this)}}setValue(e,t,s,o){const l=this.map[t];void 0!==l&&l.setValue(e,s,o)}setOptional(e,t,s){const o=t[s];void 0!==o&&this.setValue(e,s,o)}static upload(e,t,s,o){for(let l=0,d=t.length;l!==d;++l){const h=t[l],p=s[h.id];!1!==p.needsUpdate&&h.setValue(e,p.value,o)}}static seqWithValue(e,t){const s=[];for(let o=0,l=e.length;o!==l;++o){const d=e[o];d.id in t&&s.push(d)}return s}}function Pd(c,e,t){const s=c.createShader(e);return c.shaderSource(s,t),c.compileShader(s),s}let DM=0;function Ld(c,e,t){const s=c.getShaderParameter(e,c.COMPILE_STATUS),o=c.getShaderInfoLog(e).trim();if(s&&""===o)return"";const l=/ERROR: 0:(\d+)/.exec(o);if(l){const d=parseInt(l[1]);return t.toUpperCase()+"\n\n"+o+"\n\n"+function Mf(c,e){const t=c.split("\n"),s=[],o=Math.max(e-6,0),l=Math.min(e+6,t.length);for(let d=o;d<l;d++){const h=d+1;s.push(`${h===e?">":" "} ${h}: ${t[d]}`)}return s.join("\n")}(c.getShaderSource(e),d)}return o}function Gm(c,e){const t=function Fy(c){switch(c){case er:return["Linear","( value )"];case gn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",c),["Linear","( value )"]}}(e);return"vec4 "+c+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Wm(c,e){let t;switch(e){case Ai:t="Linear";break;case Ln:t="Reinhard";break;case ls:t="OptimizedCineon";break;case Zn:t="ACESFilmic";break;case Os:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+c+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function za(c){return""!==c}function $m(c,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return c.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Nd(c,e){return c.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Od=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ma(c){return c.replace(Od,Ef)}function Ef(c,e){const t=$n[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return Ma(t)}const Sf=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jm(c){return c.replace(Sf,ky)}function ky(c,e,t,s){let o="";for(let l=parseInt(e);l<parseInt(t);l++)o+=s.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return o}function bf(c){let e="precision "+c.precision+" float;\nprecision "+c.precision+" int;";return"highp"===c.precision?e+="\n#define HIGH_PRECISION":"mediump"===c.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===c.precision&&(e+="\n#define LOW_PRECISION"),e}function Xm(c,e,t,s){const o=c.getContext(),l=t.defines;let d=t.vertexShader,h=t.fragmentShader;const p=function _c(c){let e="SHADOWMAP_TYPE_BASIC";return c.shadowMapType===ge?e="SHADOWMAP_TYPE_PCF":c.shadowMapType===gt?e="SHADOWMAP_TYPE_PCF_SOFT":c.shadowMapType===He&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function By(c){let e="ENVMAP_TYPE_CUBE";if(c.envMap)switch(c.envMapMode){case Qn:case xn:e="ENVMAP_TYPE_CUBE";break;case Tr:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),_=function Hy(c){let e="ENVMAP_MODE_REFLECTION";return c.envMap&&c.envMapMode===xn&&(e="ENVMAP_MODE_REFRACTION"),e}(t),S=function zy(c){let e="ENVMAP_BLENDING_NONE";if(c.envMap)switch(c.combine){case Vn:e="ENVMAP_BLENDING_MULTIPLY";break;case st:e="ENVMAP_BLENDING_MIX";break;case Kt:e="ENVMAP_BLENDING_ADD"}return e}(t),b=function wf(c){const e=c.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,s=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:s,maxMip:t}}(t),C=t.isWebGL2?"":function xl(c){return[c.extensionDerivatives||c.envMapCubeUVHeight||c.bumpMap||c.normalMapTangentSpace||c.clearcoatNormalMap||c.flatShading||"physical"===c.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(c.extensionFragDepth||c.logarithmicDepthBuffer)&&c.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",c.extensionDrawBuffers&&c.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(c.extensionShaderTextureLOD||c.envMap||c.transmission)&&c.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(za).join("\n")}(t),R=function Uy(c){const e=[];for(const t in c){const s=c[t];!1!==s&&e.push("#define "+t+" "+s)}return e.join("\n")}(l),N=o.createProgram();let P,I,H=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(P=[R].filter(za).join("\n"),P.length>0&&(P+="\n"),I=[C,R].filter(za).join("\n"),I.length>0&&(I+="\n")):(P=[bf(t),"#define SHADER_NAME "+t.shaderName,R,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+_:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(za).join("\n"),I=[C,bf(t),"#define SHADER_NAME "+t.shaderName,R,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+_:"",t.envMap?"#define "+S:"",b?"#define CUBEUV_TEXEL_WIDTH "+b.texelWidth:"",b?"#define CUBEUV_TEXEL_HEIGHT "+b.texelHeight:"",b?"#define CUBEUV_MAX_MIP "+b.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==$i?"#define TONE_MAPPING":"",t.toneMapping!==$i?$n.tonemapping_pars_fragment:"",t.toneMapping!==$i?Wm("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",$n.encodings_pars_fragment,Gm("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(za).join("\n")),d=Ma(d),d=$m(d,t),d=Nd(d,t),h=Ma(h),h=$m(h,t),h=Nd(h,t),d=jm(d),h=jm(h),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(H="#version 300 es\n",P=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+P,I=["#define varying in",t.glslVersion===ko?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===ko?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+I);const $=H+I+h,X=Pd(o,o.VERTEX_SHADER,H+P+d),J=Pd(o,o.FRAGMENT_SHADER,$);if(o.attachShader(N,X),o.attachShader(N,J),void 0!==t.index0AttributeName?o.bindAttribLocation(N,0,t.index0AttributeName):!0===t.morphTargets&&o.bindAttribLocation(N,0,"position"),o.linkProgram(N),c.debug.checkShaderErrors){const G=o.getProgramInfoLog(N).trim(),te=o.getShaderInfoLog(X).trim(),Pe=o.getShaderInfoLog(J).trim();let qe=!0,_e=!0;if(!1===o.getProgramParameter(N,o.LINK_STATUS))if(qe=!1,"function"==typeof c.debug.onShaderError)c.debug.onShaderError(o,N,X,J);else{const Ce=Ld(o,X,"vertex"),Fe=Ld(o,J,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(N,o.VALIDATE_STATUS)+"\n\nProgram Info Log: "+G+"\n"+Ce+"\n"+Fe)}else""!==G?console.warn("THREE.WebGLProgram: Program Info Log:",G):(""===te||""===Pe)&&(_e=!1);_e&&(this.diagnostics={runnable:qe,programLog:G,vertexShader:{log:te,prefix:P},fragmentShader:{log:Pe,prefix:I}})}let re,le;return o.deleteShader(X),o.deleteShader(J),this.getUniforms=function(){return void 0===re&&(re=new vu(o,N)),re},this.getAttributes=function(){return void 0===le&&(le=function xf(c,e){const t={},s=c.getProgramParameter(e,c.ACTIVE_ATTRIBUTES);for(let o=0;o<s;o++){const l=c.getActiveAttrib(e,o),d=l.name;let h=1;l.type===c.FLOAT_MAT2&&(h=2),l.type===c.FLOAT_MAT3&&(h=3),l.type===c.FLOAT_MAT4&&(h=4),t[d]={type:l.type,location:c.getAttribLocation(e,d),locationSize:h}}return t}(o,N)),le},this.destroy=function(){s.releaseStatesOfProgram(this),o.deleteProgram(N),this.program=void 0},this.name=t.shaderName,this.id=DM++,this.cacheKey=e,this.usedTimes=1,this.program=N,this.vertexShader=X,this.fragmentShader=J,this}let Vy=0;class Ym{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const s=e.fragmentShader,o=this._getShaderStage(e.vertexShader),l=this._getShaderStage(s),d=this._getShaderCacheForMaterial(e);return!1===d.has(o)&&(d.add(o),o.usedTimes++),!1===d.has(l)&&(d.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const s of t)s.usedTimes--,0===s.usedTimes&&this.shaderCache.delete(s.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let s=t.get(e);return void 0===s&&(s=new Set,t.set(e,s)),s}_getShaderStage(e){const t=this.shaderCache;let s=t.get(e);return void 0===s&&(s=new Tf(e),t.set(e,s)),s}}class Tf{constructor(e){this.id=Vy++,this.code=e,this.usedTimes=0}}function CM(c,e,t,s,o,l,d){const h=new ic,p=new Ym,m=[],_=o.isWebGL2,S=o.logarithmicDepthBuffer,b=o.vertexTextures;let C=o.precision;const R={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function N(G){return 1===G?"uv1":2===G?"uv2":3===G?"uv3":"uv"}return{getParameters:function P(G,te,Pe,qe,_e){const Ce=qe.fog,Fe=_e.geometry,ut=(G.isMeshStandardMaterial?t:e).get(G.envMap||(G.isMeshStandardMaterial?qe.environment:null)),at=ut&&ut.mapping===Tr?ut.image.height:null,mt=R[G.type];null!==G.precision&&(C=o.getMaxPrecision(G.precision),C!==G.precision&&console.warn("THREE.WebGLProgram.getParameters:",G.precision,"not supported, using",C,"instead."));const St=Fe.morphAttributes.position||Fe.morphAttributes.normal||Fe.morphAttributes.color,Yt=void 0!==St?St.length:0;let ze,pt,Lt,Gt,Vt=0;if(void 0!==Fe.morphAttributes.position&&(Vt=1),void 0!==Fe.morphAttributes.normal&&(Vt=2),void 0!==Fe.morphAttributes.color&&(Vt=3),mt){const bi=bo[mt];ze=bi.vertexShader,pt=bi.fragmentShader}else ze=G.vertexShader,pt=G.fragmentShader,p.update(G),Lt=p.getVertexShaderID(G),Gt=p.getFragmentShaderID(G);const de=c.getRenderTarget(),yn=!0===_e.isInstancedMesh,Rn=!!G.map,dn=!!ut,_t=!!G.aoMap,Ye=!!G.lightMap,xt=!!G.bumpMap,nt=!!G.normalMap,Bt=!!G.displacementMap,wn=!!G.emissiveMap,Tn=!!G.metalnessMap,cn=!!G.roughnessMap,Jn=G.clearcoat>0,ci=G.iridescence>0,ne=G.sheen>0,j=G.transmission>0,Ne=Jn&&!!G.clearcoatMap,bt=Jn&&!!G.clearcoatNormalMap,At=Jn&&!!G.clearcoatRoughnessMap,zt=ci&&!!G.iridescenceMap,Dn=ci&&!!G.iridescenceThicknessMap,qt=ne&&!!G.sheenColorMap,je=ne&&!!G.sheenRoughnessMap,sn=!!G.specularMap,_n=!!G.specularColorMap,Cn=!!G.specularIntensityMap,Qt=j&&!!G.transmissionMap,on=j&&!!G.thicknessMap,Li=!!G.alphaMap,he=!!G.extensions,Ge=!!Fe.attributes.uv1,Tt=!!Fe.attributes.uv2,$t=!!Fe.attributes.uv3;return{isWebGL2:_,shaderID:mt,shaderName:G.type,vertexShader:ze,fragmentShader:pt,defines:G.defines,customVertexShaderID:Lt,customFragmentShaderID:Gt,isRawShaderMaterial:!0===G.isRawShaderMaterial,glslVersion:G.glslVersion,precision:C,instancing:yn,instancingColor:yn&&null!==_e.instanceColor,supportsVertexTextures:b,outputColorSpace:null===de?c.outputColorSpace:!0===de.isXRRenderTarget?de.texture.colorSpace:er,map:Rn,matcap:!!G.matcap,envMap:dn,envMapMode:dn&&ut.mapping,envMapCubeUVHeight:at,aoMap:_t,lightMap:Ye,bumpMap:xt,normalMap:nt,displacementMap:b&&Bt,emissiveMap:wn,normalMapObjectSpace:nt&&1===G.normalMapType,normalMapTangentSpace:nt&&G.normalMapType===pr,metalnessMap:Tn,roughnessMap:cn,clearcoat:Jn,clearcoatMap:Ne,clearcoatNormalMap:bt,clearcoatRoughnessMap:At,iridescence:ci,iridescenceMap:zt,iridescenceThicknessMap:Dn,sheen:ne,sheenColorMap:qt,sheenRoughnessMap:je,specularMap:sn,specularColorMap:_n,specularIntensityMap:Cn,transmission:j,transmissionMap:Qt,thicknessMap:on,gradientMap:!!G.gradientMap,opaque:!1===G.transparent&&1===G.blending,alphaMap:Li,alphaTest:G.alphaTest>0,combine:G.combine,mapUv:Rn&&N(G.map.channel),aoMapUv:_t&&N(G.aoMap.channel),lightMapUv:Ye&&N(G.lightMap.channel),bumpMapUv:xt&&N(G.bumpMap.channel),normalMapUv:nt&&N(G.normalMap.channel),displacementMapUv:Bt&&N(G.displacementMap.channel),emissiveMapUv:wn&&N(G.emissiveMap.channel),metalnessMapUv:Tn&&N(G.metalnessMap.channel),roughnessMapUv:cn&&N(G.roughnessMap.channel),clearcoatMapUv:Ne&&N(G.clearcoatMap.channel),clearcoatNormalMapUv:bt&&N(G.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:At&&N(G.clearcoatRoughnessMap.channel),iridescenceMapUv:zt&&N(G.iridescenceMap.channel),iridescenceThicknessMapUv:Dn&&N(G.iridescenceThicknessMap.channel),sheenColorMapUv:qt&&N(G.sheenColorMap.channel),sheenRoughnessMapUv:je&&N(G.sheenRoughnessMap.channel),specularMapUv:sn&&N(G.specularMap.channel),specularColorMapUv:_n&&N(G.specularColorMap.channel),specularIntensityMapUv:Cn&&N(G.specularIntensityMap.channel),transmissionMapUv:Qt&&N(G.transmissionMap.channel),thicknessMapUv:on&&N(G.thicknessMap.channel),alphaMapUv:Li&&N(G.alphaMap.channel),vertexTangents:nt&&!!Fe.attributes.tangent,vertexColors:G.vertexColors,vertexAlphas:!0===G.vertexColors&&!!Fe.attributes.color&&4===Fe.attributes.color.itemSize,vertexUv1s:Ge,vertexUv2s:Tt,vertexUv3s:$t,pointsUvs:!0===_e.isPoints&&!!Fe.attributes.uv&&(Rn||Li),fog:!!Ce,useFog:!0===G.fog,fogExp2:Ce&&Ce.isFogExp2,flatShading:!0===G.flatShading,sizeAttenuation:!0===G.sizeAttenuation,logarithmicDepthBuffer:S,skinning:!0===_e.isSkinnedMesh,morphTargets:void 0!==Fe.morphAttributes.position,morphNormals:void 0!==Fe.morphAttributes.normal,morphColors:void 0!==Fe.morphAttributes.color,morphTargetsCount:Yt,morphTextureStride:Vt,numDirLights:te.directional.length,numPointLights:te.point.length,numSpotLights:te.spot.length,numSpotLightMaps:te.spotLightMap.length,numRectAreaLights:te.rectArea.length,numHemiLights:te.hemi.length,numDirLightShadows:te.directionalShadowMap.length,numPointLightShadows:te.pointShadowMap.length,numSpotLightShadows:te.spotShadowMap.length,numSpotLightShadowsWithMaps:te.numSpotLightShadowsWithMaps,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:G.dithering,shadowMapEnabled:c.shadowMap.enabled&&Pe.length>0,shadowMapType:c.shadowMap.type,toneMapping:G.toneMapped?c.toneMapping:$i,useLegacyLights:c.useLegacyLights,premultipliedAlpha:G.premultipliedAlpha,doubleSided:G.side===Ut,flipSided:G.side===it,useDepthPacking:G.depthPacking>=0,depthPacking:G.depthPacking||0,index0AttributeName:G.index0AttributeName,extensionDerivatives:he&&!0===G.extensions.derivatives,extensionFragDepth:he&&!0===G.extensions.fragDepth,extensionDrawBuffers:he&&!0===G.extensions.drawBuffers,extensionShaderTextureLOD:he&&!0===G.extensions.shaderTextureLOD,rendererExtensionFragDepth:_||s.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||s.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||s.has("EXT_shader_texture_lod"),customProgramCacheKey:G.customProgramCacheKey()}},getProgramCacheKey:function I(G){const te=[];if(G.shaderID?te.push(G.shaderID):(te.push(G.customVertexShaderID),te.push(G.customFragmentShaderID)),void 0!==G.defines)for(const Pe in G.defines)te.push(Pe),te.push(G.defines[Pe]);return!1===G.isRawShaderMaterial&&(function H(G,te){G.push(te.precision),G.push(te.outputColorSpace),G.push(te.envMapMode),G.push(te.envMapCubeUVHeight),G.push(te.mapUv),G.push(te.alphaMapUv),G.push(te.lightMapUv),G.push(te.aoMapUv),G.push(te.bumpMapUv),G.push(te.normalMapUv),G.push(te.displacementMapUv),G.push(te.emissiveMapUv),G.push(te.metalnessMapUv),G.push(te.roughnessMapUv),G.push(te.clearcoatMapUv),G.push(te.clearcoatNormalMapUv),G.push(te.clearcoatRoughnessMapUv),G.push(te.iridescenceMapUv),G.push(te.iridescenceThicknessMapUv),G.push(te.sheenColorMapUv),G.push(te.sheenRoughnessMapUv),G.push(te.specularMapUv),G.push(te.specularColorMapUv),G.push(te.specularIntensityMapUv),G.push(te.transmissionMapUv),G.push(te.thicknessMapUv),G.push(te.combine),G.push(te.fogExp2),G.push(te.sizeAttenuation),G.push(te.morphTargetsCount),G.push(te.morphAttributeCount),G.push(te.numDirLights),G.push(te.numPointLights),G.push(te.numSpotLights),G.push(te.numSpotLightMaps),G.push(te.numHemiLights),G.push(te.numRectAreaLights),G.push(te.numDirLightShadows),G.push(te.numPointLightShadows),G.push(te.numSpotLightShadows),G.push(te.numSpotLightShadowsWithMaps),G.push(te.shadowMapType),G.push(te.toneMapping),G.push(te.numClippingPlanes),G.push(te.numClipIntersection),G.push(te.depthPacking)}(te,G),function U(G,te){h.disableAll(),te.isWebGL2&&h.enable(0),te.supportsVertexTextures&&h.enable(1),te.instancing&&h.enable(2),te.instancingColor&&h.enable(3),te.matcap&&h.enable(4),te.envMap&&h.enable(5),te.normalMapObjectSpace&&h.enable(6),te.normalMapTangentSpace&&h.enable(7),te.clearcoat&&h.enable(8),te.iridescence&&h.enable(9),te.alphaTest&&h.enable(10),te.vertexColors&&h.enable(11),te.vertexAlphas&&h.enable(12),te.vertexUv1s&&h.enable(13),te.vertexUv2s&&h.enable(14),te.vertexUv3s&&h.enable(15),te.vertexTangents&&h.enable(16),G.push(h.mask),h.disableAll(),te.fog&&h.enable(0),te.useFog&&h.enable(1),te.flatShading&&h.enable(2),te.logarithmicDepthBuffer&&h.enable(3),te.skinning&&h.enable(4),te.morphTargets&&h.enable(5),te.morphNormals&&h.enable(6),te.morphColors&&h.enable(7),te.premultipliedAlpha&&h.enable(8),te.shadowMapEnabled&&h.enable(9),te.useLegacyLights&&h.enable(10),te.doubleSided&&h.enable(11),te.flipSided&&h.enable(12),te.useDepthPacking&&h.enable(13),te.dithering&&h.enable(14),te.transmission&&h.enable(15),te.sheen&&h.enable(16),te.opaque&&h.enable(17),te.pointsUvs&&h.enable(18),G.push(h.mask)}(te,G),te.push(c.outputColorSpace)),te.push(G.customProgramCacheKey),te.join()},getUniforms:function $(G){const te=R[G.type];let Pe;return Pe=te?Gh.clone(bo[te].uniforms):G.uniforms,Pe},acquireProgram:function X(G,te){let Pe;for(let qe=0,_e=m.length;qe<_e;qe++){const Ce=m[qe];if(Ce.cacheKey===te){Pe=Ce,++Pe.usedTimes;break}}return void 0===Pe&&(Pe=new Xm(c,te,G,l),m.push(Pe)),Pe},releaseProgram:function J(G){if(0==--G.usedTimes){const te=m.indexOf(G);m[te]=m[m.length-1],m.pop(),G.destroy()}},releaseShaderCache:function re(G){p.remove(G)},programs:m,dispose:function le(){p.dispose()}}}function AM(){let c=new WeakMap;return{get:function e(l){let d=c.get(l);return void 0===d&&(d={},c.set(l,d)),d},remove:function t(l){c.delete(l)},update:function s(l,d,h){c.get(l)[d]=h},dispose:function o(){c=new WeakMap}}}function Gy(c,e){return c.groupOrder!==e.groupOrder?c.groupOrder-e.groupOrder:c.renderOrder!==e.renderOrder?c.renderOrder-e.renderOrder:c.material.id!==e.material.id?c.material.id-e.material.id:c.z!==e.z?c.z-e.z:c.id-e.id}function qm(c,e){return c.groupOrder!==e.groupOrder?c.groupOrder-e.groupOrder:c.renderOrder!==e.renderOrder?c.renderOrder-e.renderOrder:c.z!==e.z?e.z-c.z:c.id-e.id}function Wy(){const c=[];let e=0;const t=[],s=[],o=[];function d(S,b,C,R,N,P){let I=c[e];return void 0===I?(I={id:S.id,object:S,geometry:b,material:C,groupOrder:R,renderOrder:S.renderOrder,z:N,group:P},c[e]=I):(I.id=S.id,I.object=S,I.geometry=b,I.material=C,I.groupOrder=R,I.renderOrder=S.renderOrder,I.z=N,I.group=P),e++,I}return{opaque:t,transmissive:s,transparent:o,init:function l(){e=0,t.length=0,s.length=0,o.length=0},push:function h(S,b,C,R,N,P){const I=d(S,b,C,R,N,P);C.transmission>0?s.push(I):!0===C.transparent?o.push(I):t.push(I)},unshift:function p(S,b,C,R,N,P){const I=d(S,b,C,R,N,P);C.transmission>0?s.unshift(I):!0===C.transparent?o.unshift(I):t.unshift(I)},finish:function _(){for(let S=e,b=c.length;S<b;S++){const C=c[S];if(null===C.id)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}},sort:function m(S,b){t.length>1&&t.sort(S||Gy),s.length>1&&s.sort(b||qm),o.length>1&&o.sort(b||qm)}}}function $y(){let c=new WeakMap;return{get:function e(s,o){const l=c.get(s);let d;return void 0===l?(d=new Wy,c.set(s,[d])):o>=l.length?(d=new Wy,l.push(d)):d=l[o],d},dispose:function t(){c=new WeakMap}}}function IM(){const c={};return{get:function(e){if(void 0!==c[e.id])return c[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new K,color:new B};break;case"SpotLight":t={position:new K,direction:new K,color:new B,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new K,color:new B,distance:0,decay:0};break;case"HemisphereLight":t={direction:new K,skyColor:new B,groundColor:new B};break;case"RectAreaLight":t={color:new B,position:new K,halfWidth:new K,halfHeight:new K}}return c[e.id]=t,t}}}let Fd=0;function jy(c,e){return(e.castShadow?2:0)-(c.castShadow?2:0)+(e.map?1:0)-(c.map?1:0)}function Df(c,e){const t=new IM,s=function RM(){const c={};return{get:function(e){if(void 0!==c[e.id])return c[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ke};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ke,shadowCameraNear:1,shadowCameraFar:1e3}}return c[e.id]=t,t}}}(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let _=0;_<9;_++)o.probe.push(new K);const l=new K,d=new kt,h=new kt;return{setup:function p(_,S){let b=0,C=0,R=0;for(let Pe=0;Pe<9;Pe++)o.probe[Pe].set(0,0,0);let N=0,P=0,I=0,H=0,U=0,$=0,X=0,J=0,re=0,le=0;_.sort(jy);const G=!0===S?Math.PI:1;for(let Pe=0,qe=_.length;Pe<qe;Pe++){const _e=_[Pe],Ce=_e.color,Fe=_e.intensity,ft=_e.distance,ut=_e.shadow&&_e.shadow.map?_e.shadow.map.texture:null;if(_e.isAmbientLight)b+=Ce.r*Fe*G,C+=Ce.g*Fe*G,R+=Ce.b*Fe*G;else if(_e.isLightProbe)for(let at=0;at<9;at++)o.probe[at].addScaledVector(_e.sh.coefficients[at],Fe);else if(_e.isDirectionalLight){const at=t.get(_e);if(at.color.copy(_e.color).multiplyScalar(_e.intensity*G),_e.castShadow){const mt=_e.shadow,St=s.get(_e);St.shadowBias=mt.bias,St.shadowNormalBias=mt.normalBias,St.shadowRadius=mt.radius,St.shadowMapSize=mt.mapSize,o.directionalShadow[N]=St,o.directionalShadowMap[N]=ut,o.directionalShadowMatrix[N]=_e.shadow.matrix,$++}o.directional[N]=at,N++}else if(_e.isSpotLight){const at=t.get(_e);at.position.setFromMatrixPosition(_e.matrixWorld),at.color.copy(Ce).multiplyScalar(Fe*G),at.distance=ft,at.coneCos=Math.cos(_e.angle),at.penumbraCos=Math.cos(_e.angle*(1-_e.penumbra)),at.decay=_e.decay,o.spot[I]=at;const mt=_e.shadow;if(_e.map&&(o.spotLightMap[re]=_e.map,re++,mt.updateMatrices(_e),_e.castShadow&&le++),o.spotLightMatrix[I]=mt.matrix,_e.castShadow){const St=s.get(_e);St.shadowBias=mt.bias,St.shadowNormalBias=mt.normalBias,St.shadowRadius=mt.radius,St.shadowMapSize=mt.mapSize,o.spotShadow[I]=St,o.spotShadowMap[I]=ut,J++}I++}else if(_e.isRectAreaLight){const at=t.get(_e);at.color.copy(Ce).multiplyScalar(Fe),at.halfWidth.set(.5*_e.width,0,0),at.halfHeight.set(0,.5*_e.height,0),o.rectArea[H]=at,H++}else if(_e.isPointLight){const at=t.get(_e);if(at.color.copy(_e.color).multiplyScalar(_e.intensity*G),at.distance=_e.distance,at.decay=_e.decay,_e.castShadow){const mt=_e.shadow,St=s.get(_e);St.shadowBias=mt.bias,St.shadowNormalBias=mt.normalBias,St.shadowRadius=mt.radius,St.shadowMapSize=mt.mapSize,St.shadowCameraNear=mt.camera.near,St.shadowCameraFar=mt.camera.far,o.pointShadow[P]=St,o.pointShadowMap[P]=ut,o.pointShadowMatrix[P]=_e.shadow.matrix,X++}o.point[P]=at,P++}else if(_e.isHemisphereLight){const at=t.get(_e);at.skyColor.copy(_e.color).multiplyScalar(Fe*G),at.groundColor.copy(_e.groundColor).multiplyScalar(Fe*G),o.hemi[U]=at,U++}}H>0&&(e.isWebGL2||!0===c.has("OES_texture_float_linear")?(o.rectAreaLTC1=Ft.LTC_FLOAT_1,o.rectAreaLTC2=Ft.LTC_FLOAT_2):!0===c.has("OES_texture_half_float_linear")?(o.rectAreaLTC1=Ft.LTC_HALF_1,o.rectAreaLTC2=Ft.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=b,o.ambient[1]=C,o.ambient[2]=R;const te=o.hash;(te.directionalLength!==N||te.pointLength!==P||te.spotLength!==I||te.rectAreaLength!==H||te.hemiLength!==U||te.numDirectionalShadows!==$||te.numPointShadows!==X||te.numSpotShadows!==J||te.numSpotMaps!==re)&&(o.directional.length=N,o.spot.length=I,o.rectArea.length=H,o.point.length=P,o.hemi.length=U,o.directionalShadow.length=$,o.directionalShadowMap.length=$,o.pointShadow.length=X,o.pointShadowMap.length=X,o.spotShadow.length=J,o.spotShadowMap.length=J,o.directionalShadowMatrix.length=$,o.pointShadowMatrix.length=X,o.spotLightMatrix.length=J+re-le,o.spotLightMap.length=re,o.numSpotLightShadowsWithMaps=le,te.directionalLength=N,te.pointLength=P,te.spotLength=I,te.rectAreaLength=H,te.hemiLength=U,te.numDirectionalShadows=$,te.numPointShadows=X,te.numSpotShadows=J,te.numSpotMaps=re,o.version=Fd++)},setupView:function m(_,S){let b=0,C=0,R=0,N=0,P=0;const I=S.matrixWorldInverse;for(let H=0,U=_.length;H<U;H++){const $=_[H];if($.isDirectionalLight){const X=o.directional[b];X.direction.setFromMatrixPosition($.matrixWorld),l.setFromMatrixPosition($.target.matrixWorld),X.direction.sub(l),X.direction.transformDirection(I),b++}else if($.isSpotLight){const X=o.spot[R];X.position.setFromMatrixPosition($.matrixWorld),X.position.applyMatrix4(I),X.direction.setFromMatrixPosition($.matrixWorld),l.setFromMatrixPosition($.target.matrixWorld),X.direction.sub(l),X.direction.transformDirection(I),R++}else if($.isRectAreaLight){const X=o.rectArea[N];X.position.setFromMatrixPosition($.matrixWorld),X.position.applyMatrix4(I),h.identity(),d.copy($.matrixWorld),d.premultiply(I),h.extractRotation(d),X.halfWidth.set(.5*$.width,0,0),X.halfHeight.set(0,.5*$.height,0),X.halfWidth.applyMatrix4(h),X.halfHeight.applyMatrix4(h),N++}else if($.isPointLight){const X=o.point[C];X.position.setFromMatrixPosition($.matrixWorld),X.position.applyMatrix4(I),C++}else if($.isHemisphereLight){const X=o.hemi[P];X.direction.setFromMatrixPosition($.matrixWorld),X.direction.transformDirection(I),P++}}},state:o}}function Ud(c,e){const t=new Df(c,e),s=[],o=[];return{init:function l(){s.length=0,o.length=0},state:{lightsArray:s,shadowsArray:o,lights:t},setupLights:function p(S){t.setup(s,S)},setupLightsView:function m(S){t.setupView(s,S)},pushLight:function d(S){s.push(S)},pushShadow:function h(S){o.push(S)}}}function yu(c,e){let t=new WeakMap;return{get:function s(l,d=0){const h=t.get(l);let p;return void 0===h?(p=new Ud(c,e),t.set(l,[p])):d>=h.length?(p=new Ud(c,e),h.push(p)):p=h[d],p},dispose:function o(){t=new WeakMap}}}class kd extends E{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Bd extends E{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Mu(c,e,t){let s=new Gp;const o=new Ke,l=new Ke,d=new Ei,h=new kd({depthPacking:3201}),p=new Bd,m={},_=t.maxTextureSize,S={[ke]:it,[it]:ke,[Ut]:Ut},b=new Zs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ke},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),C=b.clone();C.defines.HORIZONTAL_PASS=1;const R=new Kn;R.setAttribute("position",new Gi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const N=new ns(R,b),P=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ge;let I=this.type;function H(X,J){const re=e.update(N);b.defines.VSM_SAMPLES!==X.blurSamples&&(b.defines.VSM_SAMPLES=X.blurSamples,C.defines.VSM_SAMPLES=X.blurSamples,b.needsUpdate=!0,C.needsUpdate=!0),null===X.mapPass&&(X.mapPass=new ro(o.x,o.y)),b.uniforms.shadow_pass.value=X.map.texture,b.uniforms.resolution.value=X.mapSize,b.uniforms.radius.value=X.radius,c.setRenderTarget(X.mapPass),c.clear(),c.renderBufferDirect(J,null,re,b,N,null),C.uniforms.shadow_pass.value=X.mapPass.texture,C.uniforms.resolution.value=X.mapSize,C.uniforms.radius.value=X.radius,c.setRenderTarget(X.map),c.clear(),c.renderBufferDirect(J,null,re,C,N,null)}function U(X,J,re,le){let G=null;const te=!0===re.isPointLight?X.customDistanceMaterial:X.customDepthMaterial;if(void 0!==te)G=te;else if(G=!0===re.isPointLight?p:h,c.localClippingEnabled&&!0===J.clipShadows&&Array.isArray(J.clippingPlanes)&&0!==J.clippingPlanes.length||J.displacementMap&&0!==J.displacementScale||J.alphaMap&&J.alphaTest>0||J.map&&J.alphaTest>0){const Pe=G.uuid,qe=J.uuid;let _e=m[Pe];void 0===_e&&(_e={},m[Pe]=_e);let Ce=_e[qe];void 0===Ce&&(Ce=G.clone(),_e[qe]=Ce),G=Ce}return G.visible=J.visible,G.wireframe=J.wireframe,G.side=le===He?null!==J.shadowSide?J.shadowSide:J.side:null!==J.shadowSide?J.shadowSide:S[J.side],G.alphaMap=J.alphaMap,G.alphaTest=J.alphaTest,G.map=J.map,G.clipShadows=J.clipShadows,G.clippingPlanes=J.clippingPlanes,G.clipIntersection=J.clipIntersection,G.displacementMap=J.displacementMap,G.displacementScale=J.displacementScale,G.displacementBias=J.displacementBias,G.wireframeLinewidth=J.wireframeLinewidth,G.linewidth=J.linewidth,!0===re.isPointLight&&!0===G.isMeshDistanceMaterial&&(c.properties.get(G).light=re),G}function $(X,J,re,le,G){if(!1===X.visible)return;if(X.layers.test(J.layers)&&(X.isMesh||X.isLine||X.isPoints)&&(X.castShadow||X.receiveShadow&&G===He)&&(!X.frustumCulled||s.intersectsObject(X))){X.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,X.matrixWorld);const qe=e.update(X),_e=X.material;if(Array.isArray(_e)){const Ce=qe.groups;for(let Fe=0,ft=Ce.length;Fe<ft;Fe++){const ut=Ce[Fe],at=_e[ut.materialIndex];if(at&&at.visible){const mt=U(X,at,le,G);c.renderBufferDirect(re,null,qe,mt,X,ut)}}}else if(_e.visible){const Ce=U(X,_e,le,G);c.renderBufferDirect(re,null,qe,Ce,X,null)}}const Pe=X.children;for(let qe=0,_e=Pe.length;qe<_e;qe++)$(Pe[qe],J,re,le,G)}this.render=function(X,J,re){if(!1===P.enabled||!1===P.autoUpdate&&!1===P.needsUpdate||0===X.length)return;const le=c.getRenderTarget(),G=c.getActiveCubeFace(),te=c.getActiveMipmapLevel(),Pe=c.state;Pe.setBlending(pn),Pe.buffers.color.setClear(1,1,1,1),Pe.buffers.depth.setTest(!0),Pe.setScissorTest(!1);const qe=I!==He&&this.type===He,_e=I===He&&this.type!==He;for(let Ce=0,Fe=X.length;Ce<Fe;Ce++){const ft=X[Ce],ut=ft.shadow;if(void 0===ut){console.warn("THREE.WebGLShadowMap:",ft,"has no shadow.");continue}if(!1===ut.autoUpdate&&!1===ut.needsUpdate)continue;o.copy(ut.mapSize);const at=ut.getFrameExtents();if(o.multiply(at),l.copy(ut.mapSize),(o.x>_||o.y>_)&&(o.x>_&&(l.x=Math.floor(_/at.x),o.x=l.x*at.x,ut.mapSize.x=l.x),o.y>_&&(l.y=Math.floor(_/at.y),o.y=l.y*at.y,ut.mapSize.y=l.y)),null===ut.map||!0===qe||!0===_e){const St=this.type!==He?{minFilter:li,magFilter:li}:{};null!==ut.map&&ut.map.dispose(),ut.map=new ro(o.x,o.y,St),ut.map.texture.name=ft.name+".shadowMap",ut.camera.updateProjectionMatrix()}c.setRenderTarget(ut.map),c.clear();const mt=ut.getViewportCount();for(let St=0;St<mt;St++){const Yt=ut.getViewport(St);d.set(l.x*Yt.x,l.y*Yt.y,l.x*Yt.z,l.y*Yt.w),Pe.viewport(d),ut.updateMatrices(ft,St),s=ut.getFrustum(),$(J,re,ut.camera,ft,this.type)}!0!==ut.isPointLightShadow&&this.type===He&&H(ut,re),ut.needsUpdate=!1}I=this.type,P.needsUpdate=!1,c.setRenderTarget(le,G,te)}}function Zm(c,e,t){const s=t.isWebGL2,h=new function o(){let he=!1;const Ge=new Ei;let Tt=null;const $t=new Ei(0,0,0,0);return{setMask:function(hn){Tt!==hn&&!he&&(c.colorMask(hn,hn,hn,hn),Tt=hn)},setLocked:function(hn){he=hn},setClear:function(hn,bi,wi,as,Za){!0===Za&&(hn*=as,bi*=as,wi*=as),Ge.set(hn,bi,wi,as),!1===$t.equals(Ge)&&(c.clearColor(hn,bi,wi,as),$t.copy(Ge))},reset:function(){he=!1,Tt=null,$t.set(-1,0,0,0)}}},p=new function l(){let he=!1,Ge=null,Tt=null,$t=null;return{setTest:function(hn){hn?de(c.DEPTH_TEST):yn(c.DEPTH_TEST)},setMask:function(hn){Ge!==hn&&!he&&(c.depthMask(hn),Ge=hn)},setFunc:function(hn){if(Tt!==hn){switch(hn){case 0:c.depthFunc(c.NEVER);break;case 1:c.depthFunc(c.ALWAYS);break;case 2:c.depthFunc(c.LESS);break;case 3:default:c.depthFunc(c.LEQUAL);break;case 4:c.depthFunc(c.EQUAL);break;case 5:c.depthFunc(c.GEQUAL);break;case 6:c.depthFunc(c.GREATER);break;case 7:c.depthFunc(c.NOTEQUAL)}Tt=hn}},setLocked:function(hn){he=hn},setClear:function(hn){$t!==hn&&(c.clearDepth(hn),$t=hn)},reset:function(){he=!1,Ge=null,Tt=null,$t=null}}},m=new function d(){let he=!1,Ge=null,Tt=null,$t=null,hn=null,bi=null,wi=null,as=null,Za=null;return{setTest:function(yr){he||(yr?de(c.STENCIL_TEST):yn(c.STENCIL_TEST))},setMask:function(yr){Ge!==yr&&!he&&(c.stencilMask(yr),Ge=yr)},setFunc:function(yr,Qs,Io){(Tt!==yr||$t!==Qs||hn!==Io)&&(c.stencilFunc(yr,Qs,Io),Tt=yr,$t=Qs,hn=Io)},setOp:function(yr,Qs,Io){(bi!==yr||wi!==Qs||as!==Io)&&(c.stencilOp(yr,Qs,Io),bi=yr,wi=Qs,as=Io)},setLocked:function(yr){he=yr},setClear:function(yr){Za!==yr&&(c.clearStencil(yr),Za=yr)},reset:function(){he=!1,Ge=null,Tt=null,$t=null,hn=null,bi=null,wi=null,as=null,Za=null}}},_=new WeakMap,S=new WeakMap;let b={},C={},R=new WeakMap,N=[],P=null,I=!1,H=null,U=null,$=null,X=null,J=null,re=null,le=null,G=!1,te=null,Pe=null,qe=null,_e=null,Ce=null;const Fe=c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ft=!1,ut=0;const at=c.getParameter(c.VERSION);-1!==at.indexOf("WebGL")?(ut=parseFloat(/^WebGL (\d)/.exec(at)[1]),ft=ut>=1):-1!==at.indexOf("OpenGL ES")&&(ut=parseFloat(/^OpenGL ES (\d)/.exec(at)[1]),ft=ut>=2);let mt=null,St={};const Yt=c.getParameter(c.SCISSOR_BOX),Vt=c.getParameter(c.VIEWPORT),ze=(new Ei).fromArray(Yt),pt=(new Ei).fromArray(Vt);function Lt(he,Ge,Tt,$t){const hn=new Uint8Array(4),bi=c.createTexture();c.bindTexture(he,bi),c.texParameteri(he,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(he,c.TEXTURE_MAG_FILTER,c.NEAREST);for(let wi=0;wi<Tt;wi++)!s||he!==c.TEXTURE_3D&&he!==c.TEXTURE_2D_ARRAY?c.texImage2D(Ge+wi,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,hn):c.texImage3D(Ge,0,c.RGBA,1,1,$t,0,c.RGBA,c.UNSIGNED_BYTE,hn);return bi}const Gt={};function de(he){!0!==b[he]&&(c.enable(he),b[he]=!0)}function yn(he){!1!==b[he]&&(c.disable(he),b[he]=!1)}Gt[c.TEXTURE_2D]=Lt(c.TEXTURE_2D,c.TEXTURE_2D,1),Gt[c.TEXTURE_CUBE_MAP]=Lt(c.TEXTURE_CUBE_MAP,c.TEXTURE_CUBE_MAP_POSITIVE_X,6),s&&(Gt[c.TEXTURE_2D_ARRAY]=Lt(c.TEXTURE_2D_ARRAY,c.TEXTURE_2D_ARRAY,1,1),Gt[c.TEXTURE_3D]=Lt(c.TEXTURE_3D,c.TEXTURE_3D,1,1)),h.setClear(0,0,0,1),p.setClear(1),m.setClear(0),de(c.DEPTH_TEST),p.setFunc(3),Bt(!1),wn(1),de(c.CULL_FACE),xt(pn);const _t={100:c.FUNC_ADD,101:c.FUNC_SUBTRACT,102:c.FUNC_REVERSE_SUBTRACT};if(s)_t[103]=c.MIN,_t[104]=c.MAX;else{const he=e.get("EXT_blend_minmax");null!==he&&(_t[103]=he.MIN_EXT,_t[104]=he.MAX_EXT)}const Ye={200:c.ZERO,201:c.ONE,202:c.SRC_COLOR,204:c.SRC_ALPHA,210:c.SRC_ALPHA_SATURATE,208:c.DST_COLOR,206:c.DST_ALPHA,203:c.ONE_MINUS_SRC_COLOR,205:c.ONE_MINUS_SRC_ALPHA,209:c.ONE_MINUS_DST_COLOR,207:c.ONE_MINUS_DST_ALPHA};function xt(he,Ge,Tt,$t,hn,bi,wi,as){if(he!==pn){if(!1===I&&(de(c.BLEND),I=!0),5===he)hn=hn||Ge,bi=bi||Tt,wi=wi||$t,(Ge!==U||hn!==J)&&(c.blendEquationSeparate(_t[Ge],_t[hn]),U=Ge,J=hn),(Tt!==$||$t!==X||bi!==re||wi!==le)&&(c.blendFuncSeparate(Ye[Tt],Ye[$t],Ye[bi],Ye[wi]),$=Tt,X=$t,re=bi,le=wi),H=he,G=!1;else if(he!==H||as!==G){if((100!==U||100!==J)&&(c.blendEquation(c.FUNC_ADD),U=100,J=100),as)switch(he){case 1:c.blendFuncSeparate(c.ONE,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case 2:c.blendFunc(c.ONE,c.ONE);break;case 3:c.blendFuncSeparate(c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);break;case 4:c.blendFuncSeparate(c.ZERO,c.SRC_COLOR,c.ZERO,c.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",he)}else switch(he){case 1:c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case 2:c.blendFunc(c.SRC_ALPHA,c.ONE);break;case 3:c.blendFuncSeparate(c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);break;case 4:c.blendFunc(c.ZERO,c.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",he)}$=null,X=null,re=null,le=null,H=he,G=as}}else!0===I&&(yn(c.BLEND),I=!1)}function Bt(he){te!==he&&(c.frontFace(he?c.CW:c.CCW),te=he)}function wn(he){0!==he?(de(c.CULL_FACE),he!==Pe&&c.cullFace(1===he?c.BACK:2===he?c.FRONT:c.FRONT_AND_BACK)):yn(c.CULL_FACE),Pe=he}function cn(he,Ge,Tt){he?(de(c.POLYGON_OFFSET_FILL),(_e!==Ge||Ce!==Tt)&&(c.polygonOffset(Ge,Tt),_e=Ge,Ce=Tt)):yn(c.POLYGON_OFFSET_FILL)}return{buffers:{color:h,depth:p,stencil:m},enable:de,disable:yn,bindFramebuffer:function Rn(he,Ge){return C[he]!==Ge&&(c.bindFramebuffer(he,Ge),C[he]=Ge,s&&(he===c.DRAW_FRAMEBUFFER&&(C[c.FRAMEBUFFER]=Ge),he===c.FRAMEBUFFER&&(C[c.DRAW_FRAMEBUFFER]=Ge)),!0)},drawBuffers:function It(he,Ge){let Tt=N,$t=!1;if(he)if(Tt=R.get(Ge),void 0===Tt&&(Tt=[],R.set(Ge,Tt)),he.isWebGLMultipleRenderTargets){const hn=he.texture;if(Tt.length!==hn.length||Tt[0]!==c.COLOR_ATTACHMENT0){for(let bi=0,wi=hn.length;bi<wi;bi++)Tt[bi]=c.COLOR_ATTACHMENT0+bi;Tt.length=hn.length,$t=!0}}else Tt[0]!==c.COLOR_ATTACHMENT0&&(Tt[0]=c.COLOR_ATTACHMENT0,$t=!0);else Tt[0]!==c.BACK&&(Tt[0]=c.BACK,$t=!0);$t&&(t.isWebGL2?c.drawBuffers(Tt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Tt))},useProgram:function dn(he){return P!==he&&(c.useProgram(he),P=he,!0)},setBlending:xt,setMaterial:function nt(he,Ge){he.side===Ut?yn(c.CULL_FACE):de(c.CULL_FACE);let Tt=he.side===it;Ge&&(Tt=!Tt),Bt(Tt),1===he.blending&&!1===he.transparent?xt(pn):xt(he.blending,he.blendEquation,he.blendSrc,he.blendDst,he.blendEquationAlpha,he.blendSrcAlpha,he.blendDstAlpha,he.premultipliedAlpha),p.setFunc(he.depthFunc),p.setTest(he.depthTest),p.setMask(he.depthWrite),h.setMask(he.colorWrite);const $t=he.stencilWrite;m.setTest($t),$t&&(m.setMask(he.stencilWriteMask),m.setFunc(he.stencilFunc,he.stencilRef,he.stencilFuncMask),m.setOp(he.stencilFail,he.stencilZFail,he.stencilZPass)),cn(he.polygonOffset,he.polygonOffsetFactor,he.polygonOffsetUnits),!0===he.alphaToCoverage?de(c.SAMPLE_ALPHA_TO_COVERAGE):yn(c.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Bt,setCullFace:wn,setLineWidth:function Tn(he){he!==qe&&(ft&&c.lineWidth(he),qe=he)},setPolygonOffset:cn,setScissorTest:function Jn(he){he?de(c.SCISSOR_TEST):yn(c.SCISSOR_TEST)},activeTexture:function ci(he){void 0===he&&(he=c.TEXTURE0+Fe-1),mt!==he&&(c.activeTexture(he),mt=he)},bindTexture:function ne(he,Ge,Tt){void 0===Tt&&(Tt=null===mt?c.TEXTURE0+Fe-1:mt);let $t=St[Tt];void 0===$t&&($t={type:void 0,texture:void 0},St[Tt]=$t),($t.type!==he||$t.texture!==Ge)&&(mt!==Tt&&(c.activeTexture(Tt),mt=Tt),c.bindTexture(he,Ge||Gt[he]),$t.type=he,$t.texture=Ge)},unbindTexture:function j(){const he=St[mt];void 0!==he&&void 0!==he.type&&(c.bindTexture(he.type,null),he.type=void 0,he.texture=void 0)},compressedTexImage2D:function Ne(){try{c.compressedTexImage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},compressedTexImage3D:function bt(){try{c.compressedTexImage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texImage2D:function _n(){try{c.texImage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texImage3D:function Cn(){try{c.texImage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},updateUBOMapping:function di(he,Ge){let Tt=S.get(Ge);void 0===Tt&&(Tt=new WeakMap,S.set(Ge,Tt));let $t=Tt.get(he);void 0===$t&&($t=c.getUniformBlockIndex(Ge,he.name),Tt.set(he,$t))},uniformBlockBinding:function Li(he,Ge){const $t=S.get(Ge).get(he);_.get(Ge)!==$t&&(c.uniformBlockBinding(Ge,$t,he.__bindingPointIndex),_.set(Ge,$t))},texStorage2D:function je(){try{c.texStorage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texStorage3D:function sn(){try{c.texStorage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texSubImage2D:function At(){try{c.texSubImage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texSubImage3D:function zt(){try{c.texSubImage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},compressedTexSubImage2D:function Dn(){try{c.compressedTexSubImage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},compressedTexSubImage3D:function qt(){try{c.compressedTexSubImage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},scissor:function Qt(he){!1===ze.equals(he)&&(c.scissor(he.x,he.y,he.z,he.w),ze.copy(he))},viewport:function on(he){!1===pt.equals(he)&&(c.viewport(he.x,he.y,he.z,he.w),pt.copy(he))},reset:function vr(){c.disable(c.BLEND),c.disable(c.CULL_FACE),c.disable(c.DEPTH_TEST),c.disable(c.POLYGON_OFFSET_FILL),c.disable(c.SCISSOR_TEST),c.disable(c.STENCIL_TEST),c.disable(c.SAMPLE_ALPHA_TO_COVERAGE),c.blendEquation(c.FUNC_ADD),c.blendFunc(c.ONE,c.ZERO),c.blendFuncSeparate(c.ONE,c.ZERO,c.ONE,c.ZERO),c.colorMask(!0,!0,!0,!0),c.clearColor(0,0,0,0),c.depthMask(!0),c.depthFunc(c.LESS),c.clearDepth(1),c.stencilMask(4294967295),c.stencilFunc(c.ALWAYS,0,4294967295),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),c.clearStencil(0),c.cullFace(c.BACK),c.frontFace(c.CCW),c.polygonOffset(0,0),c.activeTexture(c.TEXTURE0),c.bindFramebuffer(c.FRAMEBUFFER,null),!0===s&&(c.bindFramebuffer(c.DRAW_FRAMEBUFFER,null),c.bindFramebuffer(c.READ_FRAMEBUFFER,null)),c.useProgram(null),c.lineWidth(1),c.scissor(0,0,c.canvas.width,c.canvas.height),c.viewport(0,0,c.canvas.width,c.canvas.height),b={},mt=null,St={},C={},R=new WeakMap,N=[],P=null,I=!1,H=null,U=null,$=null,X=null,J=null,re=null,le=null,G=!1,te=null,Pe=null,qe=null,_e=null,Ce=null,ze.set(0,0,c.canvas.width,c.canvas.height),pt.set(0,0,c.canvas.width,c.canvas.height),h.reset(),p.reset(),m.reset()}}}function Cf(c,e,t,s,o,l,d){const h=o.isWebGL2,p=o.maxTextures,m=o.maxCubemapSize,_=o.maxTextureSize,S=o.maxSamples,b=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,C=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),R=new WeakMap;let N;const P=new WeakMap;let I=!1;try{I=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function H(ne,j){return I?new OffscreenCanvas(ne,j):Oa("canvas")}function U(ne,j,Ne,bt){let At=1;if((ne.width>bt||ne.height>bt)&&(At=bt/Math.max(ne.width,ne.height)),At<1||!0===j){if(typeof HTMLImageElement<"u"&&ne instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ne instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ne instanceof ImageBitmap){const zt=j?Xc:Math.floor,Dn=zt(At*ne.width),qt=zt(At*ne.height);void 0===N&&(N=H(Dn,qt));const je=Ne?H(Dn,qt):N;return je.width=Dn,je.height=qt,je.getContext("2d").drawImage(ne,0,0,Dn,qt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ne.width+"x"+ne.height+") to ("+Dn+"x"+qt+")."),je}return"data"in ne&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ne.width+"x"+ne.height+")."),ne}return ne}function $(ne){return ql(ne.width)&&ql(ne.height)}function J(ne,j){return ne.generateMipmaps&&j&&ne.minFilter!==li&&ne.minFilter!==vi}function re(ne){c.generateMipmap(ne)}function le(ne,j,Ne,bt,At=!1){if(!1===h)return j;if(null!==ne){if(void 0!==c[ne])return c[ne];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ne+"'")}let zt=j;return j===c.RED&&(Ne===c.FLOAT&&(zt=c.R32F),Ne===c.HALF_FLOAT&&(zt=c.R16F),Ne===c.UNSIGNED_BYTE&&(zt=c.R8)),j===c.RG&&(Ne===c.FLOAT&&(zt=c.RG32F),Ne===c.HALF_FLOAT&&(zt=c.RG16F),Ne===c.UNSIGNED_BYTE&&(zt=c.RG8)),j===c.RGBA&&(Ne===c.FLOAT&&(zt=c.RGBA32F),Ne===c.HALF_FLOAT&&(zt=c.RGBA16F),Ne===c.UNSIGNED_BYTE&&(zt=bt===gn&&!1===At?c.SRGB8_ALPHA8:c.RGBA8),Ne===c.UNSIGNED_SHORT_4_4_4_4&&(zt=c.RGBA4),Ne===c.UNSIGNED_SHORT_5_5_5_1&&(zt=c.RGB5_A1)),(zt===c.R16F||zt===c.R32F||zt===c.RG16F||zt===c.RG32F||zt===c.RGBA16F||zt===c.RGBA32F)&&e.get("EXT_color_buffer_float"),zt}function G(ne,j,Ne){return!0===J(ne,Ne)||ne.isFramebufferTexture&&ne.minFilter!==li&&ne.minFilter!==vi?Math.log2(Math.max(j.width,j.height))+1:void 0!==ne.mipmaps&&ne.mipmaps.length>0?ne.mipmaps.length:ne.isCompressedTexture&&Array.isArray(ne.image)?j.mipmaps.length:1}function te(ne){return ne===li||1004===ne||1005===ne?c.NEAREST:c.LINEAR}function Pe(ne){const j=ne.target;j.removeEventListener("dispose",Pe),function _e(ne){const j=s.get(ne);if(void 0===j.__webglInit)return;const Ne=ne.source,bt=P.get(Ne);if(bt){const At=bt[j.__cacheKey];At.usedTimes--,0===At.usedTimes&&Ce(ne),0===Object.keys(bt).length&&P.delete(Ne)}s.remove(ne)}(j),j.isVideoTexture&&R.delete(j)}function qe(ne){const j=ne.target;j.removeEventListener("dispose",qe),function Fe(ne){const j=ne.texture,Ne=s.get(ne),bt=s.get(j);if(void 0!==bt.__webglTexture&&(c.deleteTexture(bt.__webglTexture),d.memory.textures--),ne.depthTexture&&ne.depthTexture.dispose(),ne.isWebGLCubeRenderTarget)for(let At=0;At<6;At++)c.deleteFramebuffer(Ne.__webglFramebuffer[At]),Ne.__webglDepthbuffer&&c.deleteRenderbuffer(Ne.__webglDepthbuffer[At]);else{if(c.deleteFramebuffer(Ne.__webglFramebuffer),Ne.__webglDepthbuffer&&c.deleteRenderbuffer(Ne.__webglDepthbuffer),Ne.__webglMultisampledFramebuffer&&c.deleteFramebuffer(Ne.__webglMultisampledFramebuffer),Ne.__webglColorRenderbuffer)for(let At=0;At<Ne.__webglColorRenderbuffer.length;At++)Ne.__webglColorRenderbuffer[At]&&c.deleteRenderbuffer(Ne.__webglColorRenderbuffer[At]);Ne.__webglDepthRenderbuffer&&c.deleteRenderbuffer(Ne.__webglDepthRenderbuffer)}if(ne.isWebGLMultipleRenderTargets)for(let At=0,zt=j.length;At<zt;At++){const Dn=s.get(j[At]);Dn.__webglTexture&&(c.deleteTexture(Dn.__webglTexture),d.memory.textures--),s.remove(j[At])}s.remove(j),s.remove(ne)}(j)}function Ce(ne){const j=s.get(ne);c.deleteTexture(j.__webglTexture),delete P.get(ne.source)[j.__cacheKey],d.memory.textures--}let ft=0;function St(ne,j){const Ne=s.get(ne);if(ne.isVideoTexture&&function Jn(ne){const j=d.render.frame;R.get(ne)!==j&&(R.set(ne,j),ne.update())}(ne),!1===ne.isRenderTargetTexture&&ne.version>0&&Ne.__version!==ne.version){const bt=ne.image;if(null===bt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==bt.complete)return void yn(Ne,ne,j);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(c.TEXTURE_2D,Ne.__webglTexture,c.TEXTURE0+j)}const pt={1e3:c.REPEAT,[ji]:c.CLAMP_TO_EDGE,1002:c.MIRRORED_REPEAT},Lt={[li]:c.NEAREST,1004:c.NEAREST_MIPMAP_NEAREST,1005:c.NEAREST_MIPMAP_LINEAR,[vi]:c.LINEAR,1007:c.LINEAR_MIPMAP_NEAREST,[ce]:c.LINEAR_MIPMAP_LINEAR};function Gt(ne,j,Ne){if(Ne?(c.texParameteri(ne,c.TEXTURE_WRAP_S,pt[j.wrapS]),c.texParameteri(ne,c.TEXTURE_WRAP_T,pt[j.wrapT]),(ne===c.TEXTURE_3D||ne===c.TEXTURE_2D_ARRAY)&&c.texParameteri(ne,c.TEXTURE_WRAP_R,pt[j.wrapR]),c.texParameteri(ne,c.TEXTURE_MAG_FILTER,Lt[j.magFilter]),c.texParameteri(ne,c.TEXTURE_MIN_FILTER,Lt[j.minFilter])):(c.texParameteri(ne,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(ne,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),(ne===c.TEXTURE_3D||ne===c.TEXTURE_2D_ARRAY)&&c.texParameteri(ne,c.TEXTURE_WRAP_R,c.CLAMP_TO_EDGE),(j.wrapS!==ji||j.wrapT!==ji)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),c.texParameteri(ne,c.TEXTURE_MAG_FILTER,te(j.magFilter)),c.texParameteri(ne,c.TEXTURE_MIN_FILTER,te(j.minFilter)),j.minFilter!==li&&j.minFilter!==vi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const bt=e.get("EXT_texture_filter_anisotropic");if(j.magFilter===li||1005!==j.minFilter&&j.minFilter!==ce||j.type===tt&&!1===e.has("OES_texture_float_linear")||!1===h&&j.type===Qe&&!1===e.has("OES_texture_half_float_linear"))return;(j.anisotropy>1||s.get(j).__currentAnisotropy)&&(c.texParameterf(ne,bt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(j.anisotropy,o.getMaxAnisotropy())),s.get(j).__currentAnisotropy=j.anisotropy)}}function de(ne,j){let Ne=!1;void 0===ne.__webglInit&&(ne.__webglInit=!0,j.addEventListener("dispose",Pe));const bt=j.source;let At=P.get(bt);void 0===At&&(At={},P.set(bt,At));const zt=function mt(ne){const j=[];return j.push(ne.wrapS),j.push(ne.wrapT),j.push(ne.wrapR||0),j.push(ne.magFilter),j.push(ne.minFilter),j.push(ne.anisotropy),j.push(ne.internalFormat),j.push(ne.format),j.push(ne.type),j.push(ne.generateMipmaps),j.push(ne.premultiplyAlpha),j.push(ne.flipY),j.push(ne.unpackAlignment),j.push(ne.colorSpace),j.join()}(j);if(zt!==ne.__cacheKey){void 0===At[zt]&&(At[zt]={texture:c.createTexture(),usedTimes:0},d.memory.textures++,Ne=!0),At[zt].usedTimes++;const Dn=At[ne.__cacheKey];void 0!==Dn&&(At[ne.__cacheKey].usedTimes--,0===Dn.usedTimes&&Ce(j)),ne.__cacheKey=zt,ne.__webglTexture=At[zt].texture}return Ne}function yn(ne,j,Ne){let bt=c.TEXTURE_2D;(j.isDataArrayTexture||j.isCompressedArrayTexture)&&(bt=c.TEXTURE_2D_ARRAY),j.isData3DTexture&&(bt=c.TEXTURE_3D);const At=de(ne,j),zt=j.source;t.bindTexture(bt,ne.__webglTexture,c.TEXTURE0+Ne);const Dn=s.get(zt);if(zt.version!==Dn.__version||!0===At){t.activeTexture(c.TEXTURE0+Ne),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,j.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,j.unpackAlignment),c.pixelStorei(c.UNPACK_COLORSPACE_CONVERSION_WEBGL,c.NONE);const qt=function X(ne){return!h&&(ne.wrapS!==ji||ne.wrapT!==ji||ne.minFilter!==li&&ne.minFilter!==vi)}(j)&&!1===$(j.image);let je=U(j.image,qt,!1,_);je=ci(j,je);const sn=$(je)||h,_n=l.convert(j.format,j.colorSpace);let on,Cn=l.convert(j.type),Qt=le(j.internalFormat,_n,Cn,j.colorSpace);Gt(bt,j,sn);const di=j.mipmaps,Li=h&&!0!==j.isVideoTexture,vr=void 0===Dn.__version||!0===At,he=G(j,je,sn);if(j.isDepthTexture)Qt=c.DEPTH_COMPONENT,h?Qt=j.type===tt?c.DEPTH_COMPONENT32F:j.type===Ie?c.DEPTH_COMPONENT24:j.type===mn?c.DEPTH24_STENCIL8:c.DEPTH_COMPONENT16:j.type===tt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),j.format===qr&&Qt===c.DEPTH_COMPONENT&&1012!==j.type&&j.type!==Ie&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),j.type=Ie,Cn=l.convert(j.type)),j.format===Zr&&Qt===c.DEPTH_COMPONENT&&(Qt=c.DEPTH_STENCIL,j.type!==mn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),j.type=mn,Cn=l.convert(j.type))),vr&&(Li?t.texStorage2D(c.TEXTURE_2D,1,Qt,je.width,je.height):t.texImage2D(c.TEXTURE_2D,0,Qt,je.width,je.height,0,_n,Cn,null));else if(j.isDataTexture)if(di.length>0&&sn){Li&&vr&&t.texStorage2D(c.TEXTURE_2D,he,Qt,di[0].width,di[0].height);for(let Ge=0,Tt=di.length;Ge<Tt;Ge++)on=di[Ge],Li?t.texSubImage2D(c.TEXTURE_2D,Ge,0,0,on.width,on.height,_n,Cn,on.data):t.texImage2D(c.TEXTURE_2D,Ge,Qt,on.width,on.height,0,_n,Cn,on.data);j.generateMipmaps=!1}else Li?(vr&&t.texStorage2D(c.TEXTURE_2D,he,Qt,je.width,je.height),t.texSubImage2D(c.TEXTURE_2D,0,0,0,je.width,je.height,_n,Cn,je.data)):t.texImage2D(c.TEXTURE_2D,0,Qt,je.width,je.height,0,_n,Cn,je.data);else if(j.isCompressedTexture)if(j.isCompressedArrayTexture){Li&&vr&&t.texStorage3D(c.TEXTURE_2D_ARRAY,he,Qt,di[0].width,di[0].height,je.depth);for(let Ge=0,Tt=di.length;Ge<Tt;Ge++)on=di[Ge],j.format!==mi?null!==_n?Li?t.compressedTexSubImage3D(c.TEXTURE_2D_ARRAY,Ge,0,0,0,on.width,on.height,je.depth,_n,on.data,0,0):t.compressedTexImage3D(c.TEXTURE_2D_ARRAY,Ge,Qt,on.width,on.height,je.depth,0,on.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Li?t.texSubImage3D(c.TEXTURE_2D_ARRAY,Ge,0,0,0,on.width,on.height,je.depth,_n,Cn,on.data):t.texImage3D(c.TEXTURE_2D_ARRAY,Ge,Qt,on.width,on.height,je.depth,0,_n,Cn,on.data)}else{Li&&vr&&t.texStorage2D(c.TEXTURE_2D,he,Qt,di[0].width,di[0].height);for(let Ge=0,Tt=di.length;Ge<Tt;Ge++)on=di[Ge],j.format!==mi?null!==_n?Li?t.compressedTexSubImage2D(c.TEXTURE_2D,Ge,0,0,on.width,on.height,_n,on.data):t.compressedTexImage2D(c.TEXTURE_2D,Ge,Qt,on.width,on.height,0,on.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Li?t.texSubImage2D(c.TEXTURE_2D,Ge,0,0,on.width,on.height,_n,Cn,on.data):t.texImage2D(c.TEXTURE_2D,Ge,Qt,on.width,on.height,0,_n,Cn,on.data)}else if(j.isDataArrayTexture)Li?(vr&&t.texStorage3D(c.TEXTURE_2D_ARRAY,he,Qt,je.width,je.height,je.depth),t.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,0,je.width,je.height,je.depth,_n,Cn,je.data)):t.texImage3D(c.TEXTURE_2D_ARRAY,0,Qt,je.width,je.height,je.depth,0,_n,Cn,je.data);else if(j.isData3DTexture)Li?(vr&&t.texStorage3D(c.TEXTURE_3D,he,Qt,je.width,je.height,je.depth),t.texSubImage3D(c.TEXTURE_3D,0,0,0,0,je.width,je.height,je.depth,_n,Cn,je.data)):t.texImage3D(c.TEXTURE_3D,0,Qt,je.width,je.height,je.depth,0,_n,Cn,je.data);else if(j.isFramebufferTexture){if(vr)if(Li)t.texStorage2D(c.TEXTURE_2D,he,Qt,je.width,je.height);else{let Ge=je.width,Tt=je.height;for(let $t=0;$t<he;$t++)t.texImage2D(c.TEXTURE_2D,$t,Qt,Ge,Tt,0,_n,Cn,null),Ge>>=1,Tt>>=1}}else if(di.length>0&&sn){Li&&vr&&t.texStorage2D(c.TEXTURE_2D,he,Qt,di[0].width,di[0].height);for(let Ge=0,Tt=di.length;Ge<Tt;Ge++)on=di[Ge],Li?t.texSubImage2D(c.TEXTURE_2D,Ge,0,0,_n,Cn,on):t.texImage2D(c.TEXTURE_2D,Ge,Qt,_n,Cn,on);j.generateMipmaps=!1}else Li?(vr&&t.texStorage2D(c.TEXTURE_2D,he,Qt,je.width,je.height),t.texSubImage2D(c.TEXTURE_2D,0,0,0,_n,Cn,je)):t.texImage2D(c.TEXTURE_2D,0,Qt,_n,Cn,je);J(j,sn)&&re(bt),Dn.__version=zt.version,j.onUpdate&&j.onUpdate(j)}ne.__version=j.version}function It(ne,j,Ne,bt,At){const zt=l.convert(Ne.format,Ne.colorSpace),Dn=l.convert(Ne.type),qt=le(Ne.internalFormat,zt,Dn,Ne.colorSpace);s.get(j).__hasExternalTextures||(At===c.TEXTURE_3D||At===c.TEXTURE_2D_ARRAY?t.texImage3D(At,0,qt,j.width,j.height,j.depth,0,zt,Dn,null):t.texImage2D(At,0,qt,j.width,j.height,0,zt,Dn,null)),t.bindFramebuffer(c.FRAMEBUFFER,ne),cn(j)?b.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,bt,At,s.get(Ne).__webglTexture,0,Tn(j)):(At===c.TEXTURE_2D||At>=c.TEXTURE_CUBE_MAP_POSITIVE_X&&At<=c.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&c.framebufferTexture2D(c.FRAMEBUFFER,bt,At,s.get(Ne).__webglTexture,0),t.bindFramebuffer(c.FRAMEBUFFER,null)}function dn(ne,j,Ne){if(c.bindRenderbuffer(c.RENDERBUFFER,ne),j.depthBuffer&&!j.stencilBuffer){let bt=c.DEPTH_COMPONENT16;if(Ne||cn(j)){const At=j.depthTexture;At&&At.isDepthTexture&&(At.type===tt?bt=c.DEPTH_COMPONENT32F:At.type===Ie&&(bt=c.DEPTH_COMPONENT24));const zt=Tn(j);cn(j)?b.renderbufferStorageMultisampleEXT(c.RENDERBUFFER,zt,bt,j.width,j.height):c.renderbufferStorageMultisample(c.RENDERBUFFER,zt,bt,j.width,j.height)}else c.renderbufferStorage(c.RENDERBUFFER,bt,j.width,j.height);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,ne)}else if(j.depthBuffer&&j.stencilBuffer){const bt=Tn(j);Ne&&!1===cn(j)?c.renderbufferStorageMultisample(c.RENDERBUFFER,bt,c.DEPTH24_STENCIL8,j.width,j.height):cn(j)?b.renderbufferStorageMultisampleEXT(c.RENDERBUFFER,bt,c.DEPTH24_STENCIL8,j.width,j.height):c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,j.width,j.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,ne)}else{const bt=!0===j.isWebGLMultipleRenderTargets?j.texture:[j.texture];for(let At=0;At<bt.length;At++){const zt=bt[At],Dn=l.convert(zt.format,zt.colorSpace),qt=l.convert(zt.type),je=le(zt.internalFormat,Dn,qt,zt.colorSpace),sn=Tn(j);Ne&&!1===cn(j)?c.renderbufferStorageMultisample(c.RENDERBUFFER,sn,je,j.width,j.height):cn(j)?b.renderbufferStorageMultisampleEXT(c.RENDERBUFFER,sn,je,j.width,j.height):c.renderbufferStorage(c.RENDERBUFFER,je,j.width,j.height)}}c.bindRenderbuffer(c.RENDERBUFFER,null)}function Ye(ne){const j=s.get(ne),Ne=!0===ne.isWebGLCubeRenderTarget;if(ne.depthTexture&&!j.__autoAllocateDepthBuffer){if(Ne)throw new Error("target.depthTexture not supported in Cube render targets");!function _t(ne,j){if(j&&j.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(c.FRAMEBUFFER,ne),!j.depthTexture||!j.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!s.get(j.depthTexture).__webglTexture||j.depthTexture.image.width!==j.width||j.depthTexture.image.height!==j.height)&&(j.depthTexture.image.width=j.width,j.depthTexture.image.height=j.height,j.depthTexture.needsUpdate=!0),St(j.depthTexture,0);const bt=s.get(j.depthTexture).__webglTexture,At=Tn(j);if(j.depthTexture.format===qr)cn(j)?b.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,bt,0,At):c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,bt,0);else{if(j.depthTexture.format!==Zr)throw new Error("Unknown depthTexture format");cn(j)?b.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,bt,0,At):c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,bt,0)}}(j.__webglFramebuffer,ne)}else if(Ne){j.__webglDepthbuffer=[];for(let bt=0;bt<6;bt++)t.bindFramebuffer(c.FRAMEBUFFER,j.__webglFramebuffer[bt]),j.__webglDepthbuffer[bt]=c.createRenderbuffer(),dn(j.__webglDepthbuffer[bt],ne,!1)}else t.bindFramebuffer(c.FRAMEBUFFER,j.__webglFramebuffer),j.__webglDepthbuffer=c.createRenderbuffer(),dn(j.__webglDepthbuffer,ne,!1);t.bindFramebuffer(c.FRAMEBUFFER,null)}function Tn(ne){return Math.min(S,ne.samples)}function cn(ne){const j=s.get(ne);return h&&ne.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==j.__useRenderToTexture}function ci(ne,j){const Ne=ne.colorSpace,bt=ne.format,At=ne.type;return!0===ne.isCompressedTexture||1035===ne.format||Ne!==er&&""!==Ne&&(Ne===gn?!1===h?!0===e.has("EXT_sRGB")&&bt===mi?(ne.format=1035,ne.minFilter=vi,ne.generateMipmaps=!1):j=ll.sRGBToLinear(j):(bt!==mi||At!==ue)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ne)),j}this.allocateTextureUnit=function at(){const ne=ft;return ne>=p&&console.warn("THREE.WebGLTextures: Trying to use "+ne+" texture units while this GPU supports only "+p),ft+=1,ne},this.resetTextureUnits=function ut(){ft=0},this.setTexture2D=St,this.setTexture2DArray=function Yt(ne,j){const Ne=s.get(ne);ne.version>0&&Ne.__version!==ne.version?yn(Ne,ne,j):t.bindTexture(c.TEXTURE_2D_ARRAY,Ne.__webglTexture,c.TEXTURE0+j)},this.setTexture3D=function Vt(ne,j){const Ne=s.get(ne);ne.version>0&&Ne.__version!==ne.version?yn(Ne,ne,j):t.bindTexture(c.TEXTURE_3D,Ne.__webglTexture,c.TEXTURE0+j)},this.setTextureCube=function ze(ne,j){const Ne=s.get(ne);ne.version>0&&Ne.__version!==ne.version?function Rn(ne,j,Ne){if(6!==j.image.length)return;const bt=de(ne,j),At=j.source;t.bindTexture(c.TEXTURE_CUBE_MAP,ne.__webglTexture,c.TEXTURE0+Ne);const zt=s.get(At);if(At.version!==zt.__version||!0===bt){t.activeTexture(c.TEXTURE0+Ne),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,j.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,j.unpackAlignment),c.pixelStorei(c.UNPACK_COLORSPACE_CONVERSION_WEBGL,c.NONE);const Dn=j.isCompressedTexture||j.image[0].isCompressedTexture,qt=j.image[0]&&j.image[0].isDataTexture,je=[];for(let Ge=0;Ge<6;Ge++)je[Ge]=Dn||qt?qt?j.image[Ge].image:j.image[Ge]:U(j.image[Ge],!1,!0,m),je[Ge]=ci(j,je[Ge]);const sn=je[0],_n=$(sn)||h,Cn=l.convert(j.format,j.colorSpace),Qt=l.convert(j.type),on=le(j.internalFormat,Cn,Qt,j.colorSpace),di=h&&!0!==j.isVideoTexture,Li=void 0===zt.__version||!0===bt;let he,vr=G(j,sn,_n);if(Gt(c.TEXTURE_CUBE_MAP,j,_n),Dn){di&&Li&&t.texStorage2D(c.TEXTURE_CUBE_MAP,vr,on,sn.width,sn.height);for(let Ge=0;Ge<6;Ge++){he=je[Ge].mipmaps;for(let Tt=0;Tt<he.length;Tt++){const $t=he[Tt];j.format!==mi?null!==Cn?di?t.compressedTexSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Tt,0,0,$t.width,$t.height,Cn,$t.data):t.compressedTexImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Tt,on,$t.width,$t.height,0,$t.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):di?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Tt,0,0,$t.width,$t.height,Cn,Qt,$t.data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Tt,on,$t.width,$t.height,0,Cn,Qt,$t.data)}}}else{he=j.mipmaps,di&&Li&&(he.length>0&&vr++,t.texStorage2D(c.TEXTURE_CUBE_MAP,vr,on,je[0].width,je[0].height));for(let Ge=0;Ge<6;Ge++)if(qt){di?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,0,0,je[Ge].width,je[Ge].height,Cn,Qt,je[Ge].data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,on,je[Ge].width,je[Ge].height,0,Cn,Qt,je[Ge].data);for(let Tt=0;Tt<he.length;Tt++){const hn=he[Tt].image[Ge].image;di?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Tt+1,0,0,hn.width,hn.height,Cn,Qt,hn.data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Tt+1,on,hn.width,hn.height,0,Cn,Qt,hn.data)}}else{di?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,0,0,Cn,Qt,je[Ge]):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,on,Cn,Qt,je[Ge]);for(let Tt=0;Tt<he.length;Tt++){const $t=he[Tt];di?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Tt+1,0,0,Cn,Qt,$t.image[Ge]):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Tt+1,on,Cn,Qt,$t.image[Ge])}}}J(j,_n)&&re(c.TEXTURE_CUBE_MAP),zt.__version=At.version,j.onUpdate&&j.onUpdate(j)}ne.__version=j.version}(Ne,ne,j):t.bindTexture(c.TEXTURE_CUBE_MAP,Ne.__webglTexture,c.TEXTURE0+j)},this.rebindTextures=function xt(ne,j,Ne){const bt=s.get(ne);void 0!==j&&It(bt.__webglFramebuffer,ne,ne.texture,c.COLOR_ATTACHMENT0,c.TEXTURE_2D),void 0!==Ne&&Ye(ne)},this.setupRenderTarget=function nt(ne){const j=ne.texture,Ne=s.get(ne),bt=s.get(j);ne.addEventListener("dispose",qe),!0!==ne.isWebGLMultipleRenderTargets&&(void 0===bt.__webglTexture&&(bt.__webglTexture=c.createTexture()),bt.__version=j.version,d.memory.textures++);const At=!0===ne.isWebGLCubeRenderTarget,zt=!0===ne.isWebGLMultipleRenderTargets,Dn=$(ne)||h;if(At){Ne.__webglFramebuffer=[];for(let qt=0;qt<6;qt++)Ne.__webglFramebuffer[qt]=c.createFramebuffer()}else{if(Ne.__webglFramebuffer=c.createFramebuffer(),zt)if(o.drawBuffers){const qt=ne.texture;for(let je=0,sn=qt.length;je<sn;je++){const _n=s.get(qt[je]);void 0===_n.__webglTexture&&(_n.__webglTexture=c.createTexture(),d.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(h&&ne.samples>0&&!1===cn(ne)){const qt=zt?j:[j];Ne.__webglMultisampledFramebuffer=c.createFramebuffer(),Ne.__webglColorRenderbuffer=[],t.bindFramebuffer(c.FRAMEBUFFER,Ne.__webglMultisampledFramebuffer);for(let je=0;je<qt.length;je++){const sn=qt[je];Ne.__webglColorRenderbuffer[je]=c.createRenderbuffer(),c.bindRenderbuffer(c.RENDERBUFFER,Ne.__webglColorRenderbuffer[je]);const _n=l.convert(sn.format,sn.colorSpace),Cn=l.convert(sn.type),Qt=le(sn.internalFormat,_n,Cn,sn.colorSpace,!0===ne.isXRRenderTarget),on=Tn(ne);c.renderbufferStorageMultisample(c.RENDERBUFFER,on,Qt,ne.width,ne.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+je,c.RENDERBUFFER,Ne.__webglColorRenderbuffer[je])}c.bindRenderbuffer(c.RENDERBUFFER,null),ne.depthBuffer&&(Ne.__webglDepthRenderbuffer=c.createRenderbuffer(),dn(Ne.__webglDepthRenderbuffer,ne,!0)),t.bindFramebuffer(c.FRAMEBUFFER,null)}}if(At){t.bindTexture(c.TEXTURE_CUBE_MAP,bt.__webglTexture),Gt(c.TEXTURE_CUBE_MAP,j,Dn);for(let qt=0;qt<6;qt++)It(Ne.__webglFramebuffer[qt],ne,j,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+qt);J(j,Dn)&&re(c.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(zt){const qt=ne.texture;for(let je=0,sn=qt.length;je<sn;je++){const _n=qt[je],Cn=s.get(_n);t.bindTexture(c.TEXTURE_2D,Cn.__webglTexture),Gt(c.TEXTURE_2D,_n,Dn),It(Ne.__webglFramebuffer,ne,_n,c.COLOR_ATTACHMENT0+je,c.TEXTURE_2D),J(_n,Dn)&&re(c.TEXTURE_2D)}t.unbindTexture()}else{let qt=c.TEXTURE_2D;(ne.isWebGL3DRenderTarget||ne.isWebGLArrayRenderTarget)&&(h?qt=ne.isWebGL3DRenderTarget?c.TEXTURE_3D:c.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(qt,bt.__webglTexture),Gt(qt,j,Dn),It(Ne.__webglFramebuffer,ne,j,c.COLOR_ATTACHMENT0,qt),J(j,Dn)&&re(qt),t.unbindTexture()}ne.depthBuffer&&Ye(ne)},this.updateRenderTargetMipmap=function Bt(ne){const j=$(ne)||h,Ne=!0===ne.isWebGLMultipleRenderTargets?ne.texture:[ne.texture];for(let bt=0,At=Ne.length;bt<At;bt++){const zt=Ne[bt];if(J(zt,j)){const Dn=ne.isWebGLCubeRenderTarget?c.TEXTURE_CUBE_MAP:c.TEXTURE_2D,qt=s.get(zt).__webglTexture;t.bindTexture(Dn,qt),re(Dn),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function wn(ne){if(h&&ne.samples>0&&!1===cn(ne)){const j=ne.isWebGLMultipleRenderTargets?ne.texture:[ne.texture],Ne=ne.width,bt=ne.height;let At=c.COLOR_BUFFER_BIT;const zt=[],Dn=ne.stencilBuffer?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT,qt=s.get(ne),je=!0===ne.isWebGLMultipleRenderTargets;if(je)for(let sn=0;sn<j.length;sn++)t.bindFramebuffer(c.FRAMEBUFFER,qt.__webglMultisampledFramebuffer),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+sn,c.RENDERBUFFER,null),t.bindFramebuffer(c.FRAMEBUFFER,qt.__webglFramebuffer),c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0+sn,c.TEXTURE_2D,null,0);t.bindFramebuffer(c.READ_FRAMEBUFFER,qt.__webglMultisampledFramebuffer),t.bindFramebuffer(c.DRAW_FRAMEBUFFER,qt.__webglFramebuffer);for(let sn=0;sn<j.length;sn++){zt.push(c.COLOR_ATTACHMENT0+sn),ne.depthBuffer&&zt.push(Dn);const _n=void 0!==qt.__ignoreDepthValues&&qt.__ignoreDepthValues;if(!1===_n&&(ne.depthBuffer&&(At|=c.DEPTH_BUFFER_BIT),ne.stencilBuffer&&(At|=c.STENCIL_BUFFER_BIT)),je&&c.framebufferRenderbuffer(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.RENDERBUFFER,qt.__webglColorRenderbuffer[sn]),!0===_n&&(c.invalidateFramebuffer(c.READ_FRAMEBUFFER,[Dn]),c.invalidateFramebuffer(c.DRAW_FRAMEBUFFER,[Dn])),je){const Cn=s.get(j[sn]).__webglTexture;c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,Cn,0)}c.blitFramebuffer(0,0,Ne,bt,0,0,Ne,bt,At,c.NEAREST),C&&c.invalidateFramebuffer(c.READ_FRAMEBUFFER,zt)}if(t.bindFramebuffer(c.READ_FRAMEBUFFER,null),t.bindFramebuffer(c.DRAW_FRAMEBUFFER,null),je)for(let sn=0;sn<j.length;sn++){t.bindFramebuffer(c.FRAMEBUFFER,qt.__webglMultisampledFramebuffer),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+sn,c.RENDERBUFFER,qt.__webglColorRenderbuffer[sn]);const _n=s.get(j[sn]).__webglTexture;t.bindFramebuffer(c.FRAMEBUFFER,qt.__webglFramebuffer),c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0+sn,c.TEXTURE_2D,_n,0)}t.bindFramebuffer(c.DRAW_FRAMEBUFFER,qt.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Ye,this.setupFrameBufferTexture=It,this.useMultisampledRTT=cn}function zd(c,e,t){const s=t.isWebGL2;return{convert:function o(l,d=""){let h;if(l===ue)return c.UNSIGNED_BYTE;if(1017===l)return c.UNSIGNED_SHORT_4_4_4_4;if(1018===l)return c.UNSIGNED_SHORT_5_5_5_1;if(1010===l)return c.BYTE;if(1011===l)return c.SHORT;if(1012===l)return c.UNSIGNED_SHORT;if(1013===l)return c.INT;if(l===Ie)return c.UNSIGNED_INT;if(l===tt)return c.FLOAT;if(l===Qe)return s?c.HALF_FLOAT:(h=e.get("OES_texture_half_float"),null!==h?h.HALF_FLOAT_OES:null);if(1021===l)return c.ALPHA;if(l===mi)return c.RGBA;if(1024===l)return c.LUMINANCE;if(1025===l)return c.LUMINANCE_ALPHA;if(l===qr)return c.DEPTH_COMPONENT;if(l===Zr)return c.DEPTH_STENCIL;if(1035===l)return h=e.get("EXT_sRGB"),null!==h?h.SRGB_ALPHA_EXT:null;if(1028===l)return c.RED;if(1029===l)return c.RED_INTEGER;if(1030===l)return c.RG;if(1031===l)return c.RG_INTEGER;if(1033===l)return c.RGBA_INTEGER;if(33776===l||33777===l||33778===l||33779===l)if(d===gn){if(h=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===h)return null;if(33776===l)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(h=e.get("WEBGL_compressed_texture_s3tc"),null===h)return null;if(33776===l)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===l||35841===l||35842===l||35843===l){if(h=e.get("WEBGL_compressed_texture_pvrtc"),null===h)return null;if(35840===l)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===l)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===l)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===l)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===l)return h=e.get("WEBGL_compressed_texture_etc1"),null!==h?h.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===l||37496===l){if(h=e.get("WEBGL_compressed_texture_etc"),null===h)return null;if(37492===l)return d===gn?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(37496===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}if(37808===l||37809===l||37810===l||37811===l||37812===l||37813===l||37814===l||37815===l||37816===l||37817===l||37818===l||37819===l||37820===l||37821===l){if(h=e.get("WEBGL_compressed_texture_astc"),null===h)return null;if(37808===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===l)return d===gn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===l){if(h=e.get("EXT_texture_compression_bptc"),null===h)return null;if(36492===l)return d===gn?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===l||36284===l||36285===l||36286===l){if(h=e.get("EXT_texture_compression_rgtc"),null===h)return null;if(36492===l)return h.COMPRESSED_RED_RGTC1_EXT;if(36284===l)return h.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===l)return h.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===l)return h.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return l===mn?s?c.UNSIGNED_INT_24_8:(h=e.get("WEBGL_depth_texture"),null!==h?h.UNSIGNED_INT_24_8_WEBGL:null):void 0!==c[l]?c[l]:null}}}class PM extends Pr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class El extends ms{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Af={type:"move"};class Vd{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new El,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new El,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new K,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new K),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new El,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new K,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new K),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const s of e.hand.values())this._getHandJoint(t,s)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,s){let o=null,l=null,d=null;const h=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(m&&e.hand){d=!0;for(const N of e.hand.values()){const P=t.getJointPose(N,s),I=this._getHandJoint(m,N);null!==P&&(I.matrix.fromArray(P.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,I.jointRadius=P.radius),I.visible=null!==P}const b=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),C=.02,R=.005;m.inputState.pinching&&b>C+R?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&b<=C-R&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,s),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));null!==h&&(o=t.getPose(e.targetRaySpace,s),null===o&&null!==l&&(o=l),null!==o&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,o.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(o.linearVelocity)):h.hasLinearVelocity=!1,o.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(o.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(Af)))}return null!==h&&(h.visible=null!==o),null!==p&&(p.visible=null!==l),null!==m&&(m.visible=null!==d),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const s=new El;s.matrixAutoUpdate=!1,s.visible=!1,e.joints[t.jointName]=s,e.add(s)}return e.joints[t.jointName]}}class Xy extends js{constructor(e,t,s,o,l,d,h,p,m,_){if((_=void 0!==_?_:qr)!==qr&&_!==Zr)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===s&&_===qr&&(s=Ie),void 0===s&&_===Zr&&(s=mn),super(null,o,l,d,h,p,_,s,m),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==h?h:li,this.minFilter=void 0!==p?p:li,this.flipY=!1,this.generateMipmaps=!1}}class Yy extends oa{constructor(e,t){super();const s=this;let o=null,l=1,d=null,h="local-floor",p=1,m=null,_=null,S=null,b=null,C=null,R=null;const N=t.getContextAttributes();let P=null,I=null;const H=[],U=[],$=new Set,X=new Map,J=new Pr;J.layers.enable(1),J.viewport=new Ei;const re=new Pr;re.layers.enable(2),re.viewport=new Ei;const le=[J,re],G=new PM;G.layers.enable(1),G.layers.enable(2);let te=null,Pe=null;function qe(ze){const pt=U.indexOf(ze.inputSource);if(-1===pt)return;const Lt=H[pt];void 0!==Lt&&(Lt.update(ze.inputSource,ze.frame,m||d),Lt.dispatchEvent({type:ze.type,data:ze.inputSource}))}function _e(){o.removeEventListener("select",qe),o.removeEventListener("selectstart",qe),o.removeEventListener("selectend",qe),o.removeEventListener("squeeze",qe),o.removeEventListener("squeezestart",qe),o.removeEventListener("squeezeend",qe),o.removeEventListener("end",_e),o.removeEventListener("inputsourceschange",Ce);for(let ze=0;ze<H.length;ze++){const pt=U[ze];null!==pt&&(U[ze]=null,H[ze].disconnect(pt))}te=null,Pe=null,e.setRenderTarget(P),C=null,b=null,S=null,o=null,I=null,Vt.stop(),s.isPresenting=!1,s.dispatchEvent({type:"sessionend"})}function Ce(ze){for(let pt=0;pt<ze.removed.length;pt++){const Lt=ze.removed[pt],Gt=U.indexOf(Lt);Gt>=0&&(U[Gt]=null,H[Gt].disconnect(Lt))}for(let pt=0;pt<ze.added.length;pt++){const Lt=ze.added[pt];let Gt=U.indexOf(Lt);if(-1===Gt){for(let yn=0;yn<H.length;yn++){if(yn>=U.length){U.push(Lt),Gt=yn;break}if(null===U[yn]){U[yn]=Lt,Gt=yn;break}}if(-1===Gt)break}const de=H[Gt];de&&de.connect(Lt)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ze){let pt=H[ze];return void 0===pt&&(pt=new Vd,H[ze]=pt),pt.getTargetRaySpace()},this.getControllerGrip=function(ze){let pt=H[ze];return void 0===pt&&(pt=new Vd,H[ze]=pt),pt.getGripSpace()},this.getHand=function(ze){let pt=H[ze];return void 0===pt&&(pt=new Vd,H[ze]=pt),pt.getHandSpace()},this.setFramebufferScaleFactor=function(ze){l=ze,!0===s.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ze){h=ze,!0===s.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m||d},this.setReferenceSpace=function(ze){m=ze},this.getBaseLayer=function(){return null!==b?b:C},this.getBinding=function(){return S},this.getFrame=function(){return R},this.getSession=function(){return o},this.setSession=function(){var ze=function Le(c){return function(){var e=this,t=arguments;return new Promise(function(s,o){var l=c.apply(e,t);function d(p){ye(l,s,o,d,h,"next",p)}function h(p){ye(l,s,o,d,h,"throw",p)}d(void 0)})}}(function*(pt){if(o=pt,null!==o){if(P=e.getRenderTarget(),o.addEventListener("select",qe),o.addEventListener("selectstart",qe),o.addEventListener("selectend",qe),o.addEventListener("squeeze",qe),o.addEventListener("squeezestart",qe),o.addEventListener("squeezeend",qe),o.addEventListener("end",_e),o.addEventListener("inputsourceschange",Ce),!0!==N.xrCompatible&&(yield t.makeXRCompatible()),void 0===o.renderState.layers||!1===e.capabilities.isWebGL2)C=new XRWebGLLayer(o,t,{antialias:void 0!==o.renderState.layers||N.antialias,alpha:!0,depth:N.depth,stencil:N.stencil,framebufferScaleFactor:l}),o.updateRenderState({baseLayer:C}),I=new ro(C.framebufferWidth,C.framebufferHeight,{format:mi,type:ue,colorSpace:e.outputColorSpace,stencilBuffer:N.stencil});else{let Lt=null,Gt=null,de=null;N.depth&&(de=N.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Lt=N.stencil?Zr:qr,Gt=N.stencil?mn:Ie);const yn={colorFormat:t.RGBA8,depthFormat:de,scaleFactor:l};S=new XRWebGLBinding(o,t),b=S.createProjectionLayer(yn),o.updateRenderState({layers:[b]}),I=new ro(b.textureWidth,b.textureHeight,{format:mi,type:ue,depthTexture:new Xy(b.textureWidth,b.textureHeight,Gt,void 0,void 0,void 0,void 0,void 0,void 0,Lt),stencilBuffer:N.stencil,colorSpace:e.outputColorSpace,samples:N.antialias?4:0}),e.properties.get(I).__ignoreDepthValues=b.ignoreDepthValues}I.isXRRenderTarget=!0,this.setFoveation(p),m=null,d=yield o.requestReferenceSpace(h),Vt.setContext(o),Vt.start(),s.isPresenting=!0,s.dispatchEvent({type:"sessionstart"})}});return function(pt){return ze.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==o)return o.environmentBlendMode};const Fe=new K,ft=new K;function at(ze,pt){null===pt?ze.matrixWorld.copy(ze.matrix):ze.matrixWorld.multiplyMatrices(pt.matrixWorld,ze.matrix),ze.matrixWorldInverse.copy(ze.matrixWorld).invert()}this.updateCamera=function(ze){if(null===o)return;G.near=re.near=J.near=ze.near,G.far=re.far=J.far=ze.far,(te!==G.near||Pe!==G.far)&&(o.updateRenderState({depthNear:G.near,depthFar:G.far}),te=G.near,Pe=G.far);const pt=ze.parent,Lt=G.cameras;at(G,pt);for(let Gt=0;Gt<Lt.length;Gt++)at(Lt[Gt],pt);2===Lt.length?function ut(ze,pt,Lt){Fe.setFromMatrixPosition(pt.matrixWorld),ft.setFromMatrixPosition(Lt.matrixWorld);const Gt=Fe.distanceTo(ft),de=pt.projectionMatrix.elements,yn=Lt.projectionMatrix.elements,Rn=de[14]/(de[10]-1),It=de[14]/(de[10]+1),dn=(de[9]+1)/de[5],_t=(de[9]-1)/de[5],Ye=(de[8]-1)/de[0],xt=(yn[8]+1)/yn[0],nt=Rn*Ye,Bt=Rn*xt,wn=Gt/(-Ye+xt),Tn=wn*-Ye;pt.matrixWorld.decompose(ze.position,ze.quaternion,ze.scale),ze.translateX(Tn),ze.translateZ(wn),ze.matrixWorld.compose(ze.position,ze.quaternion,ze.scale),ze.matrixWorldInverse.copy(ze.matrixWorld).invert();const cn=Rn+wn,Jn=It+wn;ze.projectionMatrix.makePerspective(nt-Tn,Bt+(Gt-Tn),dn*It/Jn*cn,_t*It/Jn*cn,cn,Jn),ze.projectionMatrixInverse.copy(ze.projectionMatrix).invert()}(G,J,re):G.projectionMatrix.copy(J.projectionMatrix),function mt(ze,pt,Lt){null===Lt?ze.matrix.copy(pt.matrixWorld):(ze.matrix.copy(Lt.matrixWorld),ze.matrix.invert(),ze.matrix.multiply(pt.matrixWorld)),ze.matrix.decompose(ze.position,ze.quaternion,ze.scale),ze.updateMatrixWorld(!0);const Gt=ze.children;for(let de=0,yn=Gt.length;de<yn;de++)Gt[de].updateMatrixWorld(!0);ze.projectionMatrix.copy(pt.projectionMatrix),ze.projectionMatrixInverse.copy(pt.projectionMatrixInverse),ze.isPerspectiveCamera&&(ze.fov=2*la*Math.atan(1/ze.projectionMatrix.elements[5]),ze.zoom=1)}(ze,G,pt)},this.getCamera=function(){return G},this.getFoveation=function(){if(null!==b||null!==C)return p},this.setFoveation=function(ze){p=ze,null!==b&&(b.fixedFoveation=ze),null!==C&&void 0!==C.fixedFoveation&&(C.fixedFoveation=ze)},this.getPlanes=function(){return $};let St=null;const Vt=new Sr;Vt.setAnimationLoop(function Yt(ze,pt){if(_=pt.getViewerPose(m||d),R=pt,null!==_){const Lt=_.views;null!==C&&(e.setRenderTargetFramebuffer(I,C.framebuffer),e.setRenderTarget(I));let Gt=!1;Lt.length!==G.cameras.length&&(G.cameras.length=0,Gt=!0);for(let de=0;de<Lt.length;de++){const yn=Lt[de];let Rn=null;if(null!==C)Rn=C.getViewport(yn);else{const dn=S.getViewSubImage(b,yn);Rn=dn.viewport,0===de&&(e.setRenderTargetTextures(I,dn.colorTexture,b.ignoreDepthValues?void 0:dn.depthStencilTexture),e.setRenderTarget(I))}let It=le[de];void 0===It&&(It=new Pr,It.layers.enable(de),It.viewport=new Ei,le[de]=It),It.matrix.fromArray(yn.transform.matrix),It.matrix.decompose(It.position,It.quaternion,It.scale),It.projectionMatrix.fromArray(yn.projectionMatrix),It.projectionMatrixInverse.copy(It.projectionMatrix).invert(),It.viewport.set(Rn.x,Rn.y,Rn.width,Rn.height),0===de&&(G.matrix.copy(It.matrix),G.matrix.decompose(G.position,G.quaternion,G.scale)),!0===Gt&&G.cameras.push(It)}}for(let Lt=0;Lt<H.length;Lt++){const Gt=U[Lt],de=H[Lt];null!==Gt&&void 0!==de&&de.update(Gt,pt,m||d)}if(St&&St(ze,pt),pt.detectedPlanes){s.dispatchEvent({type:"planesdetected",data:pt.detectedPlanes});let Lt=null;for(const Gt of $)pt.detectedPlanes.has(Gt)||(null===Lt&&(Lt=[]),Lt.push(Gt));if(null!==Lt)for(const Gt of Lt)$.delete(Gt),X.delete(Gt),s.dispatchEvent({type:"planeremoved",data:Gt});for(const Gt of pt.detectedPlanes)if($.has(Gt)){const de=X.get(Gt);Gt.lastChangedTime>de&&(X.set(Gt,Gt.lastChangedTime),s.dispatchEvent({type:"planechanged",data:Gt}))}else $.add(Gt),X.set(Gt,pt.lastChangedTime),s.dispatchEvent({type:"planeadded",data:Gt})}R=null}),this.setAnimationLoop=function(ze){St=ze},this.dispose=function(){}}}function Km(c,e){function t(P,I){!0===P.matrixAutoUpdate&&P.updateMatrix(),I.value.copy(P.matrix)}function l(P,I){P.opacity.value=I.opacity,I.color&&P.diffuse.value.copy(I.color),I.emissive&&P.emissive.value.copy(I.emissive).multiplyScalar(I.emissiveIntensity),I.map&&(P.map.value=I.map,t(I.map,P.mapTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap,t(I.alphaMap,P.alphaMapTransform)),I.bumpMap&&(P.bumpMap.value=I.bumpMap,t(I.bumpMap,P.bumpMapTransform),P.bumpScale.value=I.bumpScale,I.side===it&&(P.bumpScale.value*=-1)),I.normalMap&&(P.normalMap.value=I.normalMap,t(I.normalMap,P.normalMapTransform),P.normalScale.value.copy(I.normalScale),I.side===it&&P.normalScale.value.negate()),I.displacementMap&&(P.displacementMap.value=I.displacementMap,t(I.displacementMap,P.displacementMapTransform),P.displacementScale.value=I.displacementScale,P.displacementBias.value=I.displacementBias),I.emissiveMap&&(P.emissiveMap.value=I.emissiveMap,t(I.emissiveMap,P.emissiveMapTransform)),I.specularMap&&(P.specularMap.value=I.specularMap,t(I.specularMap,P.specularMapTransform)),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest);const H=e.get(I).envMap;if(H&&(P.envMap.value=H,P.flipEnvMap.value=H.isCubeTexture&&!1===H.isRenderTargetTexture?-1:1,P.reflectivity.value=I.reflectivity,P.ior.value=I.ior,P.refractionRatio.value=I.refractionRatio),I.lightMap){P.lightMap.value=I.lightMap;const U=!0===c.useLegacyLights?Math.PI:1;P.lightMapIntensity.value=I.lightMapIntensity*U,t(I.lightMap,P.lightMapTransform)}I.aoMap&&(P.aoMap.value=I.aoMap,P.aoMapIntensity.value=I.aoMapIntensity,t(I.aoMap,P.aoMapTransform))}return{refreshFogUniforms:function s(P,I){I.color.getRGB(P.fogColor.value,Vh(c)),I.isFog?(P.fogNear.value=I.near,P.fogFar.value=I.far):I.isFogExp2&&(P.fogDensity.value=I.density)},refreshMaterialUniforms:function o(P,I,H,U,$){I.isMeshBasicMaterial||I.isMeshLambertMaterial?l(P,I):I.isMeshToonMaterial?(l(P,I),function S(P,I){I.gradientMap&&(P.gradientMap.value=I.gradientMap)}(P,I)):I.isMeshPhongMaterial?(l(P,I),function _(P,I){P.specular.value.copy(I.specular),P.shininess.value=Math.max(I.shininess,1e-4)}(P,I)):I.isMeshStandardMaterial?(l(P,I),function b(P,I){P.metalness.value=I.metalness,I.metalnessMap&&(P.metalnessMap.value=I.metalnessMap,t(I.metalnessMap,P.metalnessMapTransform)),P.roughness.value=I.roughness,I.roughnessMap&&(P.roughnessMap.value=I.roughnessMap,t(I.roughnessMap,P.roughnessMapTransform)),e.get(I).envMap&&(P.envMapIntensity.value=I.envMapIntensity)}(P,I),I.isMeshPhysicalMaterial&&function C(P,I,H){P.ior.value=I.ior,I.sheen>0&&(P.sheenColor.value.copy(I.sheenColor).multiplyScalar(I.sheen),P.sheenRoughness.value=I.sheenRoughness,I.sheenColorMap&&(P.sheenColorMap.value=I.sheenColorMap,t(I.sheenColorMap,P.sheenColorMapTransform)),I.sheenRoughnessMap&&(P.sheenRoughnessMap.value=I.sheenRoughnessMap,t(I.sheenRoughnessMap,P.sheenRoughnessMapTransform))),I.clearcoat>0&&(P.clearcoat.value=I.clearcoat,P.clearcoatRoughness.value=I.clearcoatRoughness,I.clearcoatMap&&(P.clearcoatMap.value=I.clearcoatMap,t(I.clearcoatMap,P.clearcoatMapTransform)),I.clearcoatRoughnessMap&&(P.clearcoatRoughnessMap.value=I.clearcoatRoughnessMap,t(I.clearcoatRoughnessMap,P.clearcoatRoughnessMapTransform)),I.clearcoatNormalMap&&(P.clearcoatNormalMap.value=I.clearcoatNormalMap,t(I.clearcoatNormalMap,P.clearcoatNormalMapTransform),P.clearcoatNormalScale.value.copy(I.clearcoatNormalScale),I.side===it&&P.clearcoatNormalScale.value.negate())),I.iridescence>0&&(P.iridescence.value=I.iridescence,P.iridescenceIOR.value=I.iridescenceIOR,P.iridescenceThicknessMinimum.value=I.iridescenceThicknessRange[0],P.iridescenceThicknessMaximum.value=I.iridescenceThicknessRange[1],I.iridescenceMap&&(P.iridescenceMap.value=I.iridescenceMap,t(I.iridescenceMap,P.iridescenceMapTransform)),I.iridescenceThicknessMap&&(P.iridescenceThicknessMap.value=I.iridescenceThicknessMap,t(I.iridescenceThicknessMap,P.iridescenceThicknessMapTransform))),I.transmission>0&&(P.transmission.value=I.transmission,P.transmissionSamplerMap.value=H.texture,P.transmissionSamplerSize.value.set(H.width,H.height),I.transmissionMap&&(P.transmissionMap.value=I.transmissionMap,t(I.transmissionMap,P.transmissionMapTransform)),P.thickness.value=I.thickness,I.thicknessMap&&(P.thicknessMap.value=I.thicknessMap,t(I.thicknessMap,P.thicknessMapTransform)),P.attenuationDistance.value=I.attenuationDistance,P.attenuationColor.value.copy(I.attenuationColor)),P.specularIntensity.value=I.specularIntensity,P.specularColor.value.copy(I.specularColor),I.specularColorMap&&(P.specularColorMap.value=I.specularColorMap,t(I.specularColorMap,P.specularColorMapTransform)),I.specularIntensityMap&&(P.specularIntensityMap.value=I.specularIntensityMap,t(I.specularIntensityMap,P.specularIntensityMapTransform))}(P,I,$)):I.isMeshMatcapMaterial?(l(P,I),function R(P,I){I.matcap&&(P.matcap.value=I.matcap)}(P,I)):I.isMeshDepthMaterial?l(P,I):I.isMeshDistanceMaterial?(l(P,I),function N(P,I){const H=e.get(I).light;P.referencePosition.value.setFromMatrixPosition(H.matrixWorld),P.nearDistance.value=H.shadow.camera.near,P.farDistance.value=H.shadow.camera.far}(P,I)):I.isMeshNormalMaterial?l(P,I):I.isLineBasicMaterial?(function d(P,I){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,I.map&&(P.map.value=I.map,t(I.map,P.mapTransform))}(P,I),I.isLineDashedMaterial&&function h(P,I){P.dashSize.value=I.dashSize,P.totalSize.value=I.dashSize+I.gapSize,P.scale.value=I.scale}(P,I)):I.isPointsMaterial?function p(P,I,H,U){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,P.size.value=I.size*H,P.scale.value=.5*U,I.map&&(P.map.value=I.map,t(I.map,P.uvTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest)}(P,I,H,U):I.isSpriteMaterial?function m(P,I){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,P.rotation.value=I.rotation,I.map&&(P.map.value=I.map,t(I.map,P.mapTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest)}(P,I):I.isShadowMaterial?(P.color.value.copy(I.color),P.opacity.value=I.opacity):I.isShaderMaterial&&(I.uniformsNeedUpdate=!1)}}}function Jm(c,e,t,s){let o={},l={},d=[];const h=t.isWebGL2?c.getParameter(c.MAX_UNIFORM_BUFFER_BINDINGS):0;function C(H,U,$){const X=H.value;if(void 0===$[U]){if("number"==typeof X)$[U]=X;else{const J=Array.isArray(X)?X:[X],re=[];for(let le=0;le<J.length;le++)re.push(J[le].clone());$[U]=re}return!0}if("number"==typeof X){if($[U]!==X)return $[U]=X,!0}else{const J=Array.isArray($[U])?$[U]:[$[U]],re=Array.isArray(X)?X:[X];for(let le=0;le<J.length;le++){const G=J[le];if(!1===G.equals(re[le]))return G.copy(re[le]),!0}}return!1}function N(H){const U={boundary:0,storage:0};return"number"==typeof H?(U.boundary=4,U.storage=4):H.isVector2?(U.boundary=8,U.storage=8):H.isVector3||H.isColor?(U.boundary=16,U.storage=12):H.isVector4?(U.boundary=16,U.storage=16):H.isMatrix3?(U.boundary=48,U.storage=48):H.isMatrix4?(U.boundary=64,U.storage=64):H.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",H),U}function P(H){const U=H.target;U.removeEventListener("dispose",P);const $=d.indexOf(U.__bindingPointIndex);d.splice($,1),c.deleteBuffer(o[U.id]),delete o[U.id],delete l[U.id]}return{bind:function p(H,U){s.uniformBlockBinding(H,U.program)},update:function m(H,U){let $=o[H.id];void 0===$&&(function R(H){const U=H.uniforms;let $=0;let J=0;for(let re=0,le=U.length;re<le;re++){const G=U[re],te={boundary:0,storage:0},Pe=Array.isArray(G.value)?G.value:[G.value];for(let qe=0,_e=Pe.length;qe<_e;qe++){const Fe=N(Pe[qe]);te.boundary+=Fe.boundary,te.storage+=Fe.storage}G.__data=new Float32Array(te.storage/Float32Array.BYTES_PER_ELEMENT),G.__offset=$,re>0&&(J=$%16,0!==J&&16-J-te.boundary<0&&($+=16-J,G.__offset=$)),$+=te.storage}J=$%16,J>0&&($+=16-J),H.__size=$,H.__cache={}}(H),$=function _(H){const U=function S(){for(let H=0;H<h;H++)if(-1===d.indexOf(H))return d.push(H),H;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();H.__bindingPointIndex=U;const $=c.createBuffer(),X=H.__size,J=H.usage;return c.bindBuffer(c.UNIFORM_BUFFER,$),c.bufferData(c.UNIFORM_BUFFER,X,J),c.bindBuffer(c.UNIFORM_BUFFER,null),c.bindBufferBase(c.UNIFORM_BUFFER,U,$),$}(H),o[H.id]=$,H.addEventListener("dispose",P)),s.updateUBOMapping(H,U.program);const J=e.render.frame;l[H.id]!==J&&(function b(H){const $=H.uniforms,X=H.__cache;c.bindBuffer(c.UNIFORM_BUFFER,o[H.id]);for(let J=0,re=$.length;J<re;J++){const le=$[J];if(!0===C(le,J,X)){const G=le.__offset,te=Array.isArray(le.value)?le.value:[le.value];let Pe=0;for(let qe=0;qe<te.length;qe++){const _e=te[qe],Ce=N(_e);"number"==typeof _e?(le.__data[0]=_e,c.bufferSubData(c.UNIFORM_BUFFER,G+Pe,le.__data)):_e.isMatrix3?(le.__data[0]=_e.elements[0],le.__data[1]=_e.elements[1],le.__data[2]=_e.elements[2],le.__data[3]=_e.elements[0],le.__data[4]=_e.elements[3],le.__data[5]=_e.elements[4],le.__data[6]=_e.elements[5],le.__data[7]=_e.elements[0],le.__data[8]=_e.elements[6],le.__data[9]=_e.elements[7],le.__data[10]=_e.elements[8],le.__data[11]=_e.elements[0]):(_e.toArray(le.__data,Pe),Pe+=Ce.storage/Float32Array.BYTES_PER_ELEMENT)}c.bufferSubData(c.UNIFORM_BUFFER,G,le.__data)}}c.bindBuffer(c.UNIFORM_BUFFER,null)}(H),l[H.id]=J)},dispose:function I(){for(const H in o)c.deleteBuffer(o[H]);d=[],o={},l={}}}}function qy(){const c=Oa("canvas");return c.style.display="block",c}class Qm{constructor(e={}){const{canvas:t=qy(),context:s=null,depth:o=!0,stencil:l=!0,alpha:d=!1,antialias:h=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:m=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:S=!1}=e;let b;this.isWebGLRenderer=!0,b=null!==s?s.getContextAttributes().alpha:d;let C=null,R=null;const N=[],P=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=gn,this.useLegacyLights=!0,this.toneMapping=$i,this.toneMappingExposure=1;const I=this;let H=!1,U=0,$=0,X=null,J=-1,re=null;const le=new Ei,G=new Ei;let te=null,Pe=t.width,qe=t.height,_e=1,Ce=null,Fe=null;const ft=new Ei(0,0,Pe,qe),ut=new Ei(0,0,Pe,qe);let at=!1;const mt=new Gp;let St=!1,Yt=!1,Vt=null;const ze=new kt,pt=new K,Lt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Gt(){return null===X?_e:1}let Rn,It,dn,_t,Ye,xt,nt,Bt,wn,Tn,cn,Jn,ci,ne,j,Ne,bt,At,zt,Dn,qt,je,sn,_n,de=s;function yn(Q,we){for(let We=0;We<Q.length;We++){const Je=t.getContext(Q[We],we);if(null!==Je)return Je}return null}try{const Q={alpha:!0,depth:o,stencil:l,antialias:h,premultipliedAlpha:p,preserveDrawingBuffer:m,powerPreference:_,failIfMajorPerformanceCaveat:S};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r152"),t.addEventListener("webglcontextlost",on,!1),t.addEventListener("webglcontextrestored",di,!1),t.addEventListener("webglcontextcreationerror",Li,!1),null===de){const we=["webgl2","webgl","experimental-webgl"];if(!0===I.isWebGL1Renderer&&we.shift(),de=yn(we,Q),null===de)throw yn(we)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===de.getShaderPrecisionFormat&&(de.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Q){throw console.error("THREE.WebGLRenderer: "+Q.message),Q}function Cn(){Rn=new pf(de),It=new bd(de,Rn,e),Rn.init(It),je=new zd(de,Rn,It),dn=new Zm(de,Rn,It),_t=new Sm(de),Ye=new AM,xt=new Cf(de,Rn,dn,Ye,It,je,_t),nt=new uf(I),Bt=new Cd(I),wn=new wv(de,It),sn=new gm(de,Rn,wn,It),Tn=new xm(de,wn,_t,sn),cn=new Ey(de,Tn,wn,_t),zt=new xy(de,It,xt),Ne=new vm(Ye),Jn=new CM(I,nt,Bt,Rn,It,sn,Ne),ci=new Km(I,Ye),ne=new $y,j=new yu(Rn,It),At=new hu(I,nt,Bt,dn,cn,b,p),bt=new Mu(I,cn,It),_n=new Jm(de,_t,It,dn),Dn=new cf(de,Rn,_t,It),qt=new Em(de,Rn,_t,It),_t.programs=Jn.programs,I.capabilities=It,I.extensions=Rn,I.properties=Ye,I.renderLists=ne,I.shadowMap=bt,I.state=dn,I.info=_t}Cn();const Qt=new Yy(I,de);function on(Q){Q.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function di(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;const Q=_t.autoReset,we=bt.enabled,We=bt.autoUpdate,xe=bt.needsUpdate,Je=bt.type;Cn(),_t.autoReset=Q,bt.enabled=we,bt.autoUpdate=We,bt.needsUpdate=xe,bt.type=Je}function Li(Q){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Q.statusMessage)}function vr(Q){const we=Q.target;we.removeEventListener("dispose",vr),function he(Q){(function Ge(Q){const we=Ye.get(Q).programs;void 0!==we&&(we.forEach(function(We){Jn.releaseProgram(We)}),Q.isShaderMaterial&&Jn.releaseShaderCache(Q))})(Q),Ye.remove(Q)}(we)}this.xr=Qt,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){const Q=Rn.get("WEBGL_lose_context");Q&&Q.loseContext()},this.forceContextRestore=function(){const Q=Rn.get("WEBGL_lose_context");Q&&Q.restoreContext()},this.getPixelRatio=function(){return _e},this.setPixelRatio=function(Q){void 0!==Q&&(_e=Q,this.setSize(Pe,qe,!1))},this.getSize=function(Q){return Q.set(Pe,qe)},this.setSize=function(Q,we,We=!0){Qt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Pe=Q,qe=we,t.width=Math.floor(Q*_e),t.height=Math.floor(we*_e),!0===We&&(t.style.width=Q+"px",t.style.height=we+"px"),this.setViewport(0,0,Q,we))},this.getDrawingBufferSize=function(Q){return Q.set(Pe*_e,qe*_e).floor()},this.setDrawingBufferSize=function(Q,we,We){Pe=Q,qe=we,_e=We,t.width=Math.floor(Q*We),t.height=Math.floor(we*We),this.setViewport(0,0,Q,we)},this.getCurrentViewport=function(Q){return Q.copy(le)},this.getViewport=function(Q){return Q.copy(ft)},this.setViewport=function(Q,we,We,xe){Q.isVector4?ft.set(Q.x,Q.y,Q.z,Q.w):ft.set(Q,we,We,xe),dn.viewport(le.copy(ft).multiplyScalar(_e).floor())},this.getScissor=function(Q){return Q.copy(ut)},this.setScissor=function(Q,we,We,xe){Q.isVector4?ut.set(Q.x,Q.y,Q.z,Q.w):ut.set(Q,we,We,xe),dn.scissor(G.copy(ut).multiplyScalar(_e).floor())},this.getScissorTest=function(){return at},this.setScissorTest=function(Q){dn.setScissorTest(at=Q)},this.setOpaqueSort=function(Q){Ce=Q},this.setTransparentSort=function(Q){Fe=Q},this.getClearColor=function(Q){return Q.copy(At.getClearColor())},this.setClearColor=function(){At.setClearColor.apply(At,arguments)},this.getClearAlpha=function(){return At.getClearAlpha()},this.setClearAlpha=function(){At.setClearAlpha.apply(At,arguments)},this.clear=function(Q=!0,we=!0,We=!0){let xe=0;Q&&(xe|=de.COLOR_BUFFER_BIT),we&&(xe|=de.DEPTH_BUFFER_BIT),We&&(xe|=de.STENCIL_BUFFER_BIT),de.clear(xe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",on,!1),t.removeEventListener("webglcontextrestored",di,!1),t.removeEventListener("webglcontextcreationerror",Li,!1),ne.dispose(),j.dispose(),Ye.dispose(),nt.dispose(),Bt.dispose(),cn.dispose(),sn.dispose(),_n.dispose(),Jn.dispose(),Qt.dispose(),Qt.removeEventListener("sessionstart",hn),Qt.removeEventListener("sessionend",bi),Vt&&(Vt.dispose(),Vt=null),wi.stop()},this.renderBufferDirect=function(Q,we,We,xe,Je,fn){null===we&&(we=Lt);const An=Je.isMesh&&Je.matrixWorld.determinant()<0,Un=function dv(Q,we,We,xe,Je){!0!==we.isScene&&(we=Lt),xt.resetTextureUnits();const fn=we.fog,Un=null===X?I.outputColorSpace:!0===X.isXRRenderTarget?X.texture.colorSpace:er,jn=(xe.isMeshStandardMaterial?Bt:nt).get(xe.envMap||(xe.isMeshStandardMaterial?we.environment:null)),Gn=!0===xe.vertexColors&&!!We.attributes.color&&4===We.attributes.color.itemSize,ti=!!xe.normalMap&&!!We.attributes.tangent,ai=!!We.morphAttributes.position,Ni=!!We.morphAttributes.normal,ys=!!We.morphAttributes.color,ia=xe.toneMapped?I.toneMapping:$i,kl=We.morphAttributes.position||We.morphAttributes.normal||We.morphAttributes.color,_r=void 0!==kl?kl.length:0,hi=Ye.get(xe),Dp=R.state.lights;!0!==St||!0!==Yt&&Q===re||Ne.setState(xe,Q,Q===re&&xe.id===J);let fr=!1;xe.version===hi.__version?(hi.needsLights&&hi.lightsStateVersion!==Dp.state.version||hi.outputColorSpace!==Un||Je.isInstancedMesh&&!1===hi.instancing||!Je.isInstancedMesh&&!0===hi.instancing||Je.isSkinnedMesh&&!1===hi.skinning||!Je.isSkinnedMesh&&!0===hi.skinning||hi.envMap!==jn||!0===xe.fog&&hi.fog!==fn||void 0!==hi.numClippingPlanes&&(hi.numClippingPlanes!==Ne.numPlanes||hi.numIntersection!==Ne.numIntersection)||hi.vertexAlphas!==Gn||hi.vertexTangents!==ti||hi.morphTargets!==ai||hi.morphNormals!==Ni||hi.morphColors!==ys||hi.toneMapping!==ia||!0===It.isWebGL2&&hi.morphTargetsCount!==_r)&&(fr=!0):(fr=!0,hi.__version=xe.version);let Bl=hi.currentProgram;!0===fr&&(Bl=Xu(xe,we,Je));let Cp=!1,Yu=!1,Rh=!1;const _s=Bl.getUniforms(),Ka=hi.uniforms;if(dn.useProgram(Bl.program)&&(Cp=!0,Yu=!0,Rh=!0),xe.id!==J&&(J=xe.id,Yu=!0),Cp||re!==Q){if(_s.setValue(de,"projectionMatrix",Q.projectionMatrix),It.logarithmicDepthBuffer&&_s.setValue(de,"logDepthBufFC",2/(Math.log(Q.far+1)/Math.LN2)),re!==Q&&(re=Q,Yu=!0,Rh=!0),xe.isShaderMaterial||xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshStandardMaterial||xe.envMap){const Ms=_s.map.cameraPosition;void 0!==Ms&&Ms.setValue(de,pt.setFromMatrixPosition(Q.matrixWorld))}(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial)&&_s.setValue(de,"isOrthographic",!0===Q.isOrthographicCamera),(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial||xe.isShadowMaterial||Je.isSkinnedMesh)&&_s.setValue(de,"viewMatrix",Q.matrixWorldInverse)}if(Je.isSkinnedMesh){_s.setOptional(de,Je,"bindMatrix"),_s.setOptional(de,Je,"bindMatrixInverse");const Ms=Je.skeleton;Ms&&(It.floatVertexTextures?(null===Ms.boneTexture&&Ms.computeBoneTexture(),_s.setValue(de,"boneTexture",Ms.boneTexture,xt),_s.setValue(de,"boneTextureSize",Ms.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Ap=We.morphAttributes;if((void 0!==Ap.position||void 0!==Ap.normal||void 0!==Ap.color&&!0===It.isWebGL2)&&zt.update(Je,We,Bl),(Yu||hi.receiveShadow!==Je.receiveShadow)&&(hi.receiveShadow=Je.receiveShadow,_s.setValue(de,"receiveShadow",Je.receiveShadow)),xe.isMeshGouraudMaterial&&null!==xe.envMap&&(Ka.envMap.value=jn,Ka.flipEnvMap.value=jn.isCubeTexture&&!1===jn.isRenderTargetTexture?-1:1),Yu&&(_s.setValue(de,"toneMappingExposure",I.toneMappingExposure),hi.needsLights&&function i_(Q,we){Q.ambientLightColor.needsUpdate=we,Q.lightProbe.needsUpdate=we,Q.directionalLights.needsUpdate=we,Q.directionalLightShadows.needsUpdate=we,Q.pointLights.needsUpdate=we,Q.pointLightShadows.needsUpdate=we,Q.spotLights.needsUpdate=we,Q.spotLightShadows.needsUpdate=we,Q.rectAreaLights.needsUpdate=we,Q.hemisphereLights.needsUpdate=we}(Ka,Rh),fn&&!0===xe.fog&&ci.refreshFogUniforms(Ka,fn),ci.refreshMaterialUniforms(Ka,xe,_e,qe,Vt),vu.upload(de,hi.uniformsList,Ka,xt)),xe.isShaderMaterial&&!0===xe.uniformsNeedUpdate&&(vu.upload(de,hi.uniformsList,Ka,xt),xe.uniformsNeedUpdate=!1),xe.isSpriteMaterial&&_s.setValue(de,"center",Je.center),_s.setValue(de,"modelViewMatrix",Je.modelViewMatrix),_s.setValue(de,"normalMatrix",Je.normalMatrix),_s.setValue(de,"modelMatrix",Je.matrixWorld),xe.isShaderMaterial||xe.isRawShaderMaterial){const Ms=xe.uniformsGroups;for(let Ip=0,hv=Ms.length;Ip<hv;Ip++)if(It.isWebGL2){const Rp=Ms[Ip];_n.update(Rp,Bl),_n.bind(Rp,Bl)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Bl}(Q,we,We,xe,Je);dn.setMaterial(xe,An);let jn=We.index,Gn=1;!0===xe.wireframe&&(jn=Tn.getWireframeAttribute(We),Gn=2);const ti=We.drawRange,ai=We.attributes.position;let Ni=ti.start*Gn,ys=(ti.start+ti.count)*Gn;null!==fn&&(Ni=Math.max(Ni,fn.start*Gn),ys=Math.min(ys,(fn.start+fn.count)*Gn)),null!==jn?(Ni=Math.max(Ni,0),ys=Math.min(ys,jn.count)):null!=ai&&(Ni=Math.max(Ni,0),ys=Math.min(ys,ai.count));const ia=ys-Ni;if(ia<0||ia===1/0)return;sn.setup(Je,xe,Un,We,jn);let kl,_r=Dn;if(null!==jn&&(kl=wn.get(jn),_r=qt,_r.setIndex(kl)),Je.isMesh)!0===xe.wireframe?(dn.setLineWidth(xe.wireframeLinewidth*Gt()),_r.setMode(de.LINES)):_r.setMode(de.TRIANGLES);else if(Je.isLine){let hi=xe.linewidth;void 0===hi&&(hi=1),dn.setLineWidth(hi*Gt()),_r.setMode(Je.isLineSegments?de.LINES:Je.isLineLoop?de.LINE_LOOP:de.LINE_STRIP)}else Je.isPoints?_r.setMode(de.POINTS):Je.isSprite&&_r.setMode(de.TRIANGLES);if(Je.isInstancedMesh)_r.renderInstances(Ni,ia,Je.count);else if(We.isInstancedBufferGeometry){const Dp=Math.min(We.instanceCount,void 0!==We._maxInstanceCount?We._maxInstanceCount:1/0);_r.renderInstances(Ni,ia,Dp)}else _r.render(Ni,ia)},this.compile=function(Q,we){function We(xe,Je,fn){!0===xe.transparent&&xe.side===Ut&&!1===xe.forceSinglePass?(xe.side=it,xe.needsUpdate=!0,Xu(xe,Je,fn),xe.side=ke,xe.needsUpdate=!0,Xu(xe,Je,fn),xe.side=Ut):Xu(xe,Je,fn)}R=j.get(Q),R.init(),P.push(R),Q.traverseVisible(function(xe){xe.isLight&&xe.layers.test(we.layers)&&(R.pushLight(xe),xe.castShadow&&R.pushShadow(xe))}),R.setupLights(I.useLegacyLights),Q.traverse(function(xe){const Je=xe.material;if(Je)if(Array.isArray(Je))for(let fn=0;fn<Je.length;fn++)We(Je[fn],Q,xe);else We(Je,Q,xe)}),P.pop(),R=null};let Tt=null;function hn(){wi.stop()}function bi(){wi.start()}const wi=new Sr;function as(Q,we,We,xe){if(!1===Q.visible)return;if(Q.layers.test(we.layers))if(Q.isGroup)We=Q.renderOrder;else if(Q.isLOD)!0===Q.autoUpdate&&Q.update(we);else if(Q.isLight)R.pushLight(Q),Q.castShadow&&R.pushShadow(Q);else if(Q.isSprite){if(!Q.frustumCulled||mt.intersectsSprite(Q)){xe&&pt.setFromMatrixPosition(Q.matrixWorld).applyMatrix4(ze);const An=cn.update(Q),Un=Q.material;Un.visible&&C.push(Q,An,Un,We,pt.z,null)}}else if((Q.isMesh||Q.isLine||Q.isPoints)&&(!Q.frustumCulled||mt.intersectsObject(Q))){Q.isSkinnedMesh&&Q.skeleton.frame!==_t.render.frame&&(Q.skeleton.update(),Q.skeleton.frame=_t.render.frame);const An=cn.update(Q),Un=Q.material;if(xe&&(null===An.boundingSphere&&An.computeBoundingSphere(),pt.copy(An.boundingSphere.center).applyMatrix4(Q.matrixWorld).applyMatrix4(ze)),Array.isArray(Un)){const jn=An.groups;for(let Gn=0,ti=jn.length;Gn<ti;Gn++){const ai=jn[Gn],Ni=Un[ai.materialIndex];Ni&&Ni.visible&&C.push(Q,An,Ni,We,pt.z,ai)}}else Un.visible&&C.push(Q,An,Un,We,pt.z,null)}const fn=Q.children;for(let An=0,Un=fn.length;An<Un;An++)as(fn[An],we,We,xe)}function Za(Q,we,We,xe){const Je=Q.opaque,fn=Q.transmissive,An=Q.transparent;R.setupLightsView(We),!0===St&&Ne.setGlobalState(I.clippingPlanes,We),fn.length>0&&function yr(Q,we,We,xe){if(null===Vt){const Un=It.isWebGL2;Vt=new ro(1024,1024,{generateMipmaps:!0,type:Rn.has("EXT_color_buffer_half_float")?Qe:ue,minFilter:ce,samples:Un&&!0===h?4:0})}const Je=I.getRenderTarget();I.setRenderTarget(Vt),I.clear();const fn=I.toneMapping;I.toneMapping=$i,Qs(Q,We,xe),xt.updateMultisampleRenderTarget(Vt),xt.updateRenderTargetMipmap(Vt);let An=!1;for(let Un=0,jn=we.length;Un<jn;Un++){const Gn=we[Un],ti=Gn.object,ai=Gn.geometry,Ni=Gn.material,ys=Gn.group;if(Ni.side===Ut&&ti.layers.test(xe.layers)){const ia=Ni.side;Ni.side=it,Ni.needsUpdate=!0,Io(ti,We,xe,ai,Ni,ys),Ni.side=ia,Ni.needsUpdate=!0,An=!0}}!0===An&&(xt.updateMultisampleRenderTarget(Vt),xt.updateRenderTargetMipmap(Vt)),I.setRenderTarget(Je),I.toneMapping=fn}(Je,fn,we,We),xe&&dn.viewport(le.copy(xe)),Je.length>0&&Qs(Je,we,We),fn.length>0&&Qs(fn,we,We),An.length>0&&Qs(An,we,We),dn.buffers.depth.setTest(!0),dn.buffers.depth.setMask(!0),dn.buffers.color.setMask(!0),dn.setPolygonOffset(!1)}function Qs(Q,we,We){const xe=!0===we.isScene?we.overrideMaterial:null;for(let Je=0,fn=Q.length;Je<fn;Je++){const An=Q[Je],Un=An.object,jn=An.geometry,Gn=null===xe?An.material:xe,ti=An.group;Un.layers.test(We.layers)&&Io(Un,we,We,jn,Gn,ti)}}function Io(Q,we,We,xe,Je,fn){Q.onBeforeRender(I,we,We,xe,Je,fn),Q.modelViewMatrix.multiplyMatrices(We.matrixWorldInverse,Q.matrixWorld),Q.normalMatrix.getNormalMatrix(Q.modelViewMatrix),Je.onBeforeRender(I,we,We,xe,Q,fn),!0===Je.transparent&&Je.side===Ut&&!1===Je.forceSinglePass?(Je.side=it,Je.needsUpdate=!0,I.renderBufferDirect(We,we,xe,Je,Q,fn),Je.side=ke,Je.needsUpdate=!0,I.renderBufferDirect(We,we,xe,Je,Q,fn),Je.side=Ut):I.renderBufferDirect(We,we,xe,Je,Q,fn),Q.onAfterRender(I,we,We,xe,Je,fn)}function Xu(Q,we,We){!0!==we.isScene&&(we=Lt);const xe=Ye.get(Q),Je=R.state.lights,An=Je.state.version,Un=Jn.getParameters(Q,Je.state,R.state.shadowsArray,we,We),jn=Jn.getProgramCacheKey(Un);let Gn=xe.programs;xe.environment=Q.isMeshStandardMaterial?we.environment:null,xe.fog=we.fog,xe.envMap=(Q.isMeshStandardMaterial?Bt:nt).get(Q.envMap||xe.environment),void 0===Gn&&(Q.addEventListener("dispose",vr),Gn=new Map,xe.programs=Gn);let ti=Gn.get(jn);if(void 0!==ti){if(xe.currentProgram===ti&&xe.lightsStateVersion===An)return uv(Q,Un),ti}else Un.uniforms=Jn.getUniforms(Q),Q.onBuild(We,Un,I),Q.onBeforeCompile(Un,I),ti=Jn.acquireProgram(Un,jn),Gn.set(jn,ti),xe.uniforms=Un.uniforms;const ai=xe.uniforms;(!Q.isShaderMaterial&&!Q.isRawShaderMaterial||!0===Q.clipping)&&(ai.clippingPlanes=Ne.uniform),uv(Q,Un),xe.needsLights=function r_(Q){return Q.isMeshLambertMaterial||Q.isMeshToonMaterial||Q.isMeshPhongMaterial||Q.isMeshStandardMaterial||Q.isShadowMaterial||Q.isShaderMaterial&&!0===Q.lights}(Q),xe.lightsStateVersion=An,xe.needsLights&&(ai.ambientLightColor.value=Je.state.ambient,ai.lightProbe.value=Je.state.probe,ai.directionalLights.value=Je.state.directional,ai.directionalLightShadows.value=Je.state.directionalShadow,ai.spotLights.value=Je.state.spot,ai.spotLightShadows.value=Je.state.spotShadow,ai.rectAreaLights.value=Je.state.rectArea,ai.ltc_1.value=Je.state.rectAreaLTC1,ai.ltc_2.value=Je.state.rectAreaLTC2,ai.pointLights.value=Je.state.point,ai.pointLightShadows.value=Je.state.pointShadow,ai.hemisphereLights.value=Je.state.hemi,ai.directionalShadowMap.value=Je.state.directionalShadowMap,ai.directionalShadowMatrix.value=Je.state.directionalShadowMatrix,ai.spotShadowMap.value=Je.state.spotShadowMap,ai.spotLightMatrix.value=Je.state.spotLightMatrix,ai.spotLightMap.value=Je.state.spotLightMap,ai.pointShadowMap.value=Je.state.pointShadowMap,ai.pointShadowMatrix.value=Je.state.pointShadowMatrix);const Ni=ti.getUniforms(),ys=vu.seqWithValue(Ni.seq,ai);return xe.currentProgram=ti,xe.uniformsList=ys,ti}function uv(Q,we){const We=Ye.get(Q);We.outputColorSpace=we.outputColorSpace,We.instancing=we.instancing,We.skinning=we.skinning,We.morphTargets=we.morphTargets,We.morphNormals=we.morphNormals,We.morphColors=we.morphColors,We.morphTargetsCount=we.morphTargetsCount,We.numClippingPlanes=we.numClippingPlanes,We.numIntersection=we.numClipIntersection,We.vertexAlphas=we.vertexAlphas,We.vertexTangents=we.vertexTangents,We.toneMapping=we.toneMapping}wi.setAnimationLoop(function $t(Q){Tt&&Tt(Q)}),typeof self<"u"&&wi.setContext(self),this.setAnimationLoop=function(Q){Tt=Q,Qt.setAnimationLoop(Q),null===Q?wi.stop():wi.start()},Qt.addEventListener("sessionstart",hn),Qt.addEventListener("sessionend",bi),this.render=function(Q,we){if(void 0===we||!0===we.isCamera){if(!0!==H){if(!0===Q.matrixWorldAutoUpdate&&Q.updateMatrixWorld(),null===we.parent&&!0===we.matrixWorldAutoUpdate&&we.updateMatrixWorld(),!0===Qt.enabled&&!0===Qt.isPresenting&&(!0===Qt.cameraAutoUpdate&&Qt.updateCamera(we),we=Qt.getCamera()),!0===Q.isScene&&Q.onBeforeRender(I,Q,we,X),R=j.get(Q,P.length),R.init(),P.push(R),ze.multiplyMatrices(we.projectionMatrix,we.matrixWorldInverse),mt.setFromProjectionMatrix(ze),Yt=this.localClippingEnabled,St=Ne.init(this.clippingPlanes,Yt),C=ne.get(Q,N.length),C.init(),N.push(C),as(Q,we,0,I.sortObjects),C.finish(),!0===I.sortObjects&&C.sort(Ce,Fe),!0===St&&Ne.beginShadows(),bt.render(R.state.shadowsArray,Q,we),!0===St&&Ne.endShadows(),!0===this.info.autoReset&&this.info.reset(),At.render(C,Q),R.setupLights(I.useLegacyLights),we.isArrayCamera){const xe=we.cameras;for(let Je=0,fn=xe.length;Je<fn;Je++){const An=xe[Je];Za(C,Q,An,An.viewport)}}else Za(C,Q,we);null!==X&&(xt.updateMultisampleRenderTarget(X),xt.updateRenderTargetMipmap(X)),!0===Q.isScene&&Q.onAfterRender(I,Q,we),sn.resetDefaultState(),J=-1,re=null,P.pop(),R=P.length>0?P[P.length-1]:null,N.pop(),C=N.length>0?N[N.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return U},this.getActiveMipmapLevel=function(){return $},this.getRenderTarget=function(){return X},this.setRenderTargetTextures=function(Q,we,We){Ye.get(Q.texture).__webglTexture=we,Ye.get(Q.depthTexture).__webglTexture=We;const xe=Ye.get(Q);xe.__hasExternalTextures=!0,xe.__hasExternalTextures&&(xe.__autoAllocateDepthBuffer=void 0===We,xe.__autoAllocateDepthBuffer||!0===Rn.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),xe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Q,we){const We=Ye.get(Q);We.__webglFramebuffer=we,We.__useDefaultFramebuffer=void 0===we},this.setRenderTarget=function(Q,we=0,We=0){X=Q,U=we,$=We;let xe=!0,Je=null,fn=!1,An=!1;if(Q){const jn=Ye.get(Q);void 0!==jn.__useDefaultFramebuffer?(dn.bindFramebuffer(de.FRAMEBUFFER,null),xe=!1):void 0===jn.__webglFramebuffer?xt.setupRenderTarget(Q):jn.__hasExternalTextures&&xt.rebindTextures(Q,Ye.get(Q.texture).__webglTexture,Ye.get(Q.depthTexture).__webglTexture);const Gn=Q.texture;(Gn.isData3DTexture||Gn.isDataArrayTexture||Gn.isCompressedArrayTexture)&&(An=!0);const ti=Ye.get(Q).__webglFramebuffer;Q.isWebGLCubeRenderTarget?(Je=ti[we],fn=!0):Je=It.isWebGL2&&Q.samples>0&&!1===xt.useMultisampledRTT(Q)?Ye.get(Q).__webglMultisampledFramebuffer:ti,le.copy(Q.viewport),G.copy(Q.scissor),te=Q.scissorTest}else le.copy(ft).multiplyScalar(_e).floor(),G.copy(ut).multiplyScalar(_e).floor(),te=at;if(dn.bindFramebuffer(de.FRAMEBUFFER,Je)&&It.drawBuffers&&xe&&dn.drawBuffers(Q,Je),dn.viewport(le),dn.scissor(G),dn.setScissorTest(te),fn){const jn=Ye.get(Q.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_CUBE_MAP_POSITIVE_X+we,jn.__webglTexture,We)}else if(An){const jn=Ye.get(Q.texture);de.framebufferTextureLayer(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,jn.__webglTexture,We||0,we||0)}J=-1},this.readRenderTargetPixels=function(Q,we,We,xe,Je,fn,An){if(!Q||!Q.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Un=Ye.get(Q).__webglFramebuffer;if(Q.isWebGLCubeRenderTarget&&void 0!==An&&(Un=Un[An]),Un){dn.bindFramebuffer(de.FRAMEBUFFER,Un);try{const jn=Q.texture,Gn=jn.format,ti=jn.type;if(Gn!==mi&&je.convert(Gn)!==de.getParameter(de.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ai=ti===Qe&&(Rn.has("EXT_color_buffer_half_float")||It.isWebGL2&&Rn.has("EXT_color_buffer_float"));if(!(ti===ue||je.convert(ti)===de.getParameter(de.IMPLEMENTATION_COLOR_READ_TYPE)||ti===tt&&(It.isWebGL2||Rn.has("OES_texture_float")||Rn.has("WEBGL_color_buffer_float"))||ai))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");we>=0&&we<=Q.width-xe&&We>=0&&We<=Q.height-Je&&de.readPixels(we,We,xe,Je,je.convert(Gn),je.convert(ti),fn)}finally{const jn=null!==X?Ye.get(X).__webglFramebuffer:null;dn.bindFramebuffer(de.FRAMEBUFFER,jn)}}},this.copyFramebufferToTexture=function(Q,we,We=0){const xe=Math.pow(2,-We),Je=Math.floor(we.image.width*xe),fn=Math.floor(we.image.height*xe);xt.setTexture2D(we,0),de.copyTexSubImage2D(de.TEXTURE_2D,We,0,0,Q.x,Q.y,Je,fn),dn.unbindTexture()},this.copyTextureToTexture=function(Q,we,We,xe=0){const Je=we.image.width,fn=we.image.height,An=je.convert(We.format),Un=je.convert(We.type);xt.setTexture2D(We,0),de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,We.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,We.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,We.unpackAlignment),we.isDataTexture?de.texSubImage2D(de.TEXTURE_2D,xe,Q.x,Q.y,Je,fn,An,Un,we.image.data):we.isCompressedTexture?de.compressedTexSubImage2D(de.TEXTURE_2D,xe,Q.x,Q.y,we.mipmaps[0].width,we.mipmaps[0].height,An,we.mipmaps[0].data):de.texSubImage2D(de.TEXTURE_2D,xe,Q.x,Q.y,An,Un,we.image),0===xe&&We.generateMipmaps&&de.generateMipmap(de.TEXTURE_2D),dn.unbindTexture()},this.copyTextureToTexture3D=function(Q,we,We,xe,Je=0){if(I.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const fn=Q.max.x-Q.min.x+1,An=Q.max.y-Q.min.y+1,Un=Q.max.z-Q.min.z+1,jn=je.convert(xe.format),Gn=je.convert(xe.type);let ti;if(xe.isData3DTexture)xt.setTexture3D(xe,0),ti=de.TEXTURE_3D;else{if(!xe.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");xt.setTexture2DArray(xe,0),ti=de.TEXTURE_2D_ARRAY}de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,xe.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xe.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,xe.unpackAlignment);const ai=de.getParameter(de.UNPACK_ROW_LENGTH),Ni=de.getParameter(de.UNPACK_IMAGE_HEIGHT),ys=de.getParameter(de.UNPACK_SKIP_PIXELS),ia=de.getParameter(de.UNPACK_SKIP_ROWS),kl=de.getParameter(de.UNPACK_SKIP_IMAGES),_r=We.isCompressedTexture?We.mipmaps[0]:We.image;de.pixelStorei(de.UNPACK_ROW_LENGTH,_r.width),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,_r.height),de.pixelStorei(de.UNPACK_SKIP_PIXELS,Q.min.x),de.pixelStorei(de.UNPACK_SKIP_ROWS,Q.min.y),de.pixelStorei(de.UNPACK_SKIP_IMAGES,Q.min.z),We.isDataTexture||We.isData3DTexture?de.texSubImage3D(ti,Je,we.x,we.y,we.z,fn,An,Un,jn,Gn,_r.data):We.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),de.compressedTexSubImage3D(ti,Je,we.x,we.y,we.z,fn,An,Un,jn,_r.data)):de.texSubImage3D(ti,Je,we.x,we.y,we.z,fn,An,Un,jn,Gn,_r),de.pixelStorei(de.UNPACK_ROW_LENGTH,ai),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,Ni),de.pixelStorei(de.UNPACK_SKIP_PIXELS,ys),de.pixelStorei(de.UNPACK_SKIP_ROWS,ia),de.pixelStorei(de.UNPACK_SKIP_IMAGES,kl),0===Je&&xe.generateMipmaps&&de.generateMipmap(ti),dn.unbindTexture()},this.initTexture=function(Q){Q.isCubeTexture?xt.setTextureCube(Q,0):Q.isData3DTexture?xt.setTexture3D(Q,0):Q.isDataArrayTexture||Q.isCompressedArrayTexture?xt.setTexture2DArray(Q,0):xt.setTexture2D(Q,0),dn.unbindTexture()},this.resetState=function(){U=0,$=0,X=null,dn.reset(),sn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===gn?un:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===un?gn:er}}(class LM extends Qm{}).prototype.isWebGL1Renderer=!0;class Gd extends ms{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class np extends E{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new B(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new B(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pr,this.normalScale=new Ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function uo(c,e,t){return sp(c)?new c.constructor(c.subarray(e,void 0!==t?t:c.length)):c.slice(e,t)}function Pl(c,e,t){return!c||!t&&c.constructor===e?c:"number"==typeof e.BYTES_PER_ELEMENT?new e(c):Array.prototype.slice.call(c)}function sp(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}class op{constructor(e,t,s,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==o?o:new t.constructor(s),this.sampleValues=t,this.valueSize=s,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let s=this._cachedIndex,o=t[s],l=t[s-1];e:{t:{let d;n:{i:if(!(e<o)){for(let h=s+2;;){if(void 0===o){if(e<l)break i;return s=t.length,this._cachedIndex=s,this.copySampleValue_(s-1)}if(s===h)break;if(l=o,o=t[++s],e<o)break t}d=t.length;break n}if(e>=l)break e;{const h=t[1];e<h&&(s=2,l=h);for(let p=s-2;;){if(void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(s===p)break;if(o=l,l=t[--s-1],e>=l)break t}d=s,s=0}}for(;s<d;){const h=s+d>>>1;e<t[h]?d=h:s=h+1}if(o=t[s],l=t[s-1],void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===o)return s=t.length,this._cachedIndex=s,this.copySampleValue_(s-1)}this._cachedIndex=s,this.intervalChanged_(s,l,o)}return this.interpolate_(s,l,e,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,s=this.sampleValues,o=this.valueSize,l=e*o;for(let d=0;d!==o;++d)t[d]=s[l+d];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class fh extends op{constructor(e,t,s,o){super(e,t,s,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,s){const o=this.parameterPositions;let l=e-2,d=e+1,h=o[l],p=o[d];if(void 0===h)switch(this.getSettings_().endingStart){case 2401:l=e,h=2*t-s;break;case 2402:l=o.length-2,h=t+o[l]-o[l+1];break;default:l=e,h=s}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:d=e,p=2*s-t;break;case 2402:d=1,p=s+o[1]-o[0];break;default:d=e-1,p=t}const m=.5*(s-t),_=this.valueSize;this._weightPrev=m/(t-h),this._weightNext=m/(p-s),this._offsetPrev=l*_,this._offsetNext=d*_}interpolate_(e,t,s,o){const l=this.resultBuffer,d=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,_=this._offsetPrev,S=this._offsetNext,b=this._weightPrev,C=this._weightNext,R=(s-t)/(o-t),N=R*R,P=N*R,I=-b*P+2*b*N-b*R,H=(1+b)*P+(-1.5-2*b)*N+(-.5+b)*R+1,U=(-1-C)*P+(1.5+C)*N+.5*R,$=C*P-C*N;for(let X=0;X!==h;++X)l[X]=I*d[_+X]+H*d[m+X]+U*d[p+X]+$*d[S+X];return l}}class Rg extends op{constructor(e,t,s,o){super(e,t,s,o)}interpolate_(e,t,s,o){const l=this.resultBuffer,d=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,_=(s-t)/(o-t),S=1-_;for(let b=0;b!==h;++b)l[b]=d[m+b]*S+d[p+b]*_;return l}}class D0 extends op{constructor(e,t,s,o){super(e,t,s,o)}interpolate_(e){return this.copySampleValue_(e-1)}}class ho{constructor(e,t,s,o){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Pl(t,this.TimeBufferType),this.values=Pl(s,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let s;if(t.toJSON!==this.toJSON)s=t.toJSON(e);else{s={name:e.name,times:Pl(e.times,Array),values:Pl(e.values,Array)};const o=e.getInterpolation();o!==e.DefaultInterpolation&&(s.interpolation=o)}return s.type=e.ValueTypeName,s}InterpolantFactoryMethodDiscrete(e){return new D0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Rg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new fh(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const s="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(s);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",s),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let s=0,o=t.length;s!==o;++s)t[s]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let s=0,o=t.length;s!==o;++s)t[s]*=e}return this}trim(e,t){const s=this.times,o=s.length;let l=0,d=o-1;for(;l!==o&&s[l]<e;)++l;for(;-1!==d&&s[d]>t;)--d;if(++d,0!==l||d!==o){l>=d&&(d=Math.max(d,1),l=d-1);const h=this.getValueSize();this.times=uo(s,l,d),this.values=uo(this.values,l*h,d*h)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const s=this.times,o=this.values,l=s.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let d=null;for(let h=0;h!==l;h++){const p=s[h];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,p),e=!1;break}if(null!==d&&d>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,p,d),e=!1;break}d=p}if(void 0!==o&&sp(o))for(let h=0,p=o.length;h!==p;++h){const m=o[h];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,m),e=!1;break}}return e}optimize(){const e=uo(this.times),t=uo(this.values),s=this.getValueSize(),o=2302===this.getInterpolation(),l=e.length-1;let d=1;for(let h=1;h<l;++h){let p=!1;const m=e[h];if(m!==e[h+1]&&(1!==h||m!==e[0]))if(o)p=!0;else{const S=h*s,b=S-s,C=S+s;for(let R=0;R!==s;++R){const N=t[S+R];if(N!==t[b+R]||N!==t[C+R]){p=!0;break}}}if(p){if(h!==d){e[d]=e[h];const S=h*s,b=d*s;for(let C=0;C!==s;++C)t[b+C]=t[S+C]}++d}}if(l>0){e[d]=e[l];for(let h=l*s,p=d*s,m=0;m!==s;++m)t[p+m]=t[h+m];++d}return d!==e.length?(this.times=uo(e,0,d),this.values=uo(t,0,d*s)):(this.times=e,this.values=t),this}clone(){const e=uo(this.times,0),t=uo(this.values,0),o=new(0,this.constructor)(this.name,e,t);return o.createInterpolant=this.createInterpolant,o}}ho.prototype.TimeBufferType=Float32Array,ho.prototype.ValueBufferType=Float32Array,ho.prototype.DefaultInterpolation=2301;class Ac extends ho{}Ac.prototype.ValueTypeName="bool",Ac.prototype.ValueBufferType=Array,Ac.prototype.DefaultInterpolation=2300,Ac.prototype.InterpolantFactoryMethodLinear=void 0,Ac.prototype.InterpolantFactoryMethodSmooth=void 0;(class wo extends ho{}).prototype.ValueTypeName="color";(class Xa extends ho{}).prototype.ValueTypeName="number";class os extends op{constructor(e,t,s,o){super(e,t,s,o)}interpolate_(e,t,s,o){const l=this.resultBuffer,d=this.sampleValues,h=this.valueSize,p=(s-t)/(o-t);let m=e*h;for(let _=m+h;m!==_;m+=4)Ur.slerpFlat(l,0,d,m-h,d,m,p);return l}}class To extends ho{InterpolantFactoryMethodLinear(e){return new os(this.times,this.values,this.getValueSize(),e)}}To.prototype.ValueTypeName="quaternion",To.prototype.DefaultInterpolation=2301,To.prototype.InterpolantFactoryMethodSmooth=void 0;class Sa extends ho{}Sa.prototype.ValueTypeName="string",Sa.prototype.ValueBufferType=Array,Sa.prototype.DefaultInterpolation=2300,Sa.prototype.InterpolantFactoryMethodLinear=void 0,Sa.prototype.InterpolantFactoryMethodSmooth=void 0;(class vs extends ho{}).prototype.ValueTypeName="vector";const Do={enabled:!1,files:{},add:function(c,e){!1!==this.enabled&&(this.files[c]=e)},get:function(c){if(!1!==this.enabled)return this.files[c]},remove:function(c){delete this.files[c]},clear:function(){this.files={}}};class Ll{constructor(e,t,s){const o=this;let p,l=!1,d=0,h=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=s,this.itemStart=function(_){h++,!1===l&&void 0!==o.onStart&&o.onStart(_,d,h),l=!0},this.itemEnd=function(_){d++,void 0!==o.onProgress&&o.onProgress(_,d,h),d===h&&(l=!1,void 0!==o.onLoad&&o.onLoad())},this.itemError=function(_){void 0!==o.onError&&o.onError(_)},this.resolveURL=function(_){return p?p(_):_},this.setURLModifier=function(_){return p=_,this},this.addHandler=function(_,S){return m.push(_,S),this},this.removeHandler=function(_){const S=m.indexOf(_);return-1!==S&&m.splice(S,2),this},this.getHandler=function(_){for(let S=0,b=m.length;S<b;S+=2){const C=m[S],R=m[S+1];if(C.global&&(C.lastIndex=0),C.test(_))return R}return null}}}const Lc=new Ll;class Nl{constructor(e){this.manager=void 0!==e?e:Lc,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const s=this;return new Promise(function(o,l){s.load(e,o,t,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}class Nc extends Error{constructor(e,t){super(e),this.response=t}}class Hu extends Nl{constructor(e){super(e)}load(e,t,s,o){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,d=Do.get(e);if(void 0!==d)return l.manager.itemStart(e),setTimeout(function(){t&&t(d),l.manager.itemEnd(e)},0),d;const h=Oa("img");function p(){_(),Do.add(e,this),t&&t(this),l.manager.itemEnd(e)}function m(S){_(),o&&o(S),l.manager.itemError(e),l.manager.itemEnd(e)}function _(){h.removeEventListener("load",p,!1),h.removeEventListener("error",m,!1)}return h.addEventListener("load",p,!1),h.addEventListener("error",m,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(h.crossOrigin=this.crossOrigin),l.manager.itemStart(e),h.src=e,h}}class Pg extends Nl{constructor(e){super(e)}load(e,t,s,o){const l=new js,d=new Hu(this.manager);return d.setCrossOrigin(this.crossOrigin),d.setPath(this.path),d.load(e,function(h){l.image=h,l.needsUpdate=!0,void 0!==t&&t(l)},s,o),l}}class ap extends ms{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new B(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const ph=new kt,mh=new K,Ng=new K;class P0{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ke(512,512),this.map=null,this.mapPass=null,this.matrix=new kt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Gp,this._frameExtents=new Ke(1,1),this._viewportCount=1,this._viewports=[new Ei(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,s=this.matrix;mh.setFromMatrixPosition(e.matrixWorld),t.position.copy(mh),Ng.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Ng),t.updateMatrixWorld(),ph.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ph),s.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),s.multiply(ph)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const Og=new kt,gh=new K,lp=new K;class WM extends P0{constructor(){super(new Pr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ke(4,2),this._viewportCount=6,this._viewports=[new Ei(2,1,1,1),new Ei(0,1,1,1),new Ei(3,1,1,1),new Ei(1,1,1,1),new Ei(3,0,1,1),new Ei(1,0,1,1)],this._cubeDirections=[new K(1,0,0),new K(-1,0,0),new K(0,0,1),new K(0,0,-1),new K(0,1,0),new K(0,-1,0)],this._cubeUps=[new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,0,1),new K(0,0,-1)]}updateMatrices(e,t=0){const s=this.camera,o=this.matrix,l=e.distance||s.far;l!==s.far&&(s.far=l,s.updateProjectionMatrix()),gh.setFromMatrixPosition(e.matrixWorld),s.position.copy(gh),lp.copy(s.position),lp.add(this._cubeDirections[t]),s.up.copy(this._cubeUps[t]),s.lookAt(lp),s.updateMatrixWorld(),o.makeTranslation(-gh.x,-gh.y,-gh.z),Og.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Og)}}class Fg extends ap{constructor(e,t,s=0,o=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=s,this.decay=o,this.shadow=new WM}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class N0 extends P0{constructor(){super(new ml(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Ug extends ap{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ms.DEFAULT_UP),this.updateMatrix(),this.target=new ms,this.shadow=new N0}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Vg{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Gg(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Gg();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Gg(){return(typeof performance>"u"?Date:performance).now()}const Eh="\\[\\]\\.:\\/",k0=new RegExp("["+Eh+"]","g"),vp="[^"+Eh+"]",B0="[^"+Eh.replace("\\.","")+"]",H0=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",vp)+/(WCOD+)?/.source.replace("WCOD",B0)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",vp)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",vp)+"$"),z0=["material","materials","bones","map"];class Xg{constructor(e,t,s){const o=s||Wi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,o)}getValue(e,t){this.bind();const o=this._bindings[this._targetGroup.nCachedObjects_];void 0!==o&&o.getValue(e,t)}setValue(e,t){const s=this._bindings;for(let o=this._targetGroup.nCachedObjects_,l=s.length;o!==l;++o)s[o].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,s=e.length;t!==s;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,s=e.length;t!==s;++t)e[t].unbind()}}let Wi=(()=>{class c{constructor(t,s,o){this.path=s,this.parsedPath=o||c.parseTrackName(s),this.node=c.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,s,o){return t&&t.isAnimationObjectGroup?new c.Composite(t,s,o):new c(t,s,o)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(k0,"")}static parseTrackName(t){const s=H0.exec(t);if(null===s)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const o={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]},l=o.nodeName&&o.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const d=o.nodeName.substring(l+1);-1!==z0.indexOf(d)&&(o.nodeName=o.nodeName.substring(0,l),o.objectName=d)}if(null===o.propertyName||0===o.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return o}static findNode(t,s){if(void 0===s||""===s||"."===s||-1===s||s===t.name||s===t.uuid)return t;if(t.skeleton){const o=t.skeleton.getBoneByName(s);if(void 0!==o)return o}if(t.children){const o=function(d){for(let h=0;h<d.length;h++){const p=d[h];if(p.name===s||p.uuid===s)return p;const m=o(p.children);if(m)return m}return null},l=o(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,s){t[s]=this.targetObject[this.propertyName]}_getValue_array(t,s){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)t[s++]=o[l]}_getValue_arrayElement(t,s){t[s]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,s){this.resolvedProperty.toArray(t,s)}_setValue_direct(t,s){this.targetObject[this.propertyName]=t[s]}_setValue_direct_setNeedsUpdate(t,s){this.targetObject[this.propertyName]=t[s],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,s){this.targetObject[this.propertyName]=t[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,s){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=t[s++]}_setValue_array_setNeedsUpdate(t,s){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=t[s++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,s){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=t[s++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,s){this.resolvedProperty[this.propertyIndex]=t[s]}_setValue_arrayElement_setNeedsUpdate(t,s){this.resolvedProperty[this.propertyIndex]=t[s],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,s){this.resolvedProperty[this.propertyIndex]=t[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,s){this.resolvedProperty.fromArray(t,s)}_setValue_fromArray_setNeedsUpdate(t,s){this.resolvedProperty.fromArray(t,s),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,s){this.resolvedProperty.fromArray(t,s),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,s){this.bind(),this.getValue(t,s)}_setValue_unbound(t,s){this.bind(),this.setValue(t,s)}bind(){let t=this.node;const s=this.parsedPath,o=s.objectName,l=s.propertyName;let d=s.propertyIndex;if(t||(t=c.findNode(this.rootNode,s.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(o){let _=s.objectIndex;switch(o){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let S=0;S<t.length;S++)if(t[S].name===_){_=S;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[o])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[o]}if(void 0!==_){if(void 0===t[_])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[_]}}const h=t[l];if(void 0===h)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+s.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==d){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[d]&&(d=t.morphTargetDictionary[d])}m=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=d}else void 0!==h.fromArray&&void 0!==h.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(m=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return c.Composite=Xg,c})();Wi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Wi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Wi.prototype.GetterByBindingType=[Wi.prototype._getValue_direct,Wi.prototype._getValue_array,Wi.prototype._getValue_arrayElement,Wi.prototype._getValue_toArray],Wi.prototype.SetterByBindingTypeAndVersioning=[[Wi.prototype._setValue_direct,Wi.prototype._setValue_direct_setNeedsUpdate,Wi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Wi.prototype._setValue_array,Wi.prototype._setValue_array_setNeedsUpdate,Wi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Wi.prototype._setValue_arrayElement,Wi.prototype._setValue_arrayElement_setNeedsUpdate,Wi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Wi.prototype._setValue_fromArray,Wi.prototype._setValue_fromArray_setNeedsUpdate,Wi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"152"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="152");const t_=["rendererContainer"];let sv=(()=>{class c{constructor(t){this.renderer2=t,this.portalParticles=[],this.smokeParticles=[]}ngAfterViewInit(){this.initScene()}initScene(){this.scene=new Gd,this.sceneLight=new Ug(8174700,.5),this.sceneLight.position.set(0,0,1),this.scene.add(this.sceneLight),this.portalLight=new Fg(1797920,30,600,1.7),this.portalLight.position.set(0,0,250),this.scene.add(this.portalLight),this.cam=new Pr(80,1.2,1,1e4),this.cam.position.z=1e3,this.scene.add(this.cam),this.renderer=new Qm,this.renderer.setClearColor(0,0),this.renderer.setSize(500,500),this.rendererContainer&&this.renderer2.appendChild(this.rendererContainer.nativeElement,this.renderer.domElement),this.particleSetup()}particleSetup(){(new Pg).load("./assets/smoke.png",s=>{let o=new Zo(350,350),l=new np({map:s,transparent:!0}),d=new Zo(1e3,1e3),h=new np({map:s,transparent:!0});for(let p=880;p>250;p--){let m=new ns(o,l);m.position.set(.5*p*Math.cos(4*p*Math.PI/180),.5*p*Math.sin(4*p*Math.PI/180),.1*p),m.rotation.z=360*Math.random(),this.portalParticles.push(m),this.scene?.add(m)}for(let p=0;p<40;p++){let m=new ns(d,h);m.position.set(1e3*Math.random()-500,400*Math.random()-200,25),m.rotation.z=360*Math.random(),m.material.opacity=.6,this.portalParticles.push(m),this.scene?.add(m)}this.clock=new Vg,this.animate()})}animate(){let t=this.clock?.getDelta()||0;this.portalParticles.forEach(s=>{s.rotation.z-=1.5*t}),this.smokeParticles.forEach(s=>{s.rotation.z-=.2*t}),Math.random()>.9&&this.portalLight&&(this.portalLight.power=350+500*Math.random()),this.cam&&this.renderer&&this.scene&&this.renderer?.render(this.scene,this.cam),requestAnimationFrame(()=>this.animate())}ngOnDestroy(){this.rendererContainer&&this.renderer2.removeChild(this.rendererContainer.nativeElement,this.renderer?.domElement),this.scene?.clear(),this.sceneLight?.clear(),this.portalLight?.clear(),this.cam?.clear(),this.renderer?.clear(),this.clock?.stop(),this.portalLight?.clear(),this.smokeParticles=[]}}return c.\u0275fac=function(t){return new(t||c)(M.Y36(M.Qsj))},c.\u0275cmp=M.Xpm({type:c,selectors:[["app-rick-portal"]],viewQuery:function(t,s){if(1&t&&M.Gf(t_,5),2&t){let o;M.iGM(o=M.CRH())&&(s.rendererContainer=o.first)}},standalone:!0,features:[M.jDz],decls:2,vars:0,consts:[[1,"render-container"],["rendererContainer",""]],template:function(t,s){1&t&&M._UZ(0,"div",0,1)},dependencies:[De.ez],styles:[".render-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}"],changeDetection:0}),c})();var ov=V(2680),Ih=V(2962);function n_(c,e){1&c&&M._UZ(0,"app-rick-portal")}const lv=[{path:"characters",loadComponent:()=>Promise.all([V.e(592),V.e(438)]).then(V.bind(V,4438)).then(c=>c.CharacterComponent)},{path:"locations",loadComponent:()=>Promise.all([V.e(592),V.e(778)]).then(V.bind(V,7778)).then(c=>c.LocationComponent)},{path:"episodes",loadComponent:()=>Promise.all([V.e(592),V.e(5)]).then(V.bind(V,2005)).then(c=>c.EpisodeComponent)},{path:"favorites",loadComponent:()=>V.e(47).then(V.bind(V,5047)).then(c=>c.FavoriteComponent)},{path:"statistics",loadComponent:()=>V.e(16).then(V.bind(V,1016)).then(c=>c.StatisticsComponent)},{path:"",loadComponent:()=>V.e(263).then(V.bind(V,8263)).then(c=>c.HomeComponent)}];(0,dt.Cg)((()=>{class c{constructor(t){this.loaderSvc=t,this.isLoader=this.loaderSvc.isLoading$}}return c.\u0275fac=function(t){return new(t||c)(M.Y36(Ih.D))},c.\u0275cmp=M.Xpm({type:c,selectors:[["app-root"]],standalone:!0,features:[M.jDz],decls:6,vars:3,consts:[[1,"application-content"],[4,"ngIf"]],template:function(t,s){1&t&&(M._UZ(0,"app-header"),M.TgZ(1,"div",0),M.YNc(2,n_,1,0,"app-rick-portal",1),M.ALo(3,"async"),M._UZ(4,"router-outlet"),M.qZA(),M._UZ(5,"app-footer")),2&t&&(M.xp6(2),M.Q6J("ngIf",M.lcZ(3,1,s.isLoader)))},dependencies:[De.ez,De.O5,De.Ov,fe.lC,Re,me,Dt.JF,sv,ov.xu],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1}.application-content[_ngcontent-%COMP%]{flex:1}.white-text[_ngcontent-%COMP%]{color:#fff}"],changeDetection:0}),c})(),{providers:[(0,M.RIp)(dt.b2,(()=>{class c{}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=M.oAB({type:c}),c.\u0275inj=M.cJS({imports:[fe.Bz.forRoot(lv,{useHash:!0}),fe.Bz]}),c})())]}).catch(c=>console.error(c))},1135:(jt,Be,V)=>{V.d(Be,{X:()=>fe});var M=V(7579);class fe extends M.x{constructor(Re){super(),this._value=Re}get value(){return this.getValue()}_subscribe(Re){const Me=super._subscribe(Re);return!Me.closed&&Re.next(this._value),Me}getValue(){const{hasError:Re,thrownError:Me,_value:Ee}=this;if(Re)throw Me;return this._throwIfClosed(),Ee}next(Re){super.next(this._value=Re)}}},9751:(jt,Be,V)=>{V.d(Be,{y:()=>Dt});var M=V(930),fe=V(727),De=V(8822),Re=V(9635),Me=V(2416),Ee=V(576),Ve=V(2806);let Dt=(()=>{class ye{constructor(Ae){Ae&&(this._subscribe=Ae)}lift(Ae){const Ct=new ye;return Ct.source=this,Ct.operator=Ae,Ct}subscribe(Ae,Ct,Zt){const ht=function me(ye){return ye&&ye instanceof M.Lv||function Ze(ye){return ye&&(0,Ee.m)(ye.next)&&(0,Ee.m)(ye.error)&&(0,Ee.m)(ye.complete)}(ye)&&(0,fe.Nn)(ye)}(Ae)?Ae:new M.Hp(Ae,Ct,Zt);return(0,Ve.x)(()=>{const{operator:an,source:Pn}=this;ht.add(an?an.call(ht,Pn):Pn?this._subscribe(ht):this._trySubscribe(ht))}),ht}_trySubscribe(Ae){try{return this._subscribe(Ae)}catch(Ct){Ae.error(Ct)}}forEach(Ae,Ct){return new(Ct=dt(Ct))((Zt,ht)=>{const an=new M.Hp({next:Pn=>{try{Ae(Pn)}catch(zn){ht(zn),an.unsubscribe()}},error:ht,complete:Zt});this.subscribe(an)})}_subscribe(Ae){var Ct;return null===(Ct=this.source)||void 0===Ct?void 0:Ct.subscribe(Ae)}[De.L](){return this}pipe(...Ae){return(0,Re.U)(Ae)(this)}toPromise(Ae){return new(Ae=dt(Ae))((Ct,Zt)=>{let ht;this.subscribe(an=>ht=an,an=>Zt(an),()=>Ct(ht))})}}return ye.create=Le=>new ye(Le),ye})();function dt(ye){var Le;return null!==(Le=ye??Me.config.Promise)&&void 0!==Le?Le:Promise}},7579:(jt,Be,V)=>{V.d(Be,{x:()=>Ve});var M=V(9751),fe=V(727);const Re=(0,V(3888).d)(dt=>function(){dt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Me=V(8737),Ee=V(2806);let Ve=(()=>{class dt extends M.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(me){const ye=new Dt(this,this);return ye.operator=me,ye}_throwIfClosed(){if(this.closed)throw new Re}next(me){(0,Ee.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const ye of this.currentObservers)ye.next(me)}})}error(me){(0,Ee.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=me;const{observers:ye}=this;for(;ye.length;)ye.shift().error(me)}})}complete(){(0,Ee.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:me}=this;for(;me.length;)me.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var me;return(null===(me=this.observers)||void 0===me?void 0:me.length)>0}_trySubscribe(me){return this._throwIfClosed(),super._trySubscribe(me)}_subscribe(me){return this._throwIfClosed(),this._checkFinalizedStatuses(me),this._innerSubscribe(me)}_innerSubscribe(me){const{hasError:ye,isStopped:Le,observers:Ae}=this;return ye||Le?fe.Lc:(this.currentObservers=null,Ae.push(me),new fe.w0(()=>{this.currentObservers=null,(0,Me.P)(Ae,me)}))}_checkFinalizedStatuses(me){const{hasError:ye,thrownError:Le,isStopped:Ae}=this;ye?me.error(Le):Ae&&me.complete()}asObservable(){const me=new M.y;return me.source=this,me}}return dt.create=(Ze,me)=>new Dt(Ze,me),dt})();class Dt extends Ve{constructor(Ze,me){super(),this.destination=Ze,this.source=me}next(Ze){var me,ye;null===(ye=null===(me=this.destination)||void 0===me?void 0:me.next)||void 0===ye||ye.call(me,Ze)}error(Ze){var me,ye;null===(ye=null===(me=this.destination)||void 0===me?void 0:me.error)||void 0===ye||ye.call(me,Ze)}complete(){var Ze,me;null===(me=null===(Ze=this.destination)||void 0===Ze?void 0:Ze.complete)||void 0===me||me.call(Ze)}_subscribe(Ze){var me,ye;return null!==(ye=null===(me=this.source)||void 0===me?void 0:me.subscribe(Ze))&&void 0!==ye?ye:fe.Lc}}},930:(jt,Be,V)=>{V.d(Be,{Hp:()=>Zt,Lv:()=>ye});var M=V(576),fe=V(727),De=V(2416),Re=V(7849),Me=V(5032);const Ee=dt("C",void 0,void 0);function dt(Pt,ge,gt){return{kind:Pt,value:ge,error:gt}}var Ze=V(3410),me=V(2806);class ye extends fe.w0{constructor(ge){super(),this.isStopped=!1,ge?(this.destination=ge,(0,fe.Nn)(ge)&&ge.add(this)):this.destination=zn}static create(ge,gt,He){return new Zt(ge,gt,He)}next(ge){this.isStopped?Pn(function Dt(Pt){return dt("N",Pt,void 0)}(ge),this):this._next(ge)}error(ge){this.isStopped?Pn(function Ve(Pt){return dt("E",void 0,Pt)}(ge),this):(this.isStopped=!0,this._error(ge))}complete(){this.isStopped?Pn(Ee,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ge){this.destination.next(ge)}_error(ge){try{this.destination.error(ge)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Le=Function.prototype.bind;function Ae(Pt,ge){return Le.call(Pt,ge)}class Ct{constructor(ge){this.partialObserver=ge}next(ge){const{partialObserver:gt}=this;if(gt.next)try{gt.next(ge)}catch(He){ht(He)}}error(ge){const{partialObserver:gt}=this;if(gt.error)try{gt.error(ge)}catch(He){ht(He)}else ht(ge)}complete(){const{partialObserver:ge}=this;if(ge.complete)try{ge.complete()}catch(gt){ht(gt)}}}class Zt extends ye{constructor(ge,gt,He){let ke;if(super(),(0,M.m)(ge)||!ge)ke={next:ge??void 0,error:gt??void 0,complete:He??void 0};else{let it;this&&De.config.useDeprecatedNextContext?(it=Object.create(ge),it.unsubscribe=()=>this.unsubscribe(),ke={next:ge.next&&Ae(ge.next,it),error:ge.error&&Ae(ge.error,it),complete:ge.complete&&Ae(ge.complete,it)}):ke=ge}this.destination=new Ct(ke)}}function ht(Pt){De.config.useDeprecatedSynchronousErrorHandling?(0,me.O)(Pt):(0,Re.h)(Pt)}function Pn(Pt,ge){const{onStoppedNotification:gt}=De.config;gt&&Ze.z.setTimeout(()=>gt(Pt,ge))}const zn={closed:!0,next:Me.Z,error:function an(Pt){throw Pt},complete:Me.Z}},727:(jt,Be,V)=>{V.d(Be,{Lc:()=>Ee,w0:()=>Me,Nn:()=>Ve});var M=V(576);const De=(0,V(3888).d)(dt=>function(me){dt(this),this.message=me?`${me.length} errors occurred during unsubscription:\n${me.map((ye,Le)=>`${Le+1}) ${ye.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=me});var Re=V(8737);class Me{constructor(Ze){this.initialTeardown=Ze,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ze;if(!this.closed){this.closed=!0;const{_parentage:me}=this;if(me)if(this._parentage=null,Array.isArray(me))for(const Ae of me)Ae.remove(this);else me.remove(this);const{initialTeardown:ye}=this;if((0,M.m)(ye))try{ye()}catch(Ae){Ze=Ae instanceof De?Ae.errors:[Ae]}const{_finalizers:Le}=this;if(Le){this._finalizers=null;for(const Ae of Le)try{Dt(Ae)}catch(Ct){Ze=Ze??[],Ct instanceof De?Ze=[...Ze,...Ct.errors]:Ze.push(Ct)}}if(Ze)throw new De(Ze)}}add(Ze){var me;if(Ze&&Ze!==this)if(this.closed)Dt(Ze);else{if(Ze instanceof Me){if(Ze.closed||Ze._hasParent(this))return;Ze._addParent(this)}(this._finalizers=null!==(me=this._finalizers)&&void 0!==me?me:[]).push(Ze)}}_hasParent(Ze){const{_parentage:me}=this;return me===Ze||Array.isArray(me)&&me.includes(Ze)}_addParent(Ze){const{_parentage:me}=this;this._parentage=Array.isArray(me)?(me.push(Ze),me):me?[me,Ze]:Ze}_removeParent(Ze){const{_parentage:me}=this;me===Ze?this._parentage=null:Array.isArray(me)&&(0,Re.P)(me,Ze)}remove(Ze){const{_finalizers:me}=this;me&&(0,Re.P)(me,Ze),Ze instanceof Me&&Ze._removeParent(this)}}Me.EMPTY=(()=>{const dt=new Me;return dt.closed=!0,dt})();const Ee=Me.EMPTY;function Ve(dt){return dt instanceof Me||dt&&"closed"in dt&&(0,M.m)(dt.remove)&&(0,M.m)(dt.add)&&(0,M.m)(dt.unsubscribe)}function Dt(dt){(0,M.m)(dt)?dt():dt.unsubscribe()}},2416:(jt,Be,V)=>{V.d(Be,{config:()=>M});const M={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},9841:(jt,Be,V)=>{V.d(Be,{a:()=>Ze});var M=V(9751),fe=V(4742),De=V(2076),Re=V(4671),Me=V(3268),Ee=V(3269),Ve=V(1810),Dt=V(5403),dt=V(9672);function Ze(...Le){const Ae=(0,Ee.yG)(Le),Ct=(0,Ee.jO)(Le),{args:Zt,keys:ht}=(0,fe.D)(Le);if(0===Zt.length)return(0,De.D)([],Ae);const an=new M.y(function me(Le,Ae,Ct=Re.y){return Zt=>{ye(Ae,()=>{const{length:ht}=Le,an=new Array(ht);let Pn=ht,zn=ht;for(let Pt=0;Pt<ht;Pt++)ye(Ae,()=>{const ge=(0,De.D)(Le[Pt],Ae);let gt=!1;ge.subscribe((0,Dt.x)(Zt,He=>{an[Pt]=He,gt||(gt=!0,zn--),zn||Zt.next(Ct(an.slice()))},()=>{--Pn||Zt.complete()}))},Zt)},Zt)}}(Zt,Ae,ht?Pn=>(0,Ve.n)(ht,Pn):Re.y));return Ct?an.pipe((0,Me.Z)(Ct)):an}function ye(Le,Ae,Ct){Le?(0,dt.f)(Ct,Le,Ae):Ae()}},7272:(jt,Be,V)=>{V.d(Be,{z:()=>Me});var M=V(8189),De=V(3269),Re=V(2076);function Me(...Ee){return function fe(){return(0,M.J)(1)}()((0,Re.D)(Ee,(0,De.yG)(Ee)))}},515:(jt,Be,V)=>{V.d(Be,{E:()=>fe});const fe=new(V(9751).y)(Me=>Me.complete())},2076:(jt,Be,V)=>{V.d(Be,{D:()=>He});var M=V(8421),fe=V(9672),De=V(4482),Re=V(5403);function Me(ke,it=0){return(0,De.e)((Ut,vt)=>{Ut.subscribe((0,Re.x)(vt,pn=>(0,fe.f)(vt,ke,()=>vt.next(pn),it),()=>(0,fe.f)(vt,ke,()=>vt.complete(),it),pn=>(0,fe.f)(vt,ke,()=>vt.error(pn),it)))})}function Ee(ke,it=0){return(0,De.e)((Ut,vt)=>{vt.add(ke.schedule(()=>Ut.subscribe(vt),it))})}var dt=V(9751),me=V(2202),ye=V(576);function Ae(ke,it){if(!ke)throw new Error("Iterable cannot be null");return new dt.y(Ut=>{(0,fe.f)(Ut,it,()=>{const vt=ke[Symbol.asyncIterator]();(0,fe.f)(Ut,it,()=>{vt.next().then(pn=>{pn.done?Ut.complete():Ut.next(pn.value)})},0,!0)})})}var Ct=V(3670),Zt=V(8239),ht=V(1144),an=V(6495),Pn=V(2206),zn=V(4532),Pt=V(3260);function He(ke,it){return it?function gt(ke,it){if(null!=ke){if((0,Ct.c)(ke))return function Ve(ke,it){return(0,M.Xf)(ke).pipe(Ee(it),Me(it))}(ke,it);if((0,ht.z)(ke))return function Ze(ke,it){return new dt.y(Ut=>{let vt=0;return it.schedule(function(){vt===ke.length?Ut.complete():(Ut.next(ke[vt++]),Ut.closed||this.schedule())})})}(ke,it);if((0,Zt.t)(ke))return function Dt(ke,it){return(0,M.Xf)(ke).pipe(Ee(it),Me(it))}(ke,it);if((0,Pn.D)(ke))return Ae(ke,it);if((0,an.T)(ke))return function Le(ke,it){return new dt.y(Ut=>{let vt;return(0,fe.f)(Ut,it,()=>{vt=ke[me.h](),(0,fe.f)(Ut,it,()=>{let pn,kn;try{({value:pn,done:kn}=vt.next())}catch(Ti){return void Ut.error(Ti)}kn?Ut.complete():Ut.next(pn)},0,!0)}),()=>(0,ye.m)(vt?.return)&&vt.return()})}(ke,it);if((0,Pt.L)(ke))return function ge(ke,it){return Ae((0,Pt.Q)(ke),it)}(ke,it)}throw(0,zn.z)(ke)}(ke,it):(0,M.Xf)(ke)}},8421:(jt,Be,V)=>{V.d(Be,{Xf:()=>Le});var M=V(655),fe=V(1144),De=V(8239),Re=V(9751),Me=V(3670),Ee=V(2206),Ve=V(4532),Dt=V(6495),dt=V(3260),Ze=V(576),me=V(7849),ye=V(8822);function Le(Pt){if(Pt instanceof Re.y)return Pt;if(null!=Pt){if((0,Me.c)(Pt))return function Ae(Pt){return new Re.y(ge=>{const gt=Pt[ye.L]();if((0,Ze.m)(gt.subscribe))return gt.subscribe(ge);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Pt);if((0,fe.z)(Pt))return function Ct(Pt){return new Re.y(ge=>{for(let gt=0;gt<Pt.length&&!ge.closed;gt++)ge.next(Pt[gt]);ge.complete()})}(Pt);if((0,De.t)(Pt))return function Zt(Pt){return new Re.y(ge=>{Pt.then(gt=>{ge.closed||(ge.next(gt),ge.complete())},gt=>ge.error(gt)).then(null,me.h)})}(Pt);if((0,Ee.D)(Pt))return an(Pt);if((0,Dt.T)(Pt))return function ht(Pt){return new Re.y(ge=>{for(const gt of Pt)if(ge.next(gt),ge.closed)return;ge.complete()})}(Pt);if((0,dt.L)(Pt))return function Pn(Pt){return an((0,dt.Q)(Pt))}(Pt)}throw(0,Ve.z)(Pt)}function an(Pt){return new Re.y(ge=>{(function zn(Pt,ge){var gt,He,ke,it;return(0,M.mG)(this,void 0,void 0,function*(){try{for(gt=(0,M.KL)(Pt);!(He=yield gt.next()).done;)if(ge.next(He.value),ge.closed)return}catch(Ut){ke={error:Ut}}finally{try{He&&!He.done&&(it=gt.return)&&(yield it.call(gt))}finally{if(ke)throw ke.error}}ge.complete()})})(Pt,ge).catch(gt=>ge.error(gt))})}},9646:(jt,Be,V)=>{V.d(Be,{of:()=>De});var M=V(3269),fe=V(2076);function De(...Re){const Me=(0,M.yG)(Re);return(0,fe.D)(Re,Me)}},5403:(jt,Be,V)=>{V.d(Be,{x:()=>fe});var M=V(930);function fe(Re,Me,Ee,Ve,Dt){return new De(Re,Me,Ee,Ve,Dt)}class De extends M.Lv{constructor(Me,Ee,Ve,Dt,dt,Ze){super(Me),this.onFinalize=dt,this.shouldUnsubscribe=Ze,this._next=Ee?function(me){try{Ee(me)}catch(ye){Me.error(ye)}}:super._next,this._error=Dt?function(me){try{Dt(me)}catch(ye){Me.error(ye)}finally{this.unsubscribe()}}:super._error,this._complete=Ve?function(){try{Ve()}catch(me){Me.error(me)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Me;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Ee}=this;super.unsubscribe(),!Ee&&(null===(Me=this.onFinalize)||void 0===Me||Me.call(this))}}}},4351:(jt,Be,V)=>{V.d(Be,{b:()=>De});var M=V(5577),fe=V(576);function De(Re,Me){return(0,fe.m)(Me)?(0,M.z)(Re,Me,1):(0,M.z)(Re,1)}},6590:(jt,Be,V)=>{V.d(Be,{d:()=>De});var M=V(4482),fe=V(5403);function De(Re){return(0,M.e)((Me,Ee)=>{let Ve=!1;Me.subscribe((0,fe.x)(Ee,Dt=>{Ve=!0,Ee.next(Dt)},()=>{Ve||Ee.next(Re),Ee.complete()}))})}},9300:(jt,Be,V)=>{V.d(Be,{h:()=>De});var M=V(4482),fe=V(5403);function De(Re,Me){return(0,M.e)((Ee,Ve)=>{let Dt=0;Ee.subscribe((0,fe.x)(Ve,dt=>Re.call(Me,dt,Dt++)&&Ve.next(dt)))})}},8746:(jt,Be,V)=>{V.d(Be,{x:()=>fe});var M=V(4482);function fe(De){return(0,M.e)((Re,Me)=>{try{Re.subscribe(Me)}finally{Me.add(De)}})}},590:(jt,Be,V)=>{V.d(Be,{P:()=>Ve});var M=V(6805),fe=V(9300),De=V(5698),Re=V(6590),Me=V(8068),Ee=V(4671);function Ve(Dt,dt){const Ze=arguments.length>=2;return me=>me.pipe(Dt?(0,fe.h)((ye,Le)=>Dt(ye,Le,me)):Ee.y,(0,De.q)(1),Ze?(0,Re.d)(dt):(0,Me.T)(()=>new M.K))}},4004:(jt,Be,V)=>{V.d(Be,{U:()=>De});var M=V(4482),fe=V(5403);function De(Re,Me){return(0,M.e)((Ee,Ve)=>{let Dt=0;Ee.subscribe((0,fe.x)(Ve,dt=>{Ve.next(Re.call(Me,dt,Dt++))}))})}},9718:(jt,Be,V)=>{V.d(Be,{h:()=>fe});var M=V(4004);function fe(De){return(0,M.U)(()=>De)}},8189:(jt,Be,V)=>{V.d(Be,{J:()=>De});var M=V(5577),fe=V(4671);function De(Re=1/0){return(0,M.z)(fe.y,Re)}},5577:(jt,Be,V)=>{V.d(Be,{z:()=>Dt});var M=V(4004),fe=V(8421),De=V(4482),Re=V(9672),Me=V(5403),Ve=V(576);function Dt(dt,Ze,me=1/0){return(0,Ve.m)(Ze)?Dt((ye,Le)=>(0,M.U)((Ae,Ct)=>Ze(ye,Ae,Le,Ct))((0,fe.Xf)(dt(ye,Le))),me):("number"==typeof Ze&&(me=Ze),(0,De.e)((ye,Le)=>function Ee(dt,Ze,me,ye,Le,Ae,Ct,Zt){const ht=[];let an=0,Pn=0,zn=!1;const Pt=()=>{zn&&!ht.length&&!an&&Ze.complete()},ge=He=>an<ye?gt(He):ht.push(He),gt=He=>{Ae&&Ze.next(He),an++;let ke=!1;(0,fe.Xf)(me(He,Pn++)).subscribe((0,Me.x)(Ze,it=>{Le?.(it),Ae?ge(it):Ze.next(it)},()=>{ke=!0},void 0,()=>{if(ke)try{for(an--;ht.length&&an<ye;){const it=ht.shift();Ct?(0,Re.f)(Ze,Ct,()=>gt(it)):gt(it)}Pt()}catch(it){Ze.error(it)}}))};return dt.subscribe((0,Me.x)(Ze,ge,()=>{zn=!0,Pt()})),()=>{Zt?.()}}(ye,Le,dt,me)))}},3099:(jt,Be,V)=>{V.d(Be,{B:()=>Me});var M=V(8421),fe=V(7579),De=V(930),Re=V(4482);function Me(Ve={}){const{connector:Dt=(()=>new fe.x),resetOnError:dt=!0,resetOnComplete:Ze=!0,resetOnRefCountZero:me=!0}=Ve;return ye=>{let Le,Ae,Ct,Zt=0,ht=!1,an=!1;const Pn=()=>{Ae?.unsubscribe(),Ae=void 0},zn=()=>{Pn(),Le=Ct=void 0,ht=an=!1},Pt=()=>{const ge=Le;zn(),ge?.unsubscribe()};return(0,Re.e)((ge,gt)=>{Zt++,!an&&!ht&&Pn();const He=Ct=Ct??Dt();gt.add(()=>{Zt--,0===Zt&&!an&&!ht&&(Ae=Ee(Pt,me))}),He.subscribe(gt),!Le&&Zt>0&&(Le=new De.Hp({next:ke=>He.next(ke),error:ke=>{an=!0,Pn(),Ae=Ee(zn,dt,ke),He.error(ke)},complete:()=>{ht=!0,Pn(),Ae=Ee(zn,Ze),He.complete()}}),(0,M.Xf)(ge).subscribe(Le))})(ye)}}function Ee(Ve,Dt,...dt){if(!0===Dt)return void Ve();if(!1===Dt)return;const Ze=new De.Hp({next:()=>{Ze.unsubscribe(),Ve()}});return(0,M.Xf)(Dt(...dt)).subscribe(Ze)}},8675:(jt,Be,V)=>{V.d(Be,{O:()=>Re});var M=V(7272),fe=V(3269),De=V(4482);function Re(...Me){const Ee=(0,fe.yG)(Me);return(0,De.e)((Ve,Dt)=>{(Ee?(0,M.z)(Me,Ve,Ee):(0,M.z)(Me,Ve)).subscribe(Dt)})}},3900:(jt,Be,V)=>{V.d(Be,{w:()=>Re});var M=V(8421),fe=V(4482),De=V(5403);function Re(Me,Ee){return(0,fe.e)((Ve,Dt)=>{let dt=null,Ze=0,me=!1;const ye=()=>me&&!dt&&Dt.complete();Ve.subscribe((0,De.x)(Dt,Le=>{dt?.unsubscribe();let Ae=0;const Ct=Ze++;(0,M.Xf)(Me(Le,Ct)).subscribe(dt=(0,De.x)(Dt,Zt=>Dt.next(Ee?Ee(Le,Zt,Ct,Ae++):Zt),()=>{dt=null,ye()}))},()=>{me=!0,ye()}))})}},5698:(jt,Be,V)=>{V.d(Be,{q:()=>Re});var M=V(515),fe=V(4482),De=V(5403);function Re(Me){return Me<=0?()=>M.E:(0,fe.e)((Ee,Ve)=>{let Dt=0;Ee.subscribe((0,De.x)(Ve,dt=>{++Dt<=Me&&(Ve.next(dt),Me<=Dt&&Ve.complete())}))})}},2722:(jt,Be,V)=>{V.d(Be,{R:()=>Me});var M=V(4482),fe=V(5403),De=V(8421),Re=V(5032);function Me(Ee){return(0,M.e)((Ve,Dt)=>{(0,De.Xf)(Ee).subscribe((0,fe.x)(Dt,()=>Dt.complete(),Re.Z)),!Dt.closed&&Ve.subscribe(Dt)})}},8505:(jt,Be,V)=>{V.d(Be,{b:()=>Me});var M=V(576),fe=V(4482),De=V(5403),Re=V(4671);function Me(Ee,Ve,Dt){const dt=(0,M.m)(Ee)||Ve||Dt?{next:Ee,error:Ve,complete:Dt}:Ee;return dt?(0,fe.e)((Ze,me)=>{var ye;null===(ye=dt.subscribe)||void 0===ye||ye.call(dt);let Le=!0;Ze.subscribe((0,De.x)(me,Ae=>{var Ct;null===(Ct=dt.next)||void 0===Ct||Ct.call(dt,Ae),me.next(Ae)},()=>{var Ae;Le=!1,null===(Ae=dt.complete)||void 0===Ae||Ae.call(dt),me.complete()},Ae=>{var Ct;Le=!1,null===(Ct=dt.error)||void 0===Ct||Ct.call(dt,Ae),me.error(Ae)},()=>{var Ae,Ct;Le&&(null===(Ae=dt.unsubscribe)||void 0===Ae||Ae.call(dt)),null===(Ct=dt.finalize)||void 0===Ct||Ct.call(dt)}))}):Re.y}},8068:(jt,Be,V)=>{V.d(Be,{T:()=>Re});var M=V(6805),fe=V(4482),De=V(5403);function Re(Ee=Me){return(0,fe.e)((Ve,Dt)=>{let dt=!1;Ve.subscribe((0,De.x)(Dt,Ze=>{dt=!0,Dt.next(Ze)},()=>dt?Dt.complete():Dt.error(Ee())))})}function Me(){return new M.K}},1566:(jt,Be,V)=>{V.d(Be,{P:()=>Ze,z:()=>dt});var M=V(727);class fe extends M.w0{constructor(ye,Le){super()}schedule(ye,Le=0){return this}}const De={setInterval(me,ye,...Le){const{delegate:Ae}=De;return Ae?.setInterval?Ae.setInterval(me,ye,...Le):setInterval(me,ye,...Le)},clearInterval(me){const{delegate:ye}=De;return(ye?.clearInterval||clearInterval)(me)},delegate:void 0};var Re=V(8737);const Ee={now:()=>(Ee.delegate||Date).now(),delegate:void 0};class Ve{constructor(ye,Le=Ve.now){this.schedulerActionCtor=ye,this.now=Le}schedule(ye,Le=0,Ae){return new this.schedulerActionCtor(this,ye).schedule(Ae,Le)}}Ve.now=Ee.now;const dt=new class Dt extends Ve{constructor(ye,Le=Ve.now){super(ye,Le),this.actions=[],this._active=!1}flush(ye){const{actions:Le}=this;if(this._active)return void Le.push(ye);let Ae;this._active=!0;do{if(Ae=ye.execute(ye.state,ye.delay))break}while(ye=Le.shift());if(this._active=!1,Ae){for(;ye=Le.shift();)ye.unsubscribe();throw Ae}}}(class Me extends fe{constructor(ye,Le){super(ye,Le),this.scheduler=ye,this.work=Le,this.pending=!1}schedule(ye,Le=0){var Ae;if(this.closed)return this;this.state=ye;const Ct=this.id,Zt=this.scheduler;return null!=Ct&&(this.id=this.recycleAsyncId(Zt,Ct,Le)),this.pending=!0,this.delay=Le,this.id=null!==(Ae=this.id)&&void 0!==Ae?Ae:this.requestAsyncId(Zt,this.id,Le),this}requestAsyncId(ye,Le,Ae=0){return De.setInterval(ye.flush.bind(ye,this),Ae)}recycleAsyncId(ye,Le,Ae=0){if(null!=Ae&&this.delay===Ae&&!1===this.pending)return Le;null!=Le&&De.clearInterval(Le)}execute(ye,Le){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Ae=this._execute(ye,Le);if(Ae)return Ae;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(ye,Le){let Ct,Ae=!1;try{this.work(ye)}catch(Zt){Ae=!0,Ct=Zt||new Error("Scheduled action threw falsy error")}if(Ae)return this.unsubscribe(),Ct}unsubscribe(){if(!this.closed){const{id:ye,scheduler:Le}=this,{actions:Ae}=Le;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Re.P)(Ae,this),null!=ye&&(this.id=this.recycleAsyncId(Le,ye,null)),this.delay=null,super.unsubscribe()}}}),Ze=dt},3410:(jt,Be,V)=>{V.d(Be,{z:()=>M});const M={setTimeout(fe,De,...Re){const{delegate:Me}=M;return Me?.setTimeout?Me.setTimeout(fe,De,...Re):setTimeout(fe,De,...Re)},clearTimeout(fe){const{delegate:De}=M;return(De?.clearTimeout||clearTimeout)(fe)},delegate:void 0}},2202:(jt,Be,V)=>{V.d(Be,{h:()=>fe});const fe=function M(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(jt,Be,V)=>{V.d(Be,{L:()=>M});const M="function"==typeof Symbol&&Symbol.observable||"@@observable"},6805:(jt,Be,V)=>{V.d(Be,{K:()=>fe});const fe=(0,V(3888).d)(De=>function(){De(this),this.name="EmptyError",this.message="no elements in sequence"})},3269:(jt,Be,V)=>{V.d(Be,{_6:()=>Ee,jO:()=>Re,yG:()=>Me});var M=V(576),fe=V(3532);function De(Ve){return Ve[Ve.length-1]}function Re(Ve){return(0,M.m)(De(Ve))?Ve.pop():void 0}function Me(Ve){return(0,fe.K)(De(Ve))?Ve.pop():void 0}function Ee(Ve,Dt){return"number"==typeof De(Ve)?Ve.pop():Dt}},4742:(jt,Be,V)=>{V.d(Be,{D:()=>Me});const{isArray:M}=Array,{getPrototypeOf:fe,prototype:De,keys:Re}=Object;function Me(Ve){if(1===Ve.length){const Dt=Ve[0];if(M(Dt))return{args:Dt,keys:null};if(function Ee(Ve){return Ve&&"object"==typeof Ve&&fe(Ve)===De}(Dt)){const dt=Re(Dt);return{args:dt.map(Ze=>Dt[Ze]),keys:dt}}}return{args:Ve,keys:null}}},8737:(jt,Be,V)=>{function M(fe,De){if(fe){const Re=fe.indexOf(De);0<=Re&&fe.splice(Re,1)}}V.d(Be,{P:()=>M})},3888:(jt,Be,V)=>{function M(fe){const Re=fe(Me=>{Error.call(Me),Me.stack=(new Error).stack});return Re.prototype=Object.create(Error.prototype),Re.prototype.constructor=Re,Re}V.d(Be,{d:()=>M})},1810:(jt,Be,V)=>{function M(fe,De){return fe.reduce((Re,Me,Ee)=>(Re[Me]=De[Ee],Re),{})}V.d(Be,{n:()=>M})},2806:(jt,Be,V)=>{V.d(Be,{O:()=>Re,x:()=>De});var M=V(2416);let fe=null;function De(Me){if(M.config.useDeprecatedSynchronousErrorHandling){const Ee=!fe;if(Ee&&(fe={errorThrown:!1,error:null}),Me(),Ee){const{errorThrown:Ve,error:Dt}=fe;if(fe=null,Ve)throw Dt}}else Me()}function Re(Me){M.config.useDeprecatedSynchronousErrorHandling&&fe&&(fe.errorThrown=!0,fe.error=Me)}},9672:(jt,Be,V)=>{function M(fe,De,Re,Me=0,Ee=!1){const Ve=De.schedule(function(){Re(),Ee?fe.add(this.schedule(null,Me)):this.unsubscribe()},Me);if(fe.add(Ve),!Ee)return Ve}V.d(Be,{f:()=>M})},4671:(jt,Be,V)=>{function M(fe){return fe}V.d(Be,{y:()=>M})},1144:(jt,Be,V)=>{V.d(Be,{z:()=>M});const M=fe=>fe&&"number"==typeof fe.length&&"function"!=typeof fe},2206:(jt,Be,V)=>{V.d(Be,{D:()=>fe});var M=V(576);function fe(De){return Symbol.asyncIterator&&(0,M.m)(De?.[Symbol.asyncIterator])}},576:(jt,Be,V)=>{function M(fe){return"function"==typeof fe}V.d(Be,{m:()=>M})},3670:(jt,Be,V)=>{V.d(Be,{c:()=>De});var M=V(8822),fe=V(576);function De(Re){return(0,fe.m)(Re[M.L])}},6495:(jt,Be,V)=>{V.d(Be,{T:()=>De});var M=V(2202),fe=V(576);function De(Re){return(0,fe.m)(Re?.[M.h])}},8239:(jt,Be,V)=>{V.d(Be,{t:()=>fe});var M=V(576);function fe(De){return(0,M.m)(De?.then)}},3260:(jt,Be,V)=>{V.d(Be,{L:()=>Re,Q:()=>De});var M=V(655),fe=V(576);function De(Me){return(0,M.FC)(this,arguments,function*(){const Ve=Me.getReader();try{for(;;){const{value:Dt,done:dt}=yield(0,M.qq)(Ve.read());if(dt)return yield(0,M.qq)(void 0);yield yield(0,M.qq)(Dt)}}finally{Ve.releaseLock()}})}function Re(Me){return(0,fe.m)(Me?.getReader)}},3532:(jt,Be,V)=>{V.d(Be,{K:()=>fe});var M=V(576);function fe(De){return De&&(0,M.m)(De.schedule)}},4482:(jt,Be,V)=>{V.d(Be,{A:()=>fe,e:()=>De});var M=V(576);function fe(Re){return(0,M.m)(Re?.lift)}function De(Re){return Me=>{if(fe(Me))return Me.lift(function(Ee){try{return Re(Ee,this)}catch(Ve){this.error(Ve)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(jt,Be,V)=>{V.d(Be,{Z:()=>Re});var M=V(4004);const{isArray:fe}=Array;function Re(Me){return(0,M.U)(Ee=>function De(Me,Ee){return fe(Ee)?Me(...Ee):Me(Ee)}(Me,Ee))}},5032:(jt,Be,V)=>{function M(){}V.d(Be,{Z:()=>M})},9635:(jt,Be,V)=>{V.d(Be,{U:()=>De,z:()=>fe});var M=V(4671);function fe(...Re){return De(Re)}function De(Re){return 0===Re.length?M.y:1===Re.length?Re[0]:function(Ee){return Re.reduce((Ve,Dt)=>Dt(Ve),Ee)}}},7849:(jt,Be,V)=>{V.d(Be,{h:()=>De});var M=V(2416),fe=V(3410);function De(Re){fe.z.setTimeout(()=>{const{onUnhandledError:Me}=M.config;if(!Me)throw Re;Me(Re)})}},4532:(jt,Be,V)=>{function M(fe){return new TypeError(`You provided ${null!==fe&&"object"==typeof fe?"an invalid object":`'${fe}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}V.d(Be,{z:()=>M})},655:(jt,Be,V)=>{function ye(be,Oe,Ue,rt){return new(Ue||(Ue=Promise))(function(wt,tn){function Bn(gi){try{nn(rt.next(gi))}catch(Xn){tn(Xn)}}function ii(gi){try{nn(rt.throw(gi))}catch(Xn){tn(Xn)}}function nn(gi){gi.done?wt(gi.value):function Rt(wt){return wt instanceof Ue?wt:new Ue(function(tn){tn(wt)})}(gi.value).then(Bn,ii)}nn((rt=rt.apply(be,Oe||[])).next())})}function Pt(be){return this instanceof Pt?(this.v=be,this):new Pt(be)}function ge(be,Oe,Ue){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Rt,rt=Ue.apply(be,Oe||[]),wt=[];return Rt={},tn("next"),tn("throw"),tn("return"),Rt[Symbol.asyncIterator]=function(){return this},Rt;function tn(yt){rt[yt]&&(Rt[yt]=function(yi){return new Promise(function(Nr,ir){wt.push([yt,yi,Nr,ir])>1||Bn(yt,yi)})})}function Bn(yt,yi){try{!function ii(yt){yt.value instanceof Pt?Promise.resolve(yt.value.v).then(nn,gi):Xn(wt[0][2],yt)}(rt[yt](yi))}catch(Nr){Xn(wt[0][3],Nr)}}function nn(yt){Bn("next",yt)}function gi(yt){Bn("throw",yt)}function Xn(yt,yi){yt(yi),wt.shift(),wt.length&&Bn(wt[0][0],wt[0][1])}}function He(be){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ue,Oe=be[Symbol.asyncIterator];return Oe?Oe.call(be):(be=function Zt(be){var Oe="function"==typeof Symbol&&Symbol.iterator,Ue=Oe&&be[Oe],rt=0;if(Ue)return Ue.call(be);if(be&&"number"==typeof be.length)return{next:function(){return be&&rt>=be.length&&(be=void 0),{value:be&&be[rt++],done:!be}}};throw new TypeError(Oe?"Object is not iterable.":"Symbol.iterator is not defined.")}(be),Ue={},rt("next"),rt("throw"),rt("return"),Ue[Symbol.asyncIterator]=function(){return this},Ue);function rt(wt){Ue[wt]=be[wt]&&function(tn){return new Promise(function(Bn,ii){!function Rt(wt,tn,Bn,ii){Promise.resolve(ii).then(function(nn){wt({value:nn,done:Bn})},tn)}(Bn,ii,(tn=be[wt](tn)).done,tn.value)})}}}V.d(Be,{FC:()=>ge,KL:()=>He,mG:()=>ye,qq:()=>Pt})},2680:(jt,Be,V)=>{V.d(Be,{Yg:()=>jr,xu:()=>Xn});var M=V(2504);function Me(Xe){return Array.isArray(Xe)?Xe:[Xe]}var dt=V(7579),Ze=V(9841),me=V(7272),ye=V(9751),Le=V(5698),Ae=V(9300),Zt=V(1566),ht=V(4482),an=V(5403),zn=V(4004),Pt=V(8675),ge=V(2722),gt=V(4755);let He;try{He=typeof Intl<"u"&&Intl.v8BreakIterator}catch{He=!1}let ke=(()=>{class Xe{constructor(Mn){this._platformId=Mn,this.isBrowser=this._platformId?(0,gt.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!He)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return Xe.\u0275fac=function(Mn){return new(Mn||Xe)(M.LFG(M.Lbi))},Xe.\u0275prov=M.Yz7({token:Xe,factory:Xe.\u0275fac,providedIn:"root"}),Xe})(),Xn=(()=>{class Xe{}return Xe.\u0275fac=function(Mn){return new(Mn||Xe)},Xe.\u0275mod=M.oAB({type:Xe}),Xe.\u0275inj=M.cJS({}),Xe})();const yt=new Set;let yi,Nr=(()=>{class Xe{constructor(Mn,fi){this._platform=Mn,this._nonce=fi,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):ri}matchMedia(Mn){return(this._platform.WEBKIT||this._platform.BLINK)&&function ir(Xe,en){if(!yt.has(Xe))try{yi||(yi=document.createElement("style"),en&&(yi.nonce=en),yi.setAttribute("type","text/css"),document.head.appendChild(yi)),yi.sheet&&(yi.sheet.insertRule(`@media ${Xe} {body{ }}`,0),yt.add(Xe))}catch(Mn){console.error(Mn)}}(Mn,this._nonce),this._matchMedia(Mn)}}return Xe.\u0275fac=function(Mn){return new(Mn||Xe)(M.LFG(ke),M.LFG(M.Ojb,8))},Xe.\u0275prov=M.Yz7({token:Xe,factory:Xe.\u0275fac,providedIn:"root"}),Xe})();function ri(Xe){return{matches:"all"===Xe||""===Xe,media:Xe,addListener:()=>{},removeListener:()=>{}}}let jr=(()=>{class Xe{constructor(Mn,fi){this._mediaMatcher=Mn,this._zone=fi,this._queries=new Map,this._destroySubject=new dt.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(Mn){return Ji(Me(Mn)).some(_i=>this._registerQuery(_i).mql.matches)}observe(Mn){const _i=Ji(Me(Mn)).map(Ci=>this._registerQuery(Ci).observable);let pi=(0,Ze.a)(_i);return pi=(0,me.z)(pi.pipe((0,Le.q)(1)),pi.pipe(function Ct(Xe){return(0,Ae.h)((en,Mn)=>Xe<=Mn)}(1),function Pn(Xe,en=Zt.z){return(0,ht.e)((Mn,fi)=>{let _i=null,pi=null,Ci=null;const Vn=()=>{if(_i){_i.unsubscribe(),_i=null;const Kt=pi;pi=null,fi.next(Kt)}};function st(){const Kt=Ci+Xe,$i=en.now();if($i<Kt)return _i=this.schedule(void 0,Kt-$i),void fi.add(_i);Vn()}Mn.subscribe((0,an.x)(fi,Kt=>{pi=Kt,Ci=en.now(),_i||(_i=en.schedule(st,Xe),fi.add(_i))},()=>{Vn(),fi.complete()},void 0,()=>{pi=_i=null}))})}(0))),pi.pipe((0,zn.U)(Ci=>{const Vn={matches:!1,breakpoints:{}};return Ci.forEach(({matches:st,query:Kt})=>{Vn.matches=Vn.matches||st,Vn.breakpoints[Kt]=st}),Vn}))}_registerQuery(Mn){if(this._queries.has(Mn))return this._queries.get(Mn);const fi=this._mediaMatcher.matchMedia(Mn),pi={observable:new ye.y(Ci=>{const Vn=st=>this._zone.run(()=>Ci.next(st));return fi.addListener(Vn),()=>{fi.removeListener(Vn)}}).pipe((0,Pt.O)(fi),(0,zn.U)(({matches:Ci})=>({query:Mn,matches:Ci})),(0,ge.R)(this._destroySubject)),mql:fi};return this._queries.set(Mn,pi),pi}}return Xe.\u0275fac=function(Mn){return new(Mn||Xe)(M.LFG(Nr),M.LFG(M.R0b))},Xe.\u0275prov=M.Yz7({token:Xe,factory:Xe.\u0275fac,providedIn:"root"}),Xe})();function Ji(Xe){return Xe.map(en=>en.split(",")).reduce((en,Mn)=>en.concat(Mn)).map(en=>en.trim())}},4755:(jt,Be,V)=>{V.d(Be,{Do:()=>Zt,EM:()=>zc,HT:()=>Re,JF:()=>rl,K0:()=>Ee,Mx:()=>us,NF:()=>Gs,O5:()=>Bs,OU:()=>Yi,Ov:()=>or,PM:()=>ra,S$:()=>Le,V_:()=>Dt,Ye:()=>ht,Zd:()=>Go,b0:()=>Ct,bD:()=>er,ez:()=>gn,q:()=>De,sg:()=>fo,w_:()=>Me});var M=V(2504);let fe=null;function De(){return fe}function Re(w){fe||(fe=w)}class Me{}const Ee=new M.OlP("DocumentToken");let Ve=(()=>{class w{historyGo(A){throw new Error("Not implemented")}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275prov=M.Yz7({token:w,factory:function(){return(0,M.f3M)(dt)},providedIn:"platform"}),w})();const Dt=new M.OlP("Location Initialized");let dt=(()=>{class w extends Ve{constructor(){super(),this._doc=(0,M.f3M)(Ee),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return De().getBaseHref(this._doc)}onPopState(A){const k=De().getGlobalEventTarget(this._doc,"window");return k.addEventListener("popstate",A,!1),()=>k.removeEventListener("popstate",A)}onHashChange(A){const k=De().getGlobalEventTarget(this._doc,"window");return k.addEventListener("hashchange",A,!1),()=>k.removeEventListener("hashchange",A)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(A){this._location.pathname=A}pushState(A,k,Y){this._history.pushState(A,k,Y)}replaceState(A,k,Y){this._history.replaceState(A,k,Y)}forward(){this._history.forward()}back(){this._history.back()}historyGo(A=0){this._history.go(A)}getState(){return this._history.state}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275prov=M.Yz7({token:w,factory:function(){return new w},providedIn:"platform"}),w})();function Ze(w,F){if(0==w.length)return F;if(0==F.length)return w;let A=0;return w.endsWith("/")&&A++,F.startsWith("/")&&A++,2==A?w+F.substring(1):1==A?w+F:w+"/"+F}function me(w){const F=w.match(/#|\?|$/),A=F&&F.index||w.length;return w.slice(0,A-("/"===w[A-1]?1:0))+w.slice(A)}function ye(w){return w&&"?"!==w[0]?"?"+w:w}let Le=(()=>{class w{historyGo(A){throw new Error("Not implemented")}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275prov=M.Yz7({token:w,factory:function(){return(0,M.f3M)(Ct)},providedIn:"root"}),w})();const Ae=new M.OlP("appBaseHref");let Ct=(()=>{class w extends Le{constructor(A,k){super(),this._platformLocation=A,this._removeListenerFns=[],this._baseHref=k??this._platformLocation.getBaseHrefFromDOM()??(0,M.f3M)(Ee).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(A){this._removeListenerFns.push(this._platformLocation.onPopState(A),this._platformLocation.onHashChange(A))}getBaseHref(){return this._baseHref}prepareExternalUrl(A){return Ze(this._baseHref,A)}path(A=!1){const k=this._platformLocation.pathname+ye(this._platformLocation.search),Y=this._platformLocation.hash;return Y&&A?`${k}${Y}`:k}pushState(A,k,Y,ve){const Te=this.prepareExternalUrl(Y+ye(ve));this._platformLocation.pushState(A,k,Te)}replaceState(A,k,Y,ve){const Te=this.prepareExternalUrl(Y+ye(ve));this._platformLocation.replaceState(A,k,Te)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(A=0){this._platformLocation.historyGo?.(A)}}return w.\u0275fac=function(A){return new(A||w)(M.LFG(Ve),M.LFG(Ae,8))},w.\u0275prov=M.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Zt=(()=>{class w extends Le{constructor(A,k){super(),this._platformLocation=A,this._baseHref="",this._removeListenerFns=[],null!=k&&(this._baseHref=k)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(A){this._removeListenerFns.push(this._platformLocation.onPopState(A),this._platformLocation.onHashChange(A))}getBaseHref(){return this._baseHref}path(A=!1){let k=this._platformLocation.hash;return null==k&&(k="#"),k.length>0?k.substring(1):k}prepareExternalUrl(A){const k=Ze(this._baseHref,A);return k.length>0?"#"+k:k}pushState(A,k,Y,ve){let Te=this.prepareExternalUrl(Y+ye(ve));0==Te.length&&(Te=this._platformLocation.pathname),this._platformLocation.pushState(A,k,Te)}replaceState(A,k,Y,ve){let Te=this.prepareExternalUrl(Y+ye(ve));0==Te.length&&(Te=this._platformLocation.pathname),this._platformLocation.replaceState(A,k,Te)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(A=0){this._platformLocation.historyGo?.(A)}}return w.\u0275fac=function(A){return new(A||w)(M.LFG(Ve),M.LFG(Ae,8))},w.\u0275prov=M.Yz7({token:w,factory:w.\u0275fac}),w})(),ht=(()=>{class w{constructor(A){this._subject=new M.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=A;const k=this._locationStrategy.getBaseHref();this._basePath=function Pt(w){if(new RegExp("^(https?:)?//").test(w)){const[,A]=w.split(/\/\/[^\/]+/);return A}return w}(me(zn(k))),this._locationStrategy.onPopState(Y=>{this._subject.emit({url:this.path(!0),pop:!0,state:Y.state,type:Y.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(A=!1){return this.normalize(this._locationStrategy.path(A))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(A,k=""){return this.path()==this.normalize(A+ye(k))}normalize(A){return w.stripTrailingSlash(function Pn(w,F){if(!w||!F.startsWith(w))return F;const A=F.substring(w.length);return""===A||["/",";","?","#"].includes(A[0])?A:F}(this._basePath,zn(A)))}prepareExternalUrl(A){return A&&"/"!==A[0]&&(A="/"+A),this._locationStrategy.prepareExternalUrl(A)}go(A,k="",Y=null){this._locationStrategy.pushState(Y,"",A,k),this._notifyUrlChangeListeners(this.prepareExternalUrl(A+ye(k)),Y)}replaceState(A,k="",Y=null){this._locationStrategy.replaceState(Y,"",A,k),this._notifyUrlChangeListeners(this.prepareExternalUrl(A+ye(k)),Y)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(A=0){this._locationStrategy.historyGo?.(A)}onUrlChange(A){return this._urlChangeListeners.push(A),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(k=>{this._notifyUrlChangeListeners(k.url,k.state)})),()=>{const k=this._urlChangeListeners.indexOf(A);this._urlChangeListeners.splice(k,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(A="",k){this._urlChangeListeners.forEach(Y=>Y(A,k))}subscribe(A,k,Y){return this._subject.subscribe({next:A,error:k,complete:Y})}}return w.normalizeQueryParams=ye,w.joinWithSlash=Ze,w.stripTrailingSlash=me,w.\u0275fac=function(A){return new(A||w)(M.LFG(Le))},w.\u0275prov=M.Yz7({token:w,factory:function(){return function an(){return new ht((0,M.LFG)(Le))}()},providedIn:"root"}),w})();function zn(w){return w.replace(/\/index.html$/,"")}function us(w,F){F=encodeURIComponent(F);for(const A of w.split(";")){const k=A.indexOf("="),[Y,ve]=-1==k?[A,""]:[A.slice(0,k),A.slice(k+1)];if(Y.trim()===F)return decodeURIComponent(ve)}return null}class Ca{constructor(F,A,k,Y){this.$implicit=F,this.ngForOf=A,this.index=k,this.count=Y}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let fo=(()=>{class w{set ngForOf(A){this._ngForOf=A,this._ngForOfDirty=!0}set ngForTrackBy(A){this._trackByFn=A}get ngForTrackBy(){return this._trackByFn}constructor(A,k,Y){this._viewContainer=A,this._template=k,this._differs=Y,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(A){A&&(this._template=A)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const A=this._ngForOf;!this._differ&&A&&(this._differ=this._differs.find(A).create(this.ngForTrackBy))}if(this._differ){const A=this._differ.diff(this._ngForOf);A&&this._applyChanges(A)}}_applyChanges(A){const k=this._viewContainer;A.forEachOperation((Y,ve,Te)=>{if(null==Y.previousIndex)k.createEmbeddedView(this._template,new Ca(Y.item,this._ngForOf,-1,-1),null===Te?void 0:Te);else if(null==Te)k.remove(null===ve?void 0:ve);else if(null!==ve){const Wt=k.get(ve);k.move(Wt,Te),ds(Wt,Y)}});for(let Y=0,ve=k.length;Y<ve;Y++){const Wt=k.get(Y).context;Wt.index=Y,Wt.count=ve,Wt.ngForOf=this._ngForOf}A.forEachIdentityChange(Y=>{ds(k.get(Y.currentIndex),Y)})}static ngTemplateContextGuard(A,k){return!0}}return w.\u0275fac=function(A){return new(A||w)(M.Y36(M.s_b),M.Y36(M.Rgc),M.Y36(M.ZZ4))},w.\u0275dir=M.lG2({type:w,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),w})();function ds(w,F){w.context.$implicit=F.item}let Bs=(()=>{class w{constructor(A,k){this._viewContainer=A,this._context=new Po,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=k}set ngIf(A){this._context.$implicit=this._context.ngIf=A,this._updateView()}set ngIfThen(A){po("ngIfThen",A),this._thenTemplateRef=A,this._thenViewRef=null,this._updateView()}set ngIfElse(A){po("ngIfElse",A),this._elseTemplateRef=A,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(A,k){return!0}}return w.\u0275fac=function(A){return new(A||w)(M.Y36(M.s_b),M.Y36(M.Rgc))},w.\u0275dir=M.lG2({type:w,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),w})();class Po{constructor(){this.$implicit=null,this.ngIf=null}}function po(w,F){if(F&&!F.createEmbeddedView)throw new Error(`${w} must be a TemplateRef, but received '${(0,M.AaK)(F)}'.`)}function zr(w,F){return new M.vHH(2100,!1)}class si{createSubscription(F,A){return F.subscribe({next:A,error:k=>{throw k}})}dispose(F){F.unsubscribe()}}class sr{createSubscription(F,A){return F.then(A,k=>{throw k})}dispose(F){}}const Vr=new sr,mo=new si;let or=(()=>{class w{constructor(A){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=A}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(A){return this._obj?A!==this._obj?(this._dispose(),this.transform(A)):this._latestValue:(A&&this._subscribe(A),this._latestValue)}_subscribe(A){this._obj=A,this._strategy=this._selectStrategy(A),this._subscription=this._strategy.createSubscription(A,k=>this._updateLatestValue(A,k))}_selectStrategy(A){if((0,M.QGY)(A))return Vr;if((0,M.F4k)(A))return mo;throw zr()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(A,k){A===this._obj&&(this._latestValue=k,this._ref.markForCheck())}}return w.\u0275fac=function(A){return new(A||w)(M.Y36(M.sBO,16))},w.\u0275pipe=M.Yjl({name:"async",type:w,pure:!1,standalone:!0}),w})(),Yi=(()=>{class w{transform(A,k,Y){if(null==A)return null;if(!this.supports(A))throw zr();return A.slice(k,Y)}supports(A){return"string"==typeof A||Array.isArray(A)}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275pipe=M.Yjl({name:"slice",type:w,pure:!1,standalone:!0}),w})(),gn=(()=>{class w{}return w.\u0275fac=function(A){return new(A||w)},w.\u0275mod=M.oAB({type:w}),w.\u0275inj=M.cJS({}),w})();const er="browser",Fo="server";function Gs(w){return w===er}function ra(w){return w===Fo}let zc=(()=>{class w{}return w.\u0275prov=(0,M.Yz7)({token:w,providedIn:"root",factory:()=>new Zu((0,M.LFG)(Ee),window)}),w})();class Zu{constructor(F,A){this.document=F,this.window=A,this.offset=()=>[0,0]}setOffset(F){this.offset=Array.isArray(F)?()=>F:F}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(F){this.supportsScrolling()&&this.window.scrollTo(F[0],F[1])}scrollToAnchor(F){if(!this.supportsScrolling())return;const A=function Gl(w,F){const A=w.getElementById(F)||w.getElementsByName(F)[0];if(A)return A;if("function"==typeof w.createTreeWalker&&w.body&&"function"==typeof w.body.attachShadow){const k=w.createTreeWalker(w.body,NodeFilter.SHOW_ELEMENT);let Y=k.currentNode;for(;Y;){const ve=Y.shadowRoot;if(ve){const Te=ve.getElementById(F)||ve.querySelector(`[name="${F}"]`);if(Te)return Te}Y=k.nextNode()}}return null}(this.document,F);A&&(this.scrollToElement(A),A.focus())}setHistoryScrollRestoration(F){if(this.supportScrollRestoration()){const A=this.window.history;A&&A.scrollRestoration&&(A.scrollRestoration=F)}}scrollToElement(F){const A=F.getBoundingClientRect(),k=A.left+this.window.pageXOffset,Y=A.top+this.window.pageYOffset,ve=this.offset();this.window.scrollTo(k-ve[0],Y-ve[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const F=Ws(this.window.history)||Ws(Object.getPrototypeOf(this.window.history));return!(!F||!F.writable&&!F.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Ws(w){return Object.getOwnPropertyDescriptor(w,"scrollRestoration")}class rl{}const Uo=w=>w.src,fs=new M.OlP("ImageLoader",{providedIn:"root",factory:()=>Uo}),Zl=new M.OlP("NG_OPTIMIZED_PRELOADED_IMAGES",{providedIn:"root",factory:()=>new Set});let Xc=(()=>{class w{constructor(){this.preloadedImages=(0,M.f3M)(Zl),this.document=(0,M.f3M)(Ee)}createPreloadLinkTag(A,k,Y,ve){if(this.preloadedImages.has(k))return;this.preloadedImages.add(k);const Te=A.createElement("link");A.setAttribute(Te,"as","image"),A.setAttribute(Te,"href",k),A.setAttribute(Te,"rel","preload"),A.setAttribute(Te,"fetchpriority","high"),ve&&A.setAttribute(Te,"imageSizes",ve),Y&&A.setAttribute(Te,"imageSrcset",Y),A.appendChild(this.document.head,Te)}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275prov=M.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})();const Hi=/^((\s*\d+w\s*(,|$)){1,})$/,Wn=[1,2],$s={breakpoints:[16,32,48,64,96,128,256,384,640,750,828,1080,1200,1920,2048,3840]},Vo=new M.OlP("ImageConfig",{providedIn:"root",factory:()=>$s});let Go=(()=>{class w{constructor(){this.imageLoader=(0,M.f3M)(fs),this.config=function al(w){let F={};return w.breakpoints&&(F.breakpoints=w.breakpoints.sort((A,k)=>A-k)),Object.assign({},$s,w,F)}((0,M.f3M)(Vo)),this.renderer=(0,M.f3M)(M.Qsj),this.imgElement=(0,M.f3M)(M.SBq).nativeElement,this.injector=(0,M.f3M)(M.zs3),this.isServer=ra((0,M.f3M)(M.Lbi)),this.preloadLinkChecker=(0,M.f3M)(Xc),this.lcpObserver=null,this._renderedSrc=null,this._priority=!1,this._disableOptimizedSrcset=!1,this._fill=!1}set width(A){this._width=Kl(A)}get width(){return this._width}set height(A){this._height=Kl(A)}get height(){return this._height}set priority(A){this._priority=Jl(A)}get priority(){return this._priority}set disableOptimizedSrcset(A){this._disableOptimizedSrcset=Jl(A)}get disableOptimizedSrcset(){return this._disableOptimizedSrcset}set fill(A){this._fill=Jl(A)}get fill(){return this._fill}ngOnInit(){this.setHostAttributes()}setHostAttributes(){this.fill?this.sizes||(this.sizes="100vw"):(this.setHostAttribute("width",this.width.toString()),this.setHostAttribute("height",this.height.toString())),this.setHostAttribute("loading",this.getLoadingBehavior()),this.setHostAttribute("fetchpriority",this.getFetchPriority()),this.setHostAttribute("ng-img","true");const A=this.getRewrittenSrc();let k;this.setHostAttribute("src",A),this.sizes&&this.setHostAttribute("sizes",this.sizes),this.ngSrcset?k=this.getRewrittenSrcset():this.shouldGenerateAutomaticSrcset()&&(k=this.getAutomaticSrcset()),k&&this.setHostAttribute("srcset",k),this.isServer&&this.priority&&this.preloadLinkChecker.createPreloadLinkTag(this.renderer,A,k,this.sizes)}ngOnChanges(A){}callImageLoader(A){let k=A;return this.loaderParams&&(k.loaderParams=this.loaderParams),this.imageLoader(k)}getLoadingBehavior(){return this.priority||void 0===this.loading?this.priority?"eager":"lazy":this.loading}getFetchPriority(){return this.priority?"high":"auto"}getRewrittenSrc(){return this._renderedSrc||(this._renderedSrc=this.callImageLoader({src:this.ngSrc})),this._renderedSrc}getRewrittenSrcset(){const A=Hi.test(this.ngSrcset);return this.ngSrcset.split(",").filter(Y=>""!==Y).map(Y=>{Y=Y.trim();const ve=A?parseFloat(Y):parseFloat(Y)*this.width;return`${this.callImageLoader({src:this.ngSrc,width:ve})} ${Y}`}).join(", ")}getAutomaticSrcset(){return this.sizes?this.getResponsiveSrcset():this.getFixedSrcset()}getResponsiveSrcset(){const{breakpoints:A}=this.config;let k=A;return"100vw"===this.sizes?.trim()&&(k=A.filter(ve=>ve>=640)),k.map(ve=>`${this.callImageLoader({src:this.ngSrc,width:ve})} ${ve}w`).join(", ")}getFixedSrcset(){return Wn.map(k=>`${this.callImageLoader({src:this.ngSrc,width:this.width*k})} ${k}x`).join(", ")}shouldGenerateAutomaticSrcset(){return!this._disableOptimizedSrcset&&!this.srcset&&this.imageLoader!==Uo&&!(this.width>1920||this.height>1080)}ngOnDestroy(){}setHostAttribute(A,k){this.renderer.setAttribute(this.imgElement,A,k)}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275dir=M.lG2({type:w,selectors:[["img","ngSrc",""]],hostVars:8,hostBindings:function(A,k){2&A&&M.Udp("position",k.fill?"absolute":null)("width",k.fill?"100%":null)("height",k.fill?"100%":null)("inset",k.fill?"0px":null)},inputs:{ngSrc:"ngSrc",ngSrcset:"ngSrcset",sizes:"sizes",width:"width",height:"height",loading:"loading",priority:"priority",loaderParams:"loaderParams",disableOptimizedSrcset:"disableOptimizedSrcset",fill:"fill",src:"src",srcset:"srcset"},standalone:!0,features:[M.TTD]}),w})();function Kl(w){return"string"==typeof w?parseInt(w,10):w}function Jl(w){return null!=w&&"false"!=`${w}`}},3144:(jt,Be,V)=>{V.d(Be,{JF:()=>to,eN:()=>rt});var M=V(2504),fe=V(9646),De=V(2076),Re=V(9751),Me=V(4351),Ee=V(9300),Ve=V(4004),Dt=V(3900),dt=V(4755);class Ze{}class me{}class ye{constructor(q){this.normalizedNames=new Map,this.lazyUpdate=null,q?this.lazyInit="string"==typeof q?()=>{this.headers=new Map,q.split("\n").forEach(ie=>{const Ie=ie.indexOf(":");if(Ie>0){const tt=ie.slice(0,Ie),Qe=tt.toLowerCase(),Et=ie.slice(Ie+1).trim();this.maybeSetNormalizedName(tt,Qe),this.headers.has(Qe)?this.headers.get(Qe).push(Et):this.headers.set(Qe,[Et])}})}:()=>{this.headers=new Map,Object.entries(q).forEach(([ie,Ie])=>{let tt;if(tt="string"==typeof Ie?[Ie]:"number"==typeof Ie?[Ie.toString()]:Ie.map(Qe=>Qe.toString()),tt.length>0){const Qe=ie.toLowerCase();this.headers.set(Qe,tt),this.maybeSetNormalizedName(ie,Qe)}})}:this.headers=new Map}has(q){return this.init(),this.headers.has(q.toLowerCase())}get(q){this.init();const ie=this.headers.get(q.toLowerCase());return ie&&ie.length>0?ie[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(q){return this.init(),this.headers.get(q.toLowerCase())||null}append(q,ie){return this.clone({name:q,value:ie,op:"a"})}set(q,ie){return this.clone({name:q,value:ie,op:"s"})}delete(q,ie){return this.clone({name:q,value:ie,op:"d"})}maybeSetNormalizedName(q,ie){this.normalizedNames.has(ie)||this.normalizedNames.set(ie,q)}init(){this.lazyInit&&(this.lazyInit instanceof ye?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(q=>this.applyUpdate(q)),this.lazyUpdate=null))}copyFrom(q){q.init(),Array.from(q.headers.keys()).forEach(ie=>{this.headers.set(ie,q.headers.get(ie)),this.normalizedNames.set(ie,q.normalizedNames.get(ie))})}clone(q){const ie=new ye;return ie.lazyInit=this.lazyInit&&this.lazyInit instanceof ye?this.lazyInit:this,ie.lazyUpdate=(this.lazyUpdate||[]).concat([q]),ie}applyUpdate(q){const ie=q.name.toLowerCase();switch(q.op){case"a":case"s":let Ie=q.value;if("string"==typeof Ie&&(Ie=[Ie]),0===Ie.length)return;this.maybeSetNormalizedName(q.name,ie);const tt=("a"===q.op?this.headers.get(ie):void 0)||[];tt.push(...Ie),this.headers.set(ie,tt);break;case"d":const Qe=q.value;if(Qe){let Et=this.headers.get(ie);if(!Et)return;Et=Et.filter(Mi=>-1===Qe.indexOf(Mi)),0===Et.length?(this.headers.delete(ie),this.normalizedNames.delete(ie)):this.headers.set(ie,Et)}else this.headers.delete(ie),this.normalizedNames.delete(ie)}}forEach(q){this.init(),Array.from(this.normalizedNames.keys()).forEach(ie=>q(this.normalizedNames.get(ie),this.headers.get(ie)))}}class Ae{encodeKey(q){return an(q)}encodeValue(q){return an(q)}decodeKey(q){return decodeURIComponent(q)}decodeValue(q){return decodeURIComponent(q)}}const Zt=/%(\d[a-f0-9])/gi,ht={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function an(oe){return encodeURIComponent(oe).replace(Zt,(q,ie)=>ht[ie]??q)}function Pn(oe){return`${oe}`}class zn{constructor(q={}){if(this.updates=null,this.cloneFrom=null,this.encoder=q.encoder||new Ae,q.fromString){if(q.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Ct(oe,q){const ie=new Map;return oe.length>0&&oe.replace(/^\?/,"").split("&").forEach(tt=>{const Qe=tt.indexOf("="),[Et,Mi]=-1==Qe?[q.decodeKey(tt),""]:[q.decodeKey(tt.slice(0,Qe)),q.decodeValue(tt.slice(Qe+1))],mn=ie.get(Et)||[];mn.push(Mi),ie.set(Et,mn)}),ie}(q.fromString,this.encoder)}else q.fromObject?(this.map=new Map,Object.keys(q.fromObject).forEach(ie=>{const Ie=q.fromObject[ie],tt=Array.isArray(Ie)?Ie.map(Pn):[Pn(Ie)];this.map.set(ie,tt)})):this.map=null}has(q){return this.init(),this.map.has(q)}get(q){this.init();const ie=this.map.get(q);return ie?ie[0]:null}getAll(q){return this.init(),this.map.get(q)||null}keys(){return this.init(),Array.from(this.map.keys())}append(q,ie){return this.clone({param:q,value:ie,op:"a"})}appendAll(q){const ie=[];return Object.keys(q).forEach(Ie=>{const tt=q[Ie];Array.isArray(tt)?tt.forEach(Qe=>{ie.push({param:Ie,value:Qe,op:"a"})}):ie.push({param:Ie,value:tt,op:"a"})}),this.clone(ie)}set(q,ie){return this.clone({param:q,value:ie,op:"s"})}delete(q,ie){return this.clone({param:q,value:ie,op:"d"})}toString(){return this.init(),this.keys().map(q=>{const ie=this.encoder.encodeKey(q);return this.map.get(q).map(Ie=>ie+"="+this.encoder.encodeValue(Ie)).join("&")}).filter(q=>""!==q).join("&")}clone(q){const ie=new zn({encoder:this.encoder});return ie.cloneFrom=this.cloneFrom||this,ie.updates=(this.updates||[]).concat(q),ie}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(q=>this.map.set(q,this.cloneFrom.map.get(q))),this.updates.forEach(q=>{switch(q.op){case"a":case"s":const ie=("a"===q.op?this.map.get(q.param):void 0)||[];ie.push(Pn(q.value)),this.map.set(q.param,ie);break;case"d":if(void 0===q.value){this.map.delete(q.param);break}{let Ie=this.map.get(q.param)||[];const tt=Ie.indexOf(Pn(q.value));-1!==tt&&Ie.splice(tt,1),Ie.length>0?this.map.set(q.param,Ie):this.map.delete(q.param)}}}),this.cloneFrom=this.updates=null)}}class ge{constructor(){this.map=new Map}set(q,ie){return this.map.set(q,ie),this}get(q){return this.map.has(q)||this.map.set(q,q.defaultValue()),this.map.get(q)}delete(q){return this.map.delete(q),this}has(q){return this.map.has(q)}keys(){return this.map.keys()}}function He(oe){return typeof ArrayBuffer<"u"&&oe instanceof ArrayBuffer}function ke(oe){return typeof Blob<"u"&&oe instanceof Blob}function it(oe){return typeof FormData<"u"&&oe instanceof FormData}class vt{constructor(q,ie,Ie,tt){let Qe;if(this.url=ie,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=q.toUpperCase(),function gt(oe){switch(oe){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||tt?(this.body=void 0!==Ie?Ie:null,Qe=tt):Qe=Ie,Qe&&(this.reportProgress=!!Qe.reportProgress,this.withCredentials=!!Qe.withCredentials,Qe.responseType&&(this.responseType=Qe.responseType),Qe.headers&&(this.headers=Qe.headers),Qe.context&&(this.context=Qe.context),Qe.params&&(this.params=Qe.params)),this.headers||(this.headers=new ye),this.context||(this.context=new ge),this.params){const Et=this.params.toString();if(0===Et.length)this.urlWithParams=ie;else{const Mi=ie.indexOf("?");this.urlWithParams=ie+(-1===Mi?"?":Mi<ie.length-1?"&":"")+Et}}else this.params=new zn,this.urlWithParams=ie}serializeBody(){return null===this.body?null:He(this.body)||ke(this.body)||it(this.body)||function Ut(oe){return typeof URLSearchParams<"u"&&oe instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof zn?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||it(this.body)?null:ke(this.body)?this.body.type||null:He(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof zn?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(q={}){const ie=q.method||this.method,Ie=q.url||this.url,tt=q.responseType||this.responseType,Qe=void 0!==q.body?q.body:this.body,Et=void 0!==q.withCredentials?q.withCredentials:this.withCredentials,Mi=void 0!==q.reportProgress?q.reportProgress:this.reportProgress;let mn=q.headers||this.headers,Mr=q.params||this.params;const mi=q.context??this.context;return void 0!==q.setHeaders&&(mn=Object.keys(q.setHeaders).reduce((Ui,xr)=>Ui.set(xr,q.setHeaders[xr]),mn)),q.setParams&&(Mr=Object.keys(q.setParams).reduce((Ui,xr)=>Ui.set(xr,q.setParams[xr]),Mr)),new vt(ie,Ie,Qe,{params:Mr,headers:mn,context:mi,reportProgress:Mi,responseType:tt,withCredentials:Et})}}var pn=(()=>((pn=pn||{})[pn.Sent=0]="Sent",pn[pn.UploadProgress=1]="UploadProgress",pn[pn.ResponseHeader=2]="ResponseHeader",pn[pn.DownloadProgress=3]="DownloadProgress",pn[pn.Response=4]="Response",pn[pn.User=5]="User",pn))();class kn{constructor(q,ie=200,Ie="OK"){this.headers=q.headers||new ye,this.status=void 0!==q.status?q.status:ie,this.statusText=q.statusText||Ie,this.url=q.url||null,this.ok=this.status>=200&&this.status<300}}class Ti extends kn{constructor(q={}){super(q),this.type=pn.ResponseHeader}clone(q={}){return new Ti({headers:q.headers||this.headers,status:void 0!==q.status?q.status:this.status,statusText:q.statusText||this.statusText,url:q.url||this.url||void 0})}}class be extends kn{constructor(q={}){super(q),this.type=pn.Response,this.body=void 0!==q.body?q.body:null}clone(q={}){return new be({body:void 0!==q.body?q.body:this.body,headers:q.headers||this.headers,status:void 0!==q.status?q.status:this.status,statusText:q.statusText||this.statusText,url:q.url||this.url||void 0})}}class Oe extends kn{constructor(q){super(q,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${q.url||"(unknown url)"}`:`Http failure response for ${q.url||"(unknown url)"}: ${q.status} ${q.statusText}`,this.error=q.error||null}}function Ue(oe,q){return{body:q,headers:oe.headers,context:oe.context,observe:oe.observe,params:oe.params,reportProgress:oe.reportProgress,responseType:oe.responseType,withCredentials:oe.withCredentials}}let rt=(()=>{class oe{constructor(ie){this.handler=ie}request(ie,Ie,tt={}){let Qe;if(ie instanceof vt)Qe=ie;else{let mn,Mr;mn=tt.headers instanceof ye?tt.headers:new ye(tt.headers),tt.params&&(Mr=tt.params instanceof zn?tt.params:new zn({fromObject:tt.params})),Qe=new vt(ie,Ie,void 0!==tt.body?tt.body:null,{headers:mn,context:tt.context,params:Mr,reportProgress:tt.reportProgress,responseType:tt.responseType||"json",withCredentials:tt.withCredentials})}const Et=(0,fe.of)(Qe).pipe((0,Me.b)(mn=>this.handler.handle(mn)));if(ie instanceof vt||"events"===tt.observe)return Et;const Mi=Et.pipe((0,Ee.h)(mn=>mn instanceof be));switch(tt.observe||"body"){case"body":switch(Qe.responseType){case"arraybuffer":return Mi.pipe((0,Ve.U)(mn=>{if(null!==mn.body&&!(mn.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return mn.body}));case"blob":return Mi.pipe((0,Ve.U)(mn=>{if(null!==mn.body&&!(mn.body instanceof Blob))throw new Error("Response is not a Blob.");return mn.body}));case"text":return Mi.pipe((0,Ve.U)(mn=>{if(null!==mn.body&&"string"!=typeof mn.body)throw new Error("Response is not a string.");return mn.body}));default:return Mi.pipe((0,Ve.U)(mn=>mn.body))}case"response":return Mi;default:throw new Error(`Unreachable: unhandled observe type ${tt.observe}}`)}}delete(ie,Ie={}){return this.request("DELETE",ie,Ie)}get(ie,Ie={}){return this.request("GET",ie,Ie)}head(ie,Ie={}){return this.request("HEAD",ie,Ie)}jsonp(ie,Ie){return this.request("JSONP",ie,{params:(new zn).append(Ie,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(ie,Ie={}){return this.request("OPTIONS",ie,Ie)}patch(ie,Ie,tt={}){return this.request("PATCH",ie,Ue(tt,Ie))}post(ie,Ie,tt={}){return this.request("POST",ie,Ue(tt,Ie))}put(ie,Ie,tt={}){return this.request("PUT",ie,Ue(tt,Ie))}}return oe.\u0275fac=function(ie){return new(ie||oe)(M.LFG(Ze))},oe.\u0275prov=M.Yz7({token:oe,factory:oe.\u0275fac}),oe})();function Rt(oe,q){return q(oe)}function wt(oe,q){return(ie,Ie)=>q.intercept(ie,{handle:tt=>oe(tt,Ie)})}const Bn=new M.OlP(""),ii=new M.OlP(""),nn=new M.OlP("");function gi(){let oe=null;return(q,ie)=>(null===oe&&(oe=((0,M.f3M)(Bn,{optional:!0})??[]).reduceRight(wt,Rt)),oe(q,ie))}let Xn=(()=>{class oe extends Ze{constructor(ie,Ie){super(),this.backend=ie,this.injector=Ie,this.chain=null}handle(ie){if(null===this.chain){const Ie=Array.from(new Set([...this.injector.get(ii),...this.injector.get(nn,[])]));this.chain=Ie.reduceRight((tt,Qe)=>function tn(oe,q,ie){return(Ie,tt)=>ie.runInContext(()=>q(Ie,Qe=>oe(Qe,tt)))}(tt,Qe,this.injector),Rt)}return this.chain(ie,Ie=>this.backend.handle(Ie))}}return oe.\u0275fac=function(ie){return new(ie||oe)(M.LFG(me),M.LFG(M.lqb))},oe.\u0275prov=M.Yz7({token:oe,factory:oe.\u0275fac}),oe})();const fi=/^\)\]\}',?\n/;let pi=(()=>{class oe{constructor(ie){this.xhrFactory=ie}handle(ie){if("JSONP"===ie.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");const Ie=this.xhrFactory;return(Ie.\u0275loadImpl?(0,De.D)(Ie.\u0275loadImpl()):(0,fe.of)(null)).pipe((0,Dt.w)(()=>new Re.y(Qe=>{const Et=Ie.build();if(Et.open(ie.method,ie.urlWithParams),ie.withCredentials&&(Et.withCredentials=!0),ie.headers.forEach((Ii,Xi)=>Et.setRequestHeader(Ii,Xi.join(","))),ie.headers.has("Accept")||Et.setRequestHeader("Accept","application/json, text/plain, */*"),!ie.headers.has("Content-Type")){const Ii=ie.detectContentTypeHeader();null!==Ii&&Et.setRequestHeader("Content-Type",Ii)}if(ie.responseType){const Ii=ie.responseType.toLowerCase();Et.responseType="json"!==Ii?Ii:"text"}const Mi=ie.serializeBody();let mn=null;const Mr=()=>{if(null!==mn)return mn;const Ii=Et.statusText||"OK",Xi=new ye(Et.getAllResponseHeaders()),us=function _i(oe){return"responseURL"in oe&&oe.responseURL?oe.responseURL:/^X-Request-URL:/m.test(oe.getAllResponseHeaders())?oe.getResponseHeader("X-Request-URL"):null}(Et)||ie.url;return mn=new Ti({headers:Xi,status:Et.status,statusText:Ii,url:us}),mn},mi=()=>{let{headers:Ii,status:Xi,statusText:us,url:Hr}=Mr(),rr=null;204!==Xi&&(rr=typeof Et.response>"u"?Et.responseText:Et.response),0===Xi&&(Xi=rr?200:0);let ks=Xi>=200&&Xi<300;if("json"===ie.responseType&&"string"==typeof rr){const Or=rr;rr=rr.replace(fi,"");try{rr=""!==rr?JSON.parse(rr):null}catch(Ro){rr=Or,ks&&(ks=!1,rr={error:Ro,text:rr})}}ks?(Qe.next(new be({body:rr,headers:Ii,status:Xi,statusText:us,url:Hr||void 0})),Qe.complete()):Qe.error(new Oe({error:rr,headers:Ii,status:Xi,statusText:us,url:Hr||void 0}))},Ui=Ii=>{const{url:Xi}=Mr(),us=new Oe({error:Ii,status:Et.status||0,statusText:Et.statusText||"Unknown Error",url:Xi||void 0});Qe.error(us)};let xr=!1;const qr=Ii=>{xr||(Qe.next(Mr()),xr=!0);let Xi={type:pn.DownloadProgress,loaded:Ii.loaded};Ii.lengthComputable&&(Xi.total=Ii.total),"text"===ie.responseType&&Et.responseText&&(Xi.partialText=Et.responseText),Qe.next(Xi)},Zr=Ii=>{let Xi={type:pn.UploadProgress,loaded:Ii.loaded};Ii.lengthComputable&&(Xi.total=Ii.total),Qe.next(Xi)};let no;Et.addEventListener("load",mi),Et.addEventListener("error",Ui),Et.addEventListener("timeout",Ui),Et.addEventListener("abort",Ui),ie.reportProgress&&(Et.addEventListener("progress",qr),null!==Mi&&Et.upload&&Et.upload.addEventListener("progress",Zr));const Es=()=>{no??=function Vn(){const oe=setTimeout(()=>{},Ci);return()=>clearTimeout(oe)}()},Us=()=>{no?.()};return Et.addEventListener("loadstart",Es),Et.addEventListener("loadend",Us),Et.send(Mi),Qe.next({type:pn.Sent}),()=>{Et.removeEventListener("loadstart",Es),Et.removeEventListener("loadend",Us),Et.removeEventListener("error",Ui),Et.removeEventListener("abort",Ui),Et.removeEventListener("load",mi),Et.removeEventListener("timeout",Ui),no?.(),ie.reportProgress&&(Et.removeEventListener("progress",qr),null!==Mi&&Et.upload&&Et.upload.removeEventListener("progress",Zr)),Et.readyState!==Et.DONE&&Et.abort()}})))}}return oe.\u0275fac=function(ie){return new(ie||oe)(M.LFG(dt.JF))},oe.\u0275prov=M.Yz7({token:oe,factory:oe.\u0275fac}),oe})();const Ci=2147483647,st=new M.OlP("XSRF_ENABLED"),$i=new M.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Ln=new M.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class ls{}let Zn=(()=>{class oe{constructor(ie,Ie,tt){this.doc=ie,this.platform=Ie,this.cookieName=tt,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const ie=this.doc.cookie||"";return ie!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,dt.Mx)(ie,this.cookieName),this.lastCookieString=ie),this.lastToken}}return oe.\u0275fac=function(ie){return new(ie||oe)(M.LFG(dt.K0),M.LFG(M.Lbi),M.LFG($i))},oe.\u0275prov=M.Yz7({token:oe,factory:oe.\u0275fac}),oe})();function Os(oe,q){const ie=oe.url.toLowerCase();if(!(0,M.f3M)(st)||"GET"===oe.method||"HEAD"===oe.method||ie.startsWith("http://")||ie.startsWith("https://"))return q(oe);const Ie=(0,M.f3M)(ls).getToken(),tt=(0,M.f3M)(Ln);return null!=Ie&&!oe.headers.has(tt)&&(oe=oe.clone({headers:oe.headers.set(tt,Ie)})),q(oe)}var Qn=(()=>((Qn=Qn||{})[Qn.Interceptors=0]="Interceptors",Qn[Qn.LegacyInterceptors=1]="LegacyInterceptors",Qn[Qn.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",Qn[Qn.NoXsrfProtection=3]="NoXsrfProtection",Qn[Qn.JsonpSupport=4]="JsonpSupport",Qn[Qn.RequestsMadeViaParent=5]="RequestsMadeViaParent",Qn))();function xn(oe,q){return{\u0275kind:oe,\u0275providers:q}}function Fs(...oe){const q=[rt,pi,Xn,{provide:Ze,useExisting:Xn},{provide:me,useExisting:pi},{provide:ii,useValue:Os,multi:!0},{provide:st,useValue:!0},{provide:ls,useClass:Zn}];for(const ie of oe)q.push(...ie.\u0275providers);return(0,M.MR2)(q)}const Tr=new M.OlP("LEGACY_INTERCEPTOR_FN");let to=(()=>{class oe{}return oe.\u0275fac=function(ie){return new(ie||oe)},oe.\u0275mod=M.oAB({type:oe}),oe.\u0275inj=M.cJS({providers:[Fs(xn(Qn.LegacyInterceptors,[{provide:Tr,useFactory:gi},{provide:ii,useExisting:Tr,multi:!0}]))]}),oe})()},2504:(jt,Be,V)=>{V.d(Be,{tb:()=>L_,AFp:()=>Xm,ip1:()=>pE,hGG:()=>Tw,z2F:()=>Oh,Ojb:()=>Gy,sBO:()=>dw,Sil:()=>Gb,EJc:()=>zb,Xts:()=>mu,SBq:()=>Ga,lqb:()=>Ma,qLn:()=>bl,vpe:()=>Ja,XFs:()=>st,OlP:()=>Si,zs3:()=>$r,ZZ4:()=>B_,aQg:()=>H_,soG:()=>gv,YKP:()=>gx,h0i:()=>Ph,PXZ:()=>nw,R0b:()=>Ns,FiY:()=>vd,Lbi:()=>Tf,g9A:()=>Ym,Qsj:()=>ng,FYo:()=>$d,JOm:()=>Ko,q3G:()=>gr,tp0:()=>yd,Rgc:()=>Np,dDg:()=>Jb,eoX:()=>wE,GfV:()=>Tu,s_b:()=>pv,ifc:()=>Ie,MMx:()=>yx,Lck:()=>DS,Gpc:()=>Zt,RIp:()=>_f,f3M:()=>ui,$WT:()=>mo,MR2:()=>gu,qFp:()=>Uw,c2e:()=>mE,zSh:()=>xf,HDt:()=>KE,wAp:()=>nt,vHH:()=>ge,lri:()=>SE,rWj:()=>bE,JZr:()=>Pt,EiD:()=>Fm,mCW:()=>Id,qzn:()=>Ml,JVY:()=>Dm,pB0:()=>yc,eBb:()=>Am,L6k:()=>Cm,LAX:()=>Im,D6c:()=>Ow,cg1:()=>It,kuF:()=>gt,kL8:()=>_t,dqk:()=>Zn,iPO:()=>sw,Z0I:()=>Xe,eJc:()=>E_,QGY:()=>Wi,F4k:()=>V0,RDi:()=>Mm,AaK:()=>Le,z3N:()=>Jo,qOj:()=>ip,TTD:()=>yo,_Bn:()=>mx,jDz:()=>_x,xp6:()=>kf,uIk:()=>Ic,ekj:()=>iv,Suo:()=>jx,Xpm:()=>Qa,lG2:()=>Vl,Yz7:()=>ri,cJS:()=>Ji,oAB:()=>tl,Yjl:()=>zr,Y36:()=>Wa,_UZ:()=>gp,qZA:()=>mp,TgZ:()=>pp,EpF:()=>Xg,n5z:()=>fl,LFG:()=>cr,$8M:()=>Gh,$Z:()=>ag,NdJ:()=>Mp,CRH:()=>Xx,kcU:()=>v,O4$:()=>y,oxw:()=>W0,ALo:()=>Rx,lcZ:()=>Px,Dn7:()=>Lx,Q6J:()=>xh,iGM:()=>Wx,MAs:()=>qa,KtG:()=>ps,CHM:()=>Fa,LSH:()=>yf,P3R:()=>km,Udp:()=>nv,YNc:()=>Ya,W1O:()=>Kx,_uU:()=>lv,Oqu:()=>t,hij:()=>s,Gf:()=>$x});var M=V(7579),fe=V(727),De=V(9751),Re=V(8189),Me=V(8421),Ee=V(515),Ve=V(3269),Dt=V(2076),Ze=V(3099);function me(n){for(let i in n)if(n[i]===me)return i;throw Error("Could not find renamed property on target object.")}function ye(n,i){for(const r in i)i.hasOwnProperty(r)&&!n.hasOwnProperty(r)&&(n[r]=i[r])}function Le(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Le).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const i=n.toString();if(null==i)return""+i;const r=i.indexOf("\n");return-1===r?i:i.substring(0,r)}function Ae(n,i){return null==n||""===n?null===i?"":i:null==i||""===i?n:n+" "+i}const Ct=me({__forward_ref__:me});function Zt(n){return n.__forward_ref__=Zt,n.toString=function(){return Le(this())},n}function ht(n){return an(n)?n():n}function an(n){return"function"==typeof n&&n.hasOwnProperty(Ct)&&n.__forward_ref__===Zt}function Pn(n){return n&&!!n.\u0275providers}const Pt="https://g.co/ng/security#xss";class ge extends Error{constructor(i,r){super(gt(i,r)),this.code=i}}function gt(n,i){return`NG0${Math.abs(n)}${i?": "+i:""}`}function He(n){return"string"==typeof n?n:null==n?"":String(n)}function pn(n,i){throw new ge(-201,!1)}function Xn(n,i){null==n&&function yt(n,i,r,a){throw new Error(`ASSERTION ERROR: ${n}`+(null==a?"":` [Expected=> ${r} ${a} ${i} <=Actual]`))}(i,n,null,"!=")}function ri(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ji(n){return{providers:n.providers||[],imports:n.imports||[]}}function Zi(n){return en(n,_i)||en(n,Ci)}function Xe(n){return null!==Zi(n)}function en(n,i){return n.hasOwnProperty(i)?n[i]:null}function fi(n){return n&&(n.hasOwnProperty(pi)||n.hasOwnProperty(Vn))?n[pi]:null}const _i=me({\u0275prov:me}),pi=me({\u0275inj:me}),Ci=me({ngInjectableDef:me}),Vn=me({ngInjectorDef:me});var st=(()=>((st=st||{})[st.Default=0]="Default",st[st.Host=1]="Host",st[st.Self=2]="Self",st[st.SkipSelf=4]="SkipSelf",st[st.Optional=8]="Optional",st))();let Kt;function Ai(n){const i=Kt;return Kt=n,i}function Ln(n,i,r){const a=Zi(n);return a&&"root"==a.providedIn?void 0===a.value?a.value=a.factory():a.value:r&st.Optional?null:void 0!==i?i:void pn(Le(n))}const Zn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),xn={},Fs="__NG_DI_FLAG__",wr="ngTempTokenPath",Xr=/\n/gm,xs="__source";let li;function Yr(n){const i=li;return li=n,i}function to(n,i=st.Default){if(void 0===li)throw new ge(-203,!1);return null===li?Ln(n,void 0,i):li.get(n,i&st.Optional?null:void 0,i)}function cr(n,i=st.Default){return(function $i(){return Kt}()||to)(ht(n),i)}function ui(n,i=st.Default){return cr(n,Se(i))}function Se(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function ce(n){const i=[];for(let r=0;r<n.length;r++){const a=ht(n[r]);if(Array.isArray(a)){if(0===a.length)throw new ge(900,!1);let u,f=st.Default;for(let g=0;g<a.length;g++){const x=a[g],T=ue(x);"number"==typeof T?-1===T?u=x.token:f|=T:u=x}i.push(cr(u,f))}else i.push(cr(a))}return i}function ee(n,i){return n[Fs]=i,n.prototype[Fs]=i,n}function ue(n){return n[Fs]}function q(n){return{toString:n}.toString()}var ie=(()=>((ie=ie||{})[ie.OnPush=0]="OnPush",ie[ie.Default=1]="Default",ie))(),Ie=(()=>{return(n=Ie||(Ie={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Ie;var n})();const tt={},Qe=[],Et=me({\u0275cmp:me}),Mi=me({\u0275dir:me}),mn=me({\u0275pipe:me}),Mr=me({\u0275mod:me}),mi=me({\u0275fac:me}),Ui=me({__NG_ELEMENT_ID__:me}),xr=me({__NG_ENV_ID__:me});function qr(n,i,r){let a=n.length;for(;;){const u=n.indexOf(i,r);if(-1===u)return u;if(0===u||n.charCodeAt(u-1)<=32){const f=i.length;if(u+f===a||n.charCodeAt(u+f)<=32)return u}r=u+1}}function Zr(n,i,r){let a=0;for(;a<r.length;){const u=r[a];if("number"==typeof u){if(0!==u)break;a++;const f=r[a++],g=r[a++],x=r[a++];n.setAttribute(i,g,x,f)}else{const f=u,g=r[++a];Es(f)?n.setProperty(i,f,g):n.setAttribute(i,f,g),a++}}return a}function no(n){return 3===n||4===n||6===n}function Es(n){return 64===n.charCodeAt(0)}function Us(n,i){if(null!==i&&0!==i.length)if(null===n||0===n.length)n=i.slice();else{let r=-1;for(let a=0;a<i.length;a++){const u=i[a];"number"==typeof u?r=u:0===r||Ii(n,r,u,null,-1===r||2===r?i[++a]:null)}}return n}function Ii(n,i,r,a,u){let f=0,g=n.length;if(-1===i)g=-1;else for(;f<n.length;){const x=n[f++];if("number"==typeof x){if(x===i){g=-1;break}if(x>i){g=f-1;break}}}for(;f<n.length;){const x=n[f];if("number"==typeof x)break;if(x===r){if(null===a)return void(null!==u&&(n[f+1]=u));if(a===n[f+1])return void(n[f+2]=u)}f++,null!==a&&f++,null!==u&&f++}-1!==g&&(n.splice(g,0,i),f=g+1),n.splice(f++,0,r),null!==a&&n.splice(f++,0,a),null!==u&&n.splice(f++,0,u)}const Xi="ng-template";function us(n,i,r){let a=0,u=!0;for(;a<n.length;){let f=n[a++];if("string"==typeof f&&u){const g=n[a++];if(r&&"class"===f&&-1!==qr(g.toLowerCase(),i,0))return!0}else{if(1===f){for(;a<n.length&&"string"==typeof(f=n[a++]);)if(f.toLowerCase()===i)return!0;return!1}"number"==typeof f&&(u=!1)}}return!1}function Hr(n){return 4===n.type&&n.value!==Xi}function rr(n,i,r){return i===(4!==n.type||r?n.value:Xi)}function ks(n,i,r){let a=4;const u=n.attrs||[],f=function ds(n){for(let i=0;i<n.length;i++)if(no(n[i]))return i;return n.length}(u);let g=!1;for(let x=0;x<i.length;x++){const T=i[x];if("number"!=typeof T){if(!g)if(4&a){if(a=2|1&a,""!==T&&!rr(n,T,r)||""===T&&1===i.length){if(Or(a))return!1;g=!0}}else{const L=8&a?T:i[++x];if(8&a&&null!==n.attrs){if(!us(n.attrs,L,r)){if(Or(a))return!1;g=!0}continue}const Z=Ro(8&a?"class":T,u,Hr(n),r);if(-1===Z){if(Or(a))return!1;g=!0;continue}if(""!==L){let ae;ae=Z>f?"":u[Z+1].toLowerCase();const pe=8&a?ae:null;if(pe&&-1!==qr(pe,L,0)||2&a&&L!==ae){if(Or(a))return!1;g=!0}}}}else{if(!g&&!Or(a)&&!Or(T))return!1;if(g&&Or(T))continue;g=!1,a=T|1&a}}return Or(a)||g}function Or(n){return 0==(1&n)}function Ro(n,i,r,a){if(null===i)return-1;let u=0;if(a||!r){let f=!1;for(;u<i.length;){const g=i[u];if(g===n)return u;if(3===g||6===g)f=!0;else{if(1===g||2===g){let x=i[++u];for(;"string"==typeof x;)x=i[++u];continue}if(4===g)break;if(0===g){u+=4;continue}}u+=f?1:2}return-1}return function Aa(n,i){let r=n.indexOf(4);if(r>-1)for(r++;r<n.length;){const a=n[r];if("number"==typeof a)return-1;if(a===i)return r;r++}return-1}(i,n)}function Ca(n,i,r=!1){for(let a=0;a<i.length;a++)if(ks(n,i[a],r))return!0;return!1}function Po(n,i){return n?":not("+i.trim()+")":i}function po(n){let i=n[0],r=1,a=2,u="",f=!1;for(;r<n.length;){let g=n[r];if("string"==typeof g)if(2&a){const x=n[++r];u+="["+g+(x.length>0?'="'+x+'"':"")+"]"}else 8&a?u+="."+g:4&a&&(u+=" "+g);else""!==u&&!Or(g)&&(i+=Po(f,u),u=""),a=g,f=f||!Or(a);r++}return""!==u&&(i+=Po(f,u)),i}function Qa(n){return q(()=>{const i=Ra(n),r={...i,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ie.OnPush,directiveDefs:null,pipeDefs:null,dependencies:i.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||Ie.Emulated,styles:n.styles||Qe,_:null,schemas:n.schemas||null,tView:null,id:""};Pa(r);const a=n.dependencies;return r.directiveDefs=No(a,!1),r.pipeDefs=No(a,!0),r.id=function zs(n){let i=0;const r=JSON.stringify([n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.exportAs,n.inputs,n.outputs,Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery]);for(const u of r)i=Math.imul(31,i)+u.charCodeAt(0)<<0;return i+=2147483648,"c"+i}(r),r})}function Bc(n){return si(n)||sr(n)}function el(n){return null!==n}function tl(n){return q(()=>({type:n.type,bootstrap:n.bootstrap||Qe,declarations:n.declarations||Qe,imports:n.imports||Qe,exports:n.exports||Qe,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function zl(n,i){if(null==n)return tt;const r={};for(const a in n)if(n.hasOwnProperty(a)){let u=n[a],f=u;Array.isArray(u)&&(f=u[1],u=u[0]),r[u]=a,i&&(i[u]=f)}return r}function Vl(n){return q(()=>{const i=Ra(n);return Pa(i),i})}function zr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function si(n){return n[Et]||null}function sr(n){return n[Mi]||null}function Vr(n){return n[mn]||null}function mo(n){const i=si(n)||sr(n)||Vr(n);return null!==i&&i.standalone}function or(n,i){const r=n[Mr]||null;if(!r&&!0===i)throw new Error(`Type ${Le(n)} does not have '\u0275mod' property.`);return r}function Ra(n){const i={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||Qe,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:zl(n.inputs,i),outputs:zl(n.outputs)}}function Pa(n){n.features?.forEach(i=>i(n))}function No(n,i){if(!n)return null;const r=i?Vr:Bc;return()=>("function"==typeof n?n():n).map(a=>r(a)).filter(el)}const ki=0,Ot=1,vn=2,ei=3,Dr=4,Vs=5,Qi=6,Oo=7,Bi=8,go=9,Ss=10,un=11,vo=12,La=13,pr=14,Yi=15,bs=16,gn=17,er=18,Fo=19,nl=20,hs=21,Gs=22,ra=23,il=24,Yn=25,zc=1,Zu=2,Ws=7,Gl=8,Na=9,ar=11;function Er(n){return Array.isArray(n)&&"object"==typeof n[zc]}function xi(n){return Array.isArray(n)&&!0===n[zc]}function Wl(n){return 0!=(4&n.flags)}function ws(n){return n.componentOffset>-1}function Uo(n){return 1==(1&n.flags)}function fs(n){return!!n.template}function sa(n){return 0!=(512&n[vn])}function zo(n,i){return n.hasOwnProperty(mi)?n[mi]:null}let ql=Zn.WeakRef??class Yl{constructor(i){this.ref=i}deref(){return this.ref}},ol=0,Hi=null,En=!1;function nr(n){const i=Hi;return Hi=n,i}class Ke{constructor(){this.id=ol++,this.ref=function Zl(n){return new ql(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[i,r]of this.producers){const a=r.producerNode.deref();if(void 0!==a&&r.atTrackingVersion===this.trackingVersion){if(a.producerPollStatus(r.seenValueVersion))return!0}else this.producers.delete(i),a?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const i=En;En=!0;try{for(const[r,a]of this.consumers){const u=a.consumerNode.deref();void 0!==u&&u.trackingVersion===a.atTrackingVersion?u.onConsumerDependencyMayHaveChanged():(this.consumers.delete(r),u?.producers.delete(this.id))}}finally{En=i}}producerAccessed(){if(En)throw new Error("");if(null===Hi)return;let i=Hi.producers.get(this.id);void 0===i?(i={consumerNode:Hi.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Hi.trackingVersion},Hi.producers.set(this.id,i),this.consumers.set(Hi.id,i)):(i.seenValueVersion=this.valueVersion,i.atTrackingVersion=Hi.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Hi?.consumerAllowSignalWrites}producerPollStatus(i){return this.valueVersion!==i||(this.onProducerUpdateValueVersion(),this.valueVersion!==i)}}let fa=null;const Yc=()=>{};class td extends Ke{constructor(i,r,a){super(),this.watch=i,this.schedule=r,this.dirty=!1,this.cleanupFn=Yc,this.registerOnCleanup=u=>{this.cleanupFn=u},this.consumerAllowSignalWrites=a}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const i=nr(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Yc,this.watch(this.registerOnCleanup)}finally{nr(i)}}cleanup(){this.cleanupFn()}}class Ds{constructor(i,r,a){this.previousValue=i,this.currentValue=r,this.firstChange=a}isFirstChange(){return this.firstChange}}function yo(){return ll}function ll(n){return n.type.prototype.ngOnChanges&&(n.setInput=Ql),Wo}function Wo(){const n=js(this),i=n?.current;if(i){const r=n.previous;if(r===tt)n.previous=i;else for(let a in i)r[a]=i[a];n.current=null,this.ngOnChanges(i)}}function Ql(n,i,r,a){const u=this.declaredInputs[r],f=js(n)||function Ei(n,i){return n[cl]=i}(n,{previous:tt,current:null}),g=f.current||(f.current={}),x=f.previous,T=x[u];g[u]=new Ds(T&&T.currentValue,i,x===tt),n[a]=i}yo.ngInherit=!0;const cl="__ngSimpleChanges__";function js(n){return n[cl]||null}const so=function(n,i,r){},tc="svg";function Pi(n){for(;Array.isArray(n);)n=n[ki];return n}function K(n,i){return Pi(i[n])}function w(n,i){return Pi(i[n.index])}function A(n,i){return n.data[i]}function k(n,i){return n[i]}function Y(n,i){const r=i[n];return Er(r)?r:r[ki]}function Te(n){return 128==(128&n[vn])}function Hn(n,i){return null==i?null:n[i]}function qn(n){n[gn]=0}function Fn(n){1024&n[vn]||(n[vn]|=1024,Di(n,1))}function bn(n){1024&n[vn]&&(n[vn]&=-1025,Di(n,-1))}function Di(n,i){let r=n[ei];if(null===r)return;r[Vs]+=i;let a=r;for(r=r[ei];null!==r&&(1===i&&1===a[Vs]||-1===i&&0===a[Vs]);)r[Vs]+=i,a=r,r=r[ei]}const Xt={lFrame:oo(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function ur(){return Xt.bindingsEnabled}function et(){return Xt.lFrame.lView}function kt(){return Xt.lFrame.tView}function Fa(n){return Xt.lFrame.contextLView=n,n[Bi]}function ps(n){return Xt.lFrame.contextLView=null,n}function zi(){let n=rd();for(;null!==n&&64===n.type;)n=n.parent;return n}function rd(){return Xt.lFrame.currentTNode}function Cs(n,i){const r=Xt.lFrame;r.currentTNode=n,r.isParent=i}function Qr(){return Xt.lFrame.isParent}function Gr(){const n=Xt.lFrame;let i=n.bindingRootIndex;return-1===i&&(i=n.bindingRootIndex=n.tView.bindingStartIndex),i}function es(){return Xt.lFrame.bindingIndex++}function Bh(n,i){const r=Xt.lFrame;r.bindingIndex=r.bindingRootIndex=n,dl(i)}function dl(n){Xt.lFrame.currentDirectiveIndex=n}function od(){return Xt.lFrame.currentQueryIndex}function oc(n){Xt.lFrame.currentQueryIndex=n}function ms(n){const i=n[Ot];return 2===i.type?i.declTNode:1===i.type?n[Qi]:null}function As(n,i,r){if(r&st.SkipSelf){let u=i,f=n;for(;!(u=u.parent,null!==u||r&st.Host||(u=ms(f),null===u||(f=f[pr],10&u.type))););if(null===u)return!1;i=u,n=f}const a=Xt.lFrame=ac();return a.currentTNode=i,a.lView=n,!0}function qs(n){const i=ac(),r=n[Ot];Xt.lFrame=i,i.currentTNode=r.firstChild,i.lView=n,i.tView=r,i.contextLView=n,i.bindingIndex=r.bindingStartIndex,i.inI18n=!1}function ac(){const n=Xt.lFrame,i=null===n?null:n.child;return null===i?oo(n):i}function oo(n){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=i),i}function Xo(){const n=Xt.lFrame;return Xt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const ma=Xo;function Jc(){const n=Xo();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function kr(){return Xt.lFrame.selectedIndex}function xo(n){Xt.lFrame.selectedIndex=n}function oi(){const n=Xt.lFrame;return A(n.tView,n.selectedIndex)}function y(){Xt.lFrame.currentNamespace=tc}function v(){!function D(){Xt.lFrame.currentNamespace=null}()}let W=!0;function B(){return W}function se(n){W=n}function Ht(n,i){for(let r=i.directiveStart,a=i.directiveEnd;r<a;r++){const f=n.data[r].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:x,ngAfterViewInit:T,ngAfterViewChecked:L,ngOnDestroy:z}=f;g&&(n.contentHooks??=[]).push(-r,g),x&&((n.contentHooks??=[]).push(r,x),(n.contentCheckHooks??=[]).push(r,x)),T&&(n.viewHooks??=[]).push(-r,T),L&&((n.viewHooks??=[]).push(r,L),(n.viewCheckHooks??=[]).push(r,L)),null!=z&&(n.destroyHooks??=[]).push(r,z)}}function Jt(n,i,r){Qc(n,i,3,r)}function In(n,i,r,a){(3&n[vn])===r&&Qc(n,i,r,a)}function mr(n,i){let r=n[vn];(3&r)===i&&(r&=4095,r+=1,n[vn]=r)}function Qc(n,i,r,a){const f=a??-1,g=i.length-1;let x=0;for(let T=void 0!==a?65535&n[gn]:0;T<g;T++)if("number"==typeof i[T+1]){if(x=i[T],null!=a&&x>=a)break}else i[T]<0&&(n[gn]+=65536),(x<f||-1==f)&&(Yo(n,r,i,T),n[gn]=(4294901760&n[gn])+T+2),T++}function Vi(n,i){so(4,n,i);const r=nr(null);try{i.call(n)}finally{nr(r),so(5,n,i)}}function Yo(n,i,r,a){const u=r[a]<0,f=r[a+1],x=n[u?-r[a]:r[a]];u?n[vn]>>12<n[gn]>>16&&(3&n[vn])===i&&(n[vn]+=4096,Vi(x,f)):Vi(x,f)}const Gi=-1;class ga{constructor(i,r,a){this.factory=i,this.resolving=!1,this.canSeeViewProviders=r,this.injectImpl=a}}function Ev(n){return n!==Gi}function cd(n){return 32767&n}function lc(n,i){let r=function ao(n){return n>>16}(n),a=i;for(;r>0;)a=a[pr],r--;return a}let Ua=!0;function ts(n){const i=Ua;return Ua=n,i}const Ir=255,Kn=5;let Bp=0;const Rr={};function eu(n,i){const r=hl(n,i);if(-1!==r)return r;const a=i[Ot];a.firstCreatePass&&(n.injectorIndex=i.length,ka(a.data,n),ka(i,null),ka(a.blueprint,null));const u=Ba(n,i),f=n.injectorIndex;if(Ev(u)){const g=cd(u),x=lc(u,i),T=x[Ot].data;for(let L=0;L<8;L++)i[f+L]=x[g+L]|T[g+L]}return i[f+8]=u,f}function ka(n,i){n.push(0,0,0,0,0,0,0,0,i)}function hl(n,i){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===i[n.injectorIndex+8]?-1:n.injectorIndex}function Ba(n,i){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let r=0,a=null,u=i;for(;null!==u;){if(a=Vh(u),null===a)return Gi;if(r++,u=u[pr],-1!==a.injectorIndex)return a.injectorIndex|r<<16}return Gi}function tu(n,i,r){!function dd(n,i,r){let a;"string"==typeof r?a=r.charCodeAt(0)||0:r.hasOwnProperty(Ui)&&(a=r[Ui]),null==a&&(a=r[Ui]=Bp++);const u=a&Ir;i.data[n+(u>>Kn)]|=1<<u}(n,i,r)}function nu(n,i,r){if(r&st.Optional||void 0!==n)return n;pn()}function iu(n,i,r,a){if(r&st.Optional&&void 0===a&&(a=null),!(r&(st.Self|st.Host))){const u=n[go],f=Ai(void 0);try{return u?u.get(i,a,r&st.Optional):Ln(i,a,r&st.Optional)}finally{Ai(f)}}return nu(a,0,r)}function ru(n,i,r,a=st.Default,u){if(null!==n){if(2048&i[vn]){const g=function Sv(n,i,r,a,u){let f=n,g=i;for(;null!==f&&null!==g&&2048&g[vn]&&!(512&g[vn]);){const x=zh(f,g,r,a|st.Self,Rr);if(x!==Rr)return x;let T=f.parent;if(!T){const L=g[nl];if(L){const z=L.get(r,Rr,a);if(z!==Rr)return z}T=Vh(g),g=g[pr]}f=T}return u}(n,i,r,a,Rr);if(g!==Rr)return g}const f=zh(n,i,r,a,Rr);if(f!==Rr)return f}return iu(i,r,a,u)}function zh(n,i,r,a,u){const f=function fd(n){if("string"==typeof n)return n.charCodeAt(0)||0;const i=n.hasOwnProperty(Ui)?n[Ui]:void 0;return"number"==typeof i?i>=0?i&Ir:cc:i}(r);if("function"==typeof f){if(!As(i,n,a))return a&st.Host?nu(u,0,a):iu(i,r,a,u);try{const g=f(a);if(null!=g||a&st.Optional)return g;pn()}finally{ma()}}else if("number"==typeof f){let g=null,x=hl(n,i),T=Gi,L=a&st.Host?i[Yi][Qi]:null;for((-1===x||a&st.SkipSelf)&&(T=-1===x?Ba(n,i):i[x+8],T!==Gi&&zp(a,!1)?(g=i[Ot],x=cd(T),i=lc(T,i)):x=-1);-1!==x;){const z=i[Ot];if(ns(f,x,z.data)){const Z=Hp(x,i,r,g,a,L);if(Z!==Rr)return Z}T=i[x+8],T!==Gi&&zp(a,i[Ot].data[x+8]===L)&&ns(f,x,i)?(g=z,x=cd(T),i=lc(T,i)):x=-1}}return u}function Hp(n,i,r,a,u,f){const g=i[Ot],x=g.data[n+8],z=su(x,g,r,null==a?ws(x)&&Ua:a!=g&&0!=(3&x.type),u&st.Host&&f===x);return null!==z?qo(i,g,z,x):Rr}function su(n,i,r,a,u){const f=n.providerIndexes,g=i.data,x=1048575&f,T=n.directiveStart,z=f>>20,ae=u?x+z:n.directiveEnd;for(let pe=a?x:x+z;pe<ae;pe++){const $e=g[pe];if(pe<T&&r===$e||pe>=T&&$e.type===r)return pe}if(u){const pe=g[T];if(pe&&fs(pe)&&pe.type===r)return T}return null}function qo(n,i,r,a){let u=n[r];const f=i.data;if(function G_(n){return n instanceof ga}(u)){const g=u;g.resolving&&function it(n,i){const r=i?`. Dependency path: ${i.join(" > ")} > ${n}`:"";throw new ge(-200,`Circular dependency in DI detected for ${n}${r}`)}(function ke(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():He(n)}(f[r]));const x=ts(g.canSeeViewProviders);g.resolving=!0;const T=g.injectImpl?Ai(g.injectImpl):null;As(n,a,st.Default);try{u=n[r]=g.factory(void 0,f,n,a),i.firstCreatePass&&r>=a.directiveStart&&function ot(n,i,r){const{ngOnChanges:a,ngOnInit:u,ngDoCheck:f}=i.type.prototype;if(a){const g=ll(i);(r.preOrderHooks??=[]).push(n,g),(r.preOrderCheckHooks??=[]).push(n,g)}u&&(r.preOrderHooks??=[]).push(0-n,u),f&&((r.preOrderHooks??=[]).push(n,f),(r.preOrderCheckHooks??=[]).push(n,f))}(r,f[r],i)}finally{null!==T&&Ai(T),ts(x),g.resolving=!1,ma()}}return u}function ns(n,i,r){return!!(r[i+(n>>Kn)]&1<<n)}function zp(n,i){return!(n&st.Self||n&st.Host&&i)}class va{constructor(i,r){this._tNode=i,this._lView=r}get(i,r,a){return ru(this._tNode,this._lView,i,Se(a),r)}}function cc(){return new va(zi(),et())}function fl(n){return q(()=>{const i=n.prototype.constructor,r=i[mi]||Wr(i),a=Object.prototype;let u=Object.getPrototypeOf(n.prototype).constructor;for(;u&&u!==a;){const f=u[mi]||Wr(u);if(f&&f!==r)return f;u=Object.getPrototypeOf(u)}return f=>new f})}function Wr(n){return an(n)?()=>{const i=Wr(ht(n));return i&&i()}:zo(n)}function Vh(n){const i=n[Ot],r=i.type;return 2===r?i.declTNode:1===r?n[Qi]:null}function Gh(n){return function hd(n,i){if("class"===i)return n.classes;if("style"===i)return n.styles;const r=n.attrs;if(r){const a=r.length;let u=0;for(;u<a;){const f=r[u];if(no(f))break;if(0===f)u+=2;else if("number"==typeof f)for(u++;u<a&&"string"==typeof r[u];)u++;else{if(f===i)return r[u+1];u+=2}}}return null}(zi(),n)}const dc="__parameters__";function Eo(n,i,r){return q(()=>{const a=function Pr(n){return function(...r){if(n){const a=n(...r);for(const u in a)this[u]=a[u]}}}(i);function u(...f){if(this instanceof u)return a.apply(this,f),this;const g=new u(...f);return x.annotation=g,x;function x(T,L,z){const Z=T.hasOwnProperty(dc)?T[dc]:Object.defineProperty(T,dc,{value:[]})[dc];for(;Z.length<=z;)Z.push(null);return(Z[z]=Z[z]||[]).push(g),T}}return r&&(u.prototype=Object.create(r.prototype)),u.prototype.ngMetadataName=n,u.annotationCls=u,u})}function au(n,i){n.forEach(r=>Array.isArray(r)?au(r,i):i(r))}function Wp(n,i,r){i>=n.length?n.push(r):n.splice(i,0,r)}function md(n,i){return i>=n.length-1?n.pop():n.splice(i,1)[0]}function Ks(n,i,r){let a=fc(n,i);return a>=0?n[1|a]=r:(a=~a,function Cv(n,i,r,a){let u=n.length;if(u==i)n.push(r,a);else if(1===u)n.push(a,n[0]),n[0]=r;else{for(u--,n.push(n[u-1],n[u]);u>i;)n[u]=n[u-2],u--;n[i]=r,n[i+1]=a}}(n,a,i,r)),a}function jh(n,i){const r=fc(n,i);if(r>=0)return n[1|r]}function fc(n,i){return function $p(n,i,r){let a=0,u=n.length>>r;for(;u!==a;){const f=a+(u-a>>1),g=n[f<<r];if(i===g)return f<<r;g>i?u=f:a=f+1}return~(u<<r)}(n,i,1)}const vd=ee(Eo("Optional"),8),yd=ee(Eo("SkipSelf"),4);function xd(n){return 128==(128&n.flags)}var Ko=(()=>((Ko=Ko||{})[Ko.Important=1]="Important",Ko[Ko.DashCase=2]="DashCase",Ko))();const Qh=new Map;let Jv=0;const tf="__ngContext__";function is(n,i){Er(i)?(n[tf]=i[Fo],function ey(n){Qh.set(n[Fo],n)}(i)):n[tf]=i}let nf;function rf(n,i){return nf(n,i)}function Sd(n){const i=n[ei];return xi(i)?i[ei]:i}function um(n){return cy(n[vo])}function dm(n){return cy(n[Dr])}function cy(n){for(;null!==n&&!xi(n);)n=n[Dr];return n}function du(n,i,r,a,u){if(null!=a){let f,g=!1;xi(a)?f=a:Er(a)&&(g=!0,a=a[ki]);const x=Pi(a);0===n&&null!==r?null==u?py(i,r,x):gc(i,r,x,u||null,!0):1===n&&null!==r?gc(i,r,x,u||null,!0):2===n?function bd(n,i,r){const a=lf(n,i);a&&function yM(n,i,r,a){n.removeChild(i,r,a)}(n,a,i,r)}(i,x,g):3===n&&i.destroyNode(x),null!=f&&function gl(n,i,r,a,u){const f=r[Ws];f!==Pi(r)&&du(i,n,a,f,u);for(let x=ar;x<r.length;x++){const T=r[x];ml(T[Ot],T,n,i,a,f)}}(i,n,f,r,u)}}function af(n,i,r){return n.createElement(i,r)}function dy(n,i){const r=n[Na],a=r.indexOf(i);bn(i),r.splice(a,1)}function fm(n,i){if(n.length<=ar)return;const r=ar+i,a=n[r];if(a){const u=a[bs];null!==u&&u!==n&&dy(u,a),i>0&&(n[r-1][Dr]=a[Dr]);const f=md(n,ar+i);!function uM(n,i){ml(n,i,i[un],2,null,null),i[ki]=null,i[Qi]=null}(a[Ot],a);const g=f[er];null!==g&&g.detachView(f[Ot]),a[ei]=null,a[Dr]=null,a[vn]&=-129}return a}function hy(n,i){if(!(256&i[vn])){const r=i[un];i[ra]?.destroy(),i[il]?.destroy(),r.destroyNode&&ml(n,i,r,3,null,null),function fM(n){let i=n[vo];if(!i)return pm(n[Ot],n);for(;i;){let r=null;if(Er(i))r=i[vo];else{const a=i[ar];a&&(r=a)}if(!r){for(;i&&!i[Dr]&&i!==n;)Er(i)&&pm(i[Ot],i),i=i[ei];null===i&&(i=n),Er(i)&&pm(i[Ot],i),r=i&&i[Dr]}i=r}}(i)}}function pm(n,i){if(!(256&i[vn])){i[vn]&=-129,i[vn]|=256,function vM(n,i){let r;if(null!=n&&null!=(r=n.destroyHooks))for(let a=0;a<r.length;a+=2){const u=i[r[a]];if(!(u instanceof ga)){const f=r[a+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const x=u[f[g]],T=f[g+1];so(4,x,T);try{T.call(x)}finally{so(5,x,T)}}else{so(4,u,f);try{f.call(u)}finally{so(5,u,f)}}}}}(n,i),function gM(n,i){const r=n.cleanup,a=i[Oo];if(null!==r)for(let f=0;f<r.length-1;f+=2)if("string"==typeof r[f]){const g=r[f+3];g>=0?a[g]():a[-g].unsubscribe(),f+=2}else r[f].call(a[r[f+1]]);null!==a&&(i[Oo]=null);const u=i[hs];if(null!==u){for(let f=0;f<u.length;f++)(0,u[f])();i[hs]=null}}(n,i),1===i[Ot].type&&i[un].destroy();const r=i[bs];if(null!==r&&xi(i[ei])){r!==i[ei]&&dy(r,i);const a=i[er];null!==a&&a.detachView(n)}!function ty(n){Qh.delete(n[Fo])}(i)}}function mm(n,i,r){return function fy(n,i,r){let a=i;for(;null!==a&&40&a.type;)a=(i=a).parent;if(null===a)return r[ki];{const{componentOffset:u}=a;if(u>-1){const{encapsulation:f}=n.data[a.directiveStart+u];if(f===Ie.None||f===Ie.Emulated)return null}return w(a,r)}}(n,i.parent,r)}function gc(n,i,r,a,u){n.insertBefore(i,r,a,u)}function py(n,i,r){n.appendChild(i,r)}function my(n,i,r,a,u){null!==a?gc(n,i,r,a,u):py(n,i,r)}function lf(n,i){return n.parentNode(i)}let Ft,ya,Dd,Cd,$n=function vy(n,i,r){return 40&n.type?w(n,r):null};function pl(n,i,r,a){const u=mm(n,a,i),f=i[un],x=function gy(n,i,r){return $n(n,i,r)}(a.parent||i[Qi],a,i);if(null!=u)if(Array.isArray(r))for(let T=0;T<r.length;T++)my(f,u,r[T],x,!1);else my(f,u,r,x,!1);void 0!==Ft&&Ft(f,a,i,r,u)}function hu(n,i){if(null!==i){const r=i.type;if(3&r)return w(i,n);if(4&r)return cf(-1,n[i.index]);if(8&r){const a=i.child;if(null!==a)return hu(n,a);{const u=n[i.index];return xi(u)?cf(-1,u):Pi(u)}}if(32&r)return rf(i,n)()||Pi(n[i.index]);{const a=gm(n,i);return null!==a?Array.isArray(a)?a[0]:hu(Sd(n[Yi]),a):hu(n,i.next)}}return null}function gm(n,i){return null!==i?n[Yi][Qi].projection[i.projection]:null}function cf(n,i){const r=ar+n+1;if(r<i.length){const a=i[r],u=a[Ot].firstChild;if(null!==u)return hu(a,u)}return i[Ws]}function uf(n,i,r,a,u,f,g){for(;null!=r;){const x=a[r.index],T=r.type;if(g&&0===i&&(x&&is(Pi(x),a),r.flags|=2),32!=(32&r.flags))if(8&T)uf(n,i,r.child,a,u,f,!1),du(i,n,u,x,f);else if(32&T){const L=rf(r,a);let z;for(;z=L();)du(i,n,u,z,f);du(i,n,u,x,f)}else 16&T?df(n,i,a,r,u,f):du(i,n,u,x,f);r=g?r.projectionNext:r.next}}function ml(n,i,r,a,u,f){uf(r,a,n.firstChild,i,u,f,!1)}function df(n,i,r,a,u,f){const g=r[Yi],T=g[Qi].projection[a.projection];if(Array.isArray(T))for(let L=0;L<T.length;L++)du(i,n,u,T[L],f);else{let L=T;const z=g[ei];xd(a)&&(L.flags|=128),uf(n,i,L,z,u,f,!0)}}function wd(n,i,r){""===r?n.removeAttribute(i,"class"):n.setAttribute(i,"class",r)}function Ha(n,i,r){const{mergedAttrs:a,classes:u,styles:f}=r;null!==a&&Zr(n,i,a),null!==u&&wd(n,i,u),null!==f&&function ym(n,i,r){n.setAttribute(i,"style",r)}(n,i,f)}function vl(n){return function Td(){if(void 0===ya&&(ya=null,Zn.trustedTypes))try{ya=Zn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ya}()?.createHTML(n)||n}function Mm(n){Dd=n}function Sm(n){return function pf(){if(void 0===Cd&&(Cd=null,Zn.trustedTypes))try{Cd=Zn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Cd}()?.createScriptURL(n)||n}class _l{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Pt})`}}class My extends _l{getTypeName(){return"HTML"}}class xy extends _l{getTypeName(){return"Style"}}class Ey extends _l{getTypeName(){return"Script"}}class bm extends _l{getTypeName(){return"URL"}}class wm extends _l{getTypeName(){return"ResourceURL"}}function Jo(n){return n instanceof _l?n.changingThisBreaksApplicationSecurity:n}function Ml(n,i){const r=function Tm(n){return n instanceof _l&&n.getTypeName()||null}(n);if(null!=r&&r!==i){if("ResourceURL"===r&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${r} (see ${Pt})`)}return r===i}function Dm(n){return new My(n)}function Cm(n){return new xy(n)}function Am(n){return new Ey(n)}function Im(n){return new bm(n)}function yc(n){return new wm(n)}class Lr{constructor(i){this.inertDocumentHelper=i}getInertBodyElement(i){i="<body><remove></remove>"+i;try{const r=(new window.DOMParser).parseFromString(vl(i),"text/html").body;return null===r?this.inertDocumentHelper.getInertBodyElement(i):(r.removeChild(r.firstChild),r)}catch{return null}}}class Ad{constructor(i){this.defaultDoc=i,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(i){const r=this.inertDocument.createElement("template");return r.innerHTML=vl(i),r}}const by=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Id(n){return(n=String(n)).match(by)?n:"unsafe:"+n}function _a(n){const i={};for(const r of n.split(","))i[r]=!0;return i}function fu(...n){const i={};for(const r of n)for(const a in r)r.hasOwnProperty(a)&&(i[a]=!0);return i}const Rm=_a("area,br,col,hr,img,wbr"),Pm=_a("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Lm=_a("rp,rt"),mf=fu(Rm,fu(Pm,_a("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),fu(Lm,_a("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),fu(Lm,Pm)),gf=_a("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Nm=fu(gf,_a("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),_a("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),wy=_a("script,style,template");class Ty{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(i){let r=i.firstChild,a=!0;for(;r;)if(r.nodeType===Node.ELEMENT_NODE?a=this.startElement(r):r.nodeType===Node.TEXT_NODE?this.chars(r.nodeValue):this.sanitizedSomething=!0,a&&r.firstChild)r=r.firstChild;else for(;r;){r.nodeType===Node.ELEMENT_NODE&&this.endElement(r);let u=this.checkClobberedElement(r,r.nextSibling);if(u){r=u;break}r=this.checkClobberedElement(r,r.parentNode)}return this.buf.join("")}startElement(i){const r=i.nodeName.toLowerCase();if(!mf.hasOwnProperty(r))return this.sanitizedSomething=!0,!wy.hasOwnProperty(r);this.buf.push("<"),this.buf.push(r);const a=i.attributes;for(let u=0;u<a.length;u++){const f=a.item(u),g=f.name,x=g.toLowerCase();if(!Nm.hasOwnProperty(x)){this.sanitizedSomething=!0;continue}let T=f.value;gf[x]&&(T=Id(T)),this.buf.push(" ",g,'="',Om(T),'"')}return this.buf.push(">"),!0}endElement(i){const r=i.nodeName.toLowerCase();mf.hasOwnProperty(r)&&!Rm.hasOwnProperty(r)&&(this.buf.push("</"),this.buf.push(r),this.buf.push(">"))}chars(i){this.buf.push(Om(i))}checkClobberedElement(i,r){if(r&&(i.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`);return r}}const Dy=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Cy=/([^\#-~ |!])/g;function Om(n){return n.replace(/&/g,"&amp;").replace(Dy,function(i){return"&#"+(1024*(i.charCodeAt(0)-55296)+(i.charCodeAt(1)-56320)+65536)+";"}).replace(Cy,function(i){return"&#"+i.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Rd;function Fm(n,i){let r=null;try{Rd=Rd||function br(n){const i=new Ad(n);return function Sy(){try{return!!(new window.DOMParser).parseFromString(vl(""),"text/html")}catch{return!1}}()?new Lr(i):i}(n);let a=i?String(i):"";r=Rd.getInertBodyElement(a);let u=5,f=a;do{if(0===u)throw new Error("Failed to sanitize html because the input is unstable");u--,a=f,f=r.innerHTML,r=Rd.getInertBodyElement(a)}while(a!==f);return vl((new Ty).sanitizeChildren(vf(r)||r))}finally{if(r){const a=vf(r)||r;for(;a.firstChild;)a.removeChild(a.firstChild)}}}function vf(n){return"content"in n&&function Ay(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var gr=(()=>((gr=gr||{})[gr.NONE=0]="NONE",gr[gr.HTML=1]="HTML",gr[gr.STYLE=2]="STYLE",gr[gr.SCRIPT=3]="SCRIPT",gr[gr.URL=4]="URL",gr[gr.RESOURCE_URL=5]="RESOURCE_URL",gr))();function yf(n){const i=pu();return i?i.sanitize(gr.URL,n)||"":Ml(n,"URL")?Jo(n):Id(He(n))}function Um(n){const i=pu();if(i)return Sm(i.sanitize(gr.RESOURCE_URL,n)||"");if(Ml(n,"ResourceURL"))return Sm(Jo(n));throw new ge(904,!1)}function km(n,i,r){return function Oy(n,i){return"src"===i&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===i&&("base"===n||"link"===n)?Um:yf}(i,r)(n)}function pu(){const n=et();return n&&n[Ss].sanitizer}class Si{constructor(i,r){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof r?this.__NG_ELEMENT_ID__=r:void 0!==r&&(this.\u0275prov=ri({token:this,providedIn:r.providedIn||"root",factory:r.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const mu=new Si("ENVIRONMENT_INITIALIZER"),Bm=new Si("INJECTOR",-1),Hm=new Si("INJECTOR_DEF_TYPES");class zm{get(i,r=xn){if(r===xn){const a=new Error(`NullInjectorError: No provider for ${Le(i)}!`);throw a.name="NullInjectorError",a}return r}}function gu(n){return{\u0275providers:n}}function _f(...n){return{\u0275providers:Vm(0,n),\u0275fromNgModule:!0}}function Vm(n,...i){const r=[],a=new Set;let u;return au(i,f=>{const g=f;Pd(g,r,[],a)&&(u||=[],u.push(g))}),void 0!==u&&vu(u,r),r}function vu(n,i){for(let r=0;r<n.length;r++){const{providers:u}=n[r];Mf(u,f=>{i.push(f)})}}function Pd(n,i,r,a){if(!(n=ht(n)))return!1;let u=null,f=fi(n);const g=!f&&si(n);if(f||g){if(g&&!g.standalone)return!1;u=n}else{const T=n.ngModule;if(f=fi(T),!f)return!1;u=T}const x=a.has(u);if(g){if(x)return!1;if(a.add(u),g.dependencies){const T="function"==typeof g.dependencies?g.dependencies():g.dependencies;for(const L of T)Pd(L,i,r,a)}}else{if(!f)return!1;{if(null!=f.imports&&!x){let L;a.add(u);try{au(f.imports,z=>{Pd(z,i,r,a)&&(L||=[],L.push(z))})}finally{}void 0!==L&&vu(L,i)}if(!x){const L=zo(u)||(()=>new u);i.push({provide:u,useFactory:L,deps:Qe},{provide:Hm,useValue:u,multi:!0},{provide:mu,useValue:()=>cr(u),multi:!0})}const T=f.providers;null==T||x||Mf(T,z=>{i.push(z)})}}return u!==n&&void 0!==n.providers}function Mf(n,i){for(let r of n)Pn(r)&&(r=r.\u0275providers),Array.isArray(r)?Mf(r,i):i(r)}const Fy=me({provide:String,useValue:me});function Ld(n){return null!==n&&"object"==typeof n&&Fy in n}function xl(n){return"function"==typeof n}const xf=new Si("Set Injector scope."),za={},$m={};let Nd;function Od(){return void 0===Nd&&(Nd=new zm),Nd}class Ma{}class Ef extends Ma{get destroyed(){return this._destroyed}constructor(i,r,a,u){super(),this.parent=r,this.source=a,this.scopes=u,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,wf(i,g=>this.processProvider(g)),this.records.set(Bm,_c(void 0,this)),u.has("environment")&&this.records.set(Ma,_c(void 0,this));const f=this.records.get(xf);null!=f&&"string"==typeof f.value&&this.scopes.add(f.value),this.injectorDefTypes=new Set(this.get(Hm.multi,Qe,st.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();for(const i of this._onDestroyHooks)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(i){return this.assertNotDestroyed(),this._onDestroyHooks.push(i),()=>this.removeOnDestroy(i)}runInContext(i){this.assertNotDestroyed();const r=Yr(this),a=Ai(void 0);try{return i()}finally{Yr(r),Ai(a)}}get(i,r=xn,a=st.Default){if(this.assertNotDestroyed(),i.hasOwnProperty(xr))return i[xr](this);a=Se(a);const u=Yr(this),f=Ai(void 0);try{if(!(a&st.SkipSelf)){let x=this.records.get(i);if(void 0===x){const T=function zy(n){return"function"==typeof n||"object"==typeof n&&n instanceof Si}(i)&&Zi(i);x=T&&this.injectableDefInScope(T)?_c(Sf(i),za):null,this.records.set(i,x)}if(null!=x)return this.hydrate(i,x)}return(a&st.Self?Od():this.parent).get(i,r=a&st.Optional&&r===xn?null:r)}catch(g){if("NullInjectorError"===g.name){if((g[wr]=g[wr]||[]).unshift(Le(i)),u)throw g;return function lt(n,i,r,a){const u=n[wr];throw i[xs]&&u.unshift(i[xs]),n.message=function oe(n,i,r,a=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let u=Le(i);if(Array.isArray(i))u=i.map(Le).join(" -> ");else if("object"==typeof i){let f=[];for(let g in i)if(i.hasOwnProperty(g)){let x=i[g];f.push(g+":"+("string"==typeof x?JSON.stringify(x):Le(x)))}u=`{${f.join(", ")}}`}return`${r}${a?"("+a+")":""}[${u}]: ${n.replace(Xr,"\n  ")}`}("\n"+n.message,u,r,a),n.ngTokenPath=u,n[wr]=null,n}(g,i,"R3InjectorError",this.source)}throw g}finally{Ai(f),Yr(u)}}resolveInjectorInitializers(){const i=Yr(this),r=Ai(void 0);try{const a=this.get(mu.multi,Qe,st.Self);for(const u of a)u()}finally{Yr(i),Ai(r)}}toString(){const i=[],r=this.records;for(const a of r.keys())i.push(Le(a));return`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ge(205,!1)}processProvider(i){let r=xl(i=ht(i))?i:ht(i&&i.provide);const a=function ky(n){return Ld(n)?_c(void 0,n.useValue):_c(bf(n),za)}(i);if(xl(i)||!0!==i.multi)this.records.get(r);else{let u=this.records.get(r);u||(u=_c(void 0,za,!0),u.factory=()=>ce(u.multi),this.records.set(r,u)),r=i,u.multi.push(i)}this.records.set(r,a)}hydrate(i,r){return r.value===za&&(r.value=$m,r.value=r.factory()),"object"==typeof r.value&&r.value&&function Hy(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(r.value)&&this._ngOnDestroyHooks.add(r.value),r.value}injectableDefInScope(i){if(!i.providedIn)return!1;const r=ht(i.providedIn);return"string"==typeof r?"any"===r||this.scopes.has(r):this.injectorDefTypes.has(r)}removeOnDestroy(i){const r=this._onDestroyHooks.indexOf(i);-1!==r&&this._onDestroyHooks.splice(r,1)}}function Sf(n){const i=Zi(n),r=null!==i?i.factory:zo(n);if(null!==r)return r;if(n instanceof Si)throw new ge(204,!1);if(n instanceof Function)return function jm(n){const i=n.length;if(i>0)throw function lu(n,i){const r=[];for(let a=0;a<n;a++)r.push(i);return r}(i,"?"),new ge(204,!1);const r=function Mn(n){return n&&(n[_i]||n[Ci])||null}(n);return null!==r?()=>r.factory(n):()=>new n}(n);throw new ge(204,!1)}function bf(n,i,r){let a;if(xl(n)){const u=ht(n);return zo(u)||Sf(u)}if(Ld(n))a=()=>ht(n.useValue);else if(function Wm(n){return!(!n||!n.useFactory)}(n))a=()=>n.useFactory(...ce(n.deps||[]));else if(function Gm(n){return!(!n||!n.useExisting)}(n))a=()=>cr(ht(n.useExisting));else{const u=ht(n&&(n.useClass||n.provide));if(!function By(n){return!!n.deps}(n))return zo(u)||Sf(u);a=()=>new u(...ce(n.deps))}return a}function _c(n,i,r=!1){return{factory:n,value:i,multi:r?[]:void 0}}function wf(n,i){for(const r of n)Array.isArray(r)?wf(r,i):r&&Pn(r)?wf(r.\u0275providers,i):i(r)}const Xm=new Si("AppId",{providedIn:"root",factory:()=>Vy}),Vy="ng",Ym=new Si("Platform Initializer"),Tf=new Si("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Gy=new Si("CSP nonce",{providedIn:"root",factory:()=>function yl(){if(void 0!==Dd)return Dd;if(typeof document<"u")return document;throw new ge(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Vd=(n,i)=>null;function Km(n,i){return Vd(n,i)}class Mc{}class xc{}class bu{resolveComponentFactory(i){throw function Ec(n){const i=Error(`No component factory found for ${Le(n)}.`);return i.ngComponent=n,i}(i)}}let wu=(()=>{class n{}return n.NULL=new bu,n})();function Wd(){return Qo(zi(),et())}function Qo(n,i){return new Ga(w(n,i))}let Ga=(()=>{class n{constructor(r){this.nativeElement=r}}return n.__NG_ELEMENT_ID__=Wd,n})();function tg(n){return n instanceof Ga?n.nativeElement:n}class $d{}let ng=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Zy(){const n=et(),r=Y(zi().index,n);return(Er(r)?r:n)[un]}(),n})(),jd=(()=>{class n{}return n.\u0275prov=ri({token:n,providedIn:"root",factory:()=>null}),n})();class Tu{constructor(i){this.full=i,this.major=i.split(".")[0],this.minor=i.split(".")[1],this.patch=i.split(".").slice(2).join(".")}}const ig=new Tu("16.0.1"),Rf={};function Sc(n){for(;n;){n[vn]|=64;const i=Sd(n);if(sa(n)&&!i)return n;n=i}return null}function Lf(n){return n.ngOriginalError}class bl{constructor(){this._console=console}handleError(i){const r=this._findOriginalError(i);this._console.error("ERROR",i),r&&this._console.error("ORIGINAL ERROR",r)}_findOriginalError(i){let r=i&&Lf(i);for(;r&&Lf(r);)r=Lf(r);return r||null}}const Nf=new Si("",{providedIn:"root",factory:()=>!1});function ea(n){return n instanceof Function?n():n}class Uf extends Ke{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(i){this._lView=i}onConsumerDependencyMayHaveChanged(){Sc(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(i,r,a){const u=nr(this);this.trackingVersion++;try{i(r,a)}finally{nr(u)}}destroy(){this.trackingVersion++}}let Iu=null;function Yd(){return Iu??=new Uf,Iu}function Ru(n,i){return n[i]??Yd()}function Pu(n,i){const r=Yd();r.hasReadASignal&&(n[i]=Iu,r.lView=n,Iu=new Uf)}const On={};function kf(n){Bf(kt(),et(),kr()+n,!1)}function Bf(n,i,r,a){if(!a)if(3==(3&i[vn])){const f=n.preOrderCheckHooks;null!==f&&Jt(i,f,r)}else{const f=n.preOrderHooks;null!==f&&In(i,f,0,r)}xo(r)}function t0(n,i=null,r=null,a){const u=n0(n,i,r,a);return u.resolveInjectorInitializers(),u}function n0(n,i=null,r=null,a,u=new Set){const f=[r||Qe,_f(n)];return a=a||("object"==typeof n?void 0:Le(n)),new Ef(f,i||Od(),a||null,u)}let $r=(()=>{class n{static create(r,a){if(Array.isArray(r))return t0({name:""},a,r,"");{const u=r.name??"";return t0({name:u},r.parent,r.providers,u)}}}return n.THROW_IF_NOT_FOUND=xn,n.NULL=new zm,n.\u0275prov=ri({token:n,providedIn:"any",factory:()=>cr(Bm)}),n.__NG_ELEMENT_ID__=-1,n})();function Wa(n,i=st.Default){const r=et();return null===r?cr(n,i):ru(zi(),r,ht(n),i)}function ag(){throw new Error("invalid")}function wl(n,i,r,a,u,f,g,x,T,L,z){const Z=i.blueprint.slice();return Z[ki]=u,Z[vn]=140|a,(null!==L||n&&2048&n[vn])&&(Z[vn]|=2048),qn(Z),Z[ei]=Z[pr]=n,Z[Bi]=r,Z[Ss]=g||n&&n[Ss],Z[un]=x||n&&n[un],Z[go]=T||n&&n[go]||null,Z[Qi]=f,Z[Fo]=function Qv(){return Jv++}(),Z[Gs]=z,Z[nl]=L,Z[Yi]=2==i.type?n[Yi]:Z,Z}function $a(n,i,r,a,u){let f=n.data[i];if(null===f)f=function Nu(n,i,r,a,u){const f=rd(),g=Qr(),T=n.data[i]=function jf(n,i,r,a,u,f){let g=i?i.injectorIndex:-1,x=0;return function $o(){return null!==Xt.skipHydrationRootTNode}()&&(x|=128),{type:r,index:a,insertBeforeIndex:null,injectorIndex:g,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:x,providerIndexes:0,value:u,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,r,i,a,u);return null===n.firstChild&&(n.firstChild=T),null!==f&&(g?null==f.child&&null!==T.parent&&(f.child=T):null===f.next&&(f.next=T,T.prev=f)),T}(n,i,r,a,u),function rc(){return Xt.lFrame.inI18n}()&&(f.flags|=32);else if(64&f.type){f.type=r,f.value=a,f.attrs=u;const g=function Xs(){const n=Xt.lFrame,i=n.currentTNode;return n.isParent?i:i.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return Cs(f,!0),f}function Tl(n,i,r,a){if(0===r)return-1;const u=i.length;for(let f=0;f<r;f++)i.push(a),n.blueprint.push(a),n.data.push(null);return u}function lg(n,i,r,a,u){const f=Ru(i,ra),g=kr(),x=2&a;try{if(xo(-1),x&&i.length>Yn&&Bf(n,i,Yn,!1),so(x?2:0,u),x)f.runInContext(r,a,u);else{const L=nr(null);try{r(a,u)}finally{nr(L)}}}finally{x&&null===i[ra]&&Pu(i,ra),xo(g),so(x?3:1,u)}}function Zd(n,i,r){if(Wl(i)){const a=nr(null);try{const f=i.directiveEnd;for(let g=i.directiveStart;g<f;g++){const x=n.data[g];x.contentQueries&&x.contentQueries(1,r[g],g)}}finally{nr(a)}}}function Wf(n,i,r){ur()&&(function Cl(n,i,r,a){const u=r.directiveStart,f=r.directiveEnd;ws(r)&&function mg(n,i,r){const a=w(i,n),g=ih(n,wl(n,cg(r),null,r.onPush?64:16,a,i,null,n[Ss].rendererFactory.createRenderer(a,r),null,null,null));n[i.index]=g}(i,r,n.data[u+r.componentOffset]),n.firstCreatePass||eu(r,i),is(a,i);const g=r.initialInputs;for(let x=u;x<f;x++){const T=n.data[x],L=qo(i,n,x,r);is(L,i),null!==g&&d0(0,x-u,L,T,0,g),fs(T)&&(Y(r.index,i)[Bi]=qo(i,n,x,r))}}(n,i,r,w(r,i)),64==(64&r.flags)&&Qd(n,i,r))}function $f(n,i,r=w){const a=i.localNames;if(null!==a){let u=i.index+1;for(let f=0;f<a.length;f+=2){const g=a[f+1],x=-1===g?r(i,n):n[g];n[u++]=x}}}function cg(n){const i=n.tView;return null===i||i.incompleteFirstPass?n.tView=Dl(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):i}function Dl(n,i,r,a,u,f,g,x,T,L,z){const Z=Yn+a,ae=Z+u,pe=function r0(n,i){const r=[];for(let a=0;a<i;a++)r.push(a<n?null:On);return r}(Z,ae),$e="function"==typeof L?L():L;return pe[Ot]={type:n,blueprint:pe,template:r,queries:null,viewQuery:x,declTNode:i,data:pe.slice().fill(null,Z),bindingStartIndex:Z,expandoStartIndex:ae,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:T,consts:$e,incompleteFirstPass:!1,ssrId:z}}let ug=n=>null;function hg(n,i,r,a){for(let u in n)if(n.hasOwnProperty(u)){r=null===r?{}:r;const f=n[u];null===a?Xf(r,i,u,f):a.hasOwnProperty(u)&&Xf(r,i,a[u],f)}return r}function Xf(n,i,r,a){n.hasOwnProperty(r)?n[r].push(i,a):n[r]=[i,a]}function Fu(n,i,r,a){if(ur()){const u=null===a?null:{"":-1},f=function th(n,i){const r=n.directiveRegistry;let a=null,u=null;if(r)for(let f=0;f<r.length;f++){const g=r[f];if(Ca(i,g.selectors,!1))if(a||(a=[]),fs(g))if(null!==g.findHostDirectiveDefs){const x=[];u=u||new Map,g.findHostDirectiveDefs(g,x,u),a.unshift(...x,g),ku(n,i,x.length)}else a.unshift(g),ku(n,i,0);else u=u||new Map,g.findHostDirectiveDefs?.(g,a,u),a.push(g)}return null===a?null:[a,u]}(n,r);let g,x;null===f?g=x=null:[g,x]=f,null!==g&&Jd(n,i,r,g,u,x),u&&function nh(n,i,r){if(i){const a=n.localNames=[];for(let u=0;u<i.length;u+=2){const f=r[i[u+1]];if(null==f)throw new ge(-301,!1);a.push(i[u],f)}}}(r,a,u)}r.mergedAttrs=Us(r.mergedAttrs,r.attrs)}function Jd(n,i,r,a,u,f){for(let L=0;L<a.length;L++)tu(eu(r,i),n,a[L].type);!function wc(n,i,r){n.flags|=1,n.directiveStart=i,n.directiveEnd=i+r,n.providerIndexes=i}(r,n.data.length,a.length);for(let L=0;L<a.length;L++){const z=a[L];z.providersResolver&&z.providersResolver(z)}let g=!1,x=!1,T=Tl(n,i,a.length,null);for(let L=0;L<a.length;L++){const z=a[L];r.mergedAttrs=Us(r.mergedAttrs,z.hostAttrs),u0(n,r,i,T,z),c0(T,z,u),null!==z.contentQueries&&(r.flags|=4),(null!==z.hostBindings||null!==z.hostAttrs||0!==z.hostVars)&&(r.flags|=64);const Z=z.type.prototype;!g&&(Z.ngOnChanges||Z.ngOnInit||Z.ngDoCheck)&&((n.preOrderHooks??=[]).push(r.index),g=!0),!x&&(Z.ngOnChanges||Z.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(r.index),x=!0),T++}!function fg(n,i,r){const u=i.directiveEnd,f=n.data,g=i.attrs,x=[];let T=null,L=null;for(let z=i.directiveStart;z<u;z++){const Z=f[z],ae=r?r.get(Z):null,$e=ae?ae.outputs:null;T=hg(Z.inputs,z,T,ae?ae.inputs:null),L=hg(Z.outputs,z,L,$e);const Mt=null===T||null===g||Hr(i)?null:h0(T,z,g);x.push(Mt)}null!==T&&(T.hasOwnProperty("class")&&(i.flags|=8),T.hasOwnProperty("style")&&(i.flags|=16)),i.initialInputs=x,i.inputs=T,i.outputs=L}(n,r,f)}function Qd(n,i,r){const a=r.directiveStart,u=r.directiveEnd,f=r.index,g=function Hh(){return Xt.lFrame.currentDirectiveIndex}();try{xo(f);for(let x=a;x<u;x++){const T=n.data[x],L=i[x];dl(x),(null!==T.hostBindings||0!==T.hostVars||null!==T.hostAttrs)&&eh(T,L)}}finally{xo(-1),dl(g)}}function eh(n,i){null!==n.hostBindings&&n.hostBindings(1,i)}function ku(n,i,r){i.componentOffset=r,(n.components??=[]).push(i.index)}function c0(n,i,r){if(r){if(i.exportAs)for(let a=0;a<i.exportAs.length;a++)r[i.exportAs[a]]=n;fs(i)&&(r[""]=n)}}function u0(n,i,r,a,u){n.data[a]=u;const f=u.factory||(u.factory=zo(u.type)),g=new ga(f,fs(u),Wa);n.blueprint[a]=g,r[a]=g,function Uu(n,i,r,a,u){const f=u.hostBindings;if(f){let g=n.hostBindingOpCodes;null===g&&(g=n.hostBindingOpCodes=[]);const x=~i.index;(function qf(n){let i=n.length;for(;i>0;){const r=n[--i];if("number"==typeof r&&r<0)return r}return 0})(g)!=x&&g.push(x),g.push(r,a,f)}}(n,i,a,Tl(n,r,u.hostVars,On),u)}function ss(n,i,r,a,u,f){const g=w(n,i);!function Al(n,i,r,a,u,f,g){if(null==f)n.removeAttribute(i,u,r);else{const x=null==g?He(f):g(f,a||"",u);n.setAttribute(i,u,x,r)}}(i[un],g,f,n.value,r,a,u)}function d0(n,i,r,a,u,f){const g=f[i];if(null!==g)for(let x=0;x<g.length;)gg(a,r,g[x++],g[x++],g[x++])}function gg(n,i,r,a,u){const f=nr(null);try{null!==n.setInput?n.setInput(i,u,r,a):i[a]=u}finally{nr(f)}}function h0(n,i,r){let a=null,u=0;for(;u<r.length;){const f=r[u];if(0!==f)if(5!==f){if("number"==typeof f)break;if(n.hasOwnProperty(f)){null===a&&(a=[]);const g=n[f];for(let x=0;x<g.length;x+=2)if(g[x]===i){a.push(f,g[x+1],r[u+1]);break}}u+=2}else u+=2;else u+=4}return a}function vg(n,i,r,a){return[n,!0,!1,i,null,0,a,r,null,null,null]}function yg(n,i){const r=n.contentQueries;if(null!==r)for(let a=0;a<r.length;a+=2){const f=r[a+1];if(-1!==f){const g=n.data[f];oc(r[a]),g.contentQueries(2,i[f],f)}}}function ih(n,i){return n[vo]?n[La][Dr]=i:n[vo]=i,n[La]=i,i}function Zf(n,i,r){oc(0);const a=nr(null);try{i(n,r)}finally{nr(a)}}function _g(n){return n[Oo]||(n[Oo]=[])}function Mg(n){return n.cleanup||(n.cleanup=[])}function rh(n,i){const r=n[go],a=r?r.get(bl,null):null;a&&a.handleError(i)}function Kf(n,i,r,a,u){for(let f=0;f<r.length;){const g=r[f++],x=r[f++];gg(n.data[g],i[g],a,x,u)}}function f0(n,i){const r=Y(i,n),a=r[Ot];!function lr(n,i){for(let r=i.length;r<n.blueprint.length;r++)i.push(n.blueprint[r])}(a,r);const u=r[ki];null!==u&&null===r[Gs]&&(r[Gs]=Km(u,r[go])),Tc(a,r,r[Bi])}function Tc(n,i,r){qs(i);try{const a=n.viewQuery;null!==a&&Zf(1,a,r);const u=n.template;null!==u&&lg(n,i,u,1,r),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&yg(n,i),n.staticViewQueries&&Zf(2,n.viewQuery,r);const f=n.components;null!==f&&function Eg(n,i){for(let r=0;r<i.length;r++)f0(n,i[r])}(i,f)}catch(a){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),a}finally{i[vn]&=-5,Jc()}}let Dc=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(r,a,u){const f=typeof Zone>"u"?null:Zone.current,g=new td(r,L=>{this.all.has(L)&&this.queue.set(L,f)},u);let x;this.all.add(g),g.notify();const T=()=>{g.cleanup(),x?.(),this.all.delete(g),this.queue.delete(g)};return x=a?.onDestroy(T),{destroy:T}}flush(){if(0!==this.queue.size)for(const[r,a]of this.queue)this.queue.delete(r),a?a.run(()=>r.run()):r.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=ri({token:n,providedIn:"root",factory:()=>new n}),n})();function Bu(n,i,r){let a=r?n.styles:null,u=r?n.classes:null,f=0;if(null!==i)for(let g=0;g<i.length;g++){const x=i[g];"number"==typeof x?f=x:1==f?u=Ae(u,x):2==f&&(a=Ae(a,x+": "+i[++g]+";"))}r?n.styles=a:n.stylesWithoutHost=a,r?n.classes=u:n.classesWithoutHost=u}function Cc(n,i,r,a,u=!1){for(;null!==r;){const f=i[r.index];if(null!==f&&a.push(Pi(f)),xi(f)){for(let x=ar;x<f.length;x++){const T=f[x],L=T[Ot].firstChild;null!==L&&Cc(T[Ot],T,L,a)}f[Ws]!==f[ki]&&a.push(f[Ws])}const g=r.type;if(8&g)Cc(n,i,r.child,a);else if(32&g){const x=rf(r,i);let T;for(;T=x();)a.push(T)}else if(16&g){const x=gm(i,r);if(Array.isArray(x))a.push(...x);else{const T=Sd(i[Yi]);Cc(T[Ot],T,x,a,!0)}}r=u?r.projectionNext:r.next}return a}function ja(n,i,r,a=!0){const u=i[Ss].rendererFactory;u.begin&&u.begin();try{co(n,i,n.template,r)}catch(g){throw a&&rh(i,g),g}finally{u.end&&u.end(),i[Ss].effectManager?.flush()}}function co(n,i,r,a){const u=i[vn];if(256!=(256&u)){i[Ss].effectManager?.flush(),qs(i);try{qn(i),function jo(n){return Xt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==r&&lg(n,i,r,2,a);const g=3==(3&u);if(g){const L=n.preOrderCheckHooks;null!==L&&Jt(i,L,null)}else{const L=n.preOrderHooks;null!==L&&In(i,L,0,null),mr(i,0)}if(function wg(n){for(let i=um(n);null!==i;i=dm(i)){if(!i[Zu])continue;const r=i[Na];for(let a=0;a<r.length;a++){Fn(r[a])}}}(i),function bg(n){for(let i=um(n);null!==i;i=dm(i))for(let r=ar;r<i.length;r++){const a=i[r],u=a[Ot];Te(a)&&co(u,a,u.template,a[Bi])}}(i),null!==n.contentQueries&&yg(n,i),g){const L=n.contentCheckHooks;null!==L&&Jt(i,L)}else{const L=n.contentHooks;null!==L&&In(i,L,1),mr(i,1)}!function Gf(n,i){const r=n.hostBindingOpCodes;if(null===r)return;const a=Ru(i,il);try{for(let u=0;u<r.length;u++){const f=r[u];if(f<0)xo(~f);else{const g=f,x=r[++u],T=r[++u];Bh(x,g),a.runInContext(T,2,i[g])}}}finally{null===i[il]&&Pu(i,il),xo(-1)}}(n,i);const x=n.components;null!==x&&function g0(n,i){for(let r=0;r<i.length;r++)Jf(n,i[r])}(i,x);const T=n.viewQuery;if(null!==T&&Zf(2,T,a),g){const L=n.viewCheckHooks;null!==L&&Jt(i,L)}else{const L=n.viewHooks;null!==L&&In(i,L,2),mr(i,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),i[vn]&=-73,bn(i)}finally{Jc()}}}function Jf(n,i){const r=Y(i,n);if(Te(r)){const a=r[Ot];80&r[vn]?co(a,r,a.template,r[Bi]):r[Vs]>0&&Qf(r)}}function Qf(n){for(let a=um(n);null!==a;a=dm(a))for(let u=ar;u<a.length;u++){const f=a[u];if(Te(f))if(1024&f[vn]){const g=f[Ot];co(g,f,g.template,f[Bi])}else f[Vs]>0&&Qf(f)}const r=n[Ot].components;if(null!==r)for(let a=0;a<r.length;a++){const u=Y(r[a],n);Te(u)&&u[Vs]>0&&Qf(u)}}class Il{get rootNodes(){const i=this._lView,r=i[Ot];return Cc(r,i,r.firstChild,[])}constructor(i,r){this._lView=i,this._cdRefInjectingView=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Bi]}set context(i){this._lView[Bi]=i}get destroyed(){return 256==(256&this._lView[vn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[ei];if(xi(i)){const r=i[Gl],a=r?r.indexOf(this):-1;a>-1&&(fm(i,a),md(r,a))}this._attachedToViewContainer=!1}hy(this._lView[Ot],this._lView)}onDestroy(i){!function Nn(n,i){if(256==(256&n[vn]))throw new ge(911,!1);null===n[hs]&&(n[hs]=[]),n[hs].push(i)}(this._lView,i)}markForCheck(){Sc(this._cdRefInjectingView||this._lView)}detach(){this._lView[vn]&=-129}reattach(){this._lView[vn]|=128}detectChanges(){ja(this._lView[Ot],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function hM(n,i){ml(n,i,i[un],2,null,null)}(this._lView[Ot],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=i}}class ah extends Il{constructor(i){super(i),this._view=i}detectChanges(){const i=this._view;ja(i[Ot],i,i[Bi],!1)}checkNoChanges(){}get context(){return null}}class lh extends wu{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const r=si(i);return new Rl(r,this.ngModule)}}function ch(n){const i=[];for(let r in n)n.hasOwnProperty(r)&&i.push({propName:n[r],templateName:r});return i}class uh{constructor(i,r){this.injector=i,this.parentInjector=r}get(i,r,a){a=Se(a);const u=this.injector.get(i,Rf,a);return u!==Rf||r===Rf?u:this.parentInjector.get(i,r,a)}}class Rl extends xc{get inputs(){return ch(this.componentDef.inputs)}get outputs(){return ch(this.componentDef.outputs)}constructor(i,r){super(),this.componentDef=i,this.ngModule=r,this.componentType=i.type,this.selector=function Lo(n){return n.map(po).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!r}create(i,r,a,u){let f=(u=u||this.ngModule)instanceof Ma?u:u?.injector;f&&null!==this.componentDef.getStandaloneInjector&&(f=this.componentDef.getStandaloneInjector(f)||f);const g=f?new uh(i,f):i,x=g.get($d,null);if(null===x)throw new ge(407,!1);const z={rendererFactory:x,sanitizer:g.get(jd,null),effectManager:g.get(Dc,null)},Z=x.createRenderer(null,this.componentDef),ae=this.componentDef.selectors[0][0]||"div",pe=a?function s0(n,i,r,a){const f=a.get(Nf,!1)||r===Ie.ShadowDom,g=n.selectRootElement(i,f);return function o0(n){ug(n)}(g),g}(Z,a,this.componentDef.encapsulation,g):af(Z,ae,function v0(n){const i=n.toLowerCase();return"svg"===i?tc:"math"===i?"math":null}(ae)),$e=this.componentDef.onPush?576:528,Mt=Dl(0,null,null,1,0,null,null,null,null,null,null),Nt=wl(null,Mt,null,$e,null,null,z,Z,g,null,null);let ln,ct;qs(Nt);try{const Sn=this.componentDef;let ni,Oi=null;Sn.findHostDirectiveDefs?(ni=[],Oi=new Map,Sn.findHostDirectiveDefs(Sn,ni,Oi),ni.push(Sn)):ni=[Sn];const Da=function tp(n,i){const r=n[Ot],a=Yn;return n[a]=i,$a(r,a,2,"#host",null)}(Nt,pe),QE=function y0(n,i,r,a,u,f,g){const x=u[Ot];!function Dg(n,i,r,a){for(const u of n)i.mergedAttrs=Us(i.mergedAttrs,u.hostAttrs);null!==i.mergedAttrs&&(Bu(i,i.mergedAttrs,!0),null!==r&&Ha(a,r,i))}(a,n,i,g);let T=null;null!==i&&(T=Km(i,u[go]));const L=f.rendererFactory.createRenderer(i,r),z=wl(u,cg(r),null,r.onPush?64:16,u[n.index],n,f,L,null,null,T);return x.firstCreatePass&&ku(x,n,a.length-1),ih(u,z),u[n.index]=z}(Da,pe,Sn,ni,Nt,z,Z);ct=A(Mt,Yn),pe&&function _0(n,i,r,a){if(a)Zr(n,r,["ng-version",ig.full]);else{const{attrs:u,classes:f}=function Ia(n){const i=[],r=[];let a=1,u=2;for(;a<n.length;){let f=n[a];if("string"==typeof f)2===u?""!==f&&i.push(f,n[++a]):8===u&&r.push(f);else{if(!Or(u))break;u=f}a++}return{attrs:i,classes:r}}(i.selectors[0]);u&&Zr(n,r,u),f&&f.length>0&&wd(n,r,f.join(" "))}}(Z,Sn,pe,a),void 0!==r&&function M0(n,i,r){const a=n.projection=[];for(let u=0;u<i.length;u++){const f=r[u];a.push(null!=f?Array.from(f):null)}}(ct,this.ngContentSelectors,r),ln=function Cg(n,i,r,a,u,f){const g=zi(),x=u[Ot],T=w(g,u);Jd(x,u,g,r,null,a);for(let z=0;z<r.length;z++)is(qo(u,x,g.directiveStart+z,g),u);Qd(x,u,g),T&&is(T,u);const L=qo(u,x,g.directiveStart+g.componentOffset,g);if(n[Bi]=u[Bi]=L,null!==f)for(const z of f)z(L,i);return Zd(x,g,n),L}(QE,Sn,ni,Oi,Nt,[np]),Tc(Mt,Nt,null)}finally{Jc()}return new ep(this.componentType,ln,Qo(ct,Nt),Nt,ct)}}class ep extends Mc{constructor(i,r,a,u,f){super(),this.location=a,this._rootLView=u,this._tNode=f,this.previousInputValues=null,this.instance=r,this.hostView=this.changeDetectorRef=new ah(u),this.componentType=i}setInput(i,r){const a=this._tNode.inputs;let u;if(null!==a&&(u=a[i])){if(this.previousInputValues??=new Map,this.previousInputValues.has(i)&&Object.is(this.previousInputValues.get(i),r))return;const f=this._rootLView;Kf(f[Ot],f,u,i,r),this.previousInputValues.set(i,r),Sc(Y(this._tNode.index,f))}}get injector(){return new va(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}function np(){const n=zi();Ht(et()[Ot],n)}function ip(n){let i=function Ag(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),r=!0;const a=[n];for(;i;){let u;if(fs(n))u=i.\u0275cmp||i.\u0275dir;else{if(i.\u0275cmp)throw new ge(903,!1);u=i.\u0275dir}if(u){if(r){a.push(u);const g=n;g.inputs=rp(n.inputs),g.declaredInputs=rp(n.declaredInputs),g.outputs=rp(n.outputs);const x=u.hostBindings;x&&b0(n,x);const T=u.viewQuery,L=u.contentQueries;if(T&&E0(n,T),L&&S0(n,L),ye(n.inputs,u.inputs),ye(n.declaredInputs,u.declaredInputs),ye(n.outputs,u.outputs),fs(u)&&u.data.animation){const z=n.data;z.animation=(z.animation||[]).concat(u.data.animation)}}const f=u.features;if(f)for(let g=0;g<f.length;g++){const x=f[g];x&&x.ngInherit&&x(n),x===ip&&(r=!1)}}i=Object.getPrototypeOf(i)}!function x0(n){let i=0,r=null;for(let a=n.length-1;a>=0;a--){const u=n[a];u.hostVars=i+=u.hostVars,u.hostAttrs=Us(u.hostAttrs,r=Us(r,u.hostAttrs))}}(a)}function rp(n){return n===tt?{}:n===Qe?[]:n}function E0(n,i){const r=n.viewQuery;n.viewQuery=r?(a,u)=>{i(a,u),r(a,u)}:i}function S0(n,i){const r=n.contentQueries;n.contentQueries=r?(a,u,f)=>{i(a,u,f),r(a,u,f)}:i}function b0(n,i){const r=n.hostBindings;n.hostBindings=r?(a,u)=>{i(a,u),r(a,u)}:i}function fh(n){return!!ho(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function ho(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function wo(n,i,r){return n[i]=r}function os(n,i,r){return!Object.is(n[i],r)&&(n[i]=r,!0)}function Sa(n,i,r,a,u){const f=function To(n,i,r,a){const u=os(n,i,r);return os(n,i+1,a)||u}(n,i,r,a);return os(n,i+2,u)||f}function Ic(n,i,r,a){const u=et();return os(u,es(),i)&&(kt(),ss(oi(),u,n,i,r,a)),Ic}function Ya(n,i,r,a,u,f,g,x){const T=et(),L=kt(),z=n+Yn,Z=L.firstCreatePass?function Gg(n,i,r,a,u,f,g,x,T){const L=i.consts,z=$a(i,n,4,g||null,Hn(L,x));Fu(i,r,z,Hn(L,T)),Ht(i,z);const Z=z.tView=Dl(2,z,a,u,f,i.directiveRegistry,i.pipeRegistry,null,i.schemas,L,null);return null!==i.queries&&(i.queries.template(i,z),Z.queries=i.queries.embeddedTView(z)),z}(z,L,T,i,r,a,u,f,g):L.data[z];Cs(Z,!1);const ae=hp(L,T,Z,n);B()&&pl(L,T,ae,Z),is(ae,T),ih(T,T[z]=vg(ae,T,ae,Z)),Uo(Z)&&Wf(L,T,Z),null!=g&&$f(T,Z,x)}let hp=function Wg(n,i,r,a){return se(!0),i[un].createComment("")};function qa(n){return k(function Kc(){return Xt.lFrame.contextLView}(),Yn+n)}function xh(n,i,r){const a=et();return os(a,es(),i)&&function gs(n,i,r,a,u,f,g,x){const T=w(i,r);let z,L=i.inputs;!x&&null!=L&&(z=L[a])?(Kf(n,r,z,a,u),ws(i)&&function l0(n,i){const r=Y(i,n);16&r[vn]||(r[vn]|=64)}(r,i.index)):3&i.type&&(a=function pg(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(a),u=null!=g?g(u,i.value||"",a):u,f.setProperty(T,a,u))}(kt(),oi(),a,n,i,a[un],r,!1),xh}function fp(n,i,r,a,u){const g=u?"class":"style";Kf(n,r,i.inputs[g],g,a)}function pp(n,i,r,a){const u=et(),f=kt(),g=Yn+n,x=u[un],T=f.firstCreatePass?function Ul(n,i,r,a,u,f){const g=i.consts,T=$a(i,n,2,a,Hn(g,u));return Fu(i,r,T,Hn(g,f)),null!==T.attrs&&Bu(T,T.attrs,!1),null!==T.mergedAttrs&&Bu(T,T.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,T),T}(g,f,u,i,r,a):f.data[g],L=Eh(f,u,T,x,i,n);u[g]=L;const z=Uo(T);return Cs(T,!0),Ha(x,L,T),32!=(32&T.flags)&&B()&&pl(f,u,L,T),0===function Cr(){return Xt.lFrame.elementDepthCount}()&&is(L,u),function Ki(){Xt.lFrame.elementDepthCount++}(),z&&(Wf(f,u,T),Zd(f,T,u)),null!==a&&$f(u,T),pp}function mp(){let n=zi();Qr()?function ul(){Xt.lFrame.isParent=!1}():(n=n.parent,Cs(n,!1));const i=n;(function nc(n){return Xt.skipHydrationRootTNode===n})(i)&&function Zc(){Xt.skipHydrationRootTNode=null}(),function Ar(){Xt.lFrame.elementDepthCount--}();const r=kt();return r.firstCreatePass&&(Ht(r,n),Wl(n)&&r.queries.elementEnd(n)),null!=i.classesWithoutHost&&function W_(n){return 0!=(8&n.flags)}(i)&&fp(r,i,et(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function kp(n){return 0!=(16&n.flags)}(i)&&fp(r,i,et(),i.stylesWithoutHost,!1),mp}function gp(n,i,r,a){return pp(n,i,r,a),mp(),gp}let Eh=(n,i,r,a,u,f)=>(se(!0),af(a,u,function O(){return Xt.lFrame.currentNamespace}()));function Xg(){return et()}function Wi(n){return!!n&&"function"==typeof n.then}function V0(n){return!!n&&"function"==typeof n.subscribe}function Mp(n,i,r,a){const u=et(),f=kt(),g=zi();return function xp(n,i,r,a,u,f,g){const x=Uo(a),L=n.firstCreatePass&&Mg(n),z=i[Bi],Z=_g(i);let ae=!0;if(3&a.type||g){const Mt=w(a,i),Nt=g?g(Mt):Mt,ln=Z.length,ct=g?ni=>g(Pi(ni[a.index])):a.index;let Sn=null;if(!g&&x&&(Sn=function qM(n,i,r,a){const u=n.cleanup;if(null!=u)for(let f=0;f<u.length-1;f+=2){const g=u[f];if(g===r&&u[f+1]===a){const x=i[Oo],T=u[f+2];return x.length>T?x[T]:null}"string"==typeof g&&(f+=2)}return null}(n,i,u,a.index)),null!==Sn)(Sn.__ngLastListenerFn__||Sn).__ngNextListenerFn__=f,Sn.__ngLastListenerFn__=f,ae=!1;else{f=G0(a,i,z,f,!1);const ni=r.listen(Nt,u,f);Z.push(f,ni),L&&L.push(u,ct,ln,ln+1)}}else f=G0(a,i,z,f,!1);const pe=a.outputs;let $e;if(ae&&null!==pe&&($e=pe[u])){const Mt=$e.length;if(Mt)for(let Nt=0;Nt<Mt;Nt+=2){const Oi=i[$e[Nt]][$e[Nt+1]].subscribe(f),Da=Z.length;Z.push(f,Oi),L&&L.push(u,a.index,Da,-(Da+1))}}}(f,u,u[un],g,n,i,a),Mp}function qg(n,i,r,a){try{return so(6,i,r),!1!==r(a)}catch(u){return rh(n,u),!1}finally{so(7,i,r)}}function G0(n,i,r,a,u){return function f(g){if(g===Function)return a;Sc(n.componentOffset>-1?Y(n.index,i):i);let T=qg(i,r,a,g),L=f.__ngNextListenerFn__;for(;L;)T=qg(i,r,L,g)&&T,L=L.__ngNextListenerFn__;return u&&!1===T&&(g.preventDefault(),g.returnValue=!1),T}}function W0(n=1){return function ad(n){return(Xt.lFrame.contextLView=function ld(n,i){for(;n>0;)i=i[pr],n--;return i}(n,Xt.lFrame.contextLView))[Bi]}(n)}function Co(n,i){return n<<17|i<<2}function Ao(n){return n>>17&32767}function bh(n){return 2|n}function Uc(n){return(131068&n)>>2}function Tp(n,i){return-131069&n|i<<2}function wh(n){return 1|n}function Wu(n,i,r,a,u){const f=n[r+1],g=null===i;let x=a?Ao(f):Uc(f),T=!1;for(;0!==x&&(!1===T||g);){const z=n[x+1];ev(n[x],i)&&(T=!0,n[x+1]=a?wh(z):bh(z)),x=a?Ao(z):Uc(z)}T&&(n[r+1]=a?bh(f):wh(f))}function ev(n,i){return null===n||null==i||(Array.isArray(n)?n[1]:n)===i||!(!Array.isArray(n)||"string"!=typeof i)&&fc(n,i)>=0}function nv(n,i,r){return ta(n,i,r,!1),nv}function iv(n,i){return ta(n,i,null,!0),iv}function ta(n,i,r,a){const u=et(),f=kt(),g=function Ys(n){const i=Xt.lFrame,r=i.bindingIndex;return i.bindingIndex=i.bindingIndex+n,r}(2);f.firstUpdatePass&&function Q0(n,i,r,a){const u=n.data;if(null===u[r+1]){const f=u[kr()],g=function J0(n,i){return i>=n.expandoStartIndex}(n,r);(function av(n,i){return 0!=(n.flags&(i?8:16))})(f,a)&&null===i&&!g&&(i=!1),i=function rx(n,i,r,a){const u=function sc(n){const i=Xt.lFrame.currentDirectiveIndex;return-1===i?null:n[i]}(n);let f=a?i.residualClasses:i.residualStyles;if(null===u)0===(a?i.classBindings:i.styleBindings)&&(r=Ah(r=rv(null,n,i,r,a),i.attrs,a),f=null);else{const g=i.directiveStylingLast;if(-1===g||n[g]!==u)if(r=rv(u,n,i,r,a),null===f){let T=function sx(n,i,r){const a=r?i.classBindings:i.styleBindings;if(0!==Uc(a))return n[Ao(a)]}(n,i,a);void 0!==T&&Array.isArray(T)&&(T=rv(null,n,i,T[1],a),T=Ah(T,i.attrs,a),function ox(n,i,r,a){n[Ao(r?i.classBindings:i.styleBindings)]=a}(n,i,a,T))}else f=function ax(n,i,r){let a;const u=i.directiveEnd;for(let f=1+i.directiveStylingLast;f<u;f++)a=Ah(a,n[f].hostAttrs,r);return Ah(a,i.attrs,r)}(n,i,a)}return void 0!==f&&(a?i.residualClasses=f:i.residualStyles=f),r}(u,f,i,a),function QM(n,i,r,a,u,f){let g=f?i.classBindings:i.styleBindings,x=Ao(g),T=Uc(g);n[a]=r;let z,L=!1;if(Array.isArray(r)?(z=r[1],(null===z||fc(r,z)>0)&&(L=!0)):z=r,u)if(0!==T){const ae=Ao(n[x+1]);n[a+1]=Co(ae,x),0!==ae&&(n[ae+1]=Tp(n[ae+1],a)),n[x+1]=function JM(n,i){return 131071&n|i<<17}(n[x+1],a)}else n[a+1]=Co(x,0),0!==x&&(n[x+1]=Tp(n[x+1],a)),x=a;else n[a+1]=Co(T,0),0===x?x=a:n[T+1]=Tp(n[T+1],a),T=a;L&&(n[a+1]=bh(n[a+1])),Wu(n,z,a,!0),Wu(n,z,a,!1),function Qg(n,i,r,a,u){const f=u?n.residualClasses:n.residualStyles;null!=f&&"string"==typeof i&&fc(f,i)>=0&&(r[a+1]=wh(r[a+1]))}(i,z,n,a,f),g=Co(x,T),f?i.classBindings=g:i.styleBindings=g}(u,f,i,r,g,a)}}(f,n,g,a),i!==On&&os(u,g,i)&&function sv(n,i,r,a,u,f,g,x){if(!(3&i.type))return;const T=n.data,L=T[x+1],z=function Jg(n){return 1==(1&n)}(L)?ov(T,i,r,u,Uc(L),g):void 0;Ih(z)||(Ih(f)||function wp(n){return 2==(2&n)}(L)&&(f=ov(T,null,r,u,x,g)),function hf(n,i,r,a,u){if(i)u?n.addClass(r,a):n.removeClass(r,a);else{let f=-1===a.indexOf("-")?void 0:Ko.DashCase;null==u?n.removeStyle(r,a,f):("string"==typeof u&&u.endsWith("!important")&&(u=u.slice(0,-10),f|=Ko.Important),n.setStyle(r,a,u,f))}}(a,g,K(kr(),r),u,f))}(f,f.data[kr()],u,u[un],n,u[g+1]=function n_(n,i){return null==n||""===n||("string"==typeof i?n+=i:"object"==typeof n&&(n=Le(Jo(n)))),n}(i,r),a,g)}function rv(n,i,r,a,u){let f=null;const g=r.directiveEnd;let x=r.directiveStylingLast;for(-1===x?x=r.directiveStart:x++;x<g&&(f=i[x],a=Ah(a,f.hostAttrs,u),f!==n);)x++;return null!==n&&(r.directiveStylingLast=x),a}function Ah(n,i,r){const a=r?1:2;let u=-1;if(null!==i)for(let f=0;f<i.length;f++){const g=i[f];"number"==typeof g?u=g:u===a&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ks(n,g,!!r||i[++f]))}return void 0===n?null:n}function ov(n,i,r,a,u,f){const g=null===i;let x;for(;u>0;){const T=n[u],L=Array.isArray(T),z=L?T[1]:T,Z=null===z;let ae=r[u+1];ae===On&&(ae=Z?Qe:void 0);let pe=Z?jh(ae,a):z===a?ae:void 0;if(L&&!Ih(pe)&&(pe=jh(T,a)),Ih(pe)&&(x=pe,g))return x;const $e=n[u+1];u=g?Ao($e):Uc($e)}if(null!==i){let T=f?i.residualClasses:i.residualStyles;null!=T&&(x=jh(T,a))}return x}function Ih(n){return void 0!==n}function lv(n,i=""){const r=et(),a=kt(),u=n+Yn,f=a.firstCreatePass?$a(a,u,1,i,null):a.data[u],g=cv(a,r,f,i,n);r[u]=g,B()&&pl(a,r,g,f),Cs(f,!1)}let cv=(n,i,r,a,u)=>(se(!0),function sf(n,i){return n.createText(i)}(i[un],a));function t(n){return s("",n,""),t}function s(n,i,r){const a=et(),u=function Pc(n,i,r,a){return os(n,es(),r)?i+He(r)+a:On}(a,n,i,r);return u!==On&&function Ps(n,i,r){const a=K(i,n);!function uy(n,i,r){n.setValue(i,r)}(n[un],a,r)}(a,kr(),u),s}const Lt=void 0;var de=["en",[["a","p"],["AM","PM"],Lt],[["AM","PM"],Lt,Lt],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Lt,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Lt,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Lt,"{1} 'at' {0}",Lt],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Gt(n){const r=Math.floor(Math.abs(n)),a=n.toString().replace(/^[^.]*\.?/,"").length;return 1===r&&0===a?1:5}];let yn={};function It(n){const i=function Bt(n){return n.toLowerCase().replace(/_/g,"-")}(n);let r=Ye(i);if(r)return r;const a=i.split("-")[0];if(r=Ye(a),r)return r;if("en"===a)return de;throw new ge(701,!1)}function _t(n){return It(n)[nt.PluralCase]}function Ye(n){return n in yn||(yn[n]=Zn.ng&&Zn.ng.common&&Zn.ng.common.locales&&Zn.ng.common.locales[n]),yn[n]}var nt=(()=>((nt=nt||{})[nt.LocaleId=0]="LocaleId",nt[nt.DayPeriodsFormat=1]="DayPeriodsFormat",nt[nt.DayPeriodsStandalone=2]="DayPeriodsStandalone",nt[nt.DaysFormat=3]="DaysFormat",nt[nt.DaysStandalone=4]="DaysStandalone",nt[nt.MonthsFormat=5]="MonthsFormat",nt[nt.MonthsStandalone=6]="MonthsStandalone",nt[nt.Eras=7]="Eras",nt[nt.FirstDayOfWeek=8]="FirstDayOfWeek",nt[nt.WeekendRange=9]="WeekendRange",nt[nt.DateFormat=10]="DateFormat",nt[nt.TimeFormat=11]="TimeFormat",nt[nt.DateTimeFormat=12]="DateTimeFormat",nt[nt.NumberSymbols=13]="NumberSymbols",nt[nt.NumberFormats=14]="NumberFormats",nt[nt.CurrencyCode=15]="CurrencyCode",nt[nt.CurrencySymbol=16]="CurrencySymbol",nt[nt.CurrencyName=17]="CurrencyName",nt[nt.Currencies=18]="Currencies",nt[nt.Directionality=19]="Directionality",nt[nt.PluralCase=20]="PluralCase",nt[nt.ExtraData=21]="ExtraData",nt))();const cn="en-US";let bt=cn;function o_(n,i,r,a,u){if(n=ht(n),Array.isArray(n))for(let f=0;f<n.length;f++)o_(n[f],i,r,a,u);else{const f=kt(),g=et();let x=xl(n)?n:ht(n.provide),T=bf(n);const L=zi(),z=1048575&L.providerIndexes,Z=L.directiveStart,ae=L.providerIndexes>>20;if(xl(n)||!n.multi){const pe=new ga(T,u,Wa),$e=l_(x,i,u?z:z+ae,Z);-1===$e?(tu(eu(L,g),f,x),a_(f,n,i.length),i.push(x),L.directiveStart++,L.directiveEnd++,u&&(L.providerIndexes+=1048576),r.push(pe),g.push(pe)):(r[$e]=pe,g[$e]=pe)}else{const pe=l_(x,i,z+ae,Z),$e=l_(x,i,z,z+ae),Nt=$e>=0&&r[$e];if(u&&!Nt||!u&&!(pe>=0&&r[pe])){tu(eu(L,g),f,x);const ln=function TS(n,i,r,a,u){const f=new ga(n,r,Wa);return f.multi=[],f.index=i,f.componentProviders=0,px(f,u,a&&!r),f}(u?wS:bS,r.length,u,a,T);!u&&Nt&&(r[$e].providerFactory=ln),a_(f,n,i.length,0),i.push(x),L.directiveStart++,L.directiveEnd++,u&&(L.providerIndexes+=1048576),r.push(ln),g.push(ln)}else a_(f,n,pe>-1?pe:$e,px(r[u?$e:pe],T,!u&&a));!u&&a&&Nt&&r[$e].componentProviders++}}}function a_(n,i,r,a){const u=xl(i),f=function Uy(n){return!!n.useClass}(i);if(u||f){const T=(f?ht(i.useClass):i).prototype.ngOnDestroy;if(T){const L=n.destroyHooks||(n.destroyHooks=[]);if(!u&&i.multi){const z=L.indexOf(r);-1===z?L.push(r,[a,T]):L[z+1].push(a,T)}else L.push(r,T)}}}function px(n,i,r){return r&&n.componentProviders++,n.multi.push(i)-1}function l_(n,i,r,a){for(let u=r;u<a;u++)if(i[u]===n)return u;return-1}function bS(n,i,r,a){return c_(this.multi,[])}function wS(n,i,r,a){const u=this.multi;let f;if(this.providerFactory){const g=this.providerFactory.componentProviders,x=qo(r,r[Ot],this.providerFactory.index,a);f=x.slice(0,g),c_(u,f);for(let T=g;T<x.length;T++)f.push(x[T])}else f=[],c_(u,f);return f}function c_(n,i){for(let r=0;r<n.length;r++)i.push((0,n[r])());return i}function mx(n,i=[]){return r=>{r.providersResolver=(a,u)=>function SS(n,i,r){const a=kt();if(a.firstCreatePass){const u=fs(n);o_(r,a.data,a.blueprint,u,!0),o_(i,a.data,a.blueprint,u,!1)}}(a,u?u(n):n,i)}}class Ph{}class gx{}function DS(n,i){return new u_(n,i??null,[])}class u_ extends Ph{constructor(i,r,a){super(),this._parent=r,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new lh(this);const u=or(i);this._bootstrapComponents=ea(u.bootstrap),this._r3Injector=n0(i,r,[{provide:Ph,useValue:this},{provide:wu,useValue:this.componentFactoryResolver},...a],Le(i),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(i)}get injector(){return this._r3Injector}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(r=>r()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class d_ extends gx{constructor(i){super(),this.moduleType=i}create(i){return new u_(this.moduleType,i,[])}}class vx extends Ph{constructor(i){super(),this.componentFactoryResolver=new lh(this),this.instance=null;const r=new Ef([...i.providers,{provide:Ph,useValue:this},{provide:wu,useValue:this.componentFactoryResolver}],i.parent||Od(),i.debugName,new Set(["environment"]));this.injector=r,i.runEnvironmentInitializers&&r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(i){this.injector.onDestroy(i)}}function yx(n,i,r=null){return new vx({providers:n,parent:i,debugName:r,runEnvironmentInitializers:!0}).injector}let AS=(()=>{class n{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r.id)){const a=Vm(0,r.type),u=a.length>0?yx([a],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r.id,u)}return this.cachedInjectors.get(r.id)}ngOnDestroy(){try{for(const r of this.cachedInjectors.values())null!==r&&r.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=ri({token:n,providedIn:"environment",factory:()=>new n(cr(Ma))}),n})();function _x(n){n.getStandaloneInjector=i=>i.get(AS).getOrCreateStandaloneInjector(n)}function Pp(n,i){const r=n[i];return r===On?void 0:r}function Rx(n,i){const r=kt();let a;const u=n+Yn;r.firstCreatePass?(a=function YS(n,i){if(i)for(let r=i.length-1;r>=0;r--){const a=i[r];if(n===a.name)return a}}(i,r.pipeRegistry),r.data[u]=a,a.onDestroy&&(r.destroyHooks??=[]).push(u,a.onDestroy)):a=r.data[u];const f=a.factory||(a.factory=zo(a.type)),g=Ai(Wa);try{const x=ts(!1),T=f();return ts(x),function YM(n,i,r,a){r>=n.data.length&&(n.data[r]=null,n.blueprint[r]=null),i[r]=a}(r,et(),u,T),T}finally{Ai(g)}}function Px(n,i,r){const a=n+Yn,u=et(),f=k(u,a);return Lp(u,a)?function Tx(n,i,r,a,u,f){const g=i+r;return os(n,g,u)?wo(n,g+1,f?a.call(f,u):a(u)):Pp(n,g+1)}(u,Gr(),i,f.transform,r,f):f.transform(r)}function Lx(n,i,r,a,u){const f=n+Yn,g=et(),x=k(g,f);return Lp(g,f)?function Cx(n,i,r,a,u,f,g,x){const T=i+r;return Sa(n,T,u,f,g)?wo(n,T+3,x?a.call(x,u,f,g):a(u,f,g)):Pp(n,T+3)}(g,Gr(),i,x.transform,r,a,u,x):x.transform(r,a,u)}function Lp(n,i){return n[Ot].data[i].pure}function f_(n){return i=>{setTimeout(n,void 0,i)}}const Ja=class JS extends M.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,r,a){let u=i,f=r||(()=>null),g=a;if(i&&"object"==typeof i){const T=i;u=T.next?.bind(T),f=T.error?.bind(T),g=T.complete?.bind(T)}this.__isAsync&&(f=f_(f),u&&(u=f_(u)),g&&(g=f_(g)));const x=super.subscribe({next:u,error:f,complete:g});return i instanceof fe.w0&&i.add(x),x}};function QS(){return this._results[Symbol.iterator]()}class p_{get changes(){return this._changes||(this._changes=new Ja)}constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const r=p_.prototype;r[Symbol.iterator]||(r[Symbol.iterator]=QS)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,r){return this._results.reduce(i,r)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,r){const a=this;a.dirty=!1;const u=function lo(n){return n.flat(Number.POSITIVE_INFINITY)}(i);(this._changesDetected=!function Tv(n,i,r){if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++){let u=n[a],f=i[a];if(r&&(u=r(u),f=r(f)),f!==u)return!1}return!0}(a._results,u,r))&&(a._results=u,a.length=u.length,a.last=u[this.length-1],a.first=u[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Np=(()=>{class n{}return n.__NG_ELEMENT_ID__=nb,n})();const eb=Np,tb=class extends eb{constructor(i,r,a){super(),this._declarationLView=i,this._declarationTContainer=r,this.elementRef=a}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(i,r){return this.createEmbeddedViewImpl(i,r,null)}createEmbeddedViewImpl(i,r,a){const u=this._declarationTContainer.tView,f=wl(this._declarationLView,u,i,16,null,u.declTNode,null,null,null,r||null,a||null);f[bs]=this._declarationLView[this._declarationTContainer.index];const x=this._declarationLView[er];return null!==x&&(f[er]=x.createEmbeddedView(u)),Tc(u,f,i),new Il(f)}};function nb(){return fv(zi(),et())}function fv(n,i){return 4&n.type?new tb(i,n,Qo(n,i)):null}let pv=(()=>{class n{}return n.__NG_ELEMENT_ID__=cb,n})();function cb(){return Bx(zi(),et())}const ub=pv,Ux=class extends ub{constructor(i,r,a){super(),this._lContainer=i,this._hostTNode=r,this._hostLView=a}get element(){return Qo(this._hostTNode,this._hostLView)}get injector(){return new va(this._hostTNode,this._hostLView)}get parentInjector(){const i=Ba(this._hostTNode,this._hostLView);if(Ev(i)){const r=lc(i,this._hostLView),a=cd(i);return new va(r[Ot].data[a+8],r)}return new va(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const r=kx(this._lContainer);return null!==r&&r[i]||null}get length(){return this._lContainer.length-ar}createEmbeddedView(i,r,a){let u,f;"number"==typeof a?u=a:null!=a&&(u=a.index,f=a.injector);const x=i.createEmbeddedViewImpl(r||{},f,null);return this.insertImpl(x,u,false),x}createComponent(i,r,a,u,f){const g=i&&!function Zo(n){return"function"==typeof n}(i);let x;if(g)x=r;else{const Mt=r||{};x=Mt.index,a=Mt.injector,u=Mt.projectableNodes,f=Mt.environmentInjector||Mt.ngModuleRef}const T=g?i:new Rl(si(i)),L=a||this.parentInjector;if(!f&&null==T.ngModule){const Nt=(g?L:this.parentInjector).get(Ma,null);Nt&&(f=Nt)}si(T.componentType??{});const pe=T.create(L,u,null,f);return this.insertImpl(pe.hostView,x,false),pe}insert(i,r){return this.insertImpl(i,r,!1)}insertImpl(i,r,a){const u=i._lView,f=u[Ot];if(function Wt(n){return xi(n[ei])}(u)){const T=this.indexOf(i);if(-1!==T)this.detach(T);else{const L=u[ei],z=new Ux(L,L[Qi],L[ei]);z.detach(z.indexOf(i))}}const g=this._adjustIndex(r),x=this._lContainer;if(function pM(n,i,r,a){const u=ar+a,f=r.length;a>0&&(r[u-1][Dr]=i),a<f-ar?(i[Dr]=r[u],Wp(r,ar+a,i)):(r.push(i),i[Dr]=null),i[ei]=r;const g=i[bs];null!==g&&r!==g&&function mM(n,i){const r=n[Na];i[Yi]!==i[ei][ei][Yi]&&(n[Zu]=!0),null===r?n[Na]=[i]:r.push(i)}(g,i);const x=i[er];null!==x&&x.insertView(n),i[vn]|=128}(f,u,x,g),!a){const T=cf(g,x),L=u[un],z=lf(L,x[Ws]);null!==z&&function dM(n,i,r,a,u,f){a[ki]=u,a[Qi]=i,ml(n,a,r,1,u,f)}(f,x[Qi],L,u,z,T)}return i.attachToViewContainerRef(),Wp(g_(x),g,i),i}move(i,r){return this.insert(i,r)}indexOf(i){const r=kx(this._lContainer);return null!==r?r.indexOf(i):-1}remove(i){const r=this._adjustIndex(i,-1),a=fm(this._lContainer,r);a&&(md(g_(this._lContainer),r),hy(a[Ot],a))}detach(i){const r=this._adjustIndex(i,-1),a=fm(this._lContainer,r);return a&&null!=md(g_(this._lContainer),r)?new Il(a):null}_adjustIndex(i,r=0){return i??this.length+r}};function kx(n){return n[Gl]}function g_(n){return n[Gl]||(n[Gl]=[])}function Bx(n,i){let r;const a=i[n.index];return xi(a)?r=a:(r=vg(a,i,null,n),i[n.index]=r,ih(i,r)),Hx(r,i,n,a),new Ux(r,n,i)}let Hx=function zx(n,i,r,a){if(n[Ws])return;let u;u=8&r.type?Pi(a):function db(n,i){const r=n[un],a=r.createComment(""),u=w(i,n);return gc(r,lf(r,u),a,function _M(n,i){return n.nextSibling(i)}(r,u),!1),a}(i,r),n[Ws]=u};class v_{constructor(i){this.queryList=i,this.matches=null}clone(){return new v_(this.queryList)}setDirty(){this.queryList.setDirty()}}class y_{constructor(i=[]){this.queries=i}createEmbeddedView(i){const r=i.queries;if(null!==r){const a=null!==i.contentQueries?i.contentQueries[0]:r.length,u=[];for(let f=0;f<a;f++){const g=r.getByIndex(f);u.push(this.queries[g.indexInDeclarationView].clone())}return new y_(u)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let r=0;r<this.queries.length;r++)null!==Zx(i,r).matches&&this.queries[r].setDirty()}}class Vx{constructor(i,r,a=null){this.predicate=i,this.flags=r,this.read=a}}class __{constructor(i=[]){this.queries=i}elementStart(i,r){for(let a=0;a<this.queries.length;a++)this.queries[a].elementStart(i,r)}elementEnd(i){for(let r=0;r<this.queries.length;r++)this.queries[r].elementEnd(i)}embeddedTView(i){let r=null;for(let a=0;a<this.length;a++){const u=null!==r?r.length:0,f=this.getByIndex(a).embeddedTView(i,u);f&&(f.indexInDeclarationView=a,null!==r?r.push(f):r=[f])}return null!==r?new __(r):null}template(i,r){for(let a=0;a<this.queries.length;a++)this.queries[a].template(i,r)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class M_{constructor(i,r=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=r}elementStart(i,r){this.isApplyingToNode(r)&&this.matchTNode(i,r)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,r){this.elementStart(i,r)}embeddedTView(i,r){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,r),new M_(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const r=this._declarationNodeIndex;let a=i.parent;for(;null!==a&&8&a.type&&a.index!==r;)a=a.parent;return r===(null!==a?a.index:-1)}return this._appliesToNextNode}matchTNode(i,r){const a=this.metadata.predicate;if(Array.isArray(a))for(let u=0;u<a.length;u++){const f=a[u];this.matchTNodeWithReadOption(i,r,pb(r,f)),this.matchTNodeWithReadOption(i,r,su(r,i,f,!1,!1))}else a===Np?4&r.type&&this.matchTNodeWithReadOption(i,r,-1):this.matchTNodeWithReadOption(i,r,su(r,i,a,!1,!1))}matchTNodeWithReadOption(i,r,a){if(null!==a){const u=this.metadata.read;if(null!==u)if(u===Ga||u===pv||u===Np&&4&r.type)this.addMatch(r.index,-2);else{const f=su(r,i,u,!1,!1);null!==f&&this.addMatch(r.index,f)}else this.addMatch(r.index,a)}}addMatch(i,r){null===this.matches?this.matches=[i,r]:this.matches.push(i,r)}}function pb(n,i){const r=n.localNames;if(null!==r)for(let a=0;a<r.length;a+=2)if(r[a]===i)return r[a+1];return null}function gb(n,i,r,a){return-1===r?function mb(n,i){return 11&n.type?Qo(n,i):4&n.type?fv(n,i):null}(i,n):-2===r?function vb(n,i,r){return r===Ga?Qo(i,n):r===Np?fv(i,n):r===pv?Bx(i,n):void 0}(n,i,a):qo(n,n[Ot],r,i)}function Gx(n,i,r,a){const u=i[er].queries[a];if(null===u.matches){const f=n.data,g=r.matches,x=[];for(let T=0;T<g.length;T+=2){const L=g[T];x.push(L<0?null:gb(i,f[L],g[T+1],r.metadata.read))}u.matches=x}return u.matches}function x_(n,i,r,a){const u=n.queries.getByIndex(r),f=u.matches;if(null!==f){const g=Gx(n,i,u,r);for(let x=0;x<f.length;x+=2){const T=f[x];if(T>0)a.push(g[x/2]);else{const L=f[x+1],z=i[-T];for(let Z=ar;Z<z.length;Z++){const ae=z[Z];ae[bs]===ae[ei]&&x_(ae[Ot],ae,L,a)}if(null!==z[Na]){const Z=z[Na];for(let ae=0;ae<Z.length;ae++){const pe=Z[ae];x_(pe[Ot],pe,L,a)}}}}}return a}function Wx(n){const i=et(),r=kt(),a=od();oc(a+1);const u=Zx(r,a);if(n.dirty&&function ve(n){return 4==(4&n[vn])}(i)===(2==(2&u.metadata.flags))){if(null===u.matches)n.reset([]);else{const f=u.crossesNgTemplate?x_(r,i,a,[]):Gx(r,i,u,a);n.reset(f,tg),n.notifyOnChanges()}return!0}return!1}function $x(n,i,r){const a=kt();a.firstCreatePass&&(qx(a,new Vx(n,i,r),-1),2==(2&i)&&(a.staticViewQueries=!0)),Yx(a,et(),i)}function jx(n,i,r,a){const u=kt();if(u.firstCreatePass){const f=zi();qx(u,new Vx(i,r,a),f.index),function _b(n,i){const r=n.contentQueries||(n.contentQueries=[]);i!==(r.length?r[r.length-1]:-1)&&r.push(n.queries.length-1,i)}(u,n),2==(2&r)&&(u.staticContentQueries=!0)}Yx(u,et(),r)}function Xx(){return function yb(n,i){return n[er].queries[i].queryList}(et(),od())}function Yx(n,i,r){const a=new p_(4==(4&r));(function a0(n,i,r,a){const u=_g(i);u.push(r),n.firstCreatePass&&Mg(n).push(a,u.length-1)})(n,i,a,a.destroy),null===i[er]&&(i[er]=new y_),i[er].queries.push(new v_(a))}function qx(n,i,r){null===n.queries&&(n.queries=new __),n.queries.track(new M_(i,r))}function Zx(n,i){return n.queries.getByIndex(i)}function Kx(n,i){return fv(n,i)}function E_(n){return!!or(n)}const pE=new Si("Application Initializer");let D_=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,a)=>{this.resolve=r,this.reject=a}),this.appInits=ui(pE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const r=[];for(const u of this.appInits){const f=u();if(Wi(f))r.push(f);else if(V0(f)){const g=new Promise((x,T)=>{f.subscribe({complete:x,error:T})});r.push(g)}}const a=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{a()}).catch(u=>{this.reject(u)}),0===r.length&&a(),this.initialized=!0}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ri({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),mE=(()=>{class n{log(r){console.log(r)}warn(r){console.warn(r)}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ri({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const gv=new Si("LocaleId",{providedIn:"root",factory:()=>ui(gv,st.Optional|st.SkipSelf)||function Hb(){return typeof $localize<"u"&&$localize.locale||cn}()}),zb=new Si("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Vb{constructor(i,r){this.ngModuleFactory=i,this.componentFactories=r}}let Gb=(()=>{class n{compileModuleSync(r){return new d_(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){const a=this.compileModuleSync(r),f=ea(or(r).declarations).reduce((g,x)=>{const T=si(x);return T&&g.push(new Rl(T)),g},[]);return new Vb(a,f)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ri({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jb=(()=>Promise.resolve(0))();function C_(n){typeof Zone>"u"?jb.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}function yE(...n){}class Ns{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:a=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ja(!1),this.onMicrotaskEmpty=new Ja(!1),this.onStable=new Ja(!1),this.onError=new Ja(!1),typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();const u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!a&&r,u.shouldCoalesceRunChangeDetection=a,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function Xb(){let n=Zn.requestAnimationFrame,i=Zn.cancelAnimationFrame;if(typeof Zone<"u"&&n&&i){const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r);const a=i[Zone.__symbol__("OriginalDelegate")];a&&(i=a)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:i}}().nativeRequestAnimationFrame,function Zb(n){const i=()=>{!function qb(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Zn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,I_(n),n.isCheckStableRunning=!0,A_(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),I_(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(r,a,u,f,g,x)=>{try{return _E(n),r.invokeTask(u,f,g,x)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||n.shouldCoalesceRunChangeDetection)&&i(),ME(n)}},onInvoke:(r,a,u,f,g,x,T)=>{try{return _E(n),r.invoke(u,f,g,x,T)}finally{n.shouldCoalesceRunChangeDetection&&i(),ME(n)}},onHasTask:(r,a,u,f)=>{r.hasTask(u,f),a===u&&("microTask"==f.change?(n._hasPendingMicrotasks=f.microTask,I_(n),A_(n)):"macroTask"==f.change&&(n.hasPendingMacrotasks=f.macroTask))},onHandleError:(r,a,u,f)=>(r.handleError(u,f),n.runOutsideAngular(()=>n.onError.emit(f)),!1)})}(u)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ns.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(Ns.isInAngularZone())throw new ge(909,!1)}run(i,r,a){return this._inner.run(i,r,a)}runTask(i,r,a,u){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+u,i,Yb,yE,yE);try{return f.runTask(g,r,a)}finally{f.cancelTask(g)}}runGuarded(i,r,a){return this._inner.runGuarded(i,r,a)}runOutsideAngular(i){return this._outer.run(i)}}const Yb={};function A_(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function I_(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function _E(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function ME(n){n._nesting--,A_(n)}const xE=new Si("",{providedIn:"root",factory:EE});function EE(){const n=ui(Ns);let i=!0;return function dt(...n){const i=(0,Ve.yG)(n),r=(0,Ve._6)(n,1/0),a=n;return a.length?1===a.length?(0,Me.Xf)(a[0]):(0,Re.J)(r)((0,Dt.D)(a,i)):Ee.E}(new De.y(u=>{i=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{u.next(i),u.complete()})}),new De.y(u=>{let f;n.runOutsideAngular(()=>{f=n.onStable.subscribe(()=>{Ns.assertNotInAngularZone(),C_(()=>{!i&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(i=!0,u.next(!0))})})});const g=n.onUnstable.subscribe(()=>{Ns.assertInAngularZone(),i&&(i=!1,n.runOutsideAngular(()=>{u.next(!1)}))});return()=>{f.unsubscribe(),g.unsubscribe()}}).pipe((0,Ze.B)()))}const SE=new Si(""),bE=new Si("");let R_,Jb=(()=>{class n{constructor(r,a,u){this._ngZone=r,this.registry=a,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,R_||(function Qb(n){R_=n}(u),u.addToWindow(a)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ns.assertNotInAngularZone(),C_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())C_(()=>{for(;0!==this._callbacks.length;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb(this._didWork)}this._didWork=!1});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(a=>!a.updateCb||!a.updateCb(r)||(clearTimeout(a.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,a,u){let f=-1;a&&a>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),r(this._didWork,this.getPendingTasks())},a)),this._callbacks.push({doneCb:r,timeoutId:f,updateCb:u})}whenStable(r,a,u){if(u&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,a,u),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,a,u){return[]}}return n.\u0275fac=function(r){return new(r||n)(cr(Ns),cr(wE),cr(bE))},n.\u0275prov=ri({token:n,factory:n.\u0275fac}),n})(),wE=(()=>{class n{constructor(){this._applications=new Map}registerApplication(r,a){this._applications.set(r,a)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,a=!0){return R_?.findTestabilityInTree(this,r,a)??null}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ri({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),kc=null;const P_=new Si("PlatformDestroyListeners"),L_=new Si("appBootstrapListener");class nw{constructor(i,r){this.name=i,this.token=r}}function sw(n){try{const{rootComponent:i,appProviders:r,platformProviders:a}=n,u=function rw(n=[]){if(kc)return kc;const i=function AE(n=[],i){return $r.create({name:i,providers:[{provide:xf,useValue:"platform"},{provide:P_,useValue:new Set([()=>kc=null])},...n]})}(n);return kc=i,function DE(){!function Vo(n){fa=n}(()=>{throw new ge(600,!1)})}(),function CE(n){n.get(Ym,null)?.forEach(r=>r())}(i),i}(a),f=[uw(),...r||[]],x=new vx({providers:f,parent:u,debugName:"",runEnvironmentInitializers:!1}).injector,T=x.get(Ns);return T.run(()=>{x.resolveInjectorInitializers();const L=x.get(bl,null);let z;T.runOutsideAngular(()=>{z=T.onError.subscribe({next:pe=>{L.handleError(pe)}})});const Z=()=>x.destroy(),ae=u.get(P_);return ae.add(Z),x.onDestroy(()=>{z.unsubscribe(),ae.delete(Z)}),function PE(n,i,r){try{const a=r();return Wi(a)?a.catch(u=>{throw i.runOutsideAngular(()=>n.handleError(u)),u}):a}catch(a){throw i.runOutsideAngular(()=>n.handleError(a)),a}}(L,T,()=>{const pe=x.get(D_);return pe.runInitializers(),pe.donePromise.then(()=>{!function At(n){Xn(n,"Expected localeId to be defined"),"string"==typeof n&&(bt=n.toLowerCase().replace(/_/g,"-"))}(x.get(gv,cn)||cn);const Mt=x.get(Oh);return void 0!==i&&Mt.bootstrap(i),Mt})})})}catch(i){return Promise.reject(i)}}let Oh=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ui(OE),this.componentTypes=[],this.components=[],this.isStable=ui(xE),this._injector=ui(Ma)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,a){const u=r instanceof xc;if(!this._injector.get(D_).done)throw!u&&mo(r),new ge(405,!1);let g;g=u?r:this._injector.get(wu).resolveComponentFactory(r),this.componentTypes.push(g.componentType);const x=function tw(n){return n.isBoundToModule}(g)?void 0:this._injector.get(Ph),L=g.create($r.NULL,[],a||g.selector,x),z=L.location.nativeElement,Z=L.injector.get(SE,null);return Z?.registerApplication(z),L.onDestroy(()=>{this.detachView(L.hostView),vv(this.components,L),Z?.unregisterApplication(z)}),this._loadComponent(L),L}tick(){if(this._runningTick)throw new ge(101,!1);try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}attachView(r){const a=r;this._views.push(a),a.attachToAppRef(this)}detachView(r){const a=r;vv(this._views,a),a.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);const a=this._injector.get(L_,[]);a.push(...this._bootstrapListeners),a.forEach(u=>u(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>vv(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new ge(406,!1);const r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ri({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function vv(n,i){const r=n.indexOf(i);r>-1&&n.splice(r,1)}const OE=new Si("",{providedIn:"root",factory:()=>ui(bl).handleError.bind(void 0)});function lw(){const n=ui(Ns),i=ui(bl);return r=>n.runOutsideAngular(()=>i.handleError(r))}let cw=(()=>{class n{constructor(){this.zone=ui(Ns),this.applicationRef=ui(Oh)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ri({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function FE(n){return[{provide:Ns,useFactory:n},{provide:mu,multi:!0,useFactory:()=>{const i=ui(cw,{optional:!0});return()=>i.initialize()}},{provide:OE,useFactory:lw},{provide:xE,useFactory:EE}]}function uw(n){return gu([[],FE(()=>new Ns(function RE(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}(n)))])}let dw=(()=>{class n{}return n.__NG_ELEMENT_ID__=hw,n})();function hw(n){return function fw(n,i,r){if(ws(n)&&!r){const a=Y(n.index,i);return new Il(a,a)}return 47&n.type?new Il(i[Yi],i):null}(zi(),et(),16==(16&n))}class HE{constructor(){}supports(i){return fh(i)}create(i){return new _w(i)}}const yw=(n,i)=>i;class _w{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||yw}forEachItem(i){let r;for(r=this._itHead;null!==r;r=r._next)i(r)}forEachOperation(i){let r=this._itHead,a=this._removalsHead,u=0,f=null;for(;r||a;){const g=!a||r&&r.currentIndex<VE(a,u,f)?r:a,x=VE(g,u,f),T=g.currentIndex;if(g===a)u--,a=a._nextRemoved;else if(r=r._next,null==g.previousIndex)u++;else{f||(f=[]);const L=x-u,z=T-u;if(L!=z){for(let ae=0;ae<L;ae++){const pe=ae<f.length?f[ae]:f[ae]=0,$e=pe+ae;z<=$e&&$e<L&&(f[ae]=pe+1)}f[g.previousIndex]=z-L}}x!==T&&i(g,x,T)}}forEachPreviousItem(i){let r;for(r=this._previousItHead;null!==r;r=r._nextPrevious)i(r)}forEachAddedItem(i){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)i(r)}forEachMovedItem(i){let r;for(r=this._movesHead;null!==r;r=r._nextMoved)i(r)}forEachRemovedItem(i){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)i(r)}forEachIdentityChange(i){let r;for(r=this._identityChangesHead;null!==r;r=r._nextIdentityChange)i(r)}diff(i){if(null==i&&(i=[]),!fh(i))throw new ge(900,!1);return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let u,f,g,r=this._itHead,a=!1;if(Array.isArray(i)){this.length=i.length;for(let x=0;x<this.length;x++)f=i[x],g=this._trackByFn(x,f),null!==r&&Object.is(r.trackById,g)?(a&&(r=this._verifyReinsertion(r,f,g,x)),Object.is(r.item,f)||this._addIdentityChange(r,f)):(r=this._mismatch(r,f,g,x),a=!0),r=r._next}else u=0,function D0(n,i){if(Array.isArray(n))for(let r=0;r<n.length;r++)i(n[r]);else{const r=n[Symbol.iterator]();let a;for(;!(a=r.next()).done;)i(a.value)}}(i,x=>{g=this._trackByFn(u,x),null!==r&&Object.is(r.trackById,g)?(a&&(r=this._verifyReinsertion(r,x,g,u)),Object.is(r.item,x)||this._addIdentityChange(r,x)):(r=this._mismatch(r,x,g,u),a=!0),r=r._next,u++}),this.length=u;return this._truncate(r),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,r,a,u){let f;return null===i?f=this._itTail:(f=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null))?(Object.is(i.item,r)||this._addIdentityChange(i,r),this._reinsertAfter(i,f,u)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(a,u))?(Object.is(i.item,r)||this._addIdentityChange(i,r),this._moveAfter(i,f,u)):i=this._addAfter(new Mw(r,a),f,u),i}_verifyReinsertion(i,r,a,u){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null);return null!==f?i=this._reinsertAfter(f,i._prev,u):i.currentIndex!=u&&(i.currentIndex=u,this._addToMoves(i,u)),i}_truncate(i){for(;null!==i;){const r=i._next;this._addToRemovals(this._unlink(i)),i=r}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,r,a){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const u=i._prevRemoved,f=i._nextRemoved;return null===u?this._removalsHead=f:u._nextRemoved=f,null===f?this._removalsTail=u:f._prevRemoved=u,this._insertAfter(i,r,a),this._addToMoves(i,a),i}_moveAfter(i,r,a){return this._unlink(i),this._insertAfter(i,r,a),this._addToMoves(i,a),i}_addAfter(i,r,a){return this._insertAfter(i,r,a),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,r,a){const u=null===r?this._itHead:r._next;return i._next=u,i._prev=r,null===u?this._itTail=i:u._prev=i,null===r?this._itHead=i:r._next=i,null===this._linkedRecords&&(this._linkedRecords=new zE),this._linkedRecords.put(i),i.currentIndex=a,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const r=i._prev,a=i._next;return null===r?this._itHead=a:r._next=a,null===a?this._itTail=r:a._prev=r,i}_addToMoves(i,r){return i.previousIndex===r||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new zE),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,r){return i.item=r,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class Mw{constructor(i,r){this.item=i,this.trackById=r,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xw{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,r){let a;for(a=this._head;null!==a;a=a._nextDup)if((null===r||r<=a.currentIndex)&&Object.is(a.trackById,i))return a;return null}remove(i){const r=i._prevDup,a=i._nextDup;return null===r?this._head=a:r._nextDup=a,null===a?this._tail=r:a._prevDup=r,null===this._head}}class zE{constructor(){this.map=new Map}put(i){const r=i.trackById;let a=this.map.get(r);a||(a=new xw,this.map.set(r,a)),a.add(i)}get(i,r){const u=this.map.get(i);return u?u.get(i,r):null}remove(i){const r=i.trackById;return this.map.get(r).remove(i)&&this.map.delete(r),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function VE(n,i,r){const a=n.previousIndex;if(null===a)return a;let u=0;return r&&a<r.length&&(u=r[a]),a+i+u}class GE{constructor(){}supports(i){return i instanceof Map||ho(i)}create(){return new Ew}}class Ew{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let r;for(r=this._mapHead;null!==r;r=r._next)i(r)}forEachPreviousItem(i){let r;for(r=this._previousMapHead;null!==r;r=r._nextPrevious)i(r)}forEachChangedItem(i){let r;for(r=this._changesHead;null!==r;r=r._nextChanged)i(r)}forEachAddedItem(i){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)i(r)}forEachRemovedItem(i){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)i(r)}diff(i){if(i){if(!(i instanceof Map||ho(i)))throw new ge(900,!1)}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let r=this._mapHead;if(this._appendAfter=null,this._forEach(i,(a,u)=>{if(r&&r.key===u)this._maybeAddToChanges(r,a),this._appendAfter=r,r=r._next;else{const f=this._getOrCreateRecordForKey(u,a);r=this._insertBeforeOrAppend(r,f)}}),r){r._prev&&(r._prev._next=null),this._removalsHead=r;for(let a=r;null!==a;a=a._nextRemoved)a===this._mapHead&&(this._mapHead=null),this._records.delete(a.key),a._nextRemoved=a._next,a.previousValue=a.currentValue,a.currentValue=null,a._prev=null,a._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,r){if(i){const a=i._prev;return r._next=i,r._prev=a,i._prev=r,a&&(a._next=r),i===this._mapHead&&(this._mapHead=r),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=r,r._prev=this._appendAfter):this._mapHead=r,this._appendAfter=r,null}_getOrCreateRecordForKey(i,r){if(this._records.has(i)){const u=this._records.get(i);this._maybeAddToChanges(u,r);const f=u._prev,g=u._next;return f&&(f._next=g),g&&(g._prev=f),u._next=null,u._prev=null,u}const a=new Sw(i);return this._records.set(i,a),a.currentValue=r,this._addToAdditions(a),a}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,r){Object.is(r,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=r,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,r){i instanceof Map?i.forEach(r):Object.keys(i).forEach(a=>r(i[a],a))}}class Sw{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function WE(){return new B_([new HE])}let B_=(()=>{class n{constructor(r){this.factories=r}static create(r,a){if(null!=a){const u=a.factories.slice();r=r.concat(u)}return new n(r)}static extend(r){return{provide:n,useFactory:a=>n.create(r,a||WE()),deps:[[n,new yd,new vd]]}}find(r){const a=this.factories.find(u=>u.supports(r));if(null!=a)return a;throw new ge(901,!1)}}return n.\u0275prov=ri({token:n,providedIn:"root",factory:WE}),n})();function $E(){return new H_([new GE])}let H_=(()=>{class n{constructor(r){this.factories=r}static create(r,a){if(a){const u=a.factories.slice();r=r.concat(u)}return new n(r)}static extend(r){return{provide:n,useFactory:a=>n.create(r,a||$E()),deps:[[n,new yd,new vd]]}}find(r){const a=this.factories.find(u=>u.supports(r));if(a)return a;throw new ge(901,!1)}}return n.\u0275prov=ri({token:n,providedIn:"root",factory:$E}),n})(),Tw=(()=>{class n{constructor(r){}}return n.\u0275fac=function(r){return new(r||n)(cr(Oh))},n.\u0275mod=tl({type:n}),n.\u0275inj=Ji({}),n})(),KE=(()=>{class n{get whenAllTasksComplete(){return 0===this.collection.size&&this.complete(),this.promise}constructor(){this.taskId=0,this.collection=new Set,this.ngZone=ui(Ns),this.completed=!1,this.ngZone.runOutsideAngular(()=>{this.promise=new Promise(r=>{this.resolve=r})})}add(){if(this.completed)return-1;const r=this.taskId++;return this.collection.add(r),r}remove(r){this.completed||(this.collection.delete(r),0===this.collection.size&&this.complete())}ngOnDestroy(){this.complete(),this.collection.clear()}complete(){this.completed=!0,this.resolve()}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ri({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ow(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function Uw(n){const i=si(n);if(!i)return null;const r=new Rl(i);return{get selector(){return r.selector},get type(){return r.componentType},get inputs(){return r.inputs},get outputs(){return r.outputs},get ngContentSelectors(){return r.ngContentSelectors},get isStandalone(){return i.standalone}}}},6550:(jt,Be,V)=>{V.d(Be,{Cg:()=>Bn,Dx:()=>_i,H7:()=>Tr,b2:()=>Zi});var M=V(2504),fe=V(4755);class De extends fe.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Re extends De{static makeCurrent(){(0,fe.HT)(new Re)}onAndCancel(ce,ee,ue){return ce.addEventListener(ee,ue),()=>{ce.removeEventListener(ee,ue)}}dispatchEvent(ce,ee){ce.dispatchEvent(ee)}remove(ce){ce.parentNode&&ce.parentNode.removeChild(ce)}createElement(ce,ee){return(ee=ee||this.getDefaultDocument()).createElement(ce)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(ce){return ce.nodeType===Node.ELEMENT_NODE}isShadowRoot(ce){return ce instanceof DocumentFragment}getGlobalEventTarget(ce,ee){return"window"===ee?window:"document"===ee?ce:"body"===ee?ce.body:null}getBaseHref(ce){const ee=function Ee(){return Me=Me||document.querySelector("base"),Me?Me.getAttribute("href"):null}();return null==ee?null:function Dt(Se){Ve=Ve||document.createElement("a"),Ve.setAttribute("href",Se);const ce=Ve.pathname;return"/"===ce.charAt(0)?ce:`/${ce}`}(ee)}resetBaseElement(){Me=null}getUserAgent(){return window.navigator.userAgent}getCookie(ce){return(0,fe.Mx)(document.cookie,ce)}}let Ve,Me=null,Ze=(()=>{class Se{build(){return new XMLHttpRequest}}return Se.\u0275fac=function(ee){return new(ee||Se)},Se.\u0275prov=M.Yz7({token:Se,factory:Se.\u0275fac}),Se})();const me=new M.OlP("EventManagerPlugins");let ye=(()=>{class Se{constructor(ee,ue){this._zone=ue,this._eventNameToPlugin=new Map,ee.forEach(lt=>{lt.manager=this}),this._plugins=ee.slice().reverse()}addEventListener(ee,ue,lt){return this._findPluginFor(ue).addEventListener(ee,ue,lt)}getZone(){return this._zone}_findPluginFor(ee){let ue=this._eventNameToPlugin.get(ee);if(ue)return ue;if(ue=this._plugins.find(oe=>oe.supports(ee)),!ue)throw new M.vHH(5101,!1);return this._eventNameToPlugin.set(ee,ue),ue}}return Se.\u0275fac=function(ee){return new(ee||Se)(M.LFG(me),M.LFG(M.R0b))},Se.\u0275prov=M.Yz7({token:Se,factory:Se.\u0275fac}),Se})();class Le{constructor(ce){this._doc=ce}}const Ae="ng-app-id";let Ct=(()=>{class Se{constructor(ee,ue,lt,oe={}){this.doc=ee,this.appId=ue,this.nonce=lt,this.platformId=oe,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,fe.PM)(oe),this.resetHostNodes()}addStyles(ee){for(const ue of ee)1===this.changeUsageCount(ue,1)&&this.onStyleAdded(ue)}removeStyles(ee){for(const ue of ee)this.changeUsageCount(ue,-1)<=0&&this.onStyleRemoved(ue)}ngOnDestroy(){const ee=this.styleNodesInDOM;ee&&(ee.forEach(ue=>ue.remove()),ee.clear());for(const ue of this.getAllStyles())this.onStyleRemoved(ue);this.resetHostNodes()}addHost(ee){this.hostNodes.add(ee);for(const ue of this.getAllStyles())this.addStyleToHost(ee,ue)}removeHost(ee){this.hostNodes.delete(ee)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(ee){for(const ue of this.hostNodes)this.addStyleToHost(ue,ee)}onStyleRemoved(ee){const ue=this.styleRef;ue.get(ee)?.elements?.forEach(lt=>lt.remove()),ue.delete(ee)}collectServerRenderedStyles(){const ee=this.doc.head?.querySelectorAll(`style[${Ae}="${this.appId}"]`);if(ee?.length){const ue=new Map;return ee.forEach(lt=>{null!=lt.textContent&&ue.set(lt.textContent,lt)}),ue}return null}changeUsageCount(ee,ue){const lt=this.styleRef;if(lt.has(ee)){const oe=lt.get(ee);return oe.usage+=ue,oe.usage}return lt.set(ee,{usage:ue,elements:[]}),ue}getStyleElement(ee,ue){const lt=this.styleNodesInDOM,oe=lt?.get(ue);if(oe?.parentNode===ee)return lt.delete(ue),oe.removeAttribute(Ae),oe;{const q=this.doc.createElement("style");return this.nonce&&q.setAttribute("nonce",this.nonce),q.textContent=ue,this.platformIsServer&&q.setAttribute(Ae,this.appId),q}}addStyleToHost(ee,ue){const lt=this.getStyleElement(ee,ue);ee.appendChild(lt);const oe=this.styleRef,q=oe.get(ue)?.elements;q?q.push(lt):oe.set(ue,{elements:[lt],usage:1})}resetHostNodes(){const ee=this.hostNodes;ee.clear(),ee.add(this.doc.head)}}return Se.\u0275fac=function(ee){return new(ee||Se)(M.LFG(fe.K0),M.LFG(M.AFp),M.LFG(M.Ojb,8),M.LFG(M.Lbi))},Se.\u0275prov=M.Yz7({token:Se,factory:Se.\u0275fac}),Se})();const Zt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ht=/%COMP%/g,ge=new M.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function ke(Se,ce){return ce.map(ee=>ee.replace(ht,Se))}let it=(()=>{class Se{constructor(ee,ue,lt,oe,q,ie,Ie,tt=null){this.eventManager=ee,this.sharedStylesHost=ue,this.appId=lt,this.removeStylesOnCompDestory=oe,this.doc=q,this.platformId=ie,this.ngZone=Ie,this.nonce=tt,this.rendererByCompId=new Map,this.platformIsServer=(0,fe.PM)(ie),this.defaultRenderer=new Ut(ee,q,Ie,this.platformIsServer)}createRenderer(ee,ue){if(!ee||!ue)return this.defaultRenderer;this.platformIsServer&&ue.encapsulation===M.ifc.ShadowDom&&(ue={...ue,encapsulation:M.ifc.Emulated});const lt=this.getOrCreateRenderer(ee,ue);return lt instanceof Oe?lt.applyToHost(ee):lt instanceof be&&lt.applyStyles(),lt}getOrCreateRenderer(ee,ue){const lt=this.rendererByCompId;let oe=lt.get(ue.id);if(!oe){const q=this.doc,ie=this.ngZone,Ie=this.eventManager,tt=this.sharedStylesHost,Qe=this.removeStylesOnCompDestory,Et=this.platformIsServer;switch(ue.encapsulation){case M.ifc.Emulated:oe=new Oe(Ie,tt,ue,this.appId,Qe,q,ie,Et);break;case M.ifc.ShadowDom:return new Ti(Ie,tt,ee,ue,q,ie,this.nonce,Et);default:oe=new be(Ie,tt,ue,Qe,q,ie,Et)}oe.onDestroy=()=>lt.delete(ue.id),lt.set(ue.id,oe)}return oe}ngOnDestroy(){this.rendererByCompId.clear()}}return Se.\u0275fac=function(ee){return new(ee||Se)(M.LFG(ye),M.LFG(Ct),M.LFG(M.AFp),M.LFG(ge),M.LFG(fe.K0),M.LFG(M.Lbi),M.LFG(M.R0b),M.LFG(M.Ojb))},Se.\u0275prov=M.Yz7({token:Se,factory:Se.\u0275fac}),Se})();class Ut{constructor(ce,ee,ue,lt){this.eventManager=ce,this.doc=ee,this.ngZone=ue,this.platformIsServer=lt,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(ce,ee){return ee?this.doc.createElementNS(Zt[ee]||ee,ce):this.doc.createElement(ce)}createComment(ce){return this.doc.createComment(ce)}createText(ce){return this.doc.createTextNode(ce)}appendChild(ce,ee){(kn(ce)?ce.content:ce).appendChild(ee)}insertBefore(ce,ee,ue){ce&&(kn(ce)?ce.content:ce).insertBefore(ee,ue)}removeChild(ce,ee){ce&&ce.removeChild(ee)}selectRootElement(ce,ee){let ue="string"==typeof ce?this.doc.querySelector(ce):ce;if(!ue)throw new M.vHH(5104,!1);return ee||(ue.textContent=""),ue}parentNode(ce){return ce.parentNode}nextSibling(ce){return ce.nextSibling}setAttribute(ce,ee,ue,lt){if(lt){ee=lt+":"+ee;const oe=Zt[lt];oe?ce.setAttributeNS(oe,ee,ue):ce.setAttribute(ee,ue)}else ce.setAttribute(ee,ue)}removeAttribute(ce,ee,ue){if(ue){const lt=Zt[ue];lt?ce.removeAttributeNS(lt,ee):ce.removeAttribute(`${ue}:${ee}`)}else ce.removeAttribute(ee)}addClass(ce,ee){ce.classList.add(ee)}removeClass(ce,ee){ce.classList.remove(ee)}setStyle(ce,ee,ue,lt){lt&(M.JOm.DashCase|M.JOm.Important)?ce.style.setProperty(ee,ue,lt&M.JOm.Important?"important":""):ce.style[ee]=ue}removeStyle(ce,ee,ue){ue&M.JOm.DashCase?ce.style.removeProperty(ee):ce.style[ee]=""}setProperty(ce,ee,ue){ce[ee]=ue}setValue(ce,ee){ce.nodeValue=ee}listen(ce,ee,ue){if("string"==typeof ce&&!(ce=(0,fe.q)().getGlobalEventTarget(this.doc,ce)))throw new Error(`Unsupported event target ${ce} for event ${ee}`);return this.eventManager.addEventListener(ce,ee,this.decoratePreventDefault(ue))}decoratePreventDefault(ce){return ee=>{if("__ngUnwrap__"===ee)return ce;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>ce(ee)):ce(ee))&&(ee.preventDefault(),ee.returnValue=!1)}}}function kn(Se){return"TEMPLATE"===Se.tagName&&void 0!==Se.content}class Ti extends Ut{constructor(ce,ee,ue,lt,oe,q,ie,Ie){super(ce,oe,q,Ie),this.sharedStylesHost=ee,this.hostEl=ue,this.shadowRoot=ue.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const tt=ke(lt.id,lt.styles);for(const Qe of tt){const Et=document.createElement("style");ie&&Et.setAttribute("nonce",ie),Et.textContent=Qe,this.shadowRoot.appendChild(Et)}}nodeOrShadowRoot(ce){return ce===this.hostEl?this.shadowRoot:ce}appendChild(ce,ee){return super.appendChild(this.nodeOrShadowRoot(ce),ee)}insertBefore(ce,ee,ue){return super.insertBefore(this.nodeOrShadowRoot(ce),ee,ue)}removeChild(ce,ee){return super.removeChild(this.nodeOrShadowRoot(ce),ee)}parentNode(ce){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(ce)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class be extends Ut{constructor(ce,ee,ue,lt,oe,q,ie,Ie){super(ce,oe,q,ie),this.sharedStylesHost=ee,this.removeStylesOnCompDestory=lt,this.rendererUsageCount=0,this.styles=Ie?ke(Ie,ue.styles):ue.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Oe extends be{constructor(ce,ee,ue,lt,oe,q,ie,Ie){const tt=lt+"-"+ue.id;super(ce,ee,ue,oe,q,ie,Ie,tt),this.contentAttr=function gt(Se){return"_ngcontent-%COMP%".replace(ht,Se)}(tt),this.hostAttr=function He(Se){return"_nghost-%COMP%".replace(ht,Se)}(tt)}applyToHost(ce){this.applyStyles(),this.setAttribute(ce,this.hostAttr,"")}createElement(ce,ee){const ue=super.createElement(ce,ee);return super.setAttribute(ue,this.contentAttr,""),ue}}let Ue=(()=>{class Se extends Le{constructor(ee){super(ee)}supports(ee){return!0}addEventListener(ee,ue,lt){return ee.addEventListener(ue,lt,!1),()=>this.removeEventListener(ee,ue,lt)}removeEventListener(ee,ue,lt){return ee.removeEventListener(ue,lt)}}return Se.\u0275fac=function(ee){return new(ee||Se)(M.LFG(fe.K0))},Se.\u0275prov=M.Yz7({token:Se,factory:Se.\u0275fac}),Se})();const rt=["alt","control","meta","shift"],Rt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wt={alt:Se=>Se.altKey,control:Se=>Se.ctrlKey,meta:Se=>Se.metaKey,shift:Se=>Se.shiftKey};let tn=(()=>{class Se extends Le{constructor(ee){super(ee)}supports(ee){return null!=Se.parseEventName(ee)}addEventListener(ee,ue,lt){const oe=Se.parseEventName(ue),q=Se.eventCallback(oe.fullKey,lt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,fe.q)().onAndCancel(ee,oe.domEventName,q))}static parseEventName(ee){const ue=ee.toLowerCase().split("."),lt=ue.shift();if(0===ue.length||"keydown"!==lt&&"keyup"!==lt)return null;const oe=Se._normalizeKey(ue.pop());let q="",ie=ue.indexOf("code");if(ie>-1&&(ue.splice(ie,1),q="code."),rt.forEach(tt=>{const Qe=ue.indexOf(tt);Qe>-1&&(ue.splice(Qe,1),q+=tt+".")}),q+=oe,0!=ue.length||0===oe.length)return null;const Ie={};return Ie.domEventName=lt,Ie.fullKey=q,Ie}static matchEventFullKeyCode(ee,ue){let lt=Rt[ee.key]||ee.key,oe="";return ue.indexOf("code.")>-1&&(lt=ee.code,oe="code."),!(null==lt||!lt)&&(lt=lt.toLowerCase()," "===lt?lt="space":"."===lt&&(lt="dot"),rt.forEach(q=>{q!==lt&&(0,wt[q])(ee)&&(oe+=q+".")}),oe+=lt,oe===ue)}static eventCallback(ee,ue,lt){return oe=>{Se.matchEventFullKeyCode(oe,ee)&&lt.runGuarded(()=>ue(oe))}}static _normalizeKey(ee){return"esc"===ee?"escape":ee}}return Se.\u0275fac=function(ee){return new(ee||Se)(M.LFG(fe.K0))},Se.\u0275prov=M.Yz7({token:Se,factory:Se.\u0275fac}),Se})();function Bn(Se,ce){return(0,M.iPO)({rootComponent:Se,...nn(ce)})}function nn(Se){return{appProviders:[...Ji,...Se?.providers??[]],platformProviders:Nr}}const Nr=[{provide:M.Lbi,useValue:fe.bD},{provide:M.g9A,useValue:function Xn(){Re.makeCurrent()},multi:!0},{provide:fe.K0,useFactory:function yi(){return(0,M.RDi)(document),document},deps:[]}],ri=new M.OlP(""),jr=[{provide:M.rWj,useClass:class dt{addToWindow(ce){M.dqk.getAngularTestability=(ue,lt=!0)=>{const oe=ce.findTestabilityInTree(ue,lt);if(null==oe)throw new M.vHH(5103,!1);return oe},M.dqk.getAllAngularTestabilities=()=>ce.getAllTestabilities(),M.dqk.getAllAngularRootElements=()=>ce.getAllRootElements(),M.dqk.frameworkStabilizers||(M.dqk.frameworkStabilizers=[]),M.dqk.frameworkStabilizers.push(ue=>{const lt=M.dqk.getAllAngularTestabilities();let oe=lt.length,q=!1;const ie=function(Ie){q=q||Ie,oe--,0==oe&&ue(q)};lt.forEach(function(Ie){Ie.whenStable(ie)})})}findTestabilityInTree(ce,ee,ue){return null==ee?null:ce.getTestability(ee)??(ue?(0,fe.q)().isShadowRoot(ee)?this.findTestabilityInTree(ce,ee.host,!0):this.findTestabilityInTree(ce,ee.parentElement,!0):null)}},deps:[]},{provide:M.lri,useClass:M.dDg,deps:[M.R0b,M.eoX,M.rWj]},{provide:M.dDg,useClass:M.dDg,deps:[M.R0b,M.eoX,M.rWj]}],Ji=[{provide:M.zSh,useValue:"root"},{provide:M.qLn,useFactory:function yt(){return new M.qLn},deps:[]},{provide:me,useClass:Ue,multi:!0,deps:[fe.K0,M.R0b,M.Lbi]},{provide:me,useClass:tn,multi:!0,deps:[fe.K0]},it,Ct,ye,{provide:M.FYo,useExisting:it},{provide:fe.JF,useClass:Ze,deps:[]},[]];let Zi=(()=>{class Se{constructor(ee){}static withServerTransition(ee){return{ngModule:Se,providers:[{provide:M.AFp,useValue:ee.appId}]}}}return Se.\u0275fac=function(ee){return new(ee||Se)(M.LFG(ri,12))},Se.\u0275mod=M.oAB({type:Se}),Se.\u0275inj=M.cJS({providers:[...Ji,...jr],imports:[fe.ez,M.hGG]}),Se})(),_i=(()=>{class Se{constructor(ee){this._doc=ee}getTitle(){return this._doc.title}setTitle(ee){this._doc.title=ee||""}}return Se.\u0275fac=function(ee){return new(ee||Se)(M.LFG(fe.K0))},Se.\u0275prov=M.Yz7({token:Se,factory:function(ee){let ue=null;return ue=ee?new ee:function fi(){return new _i((0,M.LFG)(fe.K0))}(),ue},providedIn:"root"}),Se})();typeof window<"u"&&window;let Tr=(()=>{class Se{}return Se.\u0275fac=function(ee){return new(ee||Se)},Se.\u0275prov=M.Yz7({token:Se,factory:function(ee){let ue=null;return ue=ee?new(ee||Se):M.LFG(ji),ue},providedIn:"root"}),Se})(),ji=(()=>{class Se extends Tr{constructor(ee){super(),this._doc=ee}sanitize(ee,ue){if(null==ue)return null;switch(ee){case M.q3G.NONE:return ue;case M.q3G.HTML:return(0,M.qzn)(ue,"HTML")?(0,M.z3N)(ue):(0,M.EiD)(this._doc,String(ue)).toString();case M.q3G.STYLE:return(0,M.qzn)(ue,"Style")?(0,M.z3N)(ue):ue;case M.q3G.SCRIPT:if((0,M.qzn)(ue,"Script"))return(0,M.z3N)(ue);throw new M.vHH(5200,!1);case M.q3G.URL:return(0,M.qzn)(ue,"URL")?(0,M.z3N)(ue):(0,M.mCW)(String(ue));case M.q3G.RESOURCE_URL:if((0,M.qzn)(ue,"ResourceURL"))return(0,M.z3N)(ue);throw new M.vHH(5201,!1);default:throw new M.vHH(5202,!1)}}bypassSecurityTrustHtml(ee){return(0,M.JVY)(ee)}bypassSecurityTrustStyle(ee){return(0,M.L6k)(ee)}bypassSecurityTrustScript(ee){return(0,M.eBb)(ee)}bypassSecurityTrustUrl(ee){return(0,M.LAX)(ee)}bypassSecurityTrustResourceUrl(ee){return(0,M.pB0)(ee)}}return Se.\u0275fac=function(ee){return new(ee||Se)(M.LFG(fe.K0))},Se.\u0275prov=M.Yz7({token:Se,factory:function(ee){let ue=null;return ue=ee?new ee:function Xr(Se){return new ji(Se.get(fe.K0))}(M.LFG(M.zs3)),ue},providedIn:"root"}),Se})()},4478:(jt,Be,V)=>{V.d(Be,{OD:()=>Aa,F0:()=>Ki,rH:()=>ur,Bz:()=>oc,lC:()=>vo});var M=V(2504),fe=V(9751),De=V(576),Me=V(2076),Ee=V(9646),Ve=V(1135),Dt=V(9841),dt=V(6805),Ze=V(7272),me=V(8421);function ye(y){return new fe.y(E=>{(0,me.Xf)(y()).subscribe(E)})}var Le=V(9635);function Ae(y,E){const v=(0,De.m)(y)?y:()=>y,D=O=>O.error(v());return new fe.y(E?O=>E.schedule(D,0,O):D)}var Ct=V(515),Zt=V(727),ht=V(4482),an=V(5403);function Pn(){return(0,ht.e)((y,E)=>{let v=null;y._refCount++;const D=(0,an.x)(E,void 0,void 0,void 0,()=>{if(!y||y._refCount<=0||0<--y._refCount)return void(v=null);const O=y._connection,W=v;v=null,O&&(!W||O===W)&&O.unsubscribe(),E.unsubscribe()});y.subscribe(D),D.closed||(v=y.connect())})}class zn extends fe.y{constructor(E,v){super(),this.source=E,this.subjectFactory=v,this._subject=null,this._refCount=0,this._connection=null,(0,ht.A)(E)&&(this.lift=E.lift)}_subscribe(E){return this.getSubject().subscribe(E)}getSubject(){const E=this._subject;return(!E||E.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:E}=this;this._subject=this._connection=null,E?.unsubscribe()}connect(){let E=this._connection;if(!E){E=this._connection=new Zt.w0;const v=this.getSubject();E.add(this.source.subscribe((0,an.x)(v,void 0,()=>{this._teardown(),v.complete()},D=>{this._teardown(),v.error(D)},()=>this._teardown()))),E.closed&&(this._connection=null,E=Zt.w0.EMPTY)}return E}refCount(){return Pn()(this)}}var Pt=V(7579),ge=V(4755),gt=V(4004),He=V(3900),ke=V(5698),it=V(8675),Ut=V(9300),vt=V(5577),pn=V(590),kn=V(4351),Ti=V(8505);function be(y){return(0,ht.e)((E,v)=>{let W,D=null,O=!1;D=E.subscribe((0,an.x)(v,void 0,void 0,B=>{W=(0,me.Xf)(y(B,be(y)(E))),D?(D.unsubscribe(),D=null,W.subscribe(v)):O=!0})),O&&(D.unsubscribe(),D=null,W.subscribe(v))})}var rt=V(6590);function Rt(y){return y<=0?()=>Ct.E:(0,ht.e)((E,v)=>{let D=[];E.subscribe((0,an.x)(v,O=>{D.push(O),y<D.length&&D.shift()},()=>{for(const O of D)v.next(O);v.complete()},void 0,()=>{D=null}))})}var wt=V(8068),tn=V(4671),ii=V(9718),nn=V(8746),gi=V(8189),Xn=V(6550);const yt="primary",yi=Symbol("RouteTitle");class Nr{constructor(E){this.params=E||{}}has(E){return Object.prototype.hasOwnProperty.call(this.params,E)}get(E){if(this.has(E)){const v=this.params[E];return Array.isArray(v)?v[0]:v}return null}getAll(E){if(this.has(E)){const v=this.params[E];return Array.isArray(v)?v:[v]}return[]}get keys(){return Object.keys(this.params)}}function ir(y){return new Nr(y)}function ri(y,E,v){const D=v.path.split("/");if(D.length>y.length||"full"===v.pathMatch&&(E.hasChildren()||D.length<y.length))return null;const O={};for(let W=0;W<D.length;W++){const B=D[W],se=y[W];if(B.startsWith(":"))O[B.substring(1)]=se;else if(B!==se.path)return null}return{consumed:y.slice(0,D.length),posParams:O}}function Ji(y,E){const v=y?Object.keys(y):void 0,D=E?Object.keys(E):void 0;if(!v||!D||v.length!=D.length)return!1;let O;for(let W=0;W<v.length;W++)if(O=v[W],!Zi(y[O],E[O]))return!1;return!0}function Zi(y,E){if(Array.isArray(y)&&Array.isArray(E)){if(y.length!==E.length)return!1;const v=[...y].sort(),D=[...E].sort();return v.every((O,W)=>D[W]===O)}return y===E}function Xe(y){return y.length>0?y[y.length-1]:null}function en(y){return function Re(y){return!!y&&(y instanceof fe.y||(0,De.m)(y.lift)&&(0,De.m)(y.subscribe))}(y)?y:(0,M.QGY)(y)?(0,Me.D)(Promise.resolve(y)):(0,Ee.of)(y)}const Mn={exact:function Ci(y,E,v){if(!Os(y.segments,E.segments)||!$i(y.segments,E.segments,v)||y.numberOfChildren!==E.numberOfChildren)return!1;for(const D in E.children)if(!y.children[D]||!Ci(y.children[D],E.children[D],v))return!1;return!0},subset:st},fi={exact:function pi(y,E){return Ji(y,E)},subset:function Vn(y,E){return Object.keys(E).length<=Object.keys(y).length&&Object.keys(E).every(v=>Zi(y[v],E[v]))},ignored:()=>!0};function _i(y,E,v){return Mn[v.paths](y.root,E.root,v.matrixParams)&&fi[v.queryParams](y.queryParams,E.queryParams)&&!("exact"===v.fragment&&y.fragment!==E.fragment)}function st(y,E,v){return Kt(y,E,E.segments,v)}function Kt(y,E,v,D){if(y.segments.length>v.length){const O=y.segments.slice(0,v.length);return!(!Os(O,v)||E.hasChildren()||!$i(O,v,D))}if(y.segments.length===v.length){if(!Os(y.segments,v)||!$i(y.segments,v,D))return!1;for(const O in E.children)if(!y.children[O]||!st(y.children[O],E.children[O],D))return!1;return!0}{const O=v.slice(0,y.segments.length),W=v.slice(y.segments.length);return!!(Os(y.segments,O)&&$i(y.segments,O,D)&&y.children[yt])&&Kt(y.children[yt],E,W,D)}}function $i(y,E,v){return E.every((D,O)=>fi[v](y[O].parameters,D.parameters))}class Ai{constructor(E=new Ln([],{}),v={},D=null){this.root=E,this.queryParams=v,this.fragment=D}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ir(this.queryParams)),this._queryParamMap}toString(){return Fs.serialize(this)}}class Ln{constructor(E,v){this.segments=E,this.children=v,this.parent=null,Object.values(v).forEach(D=>D.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return wr(this)}}class ls{constructor(E,v){this.path=E,this.parameters=v}get parameterMap(){return this._parameterMap||(this._parameterMap=ir(this.parameters)),this._parameterMap}toString(){return to(this)}}function Os(y,E){return y.length===E.length&&y.every((v,D)=>v.path===E[D].path)}let Qn=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:function(){return new xn},providedIn:"root"}),y})();class xn{parse(E){const v=new ie(E);return new Ai(v.parseRootSegment(),v.parseQueryParams(),v.parseFragment())}serialize(E){const v=`/${Tr(E.root,!0)}`,D=function vi(y){const E=Object.keys(y).map(v=>{const D=y[v];return Array.isArray(D)?D.map(O=>`${ji(v)}=${ji(O)}`).join("&"):`${ji(v)}=${ji(D)}`}).filter(v=>!!v);return E.length?`?${E.join("&")}`:""}(E.queryParams);return`${v}${D}${"string"==typeof E.fragment?`#${function xs(y){return encodeURI(y)}(E.fragment)}`:""}`}}const Fs=new xn;function wr(y){return y.segments.map(E=>to(E)).join("/")}function Tr(y,E){if(!y.hasChildren())return wr(y);if(E){const v=y.children[yt]?Tr(y.children[yt],!1):"",D=[];return Object.entries(y.children).forEach(([O,W])=>{O!==yt&&D.push(`${O}:${Tr(W,!1)}`)}),D.length>0?`${v}(${D.join("//")})`:v}{const v=function Fi(y,E){let v=[];return Object.entries(y.children).forEach(([D,O])=>{D===yt&&(v=v.concat(E(O,D)))}),Object.entries(y.children).forEach(([D,O])=>{D!==yt&&(v=v.concat(E(O,D)))}),v}(y,(D,O)=>O===yt?[Tr(y.children[yt],!1)]:[`${O}:${Tr(D,!1)}`]);return 1===Object.keys(y.children).length&&null!=y.children[yt]?`${wr(y)}/${v[0]}`:`${wr(y)}/(${v.join("//")})`}}function Xr(y){return encodeURIComponent(y).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ji(y){return Xr(y).replace(/%3B/gi,";")}function li(y){return Xr(y).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function cs(y){return decodeURIComponent(y)}function Yr(y){return cs(y.replace(/\+/g,"%20"))}function to(y){return`${li(y.path)}${function cr(y){return Object.keys(y).map(E=>`;${li(E)}=${li(y[E])}`).join("")}(y.parameters)}`}const ui=/^[^\/()?;#]+/;function Se(y){const E=y.match(ui);return E?E[0]:""}const ce=/^[^\/()?;=#]+/,ue=/^[^=?&#]+/,oe=/^[^&#]+/;class ie{constructor(E){this.url=E,this.remaining=E}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ln([],{}):new Ln([],this.parseChildren())}parseQueryParams(){const E={};if(this.consumeOptional("?"))do{this.parseQueryParam(E)}while(this.consumeOptional("&"));return E}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const E=[];for(this.peekStartsWith("(")||E.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),E.push(this.parseSegment());let v={};this.peekStartsWith("/(")&&(this.capture("/"),v=this.parseParens(!0));let D={};return this.peekStartsWith("(")&&(D=this.parseParens(!1)),(E.length>0||Object.keys(v).length>0)&&(D[yt]=new Ln(E,v)),D}parseSegment(){const E=Se(this.remaining);if(""===E&&this.peekStartsWith(";"))throw new M.vHH(4009,!1);return this.capture(E),new ls(cs(E),this.parseMatrixParams())}parseMatrixParams(){const E={};for(;this.consumeOptional(";");)this.parseParam(E);return E}parseParam(E){const v=function ee(y){const E=y.match(ce);return E?E[0]:""}(this.remaining);if(!v)return;this.capture(v);let D="";if(this.consumeOptional("=")){const O=Se(this.remaining);O&&(D=O,this.capture(D))}E[cs(v)]=cs(D)}parseQueryParam(E){const v=function lt(y){const E=y.match(ue);return E?E[0]:""}(this.remaining);if(!v)return;this.capture(v);let D="";if(this.consumeOptional("=")){const B=function q(y){const E=y.match(oe);return E?E[0]:""}(this.remaining);B&&(D=B,this.capture(D))}const O=Yr(v),W=Yr(D);if(E.hasOwnProperty(O)){let B=E[O];Array.isArray(B)||(B=[B],E[O]=B),B.push(W)}else E[O]=W}parseParens(E){const v={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const D=Se(this.remaining),O=this.remaining[D.length];if("/"!==O&&")"!==O&&";"!==O)throw new M.vHH(4010,!1);let W;D.indexOf(":")>-1?(W=D.slice(0,D.indexOf(":")),this.capture(W),this.capture(":")):E&&(W=yt);const B=this.parseChildren();v[W]=1===Object.keys(B).length?B[yt]:new Ln([],B),this.consumeOptional("//")}return v}peekStartsWith(E){return this.remaining.startsWith(E)}consumeOptional(E){return!!this.peekStartsWith(E)&&(this.remaining=this.remaining.substring(E.length),!0)}capture(E){if(!this.consumeOptional(E))throw new M.vHH(4011,!1)}}function Ie(y){return y.segments.length>0?new Ln([],{[yt]:y}):y}function tt(y){const E={};for(const D of Object.keys(y.children)){const W=tt(y.children[D]);if(D===yt&&0===W.segments.length&&W.hasChildren())for(const[B,se]of Object.entries(W.children))E[B]=se;else(W.segments.length>0||W.hasChildren())&&(E[D]=W)}return function Qe(y){if(1===y.numberOfChildren&&y.children[yt]){const E=y.children[yt];return new Ln(y.segments.concat(E.segments),E.children)}return y}(new Ln(y.segments,E))}function Et(y){return y instanceof Ai}function mn(y){let E;const O=Ie(function v(W){const B={};for(const ot of W.children){const Ht=v(ot);B[ot.outlet]=Ht}const se=new Ln(W.url,B);return W===y&&(E=se),se}(y.root));return E??O}function Mr(y,E,v,D){let O=y;for(;O.parent;)O=O.parent;if(0===E.length)return xr(O,O,O,v,D);const W=function no(y){if("string"==typeof y[0]&&1===y.length&&"/"===y[0])return new Zr(!0,0,y);let E=0,v=!1;const D=y.reduce((O,W,B)=>{if("object"==typeof W&&null!=W){if(W.outlets){const se={};return Object.entries(W.outlets).forEach(([ot,Ht])=>{se[ot]="string"==typeof Ht?Ht.split("/"):Ht}),[...O,{outlets:se}]}if(W.segmentPath)return[...O,W.segmentPath]}return"string"!=typeof W?[...O,W]:0===B?(W.split("/").forEach((se,ot)=>{0==ot&&"."===se||(0==ot&&""===se?v=!0:".."===se?E++:""!=se&&O.push(se))}),O):[...O,W]},[]);return new Zr(v,E,D)}(E);if(W.toRoot())return xr(O,O,new Ln([],{}),v,D);const B=function Us(y,E,v){if(y.isAbsolute)return new Es(E,!0,0);if(!v)return new Es(E,!1,NaN);if(null===v.parent)return new Es(v,!0,0);const D=mi(y.commands[0])?0:1;return function Ii(y,E,v){let D=y,O=E,W=v;for(;W>O;){if(W-=O,D=D.parent,!D)throw new M.vHH(4005,!1);O=D.segments.length}return new Es(D,!1,O-W)}(v,v.segments.length-1+D,y.numberOfDoubleDots)}(W,O,y),se=B.processChildren?Hr(B.segmentGroup,B.index,W.commands):us(B.segmentGroup,B.index,W.commands);return xr(O,B.segmentGroup,se,v,D)}function mi(y){return"object"==typeof y&&null!=y&&!y.outlets&&!y.segmentPath}function Ui(y){return"object"==typeof y&&null!=y&&y.outlets}function xr(y,E,v,D,O){let B,W={};D&&Object.entries(D).forEach(([ot,Ht])=>{W[ot]=Array.isArray(Ht)?Ht.map(Jt=>`${Jt}`):`${Ht}`}),B=y===E?v:qr(y,E,v);const se=Ie(tt(B));return new Ai(se,W,O)}function qr(y,E,v){const D={};return Object.entries(y.children).forEach(([O,W])=>{D[O]=W===E?v:qr(W,E,v)}),new Ln(y.segments,D)}class Zr{constructor(E,v,D){if(this.isAbsolute=E,this.numberOfDoubleDots=v,this.commands=D,E&&D.length>0&&mi(D[0]))throw new M.vHH(4003,!1);const O=D.find(Ui);if(O&&O!==Xe(D))throw new M.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Es{constructor(E,v,D){this.segmentGroup=E,this.processChildren=v,this.index=D}}function us(y,E,v){if(y||(y=new Ln([],{})),0===y.segments.length&&y.hasChildren())return Hr(y,E,v);const D=function rr(y,E,v){let D=0,O=E;const W={match:!1,pathIndex:0,commandIndex:0};for(;O<y.segments.length;){if(D>=v.length)return W;const B=y.segments[O],se=v[D];if(Ui(se))break;const ot=`${se}`,Ht=D<v.length-1?v[D+1]:null;if(O>0&&void 0===ot)break;if(ot&&Ht&&"object"==typeof Ht&&void 0===Ht.outlets){if(!Ca(ot,Ht,B))return W;D+=2}else{if(!Ca(ot,{},B))return W;D++}O++}return{match:!0,pathIndex:O,commandIndex:D}}(y,E,v),O=v.slice(D.commandIndex);if(D.match&&D.pathIndex<y.segments.length){const W=new Ln(y.segments.slice(0,D.pathIndex),{});return W.children[yt]=new Ln(y.segments.slice(D.pathIndex),y.children),Hr(W,0,O)}return D.match&&0===O.length?new Ln(y.segments,{}):D.match&&!y.hasChildren()?ks(y,E,v):D.match?Hr(y,0,O):ks(y,E,v)}function Hr(y,E,v){if(0===v.length)return new Ln(y.segments,{});{const D=function Xi(y){return Ui(y[0])?y[0].outlets:{[yt]:y}}(v),O={};if(!D[yt]&&y.children[yt]&&1===y.numberOfChildren&&0===y.children[yt].segments.length){const W=Hr(y.children[yt],E,v);return new Ln(y.segments,W.children)}return Object.entries(D).forEach(([W,B])=>{"string"==typeof B&&(B=[B]),null!==B&&(O[W]=us(y.children[W],E,B))}),Object.entries(y.children).forEach(([W,B])=>{void 0===D[W]&&(O[W]=B)}),new Ln(y.segments,O)}}function ks(y,E,v){const D=y.segments.slice(0,E);let O=0;for(;O<v.length;){const W=v[O];if(Ui(W)){const ot=Or(W.outlets);return new Ln(D,ot)}if(0===O&&mi(v[0])){D.push(new ls(y.segments[E].path,Ro(v[0]))),O++;continue}const B=Ui(W)?W.outlets[yt]:`${W}`,se=O<v.length-1?v[O+1]:null;B&&se&&mi(se)?(D.push(new ls(B,Ro(se))),O+=2):(D.push(new ls(B,{})),O++)}return new Ln(D,{})}function Or(y){const E={};return Object.entries(y).forEach(([v,D])=>{"string"==typeof D&&(D=[D]),null!==D&&(E[v]=ks(new Ln([],{}),0,D))}),E}function Ro(y){const E={};return Object.entries(y).forEach(([v,D])=>E[v]=`${D}`),E}function Ca(y,E,v){return y==v.path&&Ji(E,v.parameters)}const fo="imperative";class ds{constructor(E,v){this.id=E,this.url=v}}class Aa extends ds{constructor(E,v,D="imperative",O=null){super(E,v),this.type=0,this.navigationTrigger=D,this.restoredState=O}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Bs extends ds{constructor(E,v,D){super(E,v),this.urlAfterRedirects=D,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Po extends ds{constructor(E,v,D,O){super(E,v),this.reason=D,this.code=O,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class po extends ds{constructor(E,v,D,O){super(E,v),this.reason=D,this.code=O,this.type=16}}class Lo extends ds{constructor(E,v,D,O){super(E,v),this.error=D,this.target=O,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Ia extends ds{constructor(E,v,D,O){super(E,v),this.urlAfterRedirects=D,this.state=O,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qa extends ds{constructor(E,v,D,O){super(E,v),this.urlAfterRedirects=D,this.state=O,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hl extends ds{constructor(E,v,D,O,W){super(E,v),this.urlAfterRedirects=D,this.state=O,this.shouldActivate=W,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Bc extends ds{constructor(E,v,D,O){super(E,v),this.urlAfterRedirects=D,this.state=O,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class el extends ds{constructor(E,v,D,O){super(E,v),this.urlAfterRedirects=D,this.state=O,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class tl{constructor(E){this.route=E,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Hc{constructor(E){this.route=E,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class zl{constructor(E){this.snapshot=E,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vl{constructor(E){this.snapshot=E,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zr{constructor(E){this.snapshot=E,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class si{constructor(E){this.snapshot=E,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class sr{constructor(E,v,D){this.routerEvent=E,this.position=v,this.anchor=D,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class mo{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new or,this.attachRef=null}}let or=(()=>{class y{constructor(){this.contexts=new Map}onChildOutletCreated(v,D){const O=this.getOrCreateContext(v);O.outlet=D,this.contexts.set(v,O)}onChildOutletDestroyed(v){const D=this.getContext(v);D&&(D.outlet=null,D.attachRef=null)}onOutletDeactivated(){const v=this.contexts;return this.contexts=new Map,v}onOutletReAttached(v){this.contexts=v}getOrCreateContext(v){let D=this.getContext(v);return D||(D=new mo,this.contexts.set(v,D)),D}getContext(v){return this.contexts.get(v)||null}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();class Ra{constructor(E){this._root=E}get root(){return this._root.value}parent(E){const v=this.pathFromRoot(E);return v.length>1?v[v.length-2]:null}children(E){const v=Pa(E,this._root);return v?v.children.map(D=>D.value):[]}firstChild(E){const v=Pa(E,this._root);return v&&v.children.length>0?v.children[0].value:null}siblings(E){const v=No(E,this._root);return v.length<2?[]:v[v.length-2].children.map(O=>O.value).filter(O=>O!==E)}pathFromRoot(E){return No(E,this._root).map(v=>v.value)}}function Pa(y,E){if(y===E.value)return E;for(const v of E.children){const D=Pa(y,v);if(D)return D}return null}function No(y,E){if(y===E.value)return[E];for(const v of E.children){const D=No(y,v);if(D.length)return D.unshift(E),D}return[]}class Hs{constructor(E,v){this.value=E,this.children=v}toString(){return`TreeNode(${this.value})`}}function zs(y){const E={};return y&&y.children.forEach(v=>E[v.value.outlet]=v),E}class ki extends Ra{constructor(E,v){super(E),this.snapshot=v,Bi(this,E)}toString(){return this.snapshot.toString()}}function Ot(y,E){const v=function vn(y,E){const B=new Qi([],{},{},"",{},yt,E,null,{});return new Oo("",new Hs(B,[]))}(0,E),D=new Ve.X([new ls("",{})]),O=new Ve.X({}),W=new Ve.X({}),B=new Ve.X({}),se=new Ve.X(""),ot=new ei(D,O,B,se,W,yt,E,v.root);return ot.snapshot=v.root,new ki(new Hs(ot,[]),v)}class ei{constructor(E,v,D,O,W,B,se,ot){this.urlSubject=E,this.paramsSubject=v,this.queryParamsSubject=D,this.fragmentSubject=O,this.dataSubject=W,this.outlet=B,this.component=se,this._futureSnapshot=ot,this.title=this.dataSubject?.pipe((0,gt.U)(Ht=>Ht[yi]))??(0,Ee.of)(void 0),this.url=E,this.params=v,this.queryParams=D,this.fragment=O,this.data=W}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,gt.U)(E=>ir(E)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,gt.U)(E=>ir(E)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Dr(y,E="emptyOnly"){const v=y.pathFromRoot;let D=0;if("always"!==E)for(D=v.length-1;D>=1;){const O=v[D],W=v[D-1];if(O.routeConfig&&""===O.routeConfig.path)D--;else{if(W.component)break;D--}}return function Vs(y){return y.reduce((E,v)=>({params:{...E.params,...v.params},data:{...E.data,...v.data},resolve:{...v.data,...E.resolve,...v.routeConfig?.data,...v._resolvedData}}),{params:{},data:{},resolve:{}})}(v.slice(D))}class Qi{get title(){return this.data?.[yi]}constructor(E,v,D,O,W,B,se,ot,Ht){this.url=E,this.params=v,this.queryParams=D,this.fragment=O,this.data=W,this.outlet=B,this.component=se,this.routeConfig=ot,this._resolve=Ht}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ir(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ir(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(D=>D.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Oo extends Ra{constructor(E,v){super(v),this.url=E,Bi(this,v)}toString(){return go(this._root)}}function Bi(y,E){E.value._routerState=y,E.children.forEach(v=>Bi(y,v))}function go(y){const E=y.children.length>0?` { ${y.children.map(go).join(", ")} } `:"";return`${y.value}${E}`}function Ss(y){if(y.snapshot){const E=y.snapshot,v=y._futureSnapshot;y.snapshot=v,Ji(E.queryParams,v.queryParams)||y.queryParamsSubject.next(v.queryParams),E.fragment!==v.fragment&&y.fragmentSubject.next(v.fragment),Ji(E.params,v.params)||y.paramsSubject.next(v.params),function jr(y,E){if(y.length!==E.length)return!1;for(let v=0;v<y.length;++v)if(!Ji(y[v],E[v]))return!1;return!0}(E.url,v.url)||y.urlSubject.next(v.url),Ji(E.data,v.data)||y.dataSubject.next(v.data)}else y.snapshot=y._futureSnapshot,y.dataSubject.next(y._futureSnapshot.data)}function un(y,E){const v=Ji(y.params,E.params)&&function Zn(y,E){return Os(y,E)&&y.every((v,D)=>Ji(v.parameters,E[D].parameters))}(y.url,E.url);return v&&!(!y.parent!=!E.parent)&&(!y.parent||un(y.parent,E.parent))}let vo=(()=>{class y{constructor(){this.activated=null,this._activatedRoute=null,this.name=yt,this.activateEvents=new M.vpe,this.deactivateEvents=new M.vpe,this.attachEvents=new M.vpe,this.detachEvents=new M.vpe,this.parentContexts=(0,M.f3M)(or),this.location=(0,M.f3M)(M.s_b),this.changeDetector=(0,M.f3M)(M.sBO),this.environmentInjector=(0,M.f3M)(M.lqb),this.inputBinder=(0,M.f3M)(pr,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(v){if(v.name){const{firstChange:D,previousValue:O}=v.name;if(D)return;this.isTrackedInParentContexts(O)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(O)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(v){return this.parentContexts.getContext(v)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const v=this.parentContexts.getContext(this.name);v?.route&&(v.attachRef?this.attach(v.attachRef,v.route):this.activateWith(v.route,v.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new M.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new M.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new M.vHH(4012,!1);this.location.detach();const v=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(v.instance),v}attach(v,D){this.activated=v,this._activatedRoute=D,this.location.insert(v.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(v.instance)}deactivate(){if(this.activated){const v=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(v)}}activateWith(v,D){if(this.isActivated)throw new M.vHH(4013,!1);this._activatedRoute=v;const O=this.location,B=v.snapshot.component,se=this.parentContexts.getOrCreateContext(this.name).children,ot=new La(v,se,O.injector);this.activated=O.createComponent(B,{index:O.length,injector:ot,environmentInjector:D??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275dir=M.lG2({type:y,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[M.TTD]}),y})();class La{constructor(E,v,D){this.route=E,this.childContexts=v,this.parent=D}get(E,v){return E===ei?this.route:E===or?this.childContexts:this.parent.get(E,v)}}const pr=new M.OlP("");let Yi=(()=>{class y{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(v){this.unsubscribeFromRouteData(v),this.subscribeToRouteData(v)}unsubscribeFromRouteData(v){this.outletDataSubscriptions.get(v)?.unsubscribe(),this.outletDataSubscriptions.delete(v)}subscribeToRouteData(v){const{activatedRoute:D}=v,O=(0,Dt.a)([D.queryParams,D.params,D.data]).pipe((0,He.w)(([W,B,se],ot)=>(se={...W,...B,...se},0===ot?(0,Ee.of)(se):Promise.resolve(se)))).subscribe(W=>{if(!v.isActivated||!v.activatedComponentRef||v.activatedRoute!==D||null===D.component)return void this.unsubscribeFromRouteData(v);const B=(0,M.qFp)(D.component);if(B)for(const{templateName:se}of B.inputs)v.activatedComponentRef.setInput(se,W[se]);else this.unsubscribeFromRouteData(v)});this.outletDataSubscriptions.set(v,O)}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac}),y})();function gn(y,E,v){if(v&&y.shouldReuseRoute(E.value,v.value.snapshot)){const D=v.value;D._futureSnapshot=E.value;const O=function er(y,E,v){return E.children.map(D=>{for(const O of v.children)if(y.shouldReuseRoute(D.value,O.value.snapshot))return gn(y,D,O);return gn(y,D)})}(y,E,v);return new Hs(D,O)}{if(y.shouldAttach(E.value)){const W=y.retrieve(E.value);if(null!==W){const B=W.route;return B.value._futureSnapshot=E.value,B.children=E.children.map(se=>gn(y,se)),B}}const D=function Fo(y){return new ei(new Ve.X(y.url),new Ve.X(y.params),new Ve.X(y.queryParams),new Ve.X(y.fragment),new Ve.X(y.data),y.outlet,y.component,y)}(E.value),O=E.children.map(W=>gn(y,W));return new Hs(D,O)}}const nl="ngNavigationCancelingError";function hs(y,E){const{redirectTo:v,navigationBehaviorOptions:D}=Et(E)?{redirectTo:E,navigationBehaviorOptions:void 0}:E,O=Gs(!1,0,E);return O.url=v,O.navigationBehaviorOptions=D,O}function Gs(y,E,v){const D=new Error("NavigationCancelingError: "+(y||""));return D[nl]=!0,D.cancellationCode=E,v&&(D.url=v),D}function ra(y){return il(y)&&Et(y.url)}function il(y){return y&&y[nl]}let Yn=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275cmp=M.Xpm({type:y,selectors:[["ng-component"]],standalone:!0,features:[M.jDz],decls:1,vars:0,template:function(v,D){1&v&&M._UZ(0,"router-outlet")},dependencies:[vo],encapsulation:2}),y})();function Er(y){const E=y.children&&y.children.map(Er),v=E?{...y,children:E}:{...y};return!v.component&&!v.loadComponent&&(E||v.loadChildren)&&v.outlet&&v.outlet!==yt&&(v.component=Yn),v}function xi(y){return y.outlet||yt}function ws(y){if(!y)return null;if(y.routeConfig?._injector)return y.routeConfig._injector;for(let E=y.parent;E;E=E.parent){const v=E.routeConfig;if(v?._loadedInjector)return v._loadedInjector;if(v?._injector)return v._injector}return null}class sa{constructor(E,v,D,O,W){this.routeReuseStrategy=E,this.futureState=v,this.currState=D,this.forwardEvent=O,this.inputBindingEnabled=W}activate(E){const v=this.futureState._root,D=this.currState?this.currState._root:null;this.deactivateChildRoutes(v,D,E),Ss(this.futureState.root),this.activateChildRoutes(v,D,E)}deactivateChildRoutes(E,v,D){const O=zs(v);E.children.forEach(W=>{const B=W.value.outlet;this.deactivateRoutes(W,O[B],D),delete O[B]}),Object.values(O).forEach(W=>{this.deactivateRouteAndItsChildren(W,D)})}deactivateRoutes(E,v,D){const O=E.value,W=v?v.value:null;if(O===W)if(O.component){const B=D.getContext(O.outlet);B&&this.deactivateChildRoutes(E,v,B.children)}else this.deactivateChildRoutes(E,v,D);else W&&this.deactivateRouteAndItsChildren(v,D)}deactivateRouteAndItsChildren(E,v){E.value.component&&this.routeReuseStrategy.shouldDetach(E.value.snapshot)?this.detachAndStoreRouteSubtree(E,v):this.deactivateRouteAndOutlet(E,v)}detachAndStoreRouteSubtree(E,v){const D=v.getContext(E.value.outlet),O=D&&E.value.component?D.children:v,W=zs(E);for(const B of Object.keys(W))this.deactivateRouteAndItsChildren(W[B],O);if(D&&D.outlet){const B=D.outlet.detach(),se=D.children.onOutletDeactivated();this.routeReuseStrategy.store(E.value.snapshot,{componentRef:B,route:E,contexts:se})}}deactivateRouteAndOutlet(E,v){const D=v.getContext(E.value.outlet),O=D&&E.value.component?D.children:v,W=zs(E);for(const B of Object.keys(W))this.deactivateRouteAndItsChildren(W[B],O);D&&(D.outlet&&(D.outlet.deactivate(),D.children.onOutletDeactivated()),D.attachRef=null,D.route=null)}activateChildRoutes(E,v,D){const O=zs(v);E.children.forEach(W=>{this.activateRoutes(W,O[W.value.outlet],D),this.forwardEvent(new si(W.value.snapshot))}),E.children.length&&this.forwardEvent(new Vl(E.value.snapshot))}activateRoutes(E,v,D){const O=E.value,W=v?v.value:null;if(Ss(O),O===W)if(O.component){const B=D.getOrCreateContext(O.outlet);this.activateChildRoutes(E,v,B.children)}else this.activateChildRoutes(E,v,D);else if(O.component){const B=D.getOrCreateContext(O.outlet);if(this.routeReuseStrategy.shouldAttach(O.snapshot)){const se=this.routeReuseStrategy.retrieve(O.snapshot);this.routeReuseStrategy.store(O.snapshot,null),B.children.onOutletReAttached(se.contexts),B.attachRef=se.componentRef,B.route=se.route.value,B.outlet&&B.outlet.attach(se.componentRef,se.route.value),Ss(se.route.value),this.activateChildRoutes(E,null,B.children)}else{const se=ws(O.snapshot);B.attachRef=null,B.route=O,B.injector=se,B.outlet&&B.outlet.activateWith(O,B.injector),this.activateChildRoutes(E,null,B.children)}}else this.activateChildRoutes(E,null,D)}}class Gc{constructor(E){this.path=E,this.route=this.path[this.path.length-1]}}class $l{constructor(E,v){this.component=E,this.route=v}}function Fh(y,E,v){const D=y._root;return Bo(D,E?E._root:null,v,[D.value])}function ko(y,E){const v=Symbol(),D=E.get(y,v);return D===v?"function"!=typeof y||(0,M.Z0I)(y)?E.get(y):y:D}function Bo(y,E,v,D,O={canDeactivateChecks:[],canActivateChecks:[]}){const W=zs(E);return y.children.forEach(B=>{(function oa(y,E,v,D,O={canDeactivateChecks:[],canActivateChecks:[]}){const W=y.value,B=E?E.value:null,se=v?v.getContext(y.value.outlet):null;if(B&&W.routeConfig===B.routeConfig){const ot=function Fr(y,E,v){if("function"==typeof v)return v(y,E);switch(v){case"pathParamsChange":return!Os(y.url,E.url);case"pathParamsOrQueryParamsChange":return!Os(y.url,E.url)||!Ji(y.queryParams,E.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!un(y,E)||!Ji(y.queryParams,E.queryParams);default:return!un(y,E)}}(B,W,W.routeConfig.runGuardsAndResolvers);ot?O.canActivateChecks.push(new Gc(D)):(W.data=B.data,W._resolvedData=B._resolvedData),Bo(y,E,W.component?se?se.children:null:v,D,O),ot&&se&&se.outlet&&se.outlet.isActivated&&O.canDeactivateChecks.push(new $l(se.outlet.component,B))}else B&&aa(E,se,O),O.canActivateChecks.push(new Gc(D)),Bo(y,null,W.component?se?se.children:null:v,D,O)})(B,W[B.value.outlet],v,D.concat([B.value]),O),delete W[B.value.outlet]}),Object.entries(W).forEach(([B,se])=>aa(se,v.getContext(B),O)),O}function aa(y,E,v){const D=zs(y),O=y.value;Object.entries(D).forEach(([W,B])=>{aa(B,O.component?E?E.children.getContext(W):null:E,v)}),v.canDeactivateChecks.push(new $l(O.component&&E&&E.outlet&&E.outlet.isActivated?E.outlet.component:null,O))}function Ts(y){return"function"==typeof y}function $c(y){return y instanceof dt.K||"EmptyError"===y?.name}const Ri=Symbol("INITIAL_VALUE");function Ho(){return(0,He.w)(y=>(0,Dt.a)(y.map(E=>E.pipe((0,ke.q)(1),(0,it.O)(Ri)))).pipe((0,gt.U)(E=>{for(const v of E)if(!0!==v){if(v===Ri)return Ri;if(!1===v||v instanceof Ai)return v}return!0}),(0,Ut.h)(E=>E!==Ri),(0,ke.q)(1)))}function ol(y){return(0,Le.z)((0,Ti.b)(E=>{if(Et(E))throw hs(0,E)}),(0,gt.U)(E=>!0===E))}class En{constructor(E){this.segmentGroup=E||null}}class nr{constructor(E){this.urlTree=E}}function Ke(y){return Ae(new En(y))}function Wn(y){return Ae(new nr(y))}class ha{constructor(E,v){this.urlSerializer=E,this.urlTree=v}noMatchError(E){return new M.vHH(4002,!1)}lineralizeSegments(E,v){let D=[],O=v.root;for(;;){if(D=D.concat(O.segments),0===O.numberOfChildren)return(0,Ee.of)(D);if(O.numberOfChildren>1||!O.children[yt])return Ae(new M.vHH(4e3,!1));O=O.children[yt]}}applyRedirectCommands(E,v,D){return this.applyRedirectCreateUrlTree(v,this.urlSerializer.parse(v),E,D)}applyRedirectCreateUrlTree(E,v,D,O){const W=this.createSegmentGroup(E,v.root,D,O);return new Ai(W,this.createQueryParams(v.queryParams,this.urlTree.queryParams),v.fragment)}createQueryParams(E,v){const D={};return Object.entries(E).forEach(([O,W])=>{if("string"==typeof W&&W.startsWith(":")){const se=W.substring(1);D[O]=v[se]}else D[O]=W}),D}createSegmentGroup(E,v,D,O){const W=this.createSegments(E,v.segments,D,O);let B={};return Object.entries(v.children).forEach(([se,ot])=>{B[se]=this.createSegmentGroup(E,ot,D,O)}),new Ln(W,B)}createSegments(E,v,D,O){return v.map(W=>W.path.startsWith(":")?this.findPosParam(E,W,O):this.findOrReturn(W,D))}findPosParam(E,v,D){const O=D[v.path.substring(1)];if(!O)throw new M.vHH(4001,!1);return O}findOrReturn(E,v){let D=0;for(const O of v){if(O.path===E.path)return v.splice(D),O;D++}return E}}const io={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Oa(y,E,v,D,O){const W=fa(y,E,v);return W.matched?(D=function Fp(y,E){return y.providers&&!y._injector&&(y._injector=(0,M.MMx)(y.providers,E,`Route: ${y.path}`)),y._injector??E}(E,D),function Hi(y,E,v,D){const O=E.canMatch;if(!O||0===O.length)return(0,Ee.of)(!0);const W=O.map(B=>{const se=ko(B,y);return en(function Qu(y){return y&&Ts(y.canMatch)}(se)?se.canMatch(E,v):y.runInContext(()=>se(E,v)))});return(0,Ee.of)(W).pipe(Ho(),ol())}(D,E,v).pipe((0,gt.U)(B=>!0===B?W:{...io}))):(0,Ee.of)(W)}function fa(y,E,v){if(""===E.path)return"full"===E.pathMatch&&(y.hasChildren()||v.length>0)?{...io}:{matched:!0,consumedSegments:[],remainingSegments:v,parameters:{},positionalParamSegments:{}};const O=(E.matcher||ri)(v,y,E);if(!O)return{...io};const W={};Object.entries(O.posParams??{}).forEach(([se,ot])=>{W[se]=ot.path});const B=O.consumed.length>0?{...W,...O.consumed[O.consumed.length-1].parameters}:W;return{matched:!0,consumedSegments:O.consumed,remainingSegments:v.slice(O.consumed.length),parameters:B,positionalParamSegments:O.posParams??{}}}function $s(y,E,v,D){return v.length>0&&function Kl(y,E,v){return v.some(D=>al(y,E,D)&&xi(D)!==yt)}(y,v,D)?{segmentGroup:new Ln(E,Go(D,new Ln(v,y.children))),slicedSegments:[]}:0===v.length&&function Jl(y,E,v){return v.some(D=>al(y,E,D))}(y,v,D)?{segmentGroup:new Ln(y.segments,Vo(y,0,v,D,y.children)),slicedSegments:v}:{segmentGroup:new Ln(y.segments,y.children),slicedSegments:v}}function Vo(y,E,v,D,O){const W={};for(const B of D)if(al(y,v,B)&&!O[xi(B)]){const se=new Ln([],{});W[xi(B)]=se}return{...O,...W}}function Go(y,E){const v={};v[yt]=E;for(const D of y)if(""===D.path&&xi(D)!==yt){const O=new Ln([],{});v[xi(D)]=O}return v}function al(y,E,v){return(!(y.hasChildren()||E.length>0)||"full"!==v.pathMatch)&&""===v.path}class Ds{constructor(E,v,D,O,W,B,se){this.injector=E,this.configLoader=v,this.rootComponentType=D,this.config=O,this.urlTree=W,this.paramsInheritanceStrategy=B,this.urlSerializer=se,this.allowRedirects=!0,this.applyRedirects=new ha(this.urlSerializer,this.urlTree)}noMatchError(E){return new M.vHH(4002,!1)}recognize(){const E=$s(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,E,yt).pipe(be(v=>{if(v instanceof nr)return this.allowRedirects=!1,this.urlTree=v.urlTree,this.match(v.urlTree);throw v instanceof En?this.noMatchError(v):v}),(0,gt.U)(v=>{const D=new Qi([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},yt,this.rootComponentType,null,{}),O=new Hs(D,v),W=new Oo("",O),B=function Mi(y,E,v=null,D=null){return Mr(mn(y),E,v,D)}(D,[],this.urlTree.queryParams,this.urlTree.fragment);return B.queryParams=this.urlTree.queryParams,W.url=this.urlSerializer.serialize(B),this.inheritParamsAndData(W._root),{state:W,tree:B}}))}match(E){return this.processSegmentGroup(this.injector,this.config,E.root,yt).pipe(be(D=>{throw D instanceof En?this.noMatchError(D):D}))}inheritParamsAndData(E){const v=E.value,D=Dr(v,this.paramsInheritanceStrategy);v.params=Object.freeze(D.params),v.data=Object.freeze(D.data),E.children.forEach(O=>this.inheritParamsAndData(O))}processSegmentGroup(E,v,D,O){return 0===D.segments.length&&D.hasChildren()?this.processChildren(E,v,D):this.processSegment(E,v,D,D.segments,O,!0)}processChildren(E,v,D){const O=[];for(const W of Object.keys(D.children))"primary"===W?O.unshift(W):O.push(W);return(0,Me.D)(O).pipe((0,kn.b)(W=>{const B=D.children[W],se=function Wl(y,E){const v=y.filter(D=>xi(D)===E);return v.push(...y.filter(D=>xi(D)!==E)),v}(v,W);return this.processSegmentGroup(E,se,B,W)}),function Ue(y,E){return(0,ht.e)(function Oe(y,E,v,D,O){return(W,B)=>{let se=v,ot=E,Ht=0;W.subscribe((0,an.x)(B,Jt=>{const In=Ht++;ot=se?y(ot,Jt,In):(se=!0,Jt),D&&B.next(ot)},O&&(()=>{se&&B.next(ot),B.complete()})))}}(y,E,arguments.length>=2,!0))}((W,B)=>(W.push(...B),W)),(0,rt.d)(null),function Bn(y,E){const v=arguments.length>=2;return D=>D.pipe(y?(0,Ut.h)((O,W)=>y(O,W,D)):tn.y,Rt(1),v?(0,rt.d)(E):(0,wt.T)(()=>new dt.K))}(),(0,vt.z)(W=>{if(null===W)return Ke(D);const B=Wo(W);return function yo(y){y.sort((E,v)=>E.value.outlet===yt?-1:v.value.outlet===yt?1:E.value.outlet.localeCompare(v.value.outlet))}(B),(0,Ee.of)(B)}))}processSegment(E,v,D,O,W,B){return(0,Me.D)(v).pipe((0,kn.b)(se=>this.processSegmentAgainstRoute(se._injector??E,v,se,D,O,W,B).pipe(be(ot=>{if(ot instanceof En)return(0,Ee.of)(null);throw ot}))),(0,pn.P)(se=>!!se),be(se=>{if($c(se))return function Yc(y,E,v){return 0===E.length&&!y.children[v]}(D,O,W)?(0,Ee.of)([]):Ke(D);throw se}))}processSegmentAgainstRoute(E,v,D,O,W,B,se){return function Uh(y,E,v,D){return!!(xi(y)===D||D!==yt&&al(E,v,y))&&("**"===y.path||fa(E,y,v).matched)}(D,O,W,B)?void 0===D.redirectTo?this.matchSegmentAgainstRoute(E,O,D,W,B,se):se&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(E,O,v,D,W,B):Ke(O):Ke(O)}expandSegmentAgainstRouteUsingRedirect(E,v,D,O,W,B){return"**"===O.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(E,D,O,B):this.expandRegularSegmentAgainstRouteUsingRedirect(E,v,D,O,W,B)}expandWildCardWithParamsAgainstRouteUsingRedirect(E,v,D,O){const W=this.applyRedirects.applyRedirectCommands([],D.redirectTo,{});return D.redirectTo.startsWith("/")?Wn(W):this.applyRedirects.lineralizeSegments(D,W).pipe((0,vt.z)(B=>{const se=new Ln(B,{});return this.processSegment(E,v,se,B,O,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(E,v,D,O,W,B){const{matched:se,consumedSegments:ot,remainingSegments:Ht,positionalParamSegments:Jt}=fa(v,O,W);if(!se)return Ke(v);const In=this.applyRedirects.applyRedirectCommands(ot,O.redirectTo,Jt);return O.redirectTo.startsWith("/")?Wn(In):this.applyRedirects.lineralizeSegments(O,In).pipe((0,vt.z)(mr=>this.processSegment(E,D,v,mr.concat(Ht),B,!1)))}matchSegmentAgainstRoute(E,v,D,O,W,B){let se;if("**"===D.path){const ot=O.length>0?Xe(O).parameters:{},Ht=new Qi(O,ot,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cl(D),xi(D),D.component??D._loadedComponent??null,D,js(D));se=(0,Ee.of)({snapshot:Ht,consumedSegments:[],remainingSegments:[]}),v.children={}}else se=Oa(v,D,O,E).pipe((0,gt.U)(({matched:ot,consumedSegments:Ht,remainingSegments:Jt,parameters:In})=>ot?{snapshot:new Qi(Ht,In,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cl(D),xi(D),D.component??D._loadedComponent??null,D,js(D)),consumedSegments:Ht,remainingSegments:Jt}:null));return se.pipe((0,He.w)(ot=>null===ot?Ke(v):this.getChildConfig(E=D._injector??E,D,O).pipe((0,He.w)(({routes:Ht})=>{const Jt=D._loadedInjector??E,{snapshot:In,consumedSegments:mr,remainingSegments:Qc}=ot,{segmentGroup:Vi,slicedSegments:Yo}=$s(v,mr,Qc,Ht);if(0===Yo.length&&Vi.hasChildren())return this.processChildren(Jt,Ht,Vi).pipe((0,gt.U)(ga=>null===ga?null:[new Hs(In,ga)]));if(0===Ht.length&&0===Yo.length)return(0,Ee.of)([new Hs(In,[])]);const Gi=xi(D)===W;return this.processSegment(Jt,Ht,Vi,Yo,Gi?yt:W,!0).pipe((0,gt.U)(ga=>[new Hs(In,ga)]))}))))}getChildConfig(E,v,D){return v.children?(0,Ee.of)({routes:v.children,injector:E}):v.loadChildren?void 0!==v._loadedRoutes?(0,Ee.of)({routes:v._loadedRoutes,injector:v._loadedInjector}):function Xc(y,E,v,D){const O=E.canLoad;if(void 0===O||0===O.length)return(0,Ee.of)(!0);const W=O.map(B=>{const se=ko(B,y);return en(function Kr(y){return y&&Ts(y.canLoad)}(se)?se.canLoad(E,v):y.runInContext(()=>se(E,v)))});return(0,Ee.of)(W).pipe(Ho(),ol())}(E,v,D).pipe((0,vt.z)(O=>O?this.configLoader.loadChildren(E,v).pipe((0,Ti.b)(W=>{v._loadedRoutes=W.routes,v._loadedInjector=W.injector})):function da(y){return Ae(Gs(!1,3))}())):(0,Ee.of)({routes:[],injector:E})}}function ll(y){const E=y.value.routeConfig;return E&&""===E.path}function Wo(y){const E=[],v=new Set;for(const D of y){if(!ll(D)){E.push(D);continue}const O=E.find(W=>D.value.routeConfig===W.value.routeConfig);void 0!==O?(O.children.push(...D.children),v.add(O)):E.push(D)}for(const D of v){const O=Wo(D.children);E.push(new Hs(D.value,O))}return E.filter(D=>!v.has(D))}function cl(y){return y.data||{}}function js(y){return y.resolve||{}}function Pi(y){return"string"==typeof y.title||null===y.title}function Ur(y){return(0,He.w)(E=>{const v=y(E);return v?(0,Me.D)(v).pipe((0,gt.U)(()=>E)):(0,Ee.of)(E)})}const K=new M.OlP("ROUTES");let w=(()=>{class y{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,M.f3M)(M.Sil)}loadComponent(v){if(this.componentLoaders.get(v))return this.componentLoaders.get(v);if(v._loadedComponent)return(0,Ee.of)(v._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(v);const D=en(v.loadComponent()).pipe((0,gt.U)(A),(0,Ti.b)(W=>{this.onLoadEndListener&&this.onLoadEndListener(v),v._loadedComponent=W}),(0,nn.x)(()=>{this.componentLoaders.delete(v)})),O=new zn(D,()=>new Pt.x).pipe(Pn());return this.componentLoaders.set(v,O),O}loadChildren(v,D){if(this.childrenLoaders.get(D))return this.childrenLoaders.get(D);if(D._loadedRoutes)return(0,Ee.of)({routes:D._loadedRoutes,injector:D._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(D);const W=this.loadModuleFactoryOrRoutes(D.loadChildren).pipe((0,gt.U)(se=>{this.onLoadEndListener&&this.onLoadEndListener(D);let ot,Ht;return Array.isArray(se)?Ht=se:(ot=se.create(v).injector,Ht=ot.get(K,[],M.XFs.Self|M.XFs.Optional).flat()),{routes:Ht.map(Er),injector:ot}}),(0,nn.x)(()=>{this.childrenLoaders.delete(D)})),B=new zn(W,()=>new Pt.x).pipe(Pn());return this.childrenLoaders.set(D,B),B}loadModuleFactoryOrRoutes(v){return en(v()).pipe((0,gt.U)(A),(0,vt.z)(D=>D instanceof M.YKP||Array.isArray(D)?(0,Ee.of)(D):(0,Me.D)(this.compiler.compileModuleAsync(D))))}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();function A(y){return function F(y){return y&&"object"==typeof y&&"default"in y}(y)?y.default:y}let k=(()=>{class y{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Pt.x,this.configLoader=(0,M.f3M)(w),this.environmentInjector=(0,M.f3M)(M.lqb),this.urlSerializer=(0,M.f3M)(Qn),this.rootContexts=(0,M.f3M)(or),this.inputBindingEnabled=null!==(0,M.f3M)(pr,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Ee.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=O=>this.events.next(new Hc(O)),this.configLoader.onLoadStartListener=O=>this.events.next(new tl(O))}complete(){this.transitions?.complete()}handleNavigationRequest(v){const D=++this.navigationId;this.transitions?.next({...this.transitions.value,...v,id:D})}setupNavigations(v){return this.transitions=new Ve.X({id:0,currentUrlTree:v.currentUrlTree,currentRawUrl:v.currentUrlTree,extractedUrl:v.urlHandlingStrategy.extract(v.currentUrlTree),urlAfterRedirects:v.urlHandlingStrategy.extract(v.currentUrlTree),rawUrl:v.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:fo,restoredState:null,currentSnapshot:v.routerState.snapshot,targetSnapshot:null,currentRouterState:v.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,Ut.h)(D=>0!==D.id),(0,gt.U)(D=>({...D,extractedUrl:v.urlHandlingStrategy.extract(D.rawUrl)})),(0,He.w)(D=>{let O=!1,W=!1;return(0,Ee.of)(D).pipe((0,Ti.b)(B=>{this.currentNavigation={id:B.id,initialUrl:B.rawUrl,extractedUrl:B.extractedUrl,trigger:B.source,extras:B.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,He.w)(B=>{const se=v.browserUrlTree.toString(),ot=!v.navigated||B.extractedUrl.toString()!==se||se!==v.currentUrlTree.toString();if(!ot&&"reload"!==(B.extras.onSameUrlNavigation??v.onSameUrlNavigation)){const Jt="";return this.events.next(new po(B.id,v.serializeUrl(D.rawUrl),Jt,0)),v.rawUrlTree=B.rawUrl,B.resolve(null),Ct.E}if(v.urlHandlingStrategy.shouldProcessUrl(B.rawUrl))return Y(B.source)&&(v.browserUrlTree=B.extractedUrl),(0,Ee.of)(B).pipe((0,He.w)(Jt=>{const In=this.transitions?.getValue();return this.events.next(new Aa(Jt.id,this.urlSerializer.serialize(Jt.extractedUrl),Jt.source,Jt.restoredState)),In!==this.transitions?.getValue()?Ct.E:Promise.resolve(Jt)}),function Ei(y,E,v,D,O,W){return(0,vt.z)(B=>function td(y,E,v,D,O,W,B="emptyOnly"){return new Ds(y,E,v,D,O,B,W).recognize()}(y,E,v,D,B.extractedUrl,O,W).pipe((0,gt.U)(({state:se,tree:ot})=>({...B,targetSnapshot:se,urlAfterRedirects:ot}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,v.config,this.urlSerializer,v.paramsInheritanceStrategy),(0,Ti.b)(Jt=>{if(D.targetSnapshot=Jt.targetSnapshot,D.urlAfterRedirects=Jt.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:Jt.urlAfterRedirects},"eager"===v.urlUpdateStrategy){if(!Jt.extras.skipLocationChange){const mr=v.urlHandlingStrategy.merge(Jt.urlAfterRedirects,Jt.rawUrl);v.setBrowserUrl(mr,Jt)}v.browserUrlTree=Jt.urlAfterRedirects}const In=new Ia(Jt.id,this.urlSerializer.serialize(Jt.extractedUrl),this.urlSerializer.serialize(Jt.urlAfterRedirects),Jt.targetSnapshot);this.events.next(In)}));if(ot&&v.urlHandlingStrategy.shouldProcessUrl(v.rawUrlTree)){const{id:Jt,extractedUrl:In,source:mr,restoredState:Qc,extras:Vi}=B,Yo=new Aa(Jt,this.urlSerializer.serialize(In),mr,Qc);this.events.next(Yo);const Gi=Ot(0,this.rootComponentType).snapshot;return D={...B,targetSnapshot:Gi,urlAfterRedirects:In,extras:{...Vi,skipLocationChange:!1,replaceUrl:!1}},(0,Ee.of)(D)}{const Jt="";return this.events.next(new po(B.id,v.serializeUrl(D.extractedUrl),Jt,1)),v.rawUrlTree=B.rawUrl,B.resolve(null),Ct.E}}),(0,Ti.b)(B=>{const se=new Qa(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(se)}),(0,gt.U)(B=>D={...B,guards:Fh(B.targetSnapshot,B.currentSnapshot,this.rootContexts)}),function zo(y,E){return(0,vt.z)(v=>{const{targetSnapshot:D,currentSnapshot:O,guards:{canActivateChecks:W,canDeactivateChecks:B}}=v;return 0===B.length&&0===W.length?(0,Ee.of)({...v,guardsResult:!0}):function Xl(y,E,v,D){return(0,Me.D)(y).pipe((0,vt.z)(O=>function Zl(y,E,v,D,O){const W=E&&E.routeConfig?E.routeConfig.canDeactivate:null;if(!W||0===W.length)return(0,Ee.of)(!0);const B=W.map(se=>{const ot=ws(E)??O,Ht=ko(se,ot);return en(function Ju(y){return y&&Ts(y.canDeactivate)}(Ht)?Ht.canDeactivate(y,E,v,D):ot.runInContext(()=>Ht(y,E,v,D))).pipe((0,pn.P)())});return(0,Ee.of)(B).pipe(Ho())}(O.component,O.route,v,E,D)),(0,pn.P)(O=>!0!==O,!0))}(B,D,O,y).pipe((0,vt.z)(se=>se&&function la(y){return"boolean"==typeof y}(se)?function ed(y,E,v,D){return(0,Me.D)(E).pipe((0,kn.b)(O=>(0,Ze.z)(function jc(y,E){return null!==y&&E&&E(new zl(y)),(0,Ee.of)(!0)}(O.route.parent,D),function sl(y,E){return null!==y&&E&&E(new zr(y)),(0,Ee.of)(!0)}(O.route,D),function ql(y,E,v){const D=E[E.length-1],W=E.slice(0,E.length-1).reverse().map(B=>function Ku(y){const E=y.routeConfig?y.routeConfig.canActivateChild:null;return E&&0!==E.length?{node:y,guards:E}:null}(B)).filter(B=>null!==B).map(B=>ye(()=>{const se=B.guards.map(ot=>{const Ht=ws(B.node)??v,Jt=ko(ot,Ht);return en(function jl(y){return y&&Ts(y.canActivateChild)}(Jt)?Jt.canActivateChild(D,y):Ht.runInContext(()=>Jt(D,y))).pipe((0,pn.P)())});return(0,Ee.of)(se).pipe(Ho())}));return(0,Ee.of)(W).pipe(Ho())}(y,O.path,v),function Yl(y,E,v){const D=E.routeConfig?E.routeConfig.canActivate:null;if(!D||0===D.length)return(0,Ee.of)(!0);const O=D.map(W=>ye(()=>{const B=ws(E)??v,se=ko(W,B);return en(function tr(y){return y&&Ts(y.canActivate)}(se)?se.canActivate(E,y):B.runInContext(()=>se(E,y))).pipe((0,pn.P)())}));return(0,Ee.of)(O).pipe(Ho())}(y,O.route,v))),(0,pn.P)(O=>!0!==O,!0))}(D,W,y,E):(0,Ee.of)(se)),(0,gt.U)(se=>({...v,guardsResult:se})))})}(this.environmentInjector,B=>this.events.next(B)),(0,Ti.b)(B=>{if(D.guardsResult=B.guardsResult,Et(B.guardsResult))throw hs(0,B.guardsResult);const se=new Hl(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot,!!B.guardsResult);this.events.next(se)}),(0,Ut.h)(B=>!!B.guardsResult||(v.restoreHistory(B),this.cancelNavigationTransition(B,"",3),!1)),Ur(B=>{if(B.guards.canActivateChecks.length)return(0,Ee.of)(B).pipe((0,Ti.b)(se=>{const ot=new Bc(se.id,this.urlSerializer.serialize(se.extractedUrl),this.urlSerializer.serialize(se.urlAfterRedirects),se.targetSnapshot);this.events.next(ot)}),(0,He.w)(se=>{let ot=!1;return(0,Ee.of)(se).pipe(function ro(y,E){return(0,vt.z)(v=>{const{targetSnapshot:D,guards:{canActivateChecks:O}}=v;if(!O.length)return(0,Ee.of)(v);let W=0;return(0,Me.D)(O).pipe((0,kn.b)(B=>function ec(y,E,v,D){const O=y.routeConfig,W=y._resolve;return void 0!==O?.title&&!Pi(O)&&(W[yi]=O.title),function so(y,E,v,D){const O=function tc(y){return[...Object.keys(y),...Object.getOwnPropertySymbols(y)]}(y);if(0===O.length)return(0,Ee.of)({});const W={};return(0,Me.D)(O).pipe((0,vt.z)(B=>function nd(y,E,v,D){const O=ws(E)??D,W=ko(y,O);return en(W.resolve?W.resolve(E,v):O.runInContext(()=>W(E,v)))}(y[B],E,v,D).pipe((0,pn.P)(),(0,Ti.b)(se=>{W[B]=se}))),Rt(1),(0,ii.h)(W),be(B=>$c(B)?Ct.E:Ae(B)))}(W,y,E,D).pipe((0,gt.U)(B=>(y._resolvedData=B,y.data=Dr(y,v).resolve,O&&Pi(O)&&(y.data[yi]=O.title),null)))}(B.route,D,y,E)),(0,Ti.b)(()=>W++),Rt(1),(0,vt.z)(B=>W===O.length?(0,Ee.of)(v):Ct.E))})}(v.paramsInheritanceStrategy,this.environmentInjector),(0,Ti.b)({next:()=>ot=!0,complete:()=>{ot||(v.restoreHistory(se),this.cancelNavigationTransition(se,"",2))}}))}),(0,Ti.b)(se=>{const ot=new el(se.id,this.urlSerializer.serialize(se.extractedUrl),this.urlSerializer.serialize(se.urlAfterRedirects),se.targetSnapshot);this.events.next(ot)}))}),Ur(B=>{const se=ot=>{const Ht=[];ot.routeConfig?.loadComponent&&!ot.routeConfig._loadedComponent&&Ht.push(this.configLoader.loadComponent(ot.routeConfig).pipe((0,Ti.b)(Jt=>{ot.component=Jt}),(0,gt.U)(()=>{})));for(const Jt of ot.children)Ht.push(...se(Jt));return Ht};return(0,Dt.a)(se(B.targetSnapshot.root)).pipe((0,rt.d)(),(0,ke.q)(1))}),Ur(()=>this.afterPreactivation()),(0,gt.U)(B=>{const se=function bs(y,E,v){const D=gn(y,E._root,v?v._root:void 0);return new ki(D,E)}(v.routeReuseStrategy,B.targetSnapshot,B.currentRouterState);return D={...B,targetRouterState:se}}),(0,Ti.b)(B=>{v.currentUrlTree=B.urlAfterRedirects,v.rawUrlTree=v.urlHandlingStrategy.merge(B.urlAfterRedirects,B.rawUrl),v.routerState=B.targetRouterState,"deferred"===v.urlUpdateStrategy&&(B.extras.skipLocationChange||v.setBrowserUrl(v.rawUrlTree,B),v.browserUrlTree=B.urlAfterRedirects)}),((y,E,v,D)=>(0,gt.U)(O=>(new sa(E,O.targetRouterState,O.currentRouterState,v,D).activate(y),O)))(this.rootContexts,v.routeReuseStrategy,B=>this.events.next(B),this.inputBindingEnabled),(0,ke.q)(1),(0,Ti.b)({next:B=>{O=!0,this.lastSuccessfulNavigation=this.currentNavigation,v.navigated=!0,this.events.next(new Bs(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(v.currentUrlTree))),v.titleStrategy?.updateTitle(B.targetRouterState.snapshot),B.resolve(!0)},complete:()=>{O=!0}}),(0,nn.x)(()=>{O||W||this.cancelNavigationTransition(D,"",1),this.currentNavigation?.id===D.id&&(this.currentNavigation=null)}),be(B=>{if(W=!0,il(B)){ra(B)||(v.navigated=!0,v.restoreHistory(D,!0));const se=new Po(D.id,this.urlSerializer.serialize(D.extractedUrl),B.message,B.cancellationCode);if(this.events.next(se),ra(B)){const ot=v.urlHandlingStrategy.merge(B.url,v.rawUrlTree),Ht={skipLocationChange:D.extras.skipLocationChange,replaceUrl:"eager"===v.urlUpdateStrategy||Y(D.source)};v.scheduleNavigation(ot,fo,null,Ht,{resolve:D.resolve,reject:D.reject,promise:D.promise})}else D.resolve(!1)}else{v.restoreHistory(D,!0);const se=new Lo(D.id,this.urlSerializer.serialize(D.extractedUrl),B,D.targetSnapshot??void 0);this.events.next(se);try{D.resolve(v.errorHandler(B))}catch(ot){D.reject(ot)}}return Ct.E}))}))}cancelNavigationTransition(v,D,O){const W=new Po(v.id,this.urlSerializer.serialize(v.extractedUrl),D,O);this.events.next(W),v.resolve(!1)}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();function Y(y){return y!==fo}let ve=(()=>{class y{buildTitle(v){let D,O=v.root;for(;void 0!==O;)D=this.getResolvedTitleForRoute(O)??D,O=O.children.find(W=>W.outlet===yt);return D}getResolvedTitleForRoute(v){return v.data[yi]}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:function(){return(0,M.f3M)(Te)},providedIn:"root"}),y})(),Te=(()=>{class y extends ve{constructor(v){super(),this.title=v}updateTitle(v){const D=this.buildTitle(v);void 0!==D&&this.title.setTitle(D)}}return y.\u0275fac=function(v){return new(v||y)(M.LFG(Xn.Dx))},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})(),Wt=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:function(){return(0,M.f3M)(qn)},providedIn:"root"}),y})();class Hn{shouldDetach(E){return!1}store(E,v){}shouldAttach(E){return!1}retrieve(E){return null}shouldReuseRoute(E,v){return E.routeConfig===v.routeConfig}}let qn=(()=>{class y extends Hn{}return y.\u0275fac=function(){let E;return function(D){return(E||(E=M.n5z(y)))(D||y)}}(),y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();const Fn=new M.OlP("",{providedIn:"root",factory:()=>({})});let bn=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:function(){return(0,M.f3M)(Di)},providedIn:"root"}),y})(),Di=(()=>{class y{shouldProcessUrl(v){return!0}extract(v){return v}merge(v,D){return v}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();var Nn=(()=>((Nn=Nn||{})[Nn.COMPLETE=0]="COMPLETE",Nn[Nn.FAILED=1]="FAILED",Nn[Nn.REDIRECTING=2]="REDIRECTING",Nn))();function qi(y,E){y.events.pipe((0,Ut.h)(v=>v instanceof Bs||v instanceof Po||v instanceof Lo||v instanceof po),(0,gt.U)(v=>v instanceof Bs||v instanceof po?Nn.COMPLETE:v instanceof Po&&(0===v.code||1===v.code)?Nn.REDIRECTING:Nn.FAILED),(0,Ut.h)(v=>v!==Nn.REDIRECTING),(0,ke.q)(1)).subscribe(()=>{E()})}function Xt(y){throw y}function Jr(y,E,v){return E.parse("/")}const pa={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Cr={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ki=(()=>{class y{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,M.f3M)(M.c2e),this.isNgZoneEnabled=!1,this.options=(0,M.f3M)(Fn,{optional:!0})||{},this.pendingTasks=(0,M.f3M)(M.HDt),this.errorHandler=this.options.errorHandler||Xt,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Jr,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,M.f3M)(bn),this.routeReuseStrategy=(0,M.f3M)(Wt),this.titleStrategy=(0,M.f3M)(ve),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,M.f3M)(K,{optional:!0})?.flat()??[],this.navigationTransitions=(0,M.f3M)(k),this.urlSerializer=(0,M.f3M)(Qn),this.location=(0,M.f3M)(ge.Ye),this.componentInputBindingEnabled=!!(0,M.f3M)(pr,{optional:!0}),this.isNgZoneEnabled=(0,M.f3M)(M.R0b)instanceof M.R0b&&M.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Ai,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Ot(0,null),this.navigationTransitions.setupNavigations(this).subscribe(v=>{this.lastSuccessfulId=v.id,this.currentPageId=this.browserPageId??0},v=>{this.console.warn(`Unhandled Navigation Error: ${v}`)})}resetRootComponentType(v){this.routerState.root.component=v,this.navigationTransitions.rootComponentType=v}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const v=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),fo,v)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(v=>{const D="popstate"===v.type?"popstate":"hashchange";"popstate"===D&&setTimeout(()=>{this.navigateToSyncWithBrowser(v.url,D,v.state)},0)}))}navigateToSyncWithBrowser(v,D,O){const W={replaceUrl:!0},B=O?.navigationId?O:null;if(O){const ot={...O};delete ot.navigationId,delete ot.\u0275routerPageId,0!==Object.keys(ot).length&&(W.state=ot)}const se=this.parseUrl(v);this.scheduleNavigation(se,D,B,W)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(v){this.config=v.map(Er),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(v,D={}){const{relativeTo:O,queryParams:W,fragment:B,queryParamsHandling:se,preserveFragment:ot}=D,Ht=ot?this.currentUrlTree.fragment:B;let In,Jt=null;switch(se){case"merge":Jt={...this.currentUrlTree.queryParams,...W};break;case"preserve":Jt=this.currentUrlTree.queryParams;break;default:Jt=W||null}null!==Jt&&(Jt=this.removeEmptyProps(Jt));try{In=mn(O?O.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof v[0]||!v[0].startsWith("/"))&&(v=[]),In=this.currentUrlTree.root}return Mr(In,v,Jt,Ht??null)}navigateByUrl(v,D={skipLocationChange:!1}){const O=Et(v)?v:this.parseUrl(v),W=this.urlHandlingStrategy.merge(O,this.rawUrlTree);return this.scheduleNavigation(W,fo,null,D)}navigate(v,D={skipLocationChange:!1}){return function Ar(y){for(let E=0;E<y.length;E++)if(null==y[E])throw new M.vHH(4008,!1)}(v),this.navigateByUrl(this.createUrlTree(v,D),D)}serializeUrl(v){return this.urlSerializer.serialize(v)}parseUrl(v){let D;try{D=this.urlSerializer.parse(v)}catch(O){D=this.malformedUriErrorHandler(O,this.urlSerializer,v)}return D}isActive(v,D){let O;if(O=!0===D?{...pa}:!1===D?{...Cr}:D,Et(v))return _i(this.currentUrlTree,v,O);const W=this.parseUrl(v);return _i(this.currentUrlTree,W,O)}removeEmptyProps(v){return Object.keys(v).reduce((D,O)=>{const W=v[O];return null!=W&&(D[O]=W),D},{})}scheduleNavigation(v,D,O,W,B){if(this.disposed)return Promise.resolve(!1);let se,ot,Ht;B?(se=B.resolve,ot=B.reject,Ht=B.promise):Ht=new Promise((In,mr)=>{se=In,ot=mr});const Jt=this.pendingTasks.add();return qi(this,()=>{Promise.resolve().then(()=>this.pendingTasks.remove(Jt))}),this.navigationTransitions.handleNavigationRequest({source:D,restoredState:O,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:v,extras:W,resolve:se,reject:ot,promise:Ht,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ht.catch(In=>Promise.reject(In))}setBrowserUrl(v,D){const O=this.urlSerializer.serialize(v);if(this.location.isCurrentPathEqualTo(O)||D.extras.replaceUrl){const B={...D.extras.state,...this.generateNgRouterState(D.id,this.browserPageId)};this.location.replaceState(O,"",B)}else{const W={...D.extras.state,...this.generateNgRouterState(D.id,(this.browserPageId??0)+1)};this.location.go(O,"",W)}}restoreHistory(v,D=!1){if("computed"===this.canceledNavigationResolution){const W=this.currentPageId-(this.browserPageId??this.currentPageId);0!==W?this.location.historyGo(W):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===W&&(this.resetState(v),this.browserUrlTree=v.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(D&&this.resetState(v),this.resetUrlToCurrentUrlTree())}resetState(v){this.routerState=v.currentRouterState,this.currentUrlTree=v.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,v.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(v,D){return"computed"===this.canceledNavigationResolution?{navigationId:v,\u0275routerPageId:D}:{navigationId:v}}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})(),ur=(()=>{class y{constructor(v,D,O,W,B,se){this.router=v,this.route=D,this.tabIndexAttribute=O,this.renderer=W,this.el=B,this.locationStrategy=se,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Pt.x;const ot=B.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===ot||"area"===ot,this.isAnchorElement?this.subscription=v.events.subscribe(Ht=>{Ht instanceof Bs&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(v){this._preserveFragment=(0,M.D6c)(v)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(v){this._skipLocationChange=(0,M.D6c)(v)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(v){this._replaceUrl=(0,M.D6c)(v)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(v){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",v)}ngOnChanges(v){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(v){null!=v?(this.commands=Array.isArray(v)?v:[v],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(v,D,O,W,B){return!!(null===this.urlTree||this.isAnchorElement&&(0!==v||D||O||W||B||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const v=null===this.href?null:(0,M.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",v)}applyAttributeValue(v,D){const O=this.renderer,W=this.el.nativeElement;null!==D?O.setAttribute(W,v,D):O.removeAttribute(W,v)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return y.\u0275fac=function(v){return new(v||y)(M.Y36(Ki),M.Y36(ei),M.$8M("tabindex"),M.Y36(M.Qsj),M.Y36(M.SBq),M.Y36(ge.S$))},y.\u0275dir=M.lG2({type:y,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(v,D){1&v&&M.NdJ("click",function(W){return D.onClick(W.button,W.ctrlKey,W.shiftKey,W.altKey,W.metaKey)}),2&v&&M.uIk("target",D.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[M.TTD]}),y})();class _o{}let Zc=(()=>{class y{constructor(v,D,O,W,B){this.router=v,this.injector=O,this.preloadingStrategy=W,this.loader=B}setUpPreloading(){this.subscription=this.router.events.pipe((0,Ut.h)(v=>v instanceof Bs),(0,kn.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(v,D){const O=[];for(const W of D){W.providers&&!W._injector&&(W._injector=(0,M.MMx)(W.providers,v,`Route: ${W.path}`));const B=W._injector??v,se=W._loadedInjector??B;(W.loadChildren&&!W._loadedRoutes&&void 0===W.canLoad||W.loadComponent&&!W._loadedComponent)&&O.push(this.preloadConfig(B,W)),(W.children||W._loadedRoutes)&&O.push(this.processRoutes(se,W.children??W._loadedRoutes))}return(0,Me.D)(O).pipe((0,gi.J)())}preloadConfig(v,D){return this.preloadingStrategy.preload(D,()=>{let O;O=D.loadChildren&&void 0===D.canLoad?this.loader.loadChildren(v,D):(0,Ee.of)(null);const W=O.pipe((0,vt.z)(B=>null===B?(0,Ee.of)(void 0):(D._loadedRoutes=B.routes,D._loadedInjector=B.injector,this.processRoutes(B.injector??v,B.routes))));if(D.loadComponent&&!D._loadedComponent){const B=this.loader.loadComponent(D);return(0,Me.D)([W,B]).pipe((0,gi.J)())}return W})}}return y.\u0275fac=function(v){return new(v||y)(M.LFG(Ki),M.LFG(M.Sil),M.LFG(M.lqb),M.LFG(_o),M.LFG(w))},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();const et=new M.OlP("");let kt=(()=>{class y{constructor(v,D,O,W,B={}){this.urlSerializer=v,this.transitions=D,this.viewportScroller=O,this.zone=W,this.options=B,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},B.scrollPositionRestoration=B.scrollPositionRestoration||"disabled",B.anchorScrolling=B.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(v=>{v instanceof Aa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=v.navigationTrigger,this.restoredId=v.restoredState?v.restoredState.navigationId:0):v instanceof Bs?(this.lastId=v.id,this.scheduleScrollEvent(v,this.urlSerializer.parse(v.urlAfterRedirects).fragment)):v instanceof po&&0===v.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(v,this.urlSerializer.parse(v.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(v=>{v instanceof sr&&(v.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(v.position):v.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(v.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(v,D){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new sr(v,"popstate"===this.lastSource?this.store[this.restoredId]:null,D))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return y.\u0275fac=function(v){M.$Z()},y.\u0275prov=M.Yz7({token:y,factory:y.\u0275fac}),y})();function zi(y,E){return{\u0275kind:y,\u0275providers:E}}function ul(){const y=(0,M.f3M)(M.zs3);return E=>{const v=y.get(M.z2F);if(E!==v.components[0])return;const D=y.get(Ki),O=y.get(Kc);1===y.get(sd)&&D.initialNavigation(),y.get(jo,null,M.XFs.Optional)?.setUpPreloading(),y.get(et,null,M.XFs.Optional)?.init(),D.resetRootComponentType(v.componentTypes[0]),O.closed||(O.next(),O.complete(),O.unsubscribe())}}const Kc=new M.OlP("",{factory:()=>new Pt.x}),sd=new M.OlP("",{providedIn:"root",factory:()=>1}),jo=new M.OlP("");function es(y){return zi(0,[{provide:jo,useExisting:Zc},{provide:_o,useExisting:y}])}const dl=new M.OlP("ROUTER_FORROOT_GUARD"),sc=[ge.Ye,{provide:Qn,useClass:xn},Ki,or,{provide:ei,useFactory:function ps(y){return y.routerState.root},deps:[Ki]},w,[]];function od(){return new M.PXZ("Router",Ki)}let oc=(()=>{class y{constructor(v){}static forRoot(v,D){return{ngModule:y,providers:[sc,[],{provide:K,multi:!0,useValue:v},{provide:dl,useFactory:ac,deps:[[Ki,new M.FiY,new M.tp0]]},{provide:Fn,useValue:D||{}},D?.useHash?{provide:ge.S$,useClass:ge.Do}:{provide:ge.S$,useClass:ge.b0},{provide:et,useFactory:()=>{const y=(0,M.f3M)(ge.EM),E=(0,M.f3M)(M.R0b),v=(0,M.f3M)(Fn),D=(0,M.f3M)(k),O=(0,M.f3M)(Qn);return v.scrollOffset&&y.setOffset(v.scrollOffset),new kt(O,D,y,E,v)}},D?.preloadingStrategy?es(D.preloadingStrategy).\u0275providers:[],{provide:M.PXZ,multi:!0,useFactory:od},D?.initialNavigation?oo(D):[],D?.bindToComponentInputs?zi(8,[Yi,{provide:pr,useExisting:Yi}]).\u0275providers:[],[{provide:Xo,useFactory:ul},{provide:M.tb,multi:!0,useExisting:Xo}]]}}static forChild(v){return{ngModule:y,providers:[{provide:K,multi:!0,useValue:v}]}}}return y.\u0275fac=function(v){return new(v||y)(M.LFG(dl,8))},y.\u0275mod=M.oAB({type:y}),y.\u0275inj=M.cJS({}),y})();function ac(y){return"guarded"}function oo(y){return["disabled"===y.initialNavigation?zi(3,[{provide:M.ip1,multi:!0,useFactory:()=>{const E=(0,M.f3M)(Ki);return()=>{E.setUpLocationChangeListener()}}},{provide:sd,useValue:2}]).\u0275providers:[],"enabledBlocking"===y.initialNavigation?zi(2,[{provide:sd,useValue:0},{provide:M.ip1,multi:!0,deps:[M.zs3],useFactory:E=>{const v=E.get(ge.V_,Promise.resolve());return()=>v.then(()=>new Promise(D=>{const O=E.get(Ki),W=E.get(Kc);qi(O,()=>{D(!0)}),E.get(k).afterPreactivation=()=>(D(!0),W.closed?(0,Ee.of)(void 0):W),O.initialNavigation()}))}}]).\u0275providers:[]]}const Xo=new M.OlP("")}},jt=>{jt(jt.s=1130)}]);