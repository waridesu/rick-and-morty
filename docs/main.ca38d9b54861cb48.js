"use strict";(self.webpackChunkrick_and_morty=self.webpackChunkrick_and_morty||[]).push([[179],{7905:(Jt,$e,$)=>{$.d($e,{D:()=>tt});var x=$(2504),pe=$(7579),Pe=$(4482),Ve=$(5403),Ce=$(8421),Te=$(5032),Et=$(9300),ut=$(5742);let tt=(()=>{class me{constructor(wt){this.router=wt,this._isLoading=(0,x.tdS)(!1),this.destroyed$=new pe.x,this.router.events.pipe(function at(me){return(0,Pe.e)((We,wt)=>{(0,Ce.Xf)(me).subscribe((0,Ve.x)(wt,()=>wt.complete(),Te.Z)),!wt.closed&&We.subscribe(wt)})}(this.destroyed$),(0,Et.h)(pt=>pt instanceof ut.OD)).subscribe(()=>{this.isLoading=!0})}set isLoading(wt){this._isLoading.set(wt)}get isLoading$(){return this._isLoading}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}return me.\u0275fac=function(wt){return new(wt||me)(x.LFG(ut.F0))},me.\u0275prov=x.Yz7({token:me,factory:me.\u0275fac,providedIn:"root"}),me})()},1130:(Jt,$e,$)=>{var x=$(2504),pe=$(5742),Pe=$(4755);let Ve=(()=>{class c{constructor(){this.isOpenMenu=!1}toggleMenu(){this.isOpenMenu=!this.isOpenMenu}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=x.Xpm({type:c,selectors:[["app-header"]],standalone:!0,features:[x.jDz],decls:51,vars:2,consts:[[1,"container"],[1,"navbar","navbar-expand-lg","navbar-light","bg-light"],[1,"container-fluid"],["routerLink","",1,"navbar-brand"],["ngSrc","./assets/logo-image.png","alt","rick-and-morty","height","151","width","557",1,"logo-img"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","/characters",1,"nav-link"],["routerLink","/locations",1,"nav-link"],["routerLink","/episodes",1,"nav-link"],["routerLink","/favorites",1,"nav-link"],["routerLink","/statistics",1,"nav-link"],["type","button",1,"open-menu-btn",3,"click"],["width","50","height","50",1,"menu-icon"],["href","./assets/sprite.svg#icon-menu"],[1,"backdrop"],[1,"mob-menu-wrap"],[1,"mob-menu"],["type","button",1,"close-btn",3,"click"],["width","30","height","30",1,"close-icon"],["href","./assets/sprite.svg#icon-close"],[1,"mob-nav-list"],[1,"mob-nav-item"],["routerLink","/characters",1,"mob-nav-link",3,"click"],["routerLink","/locations",1,"mob-nav-link",3,"click"],["routerLink","/episodes",1,"mob-nav-link",3,"click"],["routerLink","/teleport",1,"mob-nav-link",3,"click"],["routerLink","/favorites",1,"mob-nav-link",3,"click"],["routerLink","/statistics",1,"mob-nav-link",3,"click"]],template:function(t,s){1&t&&(x.TgZ(0,"header")(1,"div",0)(2,"nav",1)(3,"div",2)(4,"a",3),x._UZ(5,"img",4),x.qZA(),x.TgZ(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),x._uU(10,"Characters"),x.qZA()(),x.TgZ(11,"li",7)(12,"a",9),x._uU(13,"Locations"),x.qZA()(),x.TgZ(14,"li",7)(15,"a",10),x._uU(16,"Episodes"),x.qZA()(),x.TgZ(17,"li",7)(18,"a",11),x._uU(19,"Favorite"),x.qZA()(),x.TgZ(20,"li",7)(21,"a",12),x._uU(22,"Statistics"),x.qZA()()()(),x.TgZ(23,"button",13),x.NdJ("click",function(){return s.toggleMenu()}),x.O4$(),x.TgZ(24,"svg",14),x._UZ(25,"use",15),x.qZA()()()()(),x.kcU(),x.TgZ(26,"div",16)(27,"div",17)(28,"div",18)(29,"button",19),x.NdJ("click",function(){return s.toggleMenu()}),x.O4$(),x.TgZ(30,"svg",20),x._UZ(31,"use",21),x.qZA()(),x.kcU(),x.TgZ(32,"ul",22)(33,"li",23)(34,"a",24),x.NdJ("click",function(){return s.toggleMenu()}),x._uU(35,"Characters"),x.qZA()(),x.TgZ(36,"li",23)(37,"a",25),x.NdJ("click",function(){return s.toggleMenu()}),x._uU(38,"Locations"),x.qZA()(),x.TgZ(39,"li",23)(40,"a",26),x.NdJ("click",function(){return s.toggleMenu()}),x._uU(41,"Episodes"),x.qZA()(),x.TgZ(42,"li",23)(43,"a",27),x.NdJ("click",function(){return s.toggleMenu()}),x._uU(44,"Teleport"),x.qZA()(),x.TgZ(45,"li",23)(46,"a",28),x.NdJ("click",function(){return s.toggleMenu()}),x._uU(47,"Favorite"),x.qZA()(),x.TgZ(48,"li",23)(49,"a",29),x.NdJ("click",function(){return s.toggleMenu()}),x._uU(50,"Statistics"),x.qZA()()()()()()()),2&t&&(x.xp6(26),x.ekj("visible",s.isOpenMenu))},dependencies:[Pe.ez,pe.rH,Pe.Zd],styles:[".container[_ngcontent-%COMP%]{width:100%;margin:0 auto;padding:0 16px;display:flex;flex-direction:column;flex:1}@media (min-width: 375px){.container[_ngcontent-%COMP%]{width:375px}}@media (min-width: 768px){.container[_ngcontent-%COMP%]{padding:0 32px;width:768px}}@media (min-width: 1200px){.container[_ngcontent-%COMP%]{padding:0 40px;width:1200px}}.navbar[_ngcontent-%COMP%]{padding:20px 0}.container-fluid[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar-nav[_ngcontent-%COMP%]{display:flex;list-style:none;gap:20px}.navbar-collapse[_ngcontent-%COMP%]{display:none}@media (min-width: 1200px){.navbar-collapse[_ngcontent-%COMP%]{display:block;width:750px;margin-left:auto}}.logo-img[_ngcontent-%COMP%]{width:200px}@media (min-width: 768px){.logo-img[_ngcontent-%COMP%]{width:280px}}@media (min-width: 1200px){.logo-img[_ngcontent-%COMP%]{width:300px}}.nav-link[_ngcontent-%COMP%]{font-size:20px;color:#87f54e;padding:10px 0;transition:color .25s linear}.nav-link[_ngcontent-%COMP%]:hover, .nav-link[_ngcontent-%COMP%]:focus{color:#11b0c8}.open-menu-btn[_ngcontent-%COMP%]{width:50px;height:50px;background-color:transparent;margin-left:auto;padding:0;border:none;display:block}@media (min-width: 1200px){.open-menu-btn[_ngcontent-%COMP%]{display:none}}.menu-icon[_ngcontent-%COMP%]{fill:#87f54e;transition:.25s linear}.menu-icon[_ngcontent-%COMP%]:hover, .menu-icon[_ngcontent-%COMP%]:focus{fill:#11b0c8}.backdrop[_ngcontent-%COMP%]{background-color:#0006;position:fixed;top:0;right:0;width:100vw;height:100vh;opacity:0;visibility:hidden;z-index:5;transition:.4s linear}@media (min-width: 768px){.backdrop[_ngcontent-%COMP%]{transition:.25s linear}}.backdrop.visible[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:rotate(720deg) scale(1)}@media (min-width: 768px){.backdrop.visible[_ngcontent-%COMP%]{transform:none}}.mob-menu-wrap[_ngcontent-%COMP%]{width:100vw;height:100vh;padding-top:100px;background-color:#000;position:fixed;top:0;right:0;background-image:url(background-image.57a7128de4add091.png)}@media (min-width: 768px){.mob-menu-wrap[_ngcontent-%COMP%]{width:50vw;transform:translate(100%);transition:.25s linear}}@media (min-width: 1200px){.mob-menu-wrap[_ngcontent-%COMP%]{display:none}}.backdrop.visible[_ngcontent-%COMP%]   .mob-menu-wrap[_ngcontent-%COMP%]{transform:translate(0)}.close-btn[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;background-color:transparent;width:40px;height:40px;border:none}.close-icon[_ngcontent-%COMP%]{fill:#fff}.mob-nav-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.mob-nav-item[_ngcontent-%COMP%]:not(:last-child){margin-bottom:20px}.mob-nav-link[_ngcontent-%COMP%]{font-size:20px;padding:20px 0;color:#87f54e;text-align:center;transition:.25s linear}@media (min-width: 768px){.mob-nav-link[_ngcontent-%COMP%]{font-size:22px}}.mob-nav-link[_ngcontent-%COMP%]:hover, .mob-nav-link[_ngcontent-%COMP%]:focus{color:#11b0c8}"]}),c})();var Ce=$(4004),Te=$(3099),at=$(590),Et=$(3144),ut=$(6550);let tt=(()=>{class c{constructor(t,s){this.http=t,this.sanitizer=s}getIcon(t,s=""){return this.http.get(t,{responseType:"text"}).pipe((0,Ce.U)(o=>(s&&(o=o.replace("<svg",`<svg fill="${s}"`)),this.sanitizer.bypassSecurityTrustHtml(o))),(0,Te.B)(),(0,at.P)())}}return c.\u0275fac=function(t){return new(t||c)(x.LFG(Et.eN),x.LFG(ut.H7))},c.\u0275prov=x.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})(),me=(()=>{class c{constructor(t){this.iconService=t,this.githubIcon=this.iconService.getIcon("./assets/github.svg","white")}}return c.\u0275fac=function(t){return new(t||c)(x.Y36(tt))},c.\u0275cmp=x.Xpm({type:c,selectors:[["app-footer"]],standalone:!0,features:[x._Bn([tt]),x.jDz],decls:18,vars:0,consts:[[1,"footer"],[1,"container"],[1,"row"],[1,"col"],[1,"link-title"],[1,"developers-links"],["href","https://github.com/waridesu","target","_blank",1,"link"],["width","30","height","30",1,"gh-icon"],["href","./assets/sprite.svg#icon-github"],["href","https://github.com/OliaChuzhdiuk","target","_blank",1,"link"],["href","https://github.com/AntoninaHoncharenko","target","_blank",1,"link"]],template:function(t,s){1&t&&(x.TgZ(0,"footer",0)(1,"div",1)(2,"div",2)(3,"p",3),x._uU(4,"\xa9 2023 Rick and Morty Adventure. All rights reserved."),x.qZA(),x.TgZ(5,"div")(6,"p",4),x._uU(7,"Developers Github"),x.qZA(),x.TgZ(8,"div",5)(9,"a",6),x.O4$(),x.TgZ(10,"svg",7),x._UZ(11,"use",8),x.qZA()(),x.kcU(),x.TgZ(12,"a",9),x.O4$(),x.TgZ(13,"svg",7),x._UZ(14,"use",8),x.qZA()(),x.kcU(),x.TgZ(15,"a",10),x.O4$(),x.TgZ(16,"svg",7),x._UZ(17,"use",8),x.qZA()()()()()()())},dependencies:[Pe.ez],styles:[".footer[_ngcontent-%COMP%]{height:80px;background-color:#272727b3}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{height:80px;display:flex;justify-content:space-between;align-items:center}.container[_ngcontent-%COMP%]{width:100%;margin:0 auto;padding:0 16px;display:flex;flex-direction:column;flex:1}@media (min-width: 375px){.container[_ngcontent-%COMP%]{width:375px}}@media (min-width: 768px){.container[_ngcontent-%COMP%]{padding:0 32px;width:768px}}@media (min-width: 1200px){.container[_ngcontent-%COMP%]{padding:0 40px;width:1200px}}.col[_ngcontent-%COMP%]{color:#fff;font-size:12px}@media (min-width: 768px){.col[_ngcontent-%COMP%]{font-size:14px}}@media (min-width: 1200px){.col[_ngcontent-%COMP%]{font-size:16px}}.gh-icon[_ngcontent-%COMP%]{fill:#fff;transition:.25s linear}.gh-icon[_ngcontent-%COMP%]:hover{fill:#11b0c8}.link-title[_ngcontent-%COMP%]{color:#fff;margin-bottom:8px;display:none}@media (min-width: 768px){.link-title[_ngcontent-%COMP%]{display:block;font-size:14px}}@media (min-width: 1200px){.link-title[_ngcontent-%COMP%]{font-size:16px}}.developers-links[_ngcontent-%COMP%]{width:100px;display:flex;justify-content:space-around}@media (min-width: 768px){.developers-links[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0}),c})();function We(c,e,t,s,o,l,d){try{var h=c[l](d),p=h.value}catch(m){return void t(m)}h.done?e(p):Promise.resolve(p).then(s,o)}const Me=1,Ft=2,je=3,Le=0,Je=1,zt=2,wn=0,pi=0,nt=1,un=2,Ji=0,Bi=1,Tr=2,js=3,$n=4,La=5,ti=301,dn=302,as=306,Gi=1001,ri=1003,si=1006,ce=1008,ue=1009,De=1014,Qe=1015,qe=1016,gn=1020,gi=1023,er=1026,cs=1027,ln=3001,vr=0,_n="srgb",ki="srgb-linear",Zs="display-p3",ad="300 es";class ha{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const s=this._listeners;void 0===s[e]&&(s[e]=[]),-1===s[e].indexOf(t)&&s[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const s=this._listeners;return void 0!==s[e]&&-1!==s[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const o=this._listeners[e];if(void 0!==o){const l=o.indexOf(t);-1!==l&&o.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const s=this._listeners[e.type];if(void 0!==s){e.target=this;const o=s.slice(0);for(let l=0,d=o.length;l<d;l++)o[l].call(this,e);e.target=null}}}const yr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],zo=Math.PI/180,fa=180/Math.PI;function nr(){const c=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(yr[255&c]+yr[c>>8&255]+yr[c>>16&255]+yr[c>>24&255]+"-"+yr[255&e]+yr[e>>8&255]+"-"+yr[e>>16&15|64]+yr[e>>24&255]+"-"+yr[63&t|128]+yr[t>>8&255]+"-"+yr[t>>16&255]+yr[t>>24&255]+yr[255&s]+yr[s>>8&255]+yr[s>>16&255]+yr[s>>24&255]).toLowerCase()}function wi(c,e,t){return Math.max(e,Math.min(t,c))}function Es(c,e,t){return(1-t)*c+t*e}function yo(c){return 0==(c&c-1)&&0!==c}function Jc(c){return Math.pow(2,Math.floor(Math.log(c)/Math.LN2))}function Ri(c,e){switch(e.constructor){case Float32Array:return c;case Uint16Array:return c/65535;case Uint8Array:return c/255;case Int16Array:return Math.max(c/32767,-1);case Int8Array:return Math.max(c/127,-1);default:throw new Error("Invalid component type.")}}function Cn(c,e){switch(e.constructor){case Float32Array:return c;case Uint16Array:return Math.round(65535*c);case Uint8Array:return Math.round(255*c);case Int16Array:return Math.round(32767*c);case Int8Array:return Math.round(127*c);default:throw new Error("Invalid component type.")}}class et{constructor(e=0,t=0){et.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,s=this.y,o=e.elements;return this.x=o[0]*t+o[3]*s+o[6],this.y=o[1]*t+o[4]*s+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(t,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const s=this.dot(e)/t;return Math.acos(wi(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,s=this.y-e.y;return t*t+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const s=Math.cos(t),o=Math.sin(t),l=this.x-e.x,d=this.y-e.y;return this.x=l*s-d*o+e.x,this.y=l*o+d*s+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Gn{constructor(){Gn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,s,o,l,d,h,p,m){const _=this.elements;return _[0]=e,_[1]=o,_[2]=h,_[3]=t,_[4]=l,_[5]=p,_[6]=s,_[7]=d,_[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,s=e.elements;return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],this}extractBasis(e,t,s){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const s=e.elements,o=t.elements,l=this.elements,d=s[0],h=s[3],p=s[6],m=s[1],_=s[4],S=s[7],b=s[2],D=s[5],R=s[8],O=o[0],P=o[3],I=o[6],B=o[1],U=o[4],W=o[7],X=o[2],K=o[5],re=o[8];return l[0]=d*O+h*B+p*X,l[3]=d*P+h*U+p*K,l[6]=d*I+h*W+p*re,l[1]=m*O+_*B+S*X,l[4]=m*P+_*U+S*K,l[7]=m*I+_*W+S*re,l[2]=b*O+D*B+R*X,l[5]=b*P+D*U+R*K,l[8]=b*I+D*W+R*re,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],s=e[1],o=e[2],l=e[3],d=e[4],h=e[5],p=e[6],m=e[7],_=e[8];return t*d*_-t*h*m-s*l*_+s*h*p+o*l*m-o*d*p}invert(){const e=this.elements,t=e[0],s=e[1],o=e[2],l=e[3],d=e[4],h=e[5],p=e[6],m=e[7],_=e[8],S=_*d-h*m,b=h*p-_*l,D=m*l-d*p,R=t*S+s*b+o*D;if(0===R)return this.set(0,0,0,0,0,0,0,0,0);const O=1/R;return e[0]=S*O,e[1]=(o*m-_*s)*O,e[2]=(h*s-o*d)*O,e[3]=b*O,e[4]=(_*t-o*p)*O,e[5]=(o*l-h*t)*O,e[6]=D*O,e[7]=(s*p-m*t)*O,e[8]=(d*t-s*l)*O,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,s,o,l,d,h){const p=Math.cos(l),m=Math.sin(l);return this.set(s*p,s*m,-s*(p*d+m*h)+d+e,-o*m,o*p,-o*(-m*d+p*h)+h+t,0,0,1),this}scale(e,t){return this.premultiply(ma.makeScale(e,t)),this}rotate(e){return this.premultiply(ma.makeRotation(-e)),this}translate(e,t){return this.premultiply(ma.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,-s,0,s,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,s=e.elements;for(let o=0;o<9;o++)if(t[o]!==s[o])return!1;return!0}fromArray(e,t=0){for(let s=0;s<9;s++)this.elements[s]=e[s+t];return this}toArray(e=[],t=0){const s=this.elements;return e[t]=s[0],e[t+1]=s[1],e[t+2]=s[2],e[t+3]=s[3],e[t+4]=s[4],e[t+5]=s[5],e[t+6]=s[6],e[t+7]=s[7],e[t+8]=s[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const ma=new Gn;function Go(c){for(let e=c.length-1;e>=0;--e)if(c[e]>=65535)return!0;return!1}function Wo(c){return document.createElementNS("http://www.w3.org/1999/xhtml",c)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Js={};function Fs(c){c in Js||(Js[c]=!0,console.warn(c))}function $o(c){return c<.04045?.0773993808*c:Math.pow(.9478672986*c+.0521327014,2.4)}function jo(c){return c<.0031308?12.92*c:1.055*Math.pow(c,.41666)-.055}const nc=(new Gn).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),va=(new Gn).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),ic={[ki]:c=>c,[_n]:c=>c.convertSRGBToLinear(),[Zs]:function ud(c){return c.convertSRGBToLinear().applyMatrix3(va)}},dd={[ki]:c=>c,[_n]:c=>c.convertLinearToSRGB(),[Zs]:function Qc(c){return c.applyMatrix3(nc).convertLinearToSRGB()}},Ss={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(c){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!c},get workingColorSpace(){return ki},set workingColorSpace(c){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(c,e,t){if(!1===this.enabled||e===t||!e||!t)return c;const s=ic[e],o=dd[t];if(void 0===s||void 0===o)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return o(s(c))},fromWorkingColorSpace:function(c,e){return this.convert(c,this.workingColorSpace,e)},toWorkingColorSpace:function(c,e){return this.convert(c,e,this.workingColorSpace)}};let _o;class dl{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===_o&&(_o=Wo("canvas")),_o.width=e.width,_o.height=e.height;const s=_o.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),t=_o}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Wo("canvas");t.width=e.width,t.height=e.height;const s=t.getContext("2d");s.drawImage(e,0,0,e.width,e.height);const o=s.getImageData(0,0,e.width,e.height),l=o.data;for(let d=0;d<l.length;d++)l[d]=255*$o(l[d]/255);return s.putImageData(o,0,0),t}if(e.data){const t=e.data.slice(0);for(let s=0;s<t.length;s++)t[s]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*$o(t[s]/255)):$o(t[s]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Qs{constructor(e=null){this.isSource=!0,this.uuid=nr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const s={uuid:this.uuid,url:""},o=this.data;if(null!==o){let l;if(Array.isArray(o)){l=[];for(let d=0,h=o.length;d<h;d++)l.push(hl(o[d].isDataTexture?o[d].image:o[d]))}else l=hl(o);s.url=l}return t||(e.images[this.uuid]=s),s}}function hl(c){return typeof HTMLImageElement<"u"&&c instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&c instanceof ImageBitmap?dl.getDataURL(c):c.data?{data:Array.from(c.data),width:c.width,height:c.height,type:c.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let rc=0,eo=(()=>{class c extends ha{constructor(t=c.DEFAULT_IMAGE,s=c.DEFAULT_MAPPING,o=Gi,l=Gi,d=si,h=ce,p=gi,m=ue,_=c.DEFAULT_ANISOTROPY,S=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:rc++}),this.uuid=nr(),this.name="",this.source=new Qs(t),this.mipmaps=[],this.mapping=s,this.channel=0,this.wrapS=o,this.wrapT=l,this.magFilter=d,this.minFilter=h,this.anisotropy=_,this.format=p,this.internalFormat=null,this.type=m,this.offset=new et(0,0),this.repeat=new et(1,1),this.center=new et(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Gn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof S?this.colorSpace=S:(Fs("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=S===ln?_n:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const s=void 0===t||"string"==typeof t;if(!s&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const o={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),s||(t.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Gi:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Gi:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Fs("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===_n?ln:3e3}set encoding(t){Fs("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===ln?_n:""}}return c.DEFAULT_IMAGE=null,c.DEFAULT_MAPPING=300,c.DEFAULT_ANISOTROPY=1,c})();class vi{constructor(e=0,t=0,s=0,o=1){vi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=s,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,s,o){return this.x=e,this.y=t,this.z=s,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,s=this.y,o=this.z,l=this.w,d=e.elements;return this.x=d[0]*t+d[4]*s+d[8]*o+d[12]*l,this.y=d[1]*t+d[5]*s+d[9]*o+d[13]*l,this.z=d[2]*t+d[6]*s+d[10]*o+d[14]*l,this.w=d[3]*t+d[7]*s+d[11]*o+d[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,s,o,l;const p=e.elements,m=p[0],_=p[4],S=p[8],b=p[1],D=p[5],R=p[9],O=p[2],P=p[6],I=p[10];if(Math.abs(_-b)<.01&&Math.abs(S-O)<.01&&Math.abs(R-P)<.01){if(Math.abs(_+b)<.1&&Math.abs(S+O)<.1&&Math.abs(R+P)<.1&&Math.abs(m+D+I-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const U=(m+1)/2,W=(D+1)/2,X=(I+1)/2,K=(_+b)/4,re=(S+O)/4,le=(R+P)/4;return U>W&&U>X?U<.01?(s=0,o=.707106781,l=.707106781):(s=Math.sqrt(U),o=K/s,l=re/s):W>X?W<.01?(s=.707106781,o=0,l=.707106781):(o=Math.sqrt(W),s=K/o,l=le/o):X<.01?(s=.707106781,o=.707106781,l=0):(l=Math.sqrt(X),s=re/l,o=le/l),this.set(s,o,l,t),this}let B=Math.sqrt((P-R)*(P-R)+(S-O)*(S-O)+(b-_)*(b-_));return Math.abs(B)<.001&&(B=1),this.x=(P-R)/B,this.y=(S-O)/B,this.z=(b-_)/B,this.w=Math.acos((m+D+I-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(t,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this.z=e.z+(t.z-e.z)*s,this.w=e.w+(t.w-e.w)*s,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class to extends ha{constructor(e=1,t=1,s={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new vi(0,0,e,t),this.scissorTest=!1,this.viewport=new vi(0,0,e,t);const o={width:e,height:t,depth:1};void 0!==s.encoding&&(Fs("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),s.colorSpace=s.encoding===ln?_n:""),this.texture=new eo(o,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==s.generateMipmaps&&s.generateMipmaps,this.texture.internalFormat=void 0!==s.internalFormat?s.internalFormat:null,this.texture.minFilter=void 0!==s.minFilter?s.minFilter:si,this.depthBuffer=void 0===s.depthBuffer||s.depthBuffer,this.stencilBuffer=void 0!==s.stencilBuffer&&s.stencilBuffer,this.depthTexture=void 0!==s.depthTexture?s.depthTexture:null,this.samples=void 0!==s.samples?s.samples:0}setSize(e,t,s=1){(this.width!==e||this.height!==t||this.depth!==s)&&(this.width=e,this.height=t,this.depth=s,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=s,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Qs(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class sc extends eo{constructor(e=null,t=1,s=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:s,depth:o},this.magFilter=ri,this.minFilter=ri,this.wrapR=Gi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eu extends eo{constructor(e=null,t=1,s=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:s,depth:o},this.magFilter=ri,this.minFilter=ri,this.wrapR=Gi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Zr{constructor(e=0,t=0,s=0,o=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=s,this._w=o}static slerpFlat(e,t,s,o,l,d,h){let p=s[o+0],m=s[o+1],_=s[o+2],S=s[o+3];const b=l[d+0],D=l[d+1],R=l[d+2],O=l[d+3];if(0===h)return e[t+0]=p,e[t+1]=m,e[t+2]=_,void(e[t+3]=S);if(1===h)return e[t+0]=b,e[t+1]=D,e[t+2]=R,void(e[t+3]=O);if(S!==O||p!==b||m!==D||_!==R){let P=1-h;const I=p*b+m*D+_*R+S*O,B=I>=0?1:-1,U=1-I*I;if(U>Number.EPSILON){const X=Math.sqrt(U),K=Math.atan2(X,I*B);P=Math.sin(P*K)/X,h=Math.sin(h*K)/X}const W=h*B;if(p=p*P+b*W,m=m*P+D*W,_=_*P+R*W,S=S*P+O*W,P===1-h){const X=1/Math.sqrt(p*p+m*m+_*_+S*S);p*=X,m*=X,_*=X,S*=X}}e[t]=p,e[t+1]=m,e[t+2]=_,e[t+3]=S}static multiplyQuaternionsFlat(e,t,s,o,l,d){const h=s[o],p=s[o+1],m=s[o+2],_=s[o+3],S=l[d],b=l[d+1],D=l[d+2],R=l[d+3];return e[t]=h*R+_*S+p*D-m*b,e[t+1]=p*R+_*b+m*S-h*D,e[t+2]=m*R+_*D+h*b-p*S,e[t+3]=_*R-h*S-p*b-m*D,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,s,o){return this._x=e,this._y=t,this._z=s,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const s=e._x,o=e._y,l=e._z,d=e._order,h=Math.cos,p=Math.sin,m=h(s/2),_=h(o/2),S=h(l/2),b=p(s/2),D=p(o/2),R=p(l/2);switch(d){case"XYZ":this._x=b*_*S+m*D*R,this._y=m*D*S-b*_*R,this._z=m*_*R+b*D*S,this._w=m*_*S-b*D*R;break;case"YXZ":this._x=b*_*S+m*D*R,this._y=m*D*S-b*_*R,this._z=m*_*R-b*D*S,this._w=m*_*S+b*D*R;break;case"ZXY":this._x=b*_*S-m*D*R,this._y=m*D*S+b*_*R,this._z=m*_*R+b*D*S,this._w=m*_*S-b*D*R;break;case"ZYX":this._x=b*_*S-m*D*R,this._y=m*D*S+b*_*R,this._z=m*_*R-b*D*S,this._w=m*_*S+b*D*R;break;case"YZX":this._x=b*_*S+m*D*R,this._y=m*D*S+b*_*R,this._z=m*_*R-b*D*S,this._w=m*_*S-b*D*R;break;case"XZY":this._x=b*_*S-m*D*R,this._y=m*D*S-b*_*R,this._z=m*_*R+b*D*S,this._w=m*_*S+b*D*R;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const s=t/2,o=Math.sin(s);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,s=t[0],o=t[4],l=t[8],d=t[1],h=t[5],p=t[9],m=t[2],_=t[6],S=t[10],b=s+h+S;if(b>0){const D=.5/Math.sqrt(b+1);this._w=.25/D,this._x=(_-p)*D,this._y=(l-m)*D,this._z=(d-o)*D}else if(s>h&&s>S){const D=2*Math.sqrt(1+s-h-S);this._w=(_-p)/D,this._x=.25*D,this._y=(o+d)/D,this._z=(l+m)/D}else if(h>S){const D=2*Math.sqrt(1+h-s-S);this._w=(l-m)/D,this._x=(o+d)/D,this._y=.25*D,this._z=(p+_)/D}else{const D=2*Math.sqrt(1+S-s-h);this._w=(d-o)/D,this._x=(l+m)/D,this._y=(p+_)/D,this._z=.25*D}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let s=e.dot(t)+1;return s<Number.EPSILON?(s=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=s):(this._x=0,this._y=-e.z,this._z=e.y,this._w=s)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=s),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(wi(this.dot(e),-1,1)))}rotateTowards(e,t){const s=this.angleTo(e);if(0===s)return this;const o=Math.min(1,t/s);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const s=e._x,o=e._y,l=e._z,d=e._w,h=t._x,p=t._y,m=t._z,_=t._w;return this._x=s*_+d*h+o*m-l*p,this._y=o*_+d*p+l*h-s*m,this._z=l*_+d*m+s*p-o*h,this._w=d*_-s*h-o*p-l*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const s=this._x,o=this._y,l=this._z,d=this._w;let h=d*e._w+s*e._x+o*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=d,this._x=s,this._y=o,this._z=l,this;const p=1-h*h;if(p<=Number.EPSILON){const D=1-t;return this._w=D*d+t*this._w,this._x=D*s+t*this._x,this._y=D*o+t*this._y,this._z=D*l+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),_=Math.atan2(m,h),S=Math.sin((1-t)*_)/m,b=Math.sin(t*_)/m;return this._w=d*S+this._w*b,this._x=s*S+this._x*b,this._y=o*S+this._y*b,this._z=l*S+this._z*b,this._onChangeCallback(),this}slerpQuaternions(e,t,s){return this.copy(e).slerp(t,s)}random(){const e=Math.random(),t=Math.sqrt(1-e),s=Math.sqrt(e),o=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(o),s*Math.sin(l),s*Math.cos(l),t*Math.sin(o))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class J{constructor(e=0,t=0,s=0){J.prototype.isVector3=!0,this.x=e,this.y=t,this.z=s}set(e,t,s){return void 0===s&&(s=this.z),this.x=e,this.y=t,this.z=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(F.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(F.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,s=this.y,o=this.z,l=e.elements;return this.x=l[0]*t+l[3]*s+l[6]*o,this.y=l[1]*t+l[4]*s+l[7]*o,this.z=l[2]*t+l[5]*s+l[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,s=this.y,o=this.z,l=e.elements,d=1/(l[3]*t+l[7]*s+l[11]*o+l[15]);return this.x=(l[0]*t+l[4]*s+l[8]*o+l[12])*d,this.y=(l[1]*t+l[5]*s+l[9]*o+l[13])*d,this.z=(l[2]*t+l[6]*s+l[10]*o+l[14])*d,this}applyQuaternion(e){const t=this.x,s=this.y,o=this.z,l=e.x,d=e.y,h=e.z,p=e.w,m=p*t+d*o-h*s,_=p*s+h*t-l*o,S=p*o+l*s-d*t,b=-l*t-d*s-h*o;return this.x=m*p+b*-l+_*-h-S*-d,this.y=_*p+b*-d+S*-l-m*-h,this.z=S*p+b*-h+m*-d-_*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,s=this.y,o=this.z,l=e.elements;return this.x=l[0]*t+l[4]*s+l[8]*o,this.y=l[1]*t+l[5]*s+l[9]*o,this.z=l[2]*t+l[6]*s+l[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(t,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,s){return this.x=e.x+(t.x-e.x)*s,this.y=e.y+(t.y-e.y)*s,this.z=e.z+(t.z-e.z)*s,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const s=e.x,o=e.y,l=e.z,d=t.x,h=t.y,p=t.z;return this.x=o*p-l*h,this.y=l*d-s*p,this.z=s*h-o*d,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const s=e.dot(this)/t;return this.copy(e).multiplyScalar(s)}projectOnPlane(e){return w.copy(this).projectOnVector(e),this.sub(w)}reflect(e){return this.sub(w.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const s=this.dot(e)/t;return Math.acos(wi(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,s=this.y-e.y,o=this.z-e.z;return t*t+s*s+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,s){const o=Math.sin(t)*e;return this.x=o*Math.sin(s),this.y=Math.cos(t)*e,this.z=o*Math.cos(s),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,s){return this.x=e*Math.sin(t),this.y=s,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),s=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=s,this.z=o,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,s=Math.sqrt(1-e**2);return this.x=s*Math.cos(t),this.y=s*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const w=new J,F=new Zr;class A{constructor(e=new J(1/0,1/0,1/0),t=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,s=e.length;t<s;t+=3)this.expandByPoint(Y.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,s=e.count;t<s;t++)this.expandByPoint(Y.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,s=e.length;t<s;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const s=Y.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(s),this.max.copy(e).add(s),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),ge.copy(e.boundingBox),ge.applyMatrix4(e.matrixWorld),this.union(ge);else{const o=e.geometry;if(void 0!==o)if(t&&void 0!==o.attributes&&void 0!==o.attributes.position){const l=o.attributes.position;for(let d=0,h=l.count;d<h;d++)Y.fromBufferAttribute(l,d).applyMatrix4(e.matrixWorld),this.expandByPoint(Y)}else null===o.boundingBox&&o.computeBoundingBox(),ge.copy(o.boundingBox),ge.applyMatrix4(e.matrixWorld),this.union(ge)}const s=e.children;for(let o=0,l=s.length;o<l;o++)this.expandByObject(s[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Y),Y.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,s;return e.normal.x>0?(t=e.normal.x*this.min.x,s=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,s=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,s+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,s+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,s+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,s+=e.normal.z*this.min.z),t<=-e.constant&&s>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(yi),ci.subVectors(this.max,yi),xe.subVectors(e.a,yi),kt.subVectors(e.b,yi),Nn.subVectors(e.c,yi),Hn.subVectors(kt,xe),Rn.subVectors(Nn,kt),Mn.subVectors(xe,Nn);let t=[0,-Hn.z,Hn.y,0,-Rn.z,Rn.y,0,-Mn.z,Mn.y,Hn.z,0,-Hn.x,Rn.z,0,-Rn.x,Mn.z,0,-Mn.x,-Hn.y,Hn.x,0,-Rn.y,Rn.x,0,-Mn.y,Mn.x,0];return!(!Kr(t,xe,kt,Nn,ci)||(t=[1,0,0,0,1,0,0,0,1],!Kr(t,xe,kt,Nn,ci)))&&(zi.crossVectors(Hn,Rn),t=[zi.x,zi.y,zi.z],Kr(t,xe,kt,Nn,ci))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Y).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Y).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(k[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),k[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),k[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),k[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),k[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),k[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),k[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),k[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(k)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const k=[new J,new J,new J,new J,new J,new J,new J,new J],Y=new J,ge=new A,xe=new J,kt=new J,Nn=new J,Hn=new J,Rn=new J,Mn=new J,yi=new J,ci=new J,zi=new J,$t=new J;function Kr(c,e,t,s,o){for(let l=0,d=c.length-3;l<=d;l+=3){$t.fromArray(c,l);const h=o.x*Math.abs($t.x)+o.y*Math.abs($t.y)+o.z*Math.abs($t.z),p=e.dot($t),m=t.dot($t),_=s.dot($t);if(Math.max(-Math.max(p,m,_),Math.min(p,m,_))>h)return!1}return!0}const no=new A,_r=new J,ks=new J;class _i{constructor(e=new J,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const s=this.center;void 0!==t?s.copy(t):no.setFromPoints(e).getCenter(s);let o=0;for(let l=0,d=e.length;l<d;l++)o=Math.max(o,s.distanceToSquared(e[l]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const s=this.center.distanceToSquared(e);return t.copy(e),s>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_r.subVectors(e,this.center);const t=_r.lengthSq();if(t>this.radius*this.radius){const s=Math.sqrt(t),o=.5*(s-this.radius);this.center.addScaledVector(_r,o/s),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(ks.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_r.copy(e.center).add(ks)),this.expandByPoint(_r.copy(e.center).sub(ks))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const cr=new J,Xo=new J,oc=new J,Yo=new J,nu=new J,Pr=new J,iu=new J;class Ye{constructor(e=new J,t=new J(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,cr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const s=t.dot(this.direction);return s<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=cr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(cr.copy(this.origin).addScaledVector(this.direction,t),cr.distanceToSquared(e))}distanceSqToSegment(e,t,s,o){Xo.copy(e).add(t).multiplyScalar(.5),oc.copy(t).sub(e).normalize(),Yo.copy(this.origin).sub(Xo);const l=.5*e.distanceTo(t),d=-this.direction.dot(oc),h=Yo.dot(this.direction),p=-Yo.dot(oc),m=Yo.lengthSq(),_=Math.abs(1-d*d);let S,b,D,R;if(_>0)if(S=d*p-h,b=d*h-p,R=l*_,S>=0)if(b>=-R)if(b<=R){const O=1/_;S*=O,b*=O,D=S*(S+d*b+2*h)+b*(d*S+b+2*p)+m}else b=l,S=Math.max(0,-(d*b+h)),D=-S*S+b*(b+2*p)+m;else b=-l,S=Math.max(0,-(d*b+h)),D=-S*S+b*(b+2*p)+m;else b<=-R?(S=Math.max(0,-(-d*l+h)),b=S>0?-l:Math.min(Math.max(-l,-p),l),D=-S*S+b*(b+2*p)+m):b<=R?(S=0,b=Math.min(Math.max(-l,-p),l),D=b*(b+2*p)+m):(S=Math.max(0,-(d*l+h)),b=S>0?l:Math.min(Math.max(-l,-p),l),D=-S*S+b*(b+2*p)+m);else b=d>0?-l:l,S=Math.max(0,-(d*b+h)),D=-S*S+b*(b+2*p)+m;return s&&s.copy(this.origin).addScaledVector(this.direction,S),o&&o.copy(Xo).addScaledVector(oc,b),D}intersectSphere(e,t){cr.subVectors(e.center,this.origin);const s=cr.dot(this.direction),o=cr.dot(cr)-s*s,l=e.radius*e.radius;if(o>l)return null;const d=Math.sqrt(l-o),h=s-d,p=s+d;return p<0?null:this.at(h<0?p:h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const s=-(this.origin.dot(e.normal)+e.constant)/t;return s>=0?s:null}intersectPlane(e,t){const s=this.distanceToPlane(e);return null===s?null:this.at(s,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let s,o,l,d,h,p;const m=1/this.direction.x,_=1/this.direction.y,S=1/this.direction.z,b=this.origin;return m>=0?(s=(e.min.x-b.x)*m,o=(e.max.x-b.x)*m):(s=(e.max.x-b.x)*m,o=(e.min.x-b.x)*m),_>=0?(l=(e.min.y-b.y)*_,d=(e.max.y-b.y)*_):(l=(e.max.y-b.y)*_,d=(e.min.y-b.y)*_),s>d||l>o||((l>s||isNaN(s))&&(s=l),(d<o||isNaN(o))&&(o=d),S>=0?(h=(e.min.z-b.z)*S,p=(e.max.z-b.z)*S):(h=(e.max.z-b.z)*S,p=(e.min.z-b.z)*S),s>p||h>o)||((h>s||s!=s)&&(s=h),(p<o||o!=o)&&(o=p),o<0)?null:this.at(s>=0?s:o,t)}intersectsBox(e){return null!==this.intersectBox(e,cr)}intersectTriangle(e,t,s,o,l){nu.subVectors(t,e),Pr.subVectors(s,e),iu.crossVectors(nu,Pr);let h,d=this.direction.dot(iu);if(d>0){if(o)return null;h=1}else{if(!(d<0))return null;h=-1,d=-d}Yo.subVectors(this.origin,e);const p=h*this.direction.dot(Pr.crossVectors(Yo,Pr));if(p<0)return null;const m=h*this.direction.dot(nu.cross(Yo));if(m<0||p+m>d)return null;const _=-h*Yo.dot(iu);return _<0?null:this.at(_/d,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Nt{constructor(){Nt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,s,o,l,d,h,p,m,_,S,b,D,R,O,P){const I=this.elements;return I[0]=e,I[4]=t,I[8]=s,I[12]=o,I[1]=l,I[5]=d,I[9]=h,I[13]=p,I[2]=m,I[6]=_,I[10]=S,I[14]=b,I[3]=D,I[7]=R,I[11]=O,I[15]=P,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Nt).fromArray(this.elements)}copy(e){const t=this.elements,s=e.elements;return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],this}copyPosition(e){const t=this.elements,s=e.elements;return t[12]=s[12],t[13]=s[13],t[14]=s[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,s){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(e,t,s){return this.set(e.x,t.x,s.x,0,e.y,t.y,s.y,0,e.z,t.z,s.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,s=e.elements,o=1/ya.setFromMatrixColumn(e,0).length(),l=1/ya.setFromMatrixColumn(e,1).length(),d=1/ya.setFromMatrixColumn(e,2).length();return t[0]=s[0]*o,t[1]=s[1]*o,t[2]=s[2]*o,t[3]=0,t[4]=s[4]*l,t[5]=s[5]*l,t[6]=s[6]*l,t[7]=0,t[8]=s[8]*d,t[9]=s[9]*d,t[10]=s[10]*d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,s=e.x,o=e.y,l=e.z,d=Math.cos(s),h=Math.sin(s),p=Math.cos(o),m=Math.sin(o),_=Math.cos(l),S=Math.sin(l);if("XYZ"===e.order){const b=d*_,D=d*S,R=h*_,O=h*S;t[0]=p*_,t[4]=-p*S,t[8]=m,t[1]=D+R*m,t[5]=b-O*m,t[9]=-h*p,t[2]=O-b*m,t[6]=R+D*m,t[10]=d*p}else if("YXZ"===e.order){const b=p*_,D=p*S,R=m*_,O=m*S;t[0]=b+O*h,t[4]=R*h-D,t[8]=d*m,t[1]=d*S,t[5]=d*_,t[9]=-h,t[2]=D*h-R,t[6]=O+b*h,t[10]=d*p}else if("ZXY"===e.order){const b=p*_,D=p*S,R=m*_,O=m*S;t[0]=b-O*h,t[4]=-d*S,t[8]=R+D*h,t[1]=D+R*h,t[5]=d*_,t[9]=O-b*h,t[2]=-d*m,t[6]=h,t[10]=d*p}else if("ZYX"===e.order){const b=d*_,D=d*S,R=h*_,O=h*S;t[0]=p*_,t[4]=R*m-D,t[8]=b*m+O,t[1]=p*S,t[5]=O*m+b,t[9]=D*m-R,t[2]=-m,t[6]=h*p,t[10]=d*p}else if("YZX"===e.order){const b=d*p,D=d*m,R=h*p,O=h*m;t[0]=p*_,t[4]=O-b*S,t[8]=R*S+D,t[1]=S,t[5]=d*_,t[9]=-h*_,t[2]=-m*_,t[6]=D*S+R,t[10]=b-O*S}else if("XZY"===e.order){const b=d*p,D=d*m,R=h*p,O=h*m;t[0]=p*_,t[4]=-S,t[8]=m*_,t[1]=b*S+O,t[5]=d*_,t[9]=D*S-R,t[2]=R*S-D,t[6]=h*_,t[10]=O*S+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Lr,e,$h)}lookAt(e,t,s){const o=this.elements;return Nr.subVectors(e,t),0===Nr.lengthSq()&&(Nr.z=1),Nr.normalize(),bs.crossVectors(s,Nr),0===bs.lengthSq()&&(1===Math.abs(s.z)?Nr.x+=1e-4:Nr.z+=1e-4,Nr.normalize(),bs.crossVectors(s,Nr)),bs.normalize(),Vr.crossVectors(Nr,bs),o[0]=bs.x,o[4]=Vr.x,o[8]=Nr.x,o[1]=bs.y,o[5]=Vr.y,o[9]=Nr.y,o[2]=bs.z,o[6]=Vr.z,o[10]=Nr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const s=e.elements,o=t.elements,l=this.elements,d=s[0],h=s[4],p=s[8],m=s[12],_=s[1],S=s[5],b=s[9],D=s[13],R=s[2],O=s[6],P=s[10],I=s[14],B=s[3],U=s[7],W=s[11],X=s[15],K=o[0],re=o[4],le=o[8],V=o[12],te=o[1],Ae=o[5],Ge=o[9],ve=o[13],we=o[2],Ie=o[6],lt=o[10],ot=o[14],it=o[3],dt=o[7],vt=o[11],jt=o[15];return l[0]=d*K+h*te+p*we+m*it,l[4]=d*re+h*Ae+p*Ie+m*dt,l[8]=d*le+h*Ge+p*lt+m*vt,l[12]=d*V+h*ve+p*ot+m*jt,l[1]=_*K+S*te+b*we+D*it,l[5]=_*re+S*Ae+b*Ie+D*dt,l[9]=_*le+S*Ge+b*lt+D*vt,l[13]=_*V+S*ve+b*ot+D*jt,l[2]=R*K+O*te+P*we+I*it,l[6]=R*re+O*Ae+P*Ie+I*dt,l[10]=R*le+O*Ge+P*lt+I*vt,l[14]=R*V+O*ve+P*ot+I*jt,l[3]=B*K+U*te+W*we+X*it,l[7]=B*re+U*Ae+W*Ie+X*dt,l[11]=B*le+U*Ge+W*lt+X*vt,l[15]=B*V+U*ve+W*ot+X*jt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],s=e[4],o=e[8],l=e[12],d=e[1],h=e[5],p=e[9],m=e[13],_=e[2],S=e[6],b=e[10],D=e[14];return e[3]*(+l*p*S-o*m*S-l*h*b+s*m*b+o*h*D-s*p*D)+e[7]*(+t*p*D-t*m*b+l*d*b-o*d*D+o*m*_-l*p*_)+e[11]*(+t*m*S-t*h*D-l*d*S+s*d*D+l*h*_-s*m*_)+e[15]*(-o*h*_-t*p*S+t*h*b+o*d*S-s*d*b+s*p*_)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,s){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=t,o[14]=s),this}invert(){const e=this.elements,t=e[0],s=e[1],o=e[2],l=e[3],d=e[4],h=e[5],p=e[6],m=e[7],_=e[8],S=e[9],b=e[10],D=e[11],R=e[12],O=e[13],P=e[14],I=e[15],B=S*P*m-O*b*m+O*p*D-h*P*D-S*p*I+h*b*I,U=R*b*m-_*P*m-R*p*D+d*P*D+_*p*I-d*b*I,W=_*O*m-R*S*m+R*h*D-d*O*D-_*h*I+d*S*I,X=R*S*p-_*O*p-R*h*b+d*O*b+_*h*P-d*S*P,K=t*B+s*U+o*W+l*X;if(0===K)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const re=1/K;return e[0]=B*re,e[1]=(O*b*l-S*P*l-O*o*D+s*P*D+S*o*I-s*b*I)*re,e[2]=(h*P*l-O*p*l+O*o*m-s*P*m-h*o*I+s*p*I)*re,e[3]=(S*p*l-h*b*l-S*o*m+s*b*m+h*o*D-s*p*D)*re,e[4]=U*re,e[5]=(_*P*l-R*b*l+R*o*D-t*P*D-_*o*I+t*b*I)*re,e[6]=(R*p*l-d*P*l-R*o*m+t*P*m+d*o*I-t*p*I)*re,e[7]=(d*b*l-_*p*l+_*o*m-t*b*m-d*o*D+t*p*D)*re,e[8]=W*re,e[9]=(R*S*l-_*O*l-R*s*D+t*O*D+_*s*I-t*S*I)*re,e[10]=(d*O*l-R*h*l+R*s*m-t*O*m-d*s*I+t*h*I)*re,e[11]=(_*h*l-d*S*l-_*s*m+t*S*m+d*s*D-t*h*D)*re,e[12]=X*re,e[13]=(_*O*o-R*S*o+R*s*b-t*O*b-_*s*P+t*S*P)*re,e[14]=(R*h*o-d*O*o-R*s*p+t*O*p+d*s*P-t*h*P)*re,e[15]=(d*S*o-_*h*o+_*s*p-t*S*p-d*s*b+t*h*b)*re,this}scale(e){const t=this.elements,s=e.x,o=e.y,l=e.z;return t[0]*=s,t[4]*=o,t[8]*=l,t[1]*=s,t[5]*=o,t[9]*=l,t[2]*=s,t[6]*=o,t[10]*=l,t[3]*=s,t[7]*=o,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,s){return this.set(1,0,0,e,0,1,0,t,0,0,1,s,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),s=Math.sin(e);return this.set(1,0,0,0,0,t,-s,0,0,s,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,0,s,0,0,1,0,0,-s,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),s=Math.sin(e);return this.set(t,-s,0,0,s,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const s=Math.cos(t),o=Math.sin(t),l=1-s,d=e.x,h=e.y,p=e.z,m=l*d,_=l*h;return this.set(m*d+s,m*h-o*p,m*p+o*h,0,m*h+o*p,_*h+s,_*p-o*d,0,m*p-o*h,_*p+o*d,l*p*p+s,0,0,0,0,1),this}makeScale(e,t,s){return this.set(e,0,0,0,0,t,0,0,0,0,s,0,0,0,0,1),this}makeShear(e,t,s,o,l,d){return this.set(1,s,l,0,e,1,d,0,t,o,1,0,0,0,0,1),this}compose(e,t,s){const o=this.elements,l=t._x,d=t._y,h=t._z,p=t._w,m=l+l,_=d+d,S=h+h,b=l*m,D=l*_,R=l*S,O=d*_,P=d*S,I=h*S,B=p*m,U=p*_,W=p*S,X=s.x,K=s.y,re=s.z;return o[0]=(1-(O+I))*X,o[1]=(D+W)*X,o[2]=(R-U)*X,o[3]=0,o[4]=(D-W)*K,o[5]=(1-(b+I))*K,o[6]=(P+B)*K,o[7]=0,o[8]=(R+U)*re,o[9]=(P-B)*re,o[10]=(1-(b+O))*re,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,t,s){const o=this.elements;let l=ya.set(o[0],o[1],o[2]).length();const d=ya.set(o[4],o[5],o[6]).length(),h=ya.set(o[8],o[9],o[10]).length();this.determinant()<0&&(l=-l),e.x=o[12],e.y=o[13],e.z=o[14],ps.copy(this);const m=1/l,_=1/d,S=1/h;return ps.elements[0]*=m,ps.elements[1]*=m,ps.elements[2]*=m,ps.elements[4]*=_,ps.elements[5]*=_,ps.elements[6]*=_,ps.elements[8]*=S,ps.elements[9]*=S,ps.elements[10]*=S,t.setFromRotationMatrix(ps),s.x=l,s.y=d,s.z=h,this}makePerspective(e,t,s,o,l,d){const h=this.elements,m=2*l/(s-o),_=(t+e)/(t-e),S=(s+o)/(s-o),b=-(d+l)/(d-l),D=-2*d*l/(d-l);return h[0]=2*l/(t-e),h[4]=0,h[8]=_,h[12]=0,h[1]=0,h[5]=m,h[9]=S,h[13]=0,h[2]=0,h[6]=0,h[10]=b,h[14]=D,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,s,o,l,d){const h=this.elements,p=1/(t-e),m=1/(s-o),_=1/(d-l),S=(t+e)*p,b=(s+o)*m,D=(d+l)*_;return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-S,h[1]=0,h[5]=2*m,h[9]=0,h[13]=-b,h[2]=0,h[6]=0,h[10]=-2*_,h[14]=-D,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,s=e.elements;for(let o=0;o<16;o++)if(t[o]!==s[o])return!1;return!0}fromArray(e,t=0){for(let s=0;s<16;s++)this.elements[s]=e[s+t];return this}toArray(e=[],t=0){const s=this.elements;return e[t]=s[0],e[t+1]=s[1],e[t+2]=s[2],e[t+3]=s[3],e[t+4]=s[4],e[t+5]=s[5],e[t+6]=s[6],e[t+7]=s[7],e[t+8]=s[8],e[t+9]=s[9],e[t+10]=s[10],e[t+11]=s[11],e[t+12]=s[12],e[t+13]=s[13],e[t+14]=s[14],e[t+15]=s[15],e}}const ya=new J,ps=new Nt,Lr=new J(0,0,0),$h=new J(1,1,1),bs=new J,Vr=new J,Nr=new J,ru=new Nt,su=new Zr;let qo=(()=>{class c{constructor(t=0,s=0,o=0,l=c.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=s,this._z=o,this._order=l}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,s,o,l=this._order){return this._x=t,this._y=s,this._z=o,this._order=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,s=this._order,o=!0){const l=t.elements,d=l[0],h=l[4],p=l[8],m=l[1],_=l[5],S=l[9],b=l[2],D=l[6],R=l[10];switch(s){case"XYZ":this._y=Math.asin(wi(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-S,R),this._z=Math.atan2(-h,d)):(this._x=Math.atan2(D,_),this._z=0);break;case"YXZ":this._x=Math.asin(-wi(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(p,R),this._z=Math.atan2(m,_)):(this._y=Math.atan2(-b,d),this._z=0);break;case"ZXY":this._x=Math.asin(wi(D,-1,1)),Math.abs(D)<.9999999?(this._y=Math.atan2(-b,R),this._z=Math.atan2(-h,_)):(this._y=0,this._z=Math.atan2(m,d));break;case"ZYX":this._y=Math.asin(-wi(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(D,R),this._z=Math.atan2(m,d)):(this._x=0,this._z=Math.atan2(-h,_));break;case"YZX":this._z=Math.asin(wi(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-S,_),this._y=Math.atan2(-b,d)):(this._x=0,this._y=Math.atan2(p,R));break;case"XZY":this._z=Math.asin(-wi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(D,_),this._y=Math.atan2(p,d)):(this._x=Math.atan2(-S,R),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+s)}return this._order=s,!0===o&&this._onChangeCallback(),this}setFromQuaternion(t,s,o){return ru.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ru,s,o)}setFromVector3(t,s=this._order){return this.set(t.x,t.y,t.z,s)}reorder(t){return su.setFromEuler(this),this.setFromQuaternion(su,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],s=0){return t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return c.DEFAULT_ORDER="XYZ",c})();class ac{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Jr=0;const Mo=new J,Ga=new Zr,Gr=new Nt,ms=new J,_a=new J,hd=new J,jh=new Zr,Xh=new J(1,0,0),fl=new J(0,1,0),lc=new J(0,0,1),Yh={type:"added"},ou={type:"removed"};let ws=(()=>{class c extends ha{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Jr++}),this.uuid=nr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=c.DEFAULT_UP.clone();const t=new J,s=new qo,o=new Zr,l=new J(1,1,1);s._onChange(function d(){o.setFromEuler(s,!1)}),o._onChange(function h(){s.setFromQuaternion(o,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:s},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new Nt},normalMatrix:{value:new Gn}}),this.matrix=new Nt,this.matrixWorld=new Nt,this.matrixAutoUpdate=c.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=c.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new ac,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,s){this.quaternion.setFromAxisAngle(t,s)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,s){return Ga.setFromAxisAngle(t,s),this.quaternion.multiply(Ga),this}rotateOnWorldAxis(t,s){return Ga.setFromAxisAngle(t,s),this.quaternion.premultiply(Ga),this}rotateX(t){return this.rotateOnAxis(Xh,t)}rotateY(t){return this.rotateOnAxis(fl,t)}rotateZ(t){return this.rotateOnAxis(lc,t)}translateOnAxis(t,s){return Mo.copy(t).applyQuaternion(this.quaternion),this.position.add(Mo.multiplyScalar(s)),this}translateX(t){return this.translateOnAxis(Xh,t)}translateY(t){return this.translateOnAxis(fl,t)}translateZ(t){return this.translateOnAxis(lc,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Gr.copy(this.matrixWorld).invert())}lookAt(t,s,o){t.isVector3?ms.copy(t):ms.set(t,s,o);const l=this.parent;this.updateWorldMatrix(!0,!1),_a.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gr.lookAt(_a,ms,this.up):Gr.lookAt(ms,_a,this.up),this.quaternion.setFromRotationMatrix(Gr),l&&(Gr.extractRotation(l.matrixWorld),Ga.setFromRotationMatrix(Gr),this.quaternion.premultiply(Ga.invert()))}add(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Yh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const s=this.children.indexOf(t);return-1!==s&&(t.parent=null,this.children.splice(s,1),t.dispatchEvent(ou)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const s=this.children[t];s.parent=null,s.dispatchEvent(ou)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Gr.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Gr.multiply(t.parent.matrixWorld)),t.applyMatrix4(Gr),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,s){if(this[t]===s)return this;for(let o=0,l=this.children.length;o<l;o++){const h=this.children[o].getObjectByProperty(t,s);if(void 0!==h)return h}}getObjectsByProperty(t,s){let o=[];this[t]===s&&o.push(this);for(let l=0,d=this.children.length;l<d;l++){const h=this.children[l].getObjectsByProperty(t,s);h.length>0&&(o=o.concat(h))}return o}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_a,t,hd),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_a,jh,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const s=this.matrixWorld.elements;return t.set(s[8],s[9],s[10]).normalize()}raycast(){}traverse(t){t(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].traverseVisible(t)}traverseAncestors(t){const s=this.parent;null!==s&&(t(s),s.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const s=this.children;for(let o=0,l=s.length;o<l;o++){const d=s[o];(!0===d.matrixWorldAutoUpdate||!0===t)&&d.updateMatrixWorld(t)}}updateWorldMatrix(t,s){const o=this.parent;if(!0===t&&null!==o&&!0===o.matrixWorldAutoUpdate&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===s){const l=this.children;for(let d=0,h=l.length;d<h;d++){const p=l[d];!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!1,!0)}}}toJSON(t){const s=void 0===t||"string"==typeof t,o={};s&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const l={};function d(p,m){return void 0===p[m.uuid]&&(p[m.uuid]=m.toJSON(t)),m.uuid}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),!0===this.castShadow&&(l.castShadow=!0),!0===this.receiveShadow&&(l.receiveShadow=!0),!1===this.visible&&(l.visible=!1),!1===this.frustumCulled&&(l.frustumCulled=!1),0!==this.renderOrder&&(l.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),l.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(l.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?l.background=this.background.toJSON():this.background.isTexture&&(l.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(l.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){l.geometry=d(t.geometries,this.geometry);const p=this.geometry.parameters;if(void 0!==p&&void 0!==p.shapes){const m=p.shapes;if(Array.isArray(m))for(let _=0,S=m.length;_<S;_++)d(t.shapes,m[_]);else d(t.shapes,m)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(d(t.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const p=[];for(let m=0,_=this.material.length;m<_;m++)p.push(d(t.materials,this.material[m]));l.material=p}else l.material=d(t.materials,this.material);if(this.children.length>0){l.children=[];for(let p=0;p<this.children.length;p++)l.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){l.animations=[];for(let p=0;p<this.animations.length;p++)l.animations.push(d(t.animations,this.animations[p]))}if(s){const p=h(t.geometries),m=h(t.materials),_=h(t.textures),S=h(t.images),b=h(t.shapes),D=h(t.skeletons),R=h(t.animations),O=h(t.nodes);p.length>0&&(o.geometries=p),m.length>0&&(o.materials=m),_.length>0&&(o.textures=_),S.length>0&&(o.images=S),b.length>0&&(o.shapes=b),D.length>0&&(o.skeletons=D),R.length>0&&(o.animations=R),O.length>0&&(o.nodes=O)}return o.object=l,o;function h(p){const m=[];for(const _ in p){const S=p[_];delete S.metadata,m.push(S)}return m}}clone(t){return(new this.constructor).copy(this,t)}copy(t,s=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===s)for(let o=0;o<t.children.length;o++)this.add(t.children[o].clone());return this}}return c.DEFAULT_UP=new J(0,1,0),c.DEFAULT_MATRIX_AUTO_UPDATE=!0,c.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,c})();const Ts=new J,io=new J,pl=new J,ro=new J,Ma=new J,xa=new J,cc=new J,au=new J,lu=new J,Mr=new J;let so=!1;class Xn{constructor(e=new J,t=new J,s=new J){this.a=e,this.b=t,this.c=s}static getNormal(e,t,s,o){o.subVectors(s,t),Ts.subVectors(e,t),o.cross(Ts);const l=o.lengthSq();return l>0?o.multiplyScalar(1/Math.sqrt(l)):o.set(0,0,0)}static getBarycoord(e,t,s,o,l){Ts.subVectors(o,t),io.subVectors(s,t),pl.subVectors(e,t);const d=Ts.dot(Ts),h=Ts.dot(io),p=Ts.dot(pl),m=io.dot(io),_=io.dot(pl),S=d*m-h*h;if(0===S)return l.set(-2,-1,-1);const b=1/S,D=(m*p-h*_)*b,R=(d*_-h*p)*b;return l.set(1-D-R,R,D)}static containsPoint(e,t,s,o){return this.getBarycoord(e,t,s,o,ro),ro.x>=0&&ro.y>=0&&ro.x+ro.y<=1}static getUV(e,t,s,o,l,d,h,p){return!1===so&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),so=!0),this.getInterpolation(e,t,s,o,l,d,h,p)}static getInterpolation(e,t,s,o,l,d,h,p){return this.getBarycoord(e,t,s,o,ro),p.setScalar(0),p.addScaledVector(l,ro.x),p.addScaledVector(d,ro.y),p.addScaledVector(h,ro.z),p}static isFrontFacing(e,t,s,o){return Ts.subVectors(s,t),io.subVectors(e,t),Ts.cross(io).dot(o)<0}set(e,t,s){return this.a.copy(e),this.b.copy(t),this.c.copy(s),this}setFromPointsAndIndices(e,t,s,o){return this.a.copy(e[t]),this.b.copy(e[s]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,t,s,o){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,s),this.c.fromBufferAttribute(e,o),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ts.subVectors(this.c,this.b),io.subVectors(this.a,this.b),.5*Ts.cross(io).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Xn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Xn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,s,o,l){return!1===so&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),so=!0),Xn.getInterpolation(e,this.a,this.b,this.c,t,s,o,l)}getInterpolation(e,t,s,o,l){return Xn.getInterpolation(e,this.a,this.b,this.c,t,s,o,l)}containsPoint(e){return Xn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Xn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const s=this.a,o=this.b,l=this.c;let d,h;Ma.subVectors(o,s),xa.subVectors(l,s),au.subVectors(e,s);const p=Ma.dot(au),m=xa.dot(au);if(p<=0&&m<=0)return t.copy(s);lu.subVectors(e,o);const _=Ma.dot(lu),S=xa.dot(lu);if(_>=0&&S<=_)return t.copy(o);const b=p*S-_*m;if(b<=0&&p>=0&&_<=0)return d=p/(p-_),t.copy(s).addScaledVector(Ma,d);Mr.subVectors(e,l);const D=Ma.dot(Mr),R=xa.dot(Mr);if(R>=0&&D<=R)return t.copy(l);const O=D*m-p*R;if(O<=0&&m>=0&&R<=0)return h=m/(m-R),t.copy(s).addScaledVector(xa,h);const P=_*R-D*S;if(P<=0&&S-_>=0&&D-R>=0)return cc.subVectors(l,o),h=(S-_)/(S-_+(D-R)),t.copy(o).addScaledVector(cc,h);const I=1/(P+O+b);return d=O*I,h=b*I,t.copy(s).addScaledVector(Ma,d).addScaledVector(xa,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let fd=0;class ml extends ha{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:fd++}),this.uuid=nr(),this.name="",this.type="Material",this.blending=1,this.side=Le,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const s=e[t];if(void 0===s){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const o=this[t];void 0!==o?o&&o.isColor?o.set(s):o&&o.isVector3&&s&&s.isVector3?o.copy(s):this[t]=s:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const s={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function o(l){const d=[];for(const h in l){const p=l[h];delete p.metadata,d.push(p)}return d}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),void 0!==this.roughness&&(s.roughness=this.roughness),void 0!==this.metalness&&(s.metalness=this.metalness),void 0!==this.sheen&&(s.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(s.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(s.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(s.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(s.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(s.shininess=this.shininess),void 0!==this.clearcoat&&(s.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(s.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(s.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(s.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(s.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(e).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(e).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(e).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(e).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(e).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(s.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(s.combine=this.combine)),void 0!==this.envMapIntensity&&(s.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(s.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(s.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(s.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(s.size=this.size),null!==this.shadowSide&&(s.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(s.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(s.blending=this.blending),this.side!==Le&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),!0===this.transparent&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.colorWrite=this.colorWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(s.rotation=this.rotation),!0===this.polygonOffset&&(s.polygonOffset=!0),0!==this.polygonOffsetFactor&&(s.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(s.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(s.linewidth=this.linewidth),void 0!==this.dashSize&&(s.dashSize=this.dashSize),void 0!==this.gapSize&&(s.gapSize=this.gapSize),void 0!==this.scale&&(s.scale=this.scale),!0===this.dithering&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(s.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(s.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(s.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(s.wireframe=this.wireframe),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(s.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(s.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(s.flatShading=this.flatShading),!1===this.visible&&(s.visible=!1),!1===this.toneMapped&&(s.toneMapped=!1),!1===this.fog&&(s.fog=!1),Object.keys(this.userData).length>0&&(s.userData=this.userData),t){const l=o(e.textures),d=o(e.images);l.length>0&&(s.textures=l),d.length>0&&(s.images=d)}return s}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let s=null;if(null!==t){const o=t.length;s=new Array(o);for(let l=0;l!==o;++l)s[l]=t[l].clone()}return this.clippingPlanes=s,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const pd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},oo={h:0,s:0,l:0},uc={h:0,s:0,l:0};function cu(c,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?c+6*(e-c)*t:t<.5?e:t<2/3?c+6*(e-c)*(2/3-t):c}class Ht{constructor(e,t,s){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===s?this.set(e):this.setRGB(e,t,s)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=_n){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Ss.toWorkingColorSpace(this,t),this}setRGB(e,t,s,o=Ss.workingColorSpace){return this.r=e,this.g=t,this.b=s,Ss.toWorkingColorSpace(this,o),this}setHSL(e,t,s,o=Ss.workingColorSpace){if(e=function Kl(c,e){return(c%e+e)%e}(e,1),t=wi(t,0,1),s=wi(s,0,1),0===t)this.r=this.g=this.b=s;else{const l=s<=.5?s*(1+t):s+t-s*t,d=2*s-l;this.r=cu(d,l,e+1/3),this.g=cu(d,l,e),this.b=cu(d,l,e-1/3)}return Ss.toWorkingColorSpace(this,o),this}setStyle(e,t=_n){function s(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const h=o[2];switch(o[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return s(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,t);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return s(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,t);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return s(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=o[1],d=l.length;if(3===d)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,t);if(6===d)return this.setHex(parseInt(l,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=_n){const s=pd[e.toLowerCase()];return void 0!==s?this.setHex(s,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=$o(e.r),this.g=$o(e.g),this.b=$o(e.b),this}copyLinearToSRGB(e){return this.r=jo(e.r),this.g=jo(e.g),this.b=jo(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=_n){return Ss.fromWorkingColorSpace(y.copy(this),e),65536*Math.round(wi(255*y.r,0,255))+256*Math.round(wi(255*y.g,0,255))+Math.round(wi(255*y.b,0,255))}getHexString(e=_n){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ss.workingColorSpace){Ss.fromWorkingColorSpace(y.copy(this),t);const s=y.r,o=y.g,l=y.b,d=Math.max(s,o,l),h=Math.min(s,o,l);let p,m;const _=(h+d)/2;if(h===d)p=0,m=0;else{const S=d-h;switch(m=_<=.5?S/(d+h):S/(2-d-h),d){case s:p=(o-l)/S+(o<l?6:0);break;case o:p=(l-s)/S+2;break;case l:p=(s-o)/S+4}p/=6}return e.h=p,e.s=m,e.l=_,e}getRGB(e,t=Ss.workingColorSpace){return Ss.fromWorkingColorSpace(y.copy(this),t),e.r=y.r,e.g=y.g,e.b=y.b,e}getStyle(e=_n){Ss.fromWorkingColorSpace(y.copy(this),e);const t=y.r,s=y.g,o=y.b;return e!==_n?`color(${e} ${t.toFixed(3)} ${s.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*s)},${Math.round(255*o)})`}offsetHSL(e,t,s){return this.getHSL(oo),oo.h+=e,oo.s+=t,oo.l+=s,this.setHSL(oo.h,oo.s,oo.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,s){return this.r=e.r+(t.r-e.r)*s,this.g=e.g+(t.g-e.g)*s,this.b=e.b+(t.b-e.b)*s,this}lerpHSL(e,t){this.getHSL(oo),e.getHSL(uc);const s=Es(oo.h,uc.h,t),o=Es(oo.s,uc.s,t),l=Es(oo.l,uc.l,t);return this.setHSL(s,o,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,s=this.g,o=this.b,l=e.elements;return this.r=l[0]*t+l[3]*s+l[6]*o,this.g=l[1]*t+l[4]*s+l[7]*o,this.b=l[2]*t+l[5]*s+l[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const y=new Ht;Ht.NAMES=pd;class E extends ml{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const se=new J,Ze=new et;class Ct{constructor(e,t,s=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=s,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,s){e*=this.itemSize,s*=t.itemSize;for(let o=0,l=this.itemSize;o<l;o++)this.array[e+o]=t.array[s+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,s=this.count;t<s;t++)Ze.fromBufferAttribute(this,t),Ze.applyMatrix3(e),this.setXY(t,Ze.x,Ze.y);else if(3===this.itemSize)for(let t=0,s=this.count;t<s;t++)se.fromBufferAttribute(this,t),se.applyMatrix3(e),this.setXYZ(t,se.x,se.y,se.z);return this}applyMatrix4(e){for(let t=0,s=this.count;t<s;t++)se.fromBufferAttribute(this,t),se.applyMatrix4(e),this.setXYZ(t,se.x,se.y,se.z);return this}applyNormalMatrix(e){for(let t=0,s=this.count;t<s;t++)se.fromBufferAttribute(this,t),se.applyNormalMatrix(e),this.setXYZ(t,se.x,se.y,se.z);return this}transformDirection(e){for(let t=0,s=this.count;t<s;t++)se.fromBufferAttribute(this,t),se.transformDirection(e),this.setXYZ(t,se.x,se.y,se.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ri(t,this.array)),t}setX(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ri(t,this.array)),t}setY(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ri(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ri(t,this.array)),t}setW(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,s){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),s=Cn(s,this.array)),this.array[e+0]=t,this.array[e+1]=s,this}setXYZ(e,t,s,o){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),s=Cn(s,this.array),o=Cn(o,this.array)),this.array[e+0]=t,this.array[e+1]=s,this.array[e+2]=o,this}setXYZW(e,t,s,o,l){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),s=Cn(s,this.array),o=Cn(o,this.array),l=Cn(l,this.array)),this.array[e+0]=t,this.array[e+1]=s,this.array[e+2]=o,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class gl extends Ct{constructor(e,t,s){super(new Uint16Array(e),t,s)}}class fc extends Ct{constructor(e,t,s){super(new Uint32Array(e),t,s)}}class en extends Ct{constructor(e,t,s){super(new Float32Array(e),t,s)}}let gd=0;const ao=new Nt,pc=new ws,Wa=new J,Qr=new A,vd=new A,xr=new J;class Yn extends ha{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:gd++}),this.uuid=nr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Go(e)?fc:gl)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,s=0){this.groups.push({start:e,count:t,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const s=this.attributes.normal;if(void 0!==s){const l=(new Gn).getNormalMatrix(e);s.applyNormalMatrix(l),s.needsUpdate=!0}const o=this.attributes.tangent;return void 0!==o&&(o.transformDirection(e),o.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return ao.makeRotationFromQuaternion(e),this.applyMatrix4(ao),this}rotateX(e){return ao.makeRotationX(e),this.applyMatrix4(ao),this}rotateY(e){return ao.makeRotationY(e),this.applyMatrix4(ao),this}rotateZ(e){return ao.makeRotationZ(e),this.applyMatrix4(ao),this}translate(e,t,s){return ao.makeTranslation(e,t,s),this.applyMatrix4(ao),this}scale(e,t,s){return ao.makeScale(e,t,s),this.applyMatrix4(ao),this}lookAt(e){return pc.lookAt(e),pc.updateMatrix(),this.applyMatrix4(pc.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wa).negate(),this.translate(Wa.x,Wa.y,Wa.z),this}setFromPoints(e){const t=[];for(let s=0,o=e.length;s<o;s++){const l=e[s];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new en(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new A);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Qr.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(xr.addVectors(this.boundingBox.min,Qr.min),this.boundingBox.expandByPoint(xr),xr.addVectors(this.boundingBox.max,Qr.max),this.boundingBox.expandByPoint(xr)):(this.boundingBox.expandByPoint(Qr.min),this.boundingBox.expandByPoint(Qr.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new _i);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new J,1/0);if(e){const s=this.boundingSphere.center;if(Qr.setFromBufferAttribute(e),t)for(let l=0,d=t.length;l<d;l++)vd.setFromBufferAttribute(t[l]),this.morphTargetsRelative?(xr.addVectors(Qr.min,vd.min),Qr.expandByPoint(xr),xr.addVectors(Qr.max,vd.max),Qr.expandByPoint(xr)):(Qr.expandByPoint(vd.min),Qr.expandByPoint(vd.max));Qr.getCenter(s);let o=0;for(let l=0,d=e.count;l<d;l++)xr.fromBufferAttribute(e,l),o=Math.max(o,s.distanceToSquared(xr));if(t)for(let l=0,d=t.length;l<d;l++){const h=t[l],p=this.morphTargetsRelative;for(let m=0,_=h.count;m<_;m++)xr.fromBufferAttribute(h,m),p&&(Wa.fromBufferAttribute(e,m),xr.add(Wa)),o=Math.max(o,s.distanceToSquared(xr))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const s=e.array,o=t.position.array,l=t.normal.array,d=t.uv.array,h=o.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Ct(new Float32Array(4*h),4));const p=this.getAttribute("tangent").array,m=[],_=[];for(let te=0;te<h;te++)m[te]=new J,_[te]=new J;const S=new J,b=new J,D=new J,R=new et,O=new et,P=new et,I=new J,B=new J;function U(te,Ae,Ge){S.fromArray(o,3*te),b.fromArray(o,3*Ae),D.fromArray(o,3*Ge),R.fromArray(d,2*te),O.fromArray(d,2*Ae),P.fromArray(d,2*Ge),b.sub(S),D.sub(S),O.sub(R),P.sub(R);const ve=1/(O.x*P.y-P.x*O.y);isFinite(ve)&&(I.copy(b).multiplyScalar(P.y).addScaledVector(D,-O.y).multiplyScalar(ve),B.copy(D).multiplyScalar(O.x).addScaledVector(b,-P.x).multiplyScalar(ve),m[te].add(I),m[Ae].add(I),m[Ge].add(I),_[te].add(B),_[Ae].add(B),_[Ge].add(B))}let W=this.groups;0===W.length&&(W=[{start:0,count:s.length}]);for(let te=0,Ae=W.length;te<Ae;++te){const Ge=W[te],ve=Ge.start;for(let Ie=ve,lt=ve+Ge.count;Ie<lt;Ie+=3)U(s[Ie+0],s[Ie+1],s[Ie+2])}const X=new J,K=new J,re=new J,le=new J;function V(te){re.fromArray(l,3*te),le.copy(re);const Ae=m[te];X.copy(Ae),X.sub(re.multiplyScalar(re.dot(Ae))).normalize(),K.crossVectors(le,Ae);const ve=K.dot(_[te])<0?-1:1;p[4*te]=X.x,p[4*te+1]=X.y,p[4*te+2]=X.z,p[4*te+3]=ve}for(let te=0,Ae=W.length;te<Ae;++te){const Ge=W[te],ve=Ge.start;for(let Ie=ve,lt=ve+Ge.count;Ie<lt;Ie+=3)V(s[Ie+0]),V(s[Ie+1]),V(s[Ie+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let s=this.getAttribute("normal");if(void 0===s)s=new Ct(new Float32Array(3*t.count),3),this.setAttribute("normal",s);else for(let b=0,D=s.count;b<D;b++)s.setXYZ(b,0,0,0);const o=new J,l=new J,d=new J,h=new J,p=new J,m=new J,_=new J,S=new J;if(e)for(let b=0,D=e.count;b<D;b+=3){const R=e.getX(b+0),O=e.getX(b+1),P=e.getX(b+2);o.fromBufferAttribute(t,R),l.fromBufferAttribute(t,O),d.fromBufferAttribute(t,P),_.subVectors(d,l),S.subVectors(o,l),_.cross(S),h.fromBufferAttribute(s,R),p.fromBufferAttribute(s,O),m.fromBufferAttribute(s,P),h.add(_),p.add(_),m.add(_),s.setXYZ(R,h.x,h.y,h.z),s.setXYZ(O,p.x,p.y,p.z),s.setXYZ(P,m.x,m.y,m.z)}else for(let b=0,D=t.count;b<D;b+=3)o.fromBufferAttribute(t,b+0),l.fromBufferAttribute(t,b+1),d.fromBufferAttribute(t,b+2),_.subVectors(d,l),S.subVectors(o,l),_.cross(S),s.setXYZ(b+0,_.x,_.y,_.z),s.setXYZ(b+1,_.x,_.y,_.z),s.setXYZ(b+2,_.x,_.y,_.z);this.normalizeNormals(),s.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,s=e.count;t<s;t++)xr.fromBufferAttribute(e,t),xr.normalize(),e.setXYZ(t,xr.x,xr.y,xr.z)}toNonIndexed(){function e(h,p){const m=h.array,_=h.itemSize,S=h.normalized,b=new m.constructor(p.length*_);let D=0,R=0;for(let O=0,P=p.length;O<P;O++){D=h.isInterleavedBufferAttribute?p[O]*h.data.stride+h.offset:p[O]*_;for(let I=0;I<_;I++)b[R++]=m[D++]}return new Ct(b,_,S)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Yn,s=this.index.array,o=this.attributes;for(const h in o){const m=e(o[h],s);t.setAttribute(h,m)}const l=this.morphAttributes;for(const h in l){const p=[],m=l[h];for(let _=0,S=m.length;_<S;_++){const D=e(m[_],s);p.push(D)}t.morphAttributes[h]=p}t.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let h=0,p=d.length;h<p;h++){const m=d[h];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const s=this.attributes;for(const p in s)e.data.attributes[p]=s[p].toJSON(e.data);const o={};let l=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],_=[];for(let S=0,b=m.length;S<b;S++)_.push(m[S].toJSON(e.data));_.length>0&&(o[p]=_,l=!0)}l&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const h=this.boundingSphere;return null!==h&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const s=e.index;null!==s&&this.setIndex(s.clone(t));const o=e.attributes;for(const m in o)this.setAttribute(m,o[m].clone(t));const l=e.morphAttributes;for(const m in l){const _=[],S=l[m];for(let b=0,D=S.length;b<D;b++)_.push(S[b].clone(t));this.morphAttributes[m]=_}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let m=0,_=d.length;m<_;m++){const S=d[m];this.addGroup(S.start,S.count,S.materialIndex)}const h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Wp=new Nt,Er=new Ye,yd=new _i,uu=new J,$a=new J,vl=new J,ja=new J,du=new J,_d=new J,hu=new et,fu=new et,pu=new et,qh=new J,$p=new J,mu=new J,Zo=new J,Md=new J;class es extends ws{constructor(e=new Yn,t=new E){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,s=Object.keys(t);if(s.length>0){const o=t[s[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=o.length;l<d;l++){const h=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}getVertexPosition(e,t){const s=this.geometry,l=s.morphAttributes.position,d=s.morphTargetsRelative;t.fromBufferAttribute(s.attributes.position,e);const h=this.morphTargetInfluences;if(l&&h){_d.set(0,0,0);for(let p=0,m=l.length;p<m;p++){const _=h[p];0!==_&&(du.fromBufferAttribute(l[p],e),_d.addScaledVector(d?du:du.sub(t),_))}t.add(_d)}return t}raycast(e,t){const s=this.geometry,l=this.matrixWorld;void 0!==this.material&&(null===s.boundingSphere&&s.computeBoundingSphere(),yd.copy(s.boundingSphere),yd.applyMatrix4(l),Er.copy(e.ray).recast(e.near),(!1!==yd.containsPoint(Er.origin)||!(null===Er.intersectSphere(yd,uu)||Er.origin.distanceToSquared(uu)>(e.far-e.near)**2))&&(Wp.copy(l).invert(),Er.copy(e.ray).applyMatrix4(Wp),(null===s.boundingBox||!1!==Er.intersectsBox(s.boundingBox))&&this._computeIntersections(e,t)))}_computeIntersections(e,t){let s;const o=this.geometry,l=this.material,d=o.index,h=o.attributes.position,p=o.attributes.uv,m=o.attributes.uv1,_=o.attributes.normal,S=o.groups,b=o.drawRange;if(null!==d)if(Array.isArray(l))for(let D=0,R=S.length;D<R;D++){const O=S[D],P=l[O.materialIndex];for(let U=Math.max(O.start,b.start),W=Math.min(d.count,Math.min(O.start+O.count,b.start+b.count));U<W;U+=3){const X=d.getX(U),K=d.getX(U+1),re=d.getX(U+2);s=Ea(this,P,e,Er,p,m,_,X,K,re),s&&(s.faceIndex=Math.floor(U/3),s.face.materialIndex=O.materialIndex,t.push(s))}}else for(let O=Math.max(0,b.start),P=Math.min(d.count,b.start+b.count);O<P;O+=3){const I=d.getX(O),B=d.getX(O+1),U=d.getX(O+2);s=Ea(this,l,e,Er,p,m,_,I,B,U),s&&(s.faceIndex=Math.floor(O/3),t.push(s))}else if(void 0!==h)if(Array.isArray(l))for(let D=0,R=S.length;D<R;D++){const O=S[D],P=l[O.materialIndex];for(let U=Math.max(O.start,b.start),W=Math.min(h.count,Math.min(O.start+O.count,b.start+b.count));U<W;U+=3)s=Ea(this,P,e,Er,p,m,_,U,U+1,U+2),s&&(s.faceIndex=Math.floor(U/3),s.face.materialIndex=O.materialIndex,t.push(s))}else for(let O=Math.max(0,b.start),P=Math.min(h.count,b.start+b.count);O<P;O+=3)s=Ea(this,l,e,Er,p,m,_,O,O+1,O+2),s&&(s.faceIndex=Math.floor(O/3),t.push(s))}}function Ea(c,e,t,s,o,l,d,h,p,m){c.getVertexPosition(h,$a),c.getVertexPosition(p,vl),c.getVertexPosition(m,ja);const _=function jp(c,e,t,s,o,l,d,h){let p;if(p=e.side===Je?s.intersectTriangle(d,l,o,!0,h):s.intersectTriangle(o,l,d,e.side===Le,h),null===p)return null;Md.copy(h),Md.applyMatrix4(c.matrixWorld);const m=t.ray.origin.distanceTo(Md);return m<t.near||m>t.far?null:{distance:m,point:Md.clone(),object:c}}(c,e,t,s,$a,vl,ja,Zo);if(_){o&&(hu.fromBufferAttribute(o,h),fu.fromBufferAttribute(o,p),pu.fromBufferAttribute(o,m),_.uv=Xn.getInterpolation(Zo,$a,vl,ja,hu,fu,pu,new et)),l&&(hu.fromBufferAttribute(l,h),fu.fromBufferAttribute(l,p),pu.fromBufferAttribute(l,m),_.uv1=Xn.getInterpolation(Zo,$a,vl,ja,hu,fu,pu,new et),_.uv2=_.uv1),d&&(qh.fromBufferAttribute(d,h),$p.fromBufferAttribute(d,p),mu.fromBufferAttribute(d,m),_.normal=Xn.getInterpolation(Zo,$a,vl,ja,qh,$p,mu,new J),_.normal.dot(s.direction)>0&&_.normal.multiplyScalar(-1));const S={a:h,b:p,c:m,normal:new J,materialIndex:0};Xn.getNormal($a,vl,ja,S.normal),_.face=S}return _}class mc extends Yn{constructor(e=1,t=1,s=1,o=1,l=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:s,widthSegments:o,heightSegments:l,depthSegments:d};const h=this;o=Math.floor(o),l=Math.floor(l),d=Math.floor(d);const p=[],m=[],_=[],S=[];let b=0,D=0;function R(O,P,I,B,U,W,X,K,re,le,V){const te=W/re,Ae=X/le,Ge=W/2,ve=X/2,we=K/2,Ie=re+1,lt=le+1;let ot=0,it=0;const dt=new J;for(let vt=0;vt<lt;vt++){const jt=vt*Ae-ve;for(let Bt=0;Bt<Ie;Bt++)dt[O]=(Bt*te-Ge)*B,dt[P]=jt*U,dt[I]=we,m.push(dt.x,dt.y,dt.z),dt[O]=0,dt[P]=0,dt[I]=K>0?1:-1,_.push(dt.x,dt.y,dt.z),S.push(Bt/re),S.push(1-vt/le),ot+=1}for(let vt=0;vt<le;vt++)for(let jt=0;jt<re;jt++){const Ne=b+jt+Ie*(vt+1),ct=b+(jt+1)+Ie*(vt+1),Pt=b+(jt+1)+Ie*vt;p.push(b+jt+Ie*vt,Ne,Pt),p.push(Ne,ct,Pt),it+=6}h.addGroup(D,it,V),D+=it,b+=ot}R("z","y","x",-1,-1,s,t,e,d,l,0),R("z","y","x",1,-1,s,t,-e,d,l,1),R("x","z","y",1,1,e,s,t,o,d,2),R("x","z","y",1,-1,e,s,-t,o,d,3),R("x","y","z",1,-1,e,t,s,o,l,4),R("x","y","z",-1,-1,e,t,-s,o,l,5),this.setIndex(p),this.setAttribute("position",new en(m,3)),this.setAttribute("normal",new en(_,3)),this.setAttribute("uv",new en(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function yl(c){const e={};for(const t in c){e[t]={};for(const s in c[t]){const o=c[t][s];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?o.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][s]=null):e[t][s]=o.clone():e[t][s]=Array.isArray(o)?o.slice():o}}return e}function Wr(c){const e={};for(let t=0;t<c.length;t++){const s=yl(c[t]);for(const o in s)e[o]=s[o]}return e}function Zh(c){return null===c.getRenderTarget()?c.outputColorSpace:ki}const Kh={clone:yl,merge:Wr};class Hs extends ml{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=yl(e.uniforms),this.uniformsGroups=function wv(c){const e=[];for(let t=0;t<c.length;t++)e.push(c[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const o in this.uniforms){const d=this.uniforms[o].value;t.uniforms[o]=d&&d.isTexture?{type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?{type:"c",value:d.getHex()}:d&&d.isVector2?{type:"v2",value:d.toArray()}:d&&d.isVector3?{type:"v3",value:d.toArray()}:d&&d.isVector4?{type:"v4",value:d.toArray()}:d&&d.isMatrix3?{type:"m3",value:d.toArray()}:d&&d.isMatrix4?{type:"m4",value:d.toArray()}:{value:d}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const s={};for(const o in this.extensions)!0===this.extensions[o]&&(s[o]=!0);return Object.keys(s).length>0&&(t.extensions=s),t}}class xd extends ws{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Nt,this.projectionMatrix=new Nt,this.projectionMatrixInverse=new Nt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Sr extends xd{constructor(e=50,t=1,s=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=s,this.far=o,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*fa*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*zo*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*fa*Math.atan(Math.tan(.5*zo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,s,o,l,d){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=s,this.view.offsetY=o,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*zo*this.fov)/this.zoom,s=2*t,o=this.aspect*s,l=-.5*o;const d=this.view;if(null!==this.view&&this.view.enabled){const p=d.fullWidth,m=d.fullHeight;l+=d.offsetX*o/p,t-=d.offsetY*s/m,o*=d.width/p,s*=d.height/m}const h=this.filmOffset;0!==h&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+o,t,t-s,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Tv extends ws{constructor(e,t,s){super(),this.type="CubeCamera",this.renderTarget=s;const o=new Sr(-90,1,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(1,0,0),this.add(o);const l=new Sr(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(-1,0,0),this.add(l);const d=new Sr(-90,1,e,t);d.layers=this.layers,d.up.set(0,0,-1),d.lookAt(0,1,0),this.add(d);const h=new Sr(-90,1,e,t);h.layers=this.layers,h.up.set(0,0,1),h.lookAt(0,-1,0),this.add(h);const p=new Sr(-90,1,e,t);p.layers=this.layers,p.up.set(0,1,0),p.lookAt(0,0,1),this.add(p);const m=new Sr(-90,1,e,t);m.layers=this.layers,m.up.set(0,1,0),m.lookAt(0,0,-1),this.add(m)}update(e,t){null===this.parent&&this.updateMatrixWorld();const s=this.renderTarget,[o,l,d,h,p,m]=this.children,_=e.getRenderTarget(),S=e.toneMapping,b=e.xr.enabled;e.toneMapping=Ji,e.xr.enabled=!1;const D=s.texture.generateMipmaps;s.texture.generateMipmaps=!1,e.setRenderTarget(s,0),e.render(t,o),e.setRenderTarget(s,1),e.render(t,l),e.setRenderTarget(s,2),e.render(t,d),e.setRenderTarget(s,3),e.render(t,h),e.setRenderTarget(s,4),e.render(t,p),s.texture.generateMipmaps=D,e.setRenderTarget(s,5),e.render(t,m),e.setRenderTarget(_),e.toneMapping=S,e.xr.enabled=b,s.texture.needsPMREMUpdate=!0}}class Jh extends eo{constructor(e,t,s,o,l,d,h,p,m,_){super(e=void 0!==e?e:[],t=void 0!==t?t:ti,s,o,l,d,h,p,m,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class j_ extends to{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const s={width:e,height:e,depth:1},o=[s,s,s,s,s,s];void 0!==t.encoding&&(Fs("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===ln?_n:""),this.texture=new Jh(o,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:si}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s_uniforms={tEquirect:{value:null}},s_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",s_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new mc(5,5,5),l=new Hs({name:"CubemapFromEquirect",uniforms:yl(s_uniforms),vertexShader:s_vertexShader,fragmentShader:s_fragmentShader,side:Je,blending:wn});l.uniforms.tEquirect.value=t;const d=new es(o,l),h=t.minFilter;return t.minFilter===ce&&(t.minFilter=si),new Tv(1,10,this).update(e,d),t.minFilter=h,d.geometry.dispose(),d.material.dispose(),this}clear(e,t,s,o){const l=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(t,s,o);e.setRenderTarget(l)}}const Xp=new J,X_=new J,Y_=new Gn;class yc{constructor(e=new J(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,s,o){return this.normal.set(e,t,s),this.constant=o,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,s){const o=Xp.subVectors(s,t).cross(X_.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const s=e.delta(Xp),o=this.normal.dot(s);if(0===o)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/o;return l<0||l>1?null:t.copy(e.start).addScaledVector(s,l)}intersectsLine(e){const t=this.distanceToPoint(e.start),s=this.distanceToPoint(e.end);return t<0&&s>0||s<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const s=t||Y_.getNormalMatrix(e),o=this.coplanarPoint(Xp).applyMatrix4(e),l=this.normal.applyMatrix3(s).normalize();return this.constant=-o.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Eo=new _i,Qh=new J;class Yp{constructor(e=new yc,t=new yc,s=new yc,o=new yc,l=new yc,d=new yc){this.planes=[e,t,s,o,l,d]}set(e,t,s,o,l,d){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(s),h[3].copy(o),h[4].copy(l),h[5].copy(d),this}copy(e){const t=this.planes;for(let s=0;s<6;s++)t[s].copy(e.planes[s]);return this}setFromProjectionMatrix(e){const t=this.planes,s=e.elements,o=s[0],l=s[1],d=s[2],h=s[3],p=s[4],m=s[5],_=s[6],S=s[7],b=s[8],D=s[9],R=s[10],O=s[11],P=s[12],I=s[13],B=s[14],U=s[15];return t[0].setComponents(h-o,S-p,O-b,U-P).normalize(),t[1].setComponents(h+o,S+p,O+b,U+P).normalize(),t[2].setComponents(h+l,S+m,O+D,U+I).normalize(),t[3].setComponents(h-l,S-m,O-D,U-I).normalize(),t[4].setComponents(h-d,S-_,O-R,U-B).normalize(),t[5].setComponents(h+d,S+_,O+R,U+B).normalize(),this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Eo.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Eo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Eo)}intersectsSprite(e){return Eo.center.set(0,0,0),Eo.radius=.7071067811865476,Eo.applyMatrix4(e.matrixWorld),this.intersectsSphere(Eo)}intersectsSphere(e){const t=this.planes,s=e.center,o=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(s)<o)return!1;return!0}intersectsBox(e){const t=this.planes;for(let s=0;s<6;s++){const o=t[s];if(Qh.x=o.normal.x>0?e.max.x:e.min.x,Qh.y=o.normal.y>0?e.max.y:e.min.y,Qh.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(Qh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let s=0;s<6;s++)if(t[s].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function ur(){let c=null,e=!1,t=null,s=null;function o(l,d){t(l,d),s=c.requestAnimationFrame(o)}return{start:function(){!0!==e&&null!==t&&(s=c.requestAnimationFrame(o),e=!0)},stop:function(){c.cancelAnimationFrame(s),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){c=l}}}function Cv(c,e){const t=e.isWebGL2,s=new WeakMap;return{get:function d(m){return m.isInterleavedBufferAttribute&&(m=m.data),s.get(m)},remove:function h(m){m.isInterleavedBufferAttribute&&(m=m.data);const _=s.get(m);_&&(c.deleteBuffer(_.buffer),s.delete(m))},update:function p(m,_){if(m.isGLBufferAttribute){const b=s.get(m);return void((!b||b.version<m.version)&&s.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const S=s.get(m);void 0===S?s.set(m,function o(m,_){const S=m.array,b=m.usage,D=c.createBuffer();let R;if(c.bindBuffer(_,D),c.bufferData(_,S,b),m.onUploadCallback(),S instanceof Float32Array)R=c.FLOAT;else if(S instanceof Uint16Array)if(m.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");R=c.HALF_FLOAT}else R=c.UNSIGNED_SHORT;else if(S instanceof Int16Array)R=c.SHORT;else if(S instanceof Uint32Array)R=c.UNSIGNED_INT;else if(S instanceof Int32Array)R=c.INT;else if(S instanceof Int8Array)R=c.BYTE;else if(S instanceof Uint8Array)R=c.UNSIGNED_BYTE;else{if(!(S instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+S);R=c.UNSIGNED_BYTE}return{buffer:D,type:R,bytesPerElement:S.BYTES_PER_ELEMENT,version:m.version}}(m,_)):S.version<m.version&&(function l(m,_,S){const b=_.array,D=_.updateRange;c.bindBuffer(S,m),-1===D.count?c.bufferSubData(S,0,b):(t?c.bufferSubData(S,D.offset*b.BYTES_PER_ELEMENT,b,D.offset,D.count):c.bufferSubData(S,D.offset*b.BYTES_PER_ELEMENT,b.subarray(D.offset,D.offset+D.count)),D.count=-1),_.onUploadCallback()}(S.buffer,m,_),S.version=m.version)}}}class Ko extends Yn{constructor(e=1,t=1,s=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:s,heightSegments:o};const l=e/2,d=t/2,h=Math.floor(s),p=Math.floor(o),m=h+1,_=p+1,S=e/h,b=t/p,D=[],R=[],O=[],P=[];for(let I=0;I<_;I++){const B=I*b-d;for(let U=0;U<m;U++)R.push(U*S-l,-B,0),O.push(0,0,1),P.push(U/h),P.push(1-I/p)}for(let I=0;I<p;I++)for(let B=0;B<h;B++){const W=B+m*(I+1),X=B+1+m*(I+1),K=B+1+m*I;D.push(B+m*I,W,K),D.push(W,X,K)}this.setIndex(D),this.setAttribute("position",new en(R,3)),this.setAttribute("normal",new en(O,3)),this.setAttribute("uv",new en(P,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ko(e.width,e.height,e.widthSegments,e.heightSegments)}}const zn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_NORMALMAP_TANGENTSPACE\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Rt={common:{diffuse:{value:new Ht(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Gn},alphaMap:{value:null},alphaMapTransform:{value:new Gn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Gn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Gn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Gn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Gn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Gn},normalScale:{value:new et(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Gn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Gn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Gn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Gn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ht(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ht(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Gn}},sprite:{diffuse:{value:new Ht(16777215)},opacity:{value:1},center:{value:new et(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Gn},alphaMap:{value:null},alphaTest:{value:0}}},So={basic:{uniforms:Wr([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.fog]),vertexShader:zn.meshbasic_vert,fragmentShader:zn.meshbasic_frag},lambert:{uniforms:Wr([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,Rt.lights,{emissive:{value:new Ht(0)}}]),vertexShader:zn.meshlambert_vert,fragmentShader:zn.meshlambert_frag},phong:{uniforms:Wr([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,Rt.lights,{emissive:{value:new Ht(0)},specular:{value:new Ht(1118481)},shininess:{value:30}}]),vertexShader:zn.meshphong_vert,fragmentShader:zn.meshphong_frag},standard:{uniforms:Wr([Rt.common,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.roughnessmap,Rt.metalnessmap,Rt.fog,Rt.lights,{emissive:{value:new Ht(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:zn.meshphysical_vert,fragmentShader:zn.meshphysical_frag},toon:{uniforms:Wr([Rt.common,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.gradientmap,Rt.fog,Rt.lights,{emissive:{value:new Ht(0)}}]),vertexShader:zn.meshtoon_vert,fragmentShader:zn.meshtoon_frag},matcap:{uniforms:Wr([Rt.common,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,{matcap:{value:null}}]),vertexShader:zn.meshmatcap_vert,fragmentShader:zn.meshmatcap_frag},points:{uniforms:Wr([Rt.points,Rt.fog]),vertexShader:zn.points_vert,fragmentShader:zn.points_frag},dashed:{uniforms:Wr([Rt.common,Rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:zn.linedashed_vert,fragmentShader:zn.linedashed_frag},depth:{uniforms:Wr([Rt.common,Rt.displacementmap]),vertexShader:zn.depth_vert,fragmentShader:zn.depth_frag},normal:{uniforms:Wr([Rt.common,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,{opacity:{value:1}}]),vertexShader:zn.meshnormal_vert,fragmentShader:zn.meshnormal_frag},sprite:{uniforms:Wr([Rt.sprite,Rt.fog]),vertexShader:zn.sprite_vert,fragmentShader:zn.sprite_frag},background:{uniforms:{uvTransform:{value:new Gn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:zn.background_vert,fragmentShader:zn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:zn.backgroundCube_vert,fragmentShader:zn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:zn.cube_vert,fragmentShader:zn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:zn.equirect_vert,fragmentShader:zn.equirect_frag},distanceRGBA:{uniforms:Wr([Rt.common,Rt.displacementmap,{referencePosition:{value:new J},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:zn.distanceRGBA_vert,fragmentShader:zn.distanceRGBA_frag},shadow:{uniforms:Wr([Rt.lights,Rt.fog,{color:{value:new Ht(0)},opacity:{value:1}}]),vertexShader:zn.shadow_vert,fragmentShader:zn.shadow_frag}};So.physical={uniforms:Wr([So.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Gn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Gn},clearcoatNormalScale:{value:new et(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Gn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Gn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Gn},sheen:{value:0},sheenColor:{value:new Ht(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Gn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Gn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Gn},transmissionSamplerSize:{value:new et},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Gn},attenuationDistance:{value:0},attenuationColor:{value:new Ht(0)},specularColor:{value:new Ht(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Gn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Gn}}]),vertexShader:zn.meshphysical_vert,fragmentShader:zn.meshphysical_frag};const _l={r:0,b:0,g:0};function Eu(c,e,t,s,o,l,d){const h=new Ht(0);let m,_,p=!0===l?0:1,S=null,b=0,D=null;function O(P,I){P.getRGB(_l,Zh(c)),s.buffers.color.setClear(_l.r,_l.g,_l.b,I,d)}return{getClearColor:function(){return h},setClearColor:function(P,I=1){h.set(P),p=I,O(h,p)},getClearAlpha:function(){return p},setClearAlpha:function(P){p=P,O(h,p)},render:function R(P,I){let B=!1,U=!0===I.isScene?I.background:null;switch(U&&U.isTexture&&(U=(I.backgroundBlurriness>0?t:e).get(U)),null===U?O(h,p):U&&U.isColor&&(O(U,1),B=!0),c.xr.getEnvironmentBlendMode()){case"opaque":B=!0;break;case"additive":s.buffers.color.setClear(0,0,0,1,d),B=!0;break;case"alpha-blend":s.buffers.color.setClear(0,0,0,0,d),B=!0}(c.autoClear||B)&&c.clear(c.autoClearColor,c.autoClearDepth,c.autoClearStencil),U&&(U.isCubeTexture||U.mapping===as)?(void 0===_&&(_=new es(new mc(1,1,1),new Hs({name:"BackgroundCubeMaterial",uniforms:yl(So.backgroundCube.uniforms),vertexShader:So.backgroundCube.vertexShader,fragmentShader:So.backgroundCube.fragmentShader,side:Je,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(K,re,le){this.matrixWorld.copyPosition(le.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(_)),_.material.uniforms.envMap.value=U,_.material.uniforms.flipEnvMap.value=U.isCubeTexture&&!1===U.isRenderTargetTexture?-1:1,_.material.uniforms.backgroundBlurriness.value=I.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,_.material.toneMapped=U.colorSpace!==_n,(S!==U||b!==U.version||D!==c.toneMapping)&&(_.material.needsUpdate=!0,S=U,b=U.version,D=c.toneMapping),_.layers.enableAll(),P.unshift(_,_.geometry,_.material,0,0,null)):U&&U.isTexture&&(void 0===m&&(m=new es(new Ko(2,2),new Hs({name:"BackgroundMaterial",uniforms:yl(So.background.uniforms),vertexShader:So.background.vertexShader,fragmentShader:So.background.fragmentShader,side:Le,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(m)),m.material.uniforms.t2D.value=U,m.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,m.material.toneMapped=U.colorSpace!==_n,!0===U.matrixAutoUpdate&&U.updateMatrix(),m.material.uniforms.uvTransform.value.copy(U.matrix),(S!==U||b!==U.version||D!==c.toneMapping)&&(m.material.needsUpdate=!0,S=U,b=U.version,D=c.toneMapping),m.layers.enableAll(),P.unshift(m,m.geometry,m.material,0,0,null))}}}function xm(c,e,t,s){const o=c.getParameter(c.MAX_VERTEX_ATTRIBS),l=s.isWebGL2?null:e.get("OES_vertex_array_object"),d=s.isWebGL2||null!==l,h={},p=P(null);let m=p,_=!1;function D(we){return s.isWebGL2?c.bindVertexArray(we):l.bindVertexArrayOES(we)}function R(we){return s.isWebGL2?c.deleteVertexArray(we):l.deleteVertexArrayOES(we)}function P(we){const Ie=[],lt=[],ot=[];for(let it=0;it<o;it++)Ie[it]=0,lt[it]=0,ot[it]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ie,enabledAttributes:lt,attributeDivisors:ot,object:we,attributes:{},index:null}}function U(){const we=m.newAttributes;for(let Ie=0,lt=we.length;Ie<lt;Ie++)we[Ie]=0}function W(we){X(we,0)}function X(we,Ie){const ot=m.enabledAttributes,it=m.attributeDivisors;m.newAttributes[we]=1,0===ot[we]&&(c.enableVertexAttribArray(we),ot[we]=1),it[we]!==Ie&&((s.isWebGL2?c:e.get("ANGLE_instanced_arrays"))[s.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](we,Ie),it[we]=Ie)}function K(){const we=m.newAttributes,Ie=m.enabledAttributes;for(let lt=0,ot=Ie.length;lt<ot;lt++)Ie[lt]!==we[lt]&&(c.disableVertexAttribArray(lt),Ie[lt]=0)}function re(we,Ie,lt,ot,it,dt){!0!==s.isWebGL2||lt!==c.INT&&lt!==c.UNSIGNED_INT?c.vertexAttribPointer(we,Ie,lt,ot,it,dt):c.vertexAttribIPointer(we,Ie,lt,it,dt)}function Ge(){ve(),_=!0,m!==p&&(m=p,D(m.object))}function ve(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function S(we,Ie,lt,ot,it){let dt=!1;if(d){const vt=function O(we,Ie,lt){const ot=!0===lt.wireframe;let it=h[we.id];void 0===it&&(it={},h[we.id]=it);let dt=it[Ie.id];void 0===dt&&(dt={},it[Ie.id]=dt);let vt=dt[ot];return void 0===vt&&(vt=P(function b(){return s.isWebGL2?c.createVertexArray():l.createVertexArrayOES()}()),dt[ot]=vt),vt}(ot,lt,Ie);m!==vt&&(m=vt,D(m.object)),dt=function I(we,Ie,lt,ot){const it=m.attributes,dt=Ie.attributes;let vt=0;const jt=lt.getAttributes();for(const Bt in jt)if(jt[Bt].location>=0){const ct=it[Bt];let Pt=dt[Bt];if(void 0===Pt&&("instanceMatrix"===Bt&&we.instanceMatrix&&(Pt=we.instanceMatrix),"instanceColor"===Bt&&we.instanceColor&&(Pt=we.instanceColor)),void 0===ct||ct.attribute!==Pt||Pt&&ct.data!==Pt.data)return!0;vt++}return m.attributesNum!==vt||m.index!==ot}(we,ot,lt,it),dt&&function B(we,Ie,lt,ot){const it={},dt=Ie.attributes;let vt=0;const jt=lt.getAttributes();for(const Bt in jt)if(jt[Bt].location>=0){let ct=dt[Bt];void 0===ct&&("instanceMatrix"===Bt&&we.instanceMatrix&&(ct=we.instanceMatrix),"instanceColor"===Bt&&we.instanceColor&&(ct=we.instanceColor));const Pt={};Pt.attribute=ct,ct&&ct.data&&(Pt.data=ct.data),it[Bt]=Pt,vt++}m.attributes=it,m.attributesNum=vt,m.index=ot}(we,ot,lt,it)}else{const vt=!0===Ie.wireframe;(m.geometry!==ot.id||m.program!==lt.id||m.wireframe!==vt)&&(m.geometry=ot.id,m.program=lt.id,m.wireframe=vt,dt=!0)}null!==it&&t.update(it,c.ELEMENT_ARRAY_BUFFER),(dt||_)&&(_=!1,function le(we,Ie,lt,ot){if(!1===s.isWebGL2&&(we.isInstancedMesh||ot.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;U();const it=ot.attributes,dt=lt.getAttributes(),vt=Ie.defaultAttributeValues;for(const jt in dt){const Bt=dt[jt];if(Bt.location>=0){let Ne=it[jt];if(void 0===Ne&&("instanceMatrix"===jt&&we.instanceMatrix&&(Ne=we.instanceMatrix),"instanceColor"===jt&&we.instanceColor&&(Ne=we.instanceColor)),void 0!==Ne){const ct=Ne.normalized,Pt=Ne.itemSize,Lt=t.get(Ne);if(void 0===Lt)continue;const de=Lt.buffer,Dn=Lt.type,fn=Lt.bytesPerElement;if(Ne.isInterleavedBufferAttribute){const Dt=Ne.data,tn=Dt.stride,mt=Ne.offset;if(Dt.isInstancedInterleavedBuffer){for(let ze=0;ze<Bt.locationSize;ze++)X(Bt.location+ze,Dt.meshPerAttribute);!0!==we.isInstancedMesh&&void 0===ot._maxInstanceCount&&(ot._maxInstanceCount=Dt.meshPerAttribute*Dt.count)}else for(let ze=0;ze<Bt.locationSize;ze++)W(Bt.location+ze);c.bindBuffer(c.ARRAY_BUFFER,de);for(let ze=0;ze<Bt.locationSize;ze++)re(Bt.location+ze,Pt/Bt.locationSize,Dn,ct,tn*fn,(mt+Pt/Bt.locationSize*ze)*fn)}else{if(Ne.isInstancedBufferAttribute){for(let Dt=0;Dt<Bt.locationSize;Dt++)X(Bt.location+Dt,Ne.meshPerAttribute);!0!==we.isInstancedMesh&&void 0===ot._maxInstanceCount&&(ot._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let Dt=0;Dt<Bt.locationSize;Dt++)W(Bt.location+Dt);c.bindBuffer(c.ARRAY_BUFFER,de);for(let Dt=0;Dt<Bt.locationSize;Dt++)re(Bt.location+Dt,Pt/Bt.locationSize,Dn,ct,Pt*fn,Pt/Bt.locationSize*Dt*fn)}}else if(void 0!==vt){const ct=vt[jt];if(void 0!==ct)switch(ct.length){case 2:c.vertexAttrib2fv(Bt.location,ct);break;case 3:c.vertexAttrib3fv(Bt.location,ct);break;case 4:c.vertexAttrib4fv(Bt.location,ct);break;default:c.vertexAttrib1fv(Bt.location,ct)}}}}K()}(we,Ie,lt,ot),null!==it&&c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,t.get(it).buffer))},reset:Ge,resetDefaultState:ve,dispose:function V(){Ge();for(const we in h){const Ie=h[we];for(const lt in Ie){const ot=Ie[lt];for(const it in ot)R(ot[it].object),delete ot[it];delete Ie[lt]}delete h[we]}},releaseStatesOfGeometry:function te(we){if(void 0===h[we.id])return;const Ie=h[we.id];for(const lt in Ie){const ot=Ie[lt];for(const it in ot)R(ot[it].object),delete ot[it];delete Ie[lt]}delete h[we.id]},releaseStatesOfProgram:function Ae(we){for(const Ie in h){const lt=h[Ie];if(void 0===lt[we.id])continue;const ot=lt[we.id];for(const it in ot)R(ot[it].object),delete ot[it];delete lt[we.id]}},initAttributes:U,enableAttribute:W,disableUnusedAttributes:K}}function vf(c,e,t,s){const o=s.isWebGL2;let l;this.setMode=function d(m){l=m},this.render=function h(m,_){c.drawArrays(l,m,_),t.update(_,l,1)},this.renderInstances=function p(m,_,S){if(0===S)return;let b,D;if(o)b=c,D="drawArraysInstanced";else if(b=e.get("ANGLE_instanced_arrays"),D="drawArraysInstancedANGLE",null===b)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");b[D](l,m,_,S),t.update(_,l,S)}}function Rd(c,e,t){let s;function l(re){if("highp"===re){if(c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.HIGH_FLOAT).precision>0&&c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_FLOAT).precision>0)return"highp";re="mediump"}return"mediump"===re&&c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.MEDIUM_FLOAT).precision>0&&c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===c.constructor.name;let h=void 0!==t.precision?t.precision:"highp";const p=l(h);p!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",p,"instead."),h=p);const m=d||e.has("WEBGL_draw_buffers"),_=!0===t.logarithmicDepthBuffer,S=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),b=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS),D=c.getParameter(c.MAX_TEXTURE_SIZE),R=c.getParameter(c.MAX_CUBE_MAP_TEXTURE_SIZE),O=c.getParameter(c.MAX_VERTEX_ATTRIBS),P=c.getParameter(c.MAX_VERTEX_UNIFORM_VECTORS),I=c.getParameter(c.MAX_VARYING_VECTORS),B=c.getParameter(c.MAX_FRAGMENT_UNIFORM_VECTORS),U=b>0,W=d||e.has("OES_texture_float");return{isWebGL2:d,drawBuffers:m,getMaxAnisotropy:function o(){if(void 0!==s)return s;if(!0===e.has("EXT_texture_filter_anisotropic")){const re=e.get("EXT_texture_filter_anisotropic");s=c.getParameter(re.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s},getMaxPrecision:l,precision:h,logarithmicDepthBuffer:_,maxTextures:S,maxVertexTextures:b,maxTextureSize:D,maxCubemapSize:R,maxAttributes:O,maxVertexUniforms:P,maxVaryings:I,maxFragmentUniforms:B,vertexTextures:U,floatFragmentTextures:W,floatVertexTextures:U&&W,maxSamples:d?c.getParameter(c.MAX_SAMPLES):0}}function Em(c){const e=this;let t=null,s=0,o=!1,l=!1;const d=new yc,h=new Gn,p={value:null,needsUpdate:!1};function _(S,b,D,R){const O=null!==S?S.length:0;let P=null;if(0!==O){if(P=p.value,!0!==R||null===P){const I=D+4*O,B=b.matrixWorldInverse;h.getNormalMatrix(B),(null===P||P.length<I)&&(P=new Float32Array(I));for(let U=0,W=D;U!==O;++U,W+=4)d.copy(S[U]).applyMatrix4(B,h),d.normal.toArray(P,W),P[W+3]=d.constant}p.value=P,p.needsUpdate=!0}return e.numPlanes=O,e.numIntersection=0,P}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(S,b){const D=0!==S.length||b||0!==s||o;return o=b,s=S.length,D},this.beginShadows=function(){l=!0,_(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(S,b){t=_(S,b,0)},this.setState=function(S,b,D){const R=S.clippingPlanes,O=S.clipIntersection,P=S.clipShadows,I=c.get(S);if(!o||null===R||0===R.length||l&&!P)l?_(null):function m(){p.value!==t&&(p.value=t,p.needsUpdate=s>0),e.numPlanes=s,e.numIntersection=0}();else{const B=l?0:s,U=4*B;let W=I.clippingState||null;p.value=W,W=_(R,b,U,D);for(let X=0;X!==U;++X)W[X]=t[X];I.clippingState=W,this.numIntersection=O?this.numPlanes:0,this.numPlanes+=B}}}function yf(c){let e=new WeakMap;function t(d,h){return 303===h?d.mapping=ti:304===h&&(d.mapping=dn),d}function o(d){const h=d.target;h.removeEventListener("dispose",o);const p=e.get(h);void 0!==p&&(e.delete(h),p.dispose())}return{get:function s(d){if(d&&d.isTexture&&!1===d.isRenderTargetTexture){const h=d.mapping;if(303===h||304===h){if(e.has(d))return t(e.get(d).texture,d.mapping);{const p=d.image;if(p&&p.height>0){const m=new j_(p.height/2);return m.fromEquirectangularTexture(c,d),e.set(d,m),d.addEventListener("dispose",o),t(m.texture,d.mapping)}return null}}}return d},dispose:function l(){e=new WeakMap}}}class Ml extends xd{constructor(e=-1,t=1,s=1,o=-1,l=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=s,this.bottom=o,this.near=l,this.far=d,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,s,o,l,d){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=s,this.view.offsetY=o,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),s=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let l=s-e,d=s+e,h=o+t,p=o-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=m*this.view.offsetX,d=l+m*this.view.width,h-=_*this.view.offsetY,p=h-_*this.view.height}this.projectionMatrix.makeOrthographic(l,d,h,p,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const _f=[.125,.215,.35,.446,.526,.582],Mf=new Ml,Sm=new Ht;let Pd=null;const Xa=(1+Math.sqrt(5))/2,Sa=1/Xa,Ld=[new J(1,1,1),new J(-1,1,1),new J(1,1,-1),new J(-1,1,-1),new J(0,Xa,Sa),new J(0,Xa,-Sa),new J(Sa,0,Xa),new J(-Sa,0,Xa),new J(Xa,Sa,0),new J(-Xa,Sa,0)];class El{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,s=.1,o=100){Pd=this._renderer.getRenderTarget(),this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,s,o,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=wm(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Nd(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Pd),e.scissorTest=!1,xf(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===ti||e.mapping===dn?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Pd=this._renderer.getRenderTarget();const s=t||this._allocateTargets();return this._textureToCubeUV(e,s),this._applyPMREM(s),this._cleanup(s),s}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,s={magFilter:si,minFilter:si,generateMipmaps:!1,type:qe,format:gi,colorSpace:ki,depthBuffer:!1},o=bm(e,t,s);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=bm(e,t,s);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function My(c){const e=[],t=[],s=[];let o=c;const l=c-4+1+_f.length;for(let d=0;d<l;d++){const h=Math.pow(2,o);t.push(h);let p=1/h;d>c-4?p=_f[d-c+4-1]:0===d&&(p=0),s.push(p);const m=1/(h-2),_=-m,S=1+m,b=[_,_,S,_,S,S,_,_,S,S,_,S],D=6,R=6,O=3,P=2,I=1,B=new Float32Array(O*R*D),U=new Float32Array(P*R*D),W=new Float32Array(I*R*D);for(let K=0;K<D;K++){const re=K%3*2/3-1,le=K>2?0:-1;B.set([re,le,0,re+2/3,le,0,re+2/3,le+1,0,re,le,0,re+2/3,le+1,0,re,le+1,0],O*R*K),U.set(b,P*R*K),W.set([K,K,K,K,K,K],I*R*K)}const X=new Yn;X.setAttribute("position",new Ct(B,O)),X.setAttribute("uv",new Ct(U,P)),X.setAttribute("faceIndex",new Ct(W,I)),e.push(X),o>4&&o--}return{lodPlanes:e,sizeLods:t,sigmas:s}}(l)),this._blurMaterial=function xy(c,e,t){const s=new Float32Array(20),o=new J(0,1,0);return new Hs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${c}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:wn,depthTest:!1,depthWrite:!1})}(l,e,t)}return o}_compileMaterial(e){const t=new es(this._lodPlanes[0],e);this._renderer.compile(t,Mf)}_sceneToCubeUV(e,t,s,o){const h=new Sr(90,1,t,s),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],_=this._renderer,S=_.autoClear,b=_.toneMapping;_.getClearColor(Sm),_.toneMapping=Ji,_.autoClear=!1;const D=new E({name:"PMREM.Background",side:Je,depthWrite:!1,depthTest:!1}),R=new es(new mc,D);let O=!1;const P=e.background;P?P.isColor&&(D.color.copy(P),e.background=null,O=!0):(D.color.copy(Sm),O=!0);for(let I=0;I<6;I++){const B=I%3;0===B?(h.up.set(0,p[I],0),h.lookAt(m[I],0,0)):1===B?(h.up.set(0,0,p[I]),h.lookAt(0,m[I],0)):(h.up.set(0,p[I],0),h.lookAt(0,0,m[I]));const U=this._cubeSize;xf(o,B*U,I>2?U:0,U,U),_.setRenderTarget(o),O&&_.render(R,h),_.render(e,h)}R.geometry.dispose(),R.material.dispose(),_.toneMapping=b,_.autoClear=S,e.background=P}_textureToCubeUV(e,t){const s=this._renderer,o=e.mapping===ti||e.mapping===dn;o?(null===this._cubemapMaterial&&(this._cubemapMaterial=wm()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Nd());const l=o?this._cubemapMaterial:this._equirectMaterial,d=new es(this._lodPlanes[0],l);l.uniforms.envMap.value=e;const p=this._cubeSize;xf(t,0,0,3*p,2*p),s.setRenderTarget(t),s.render(d,Mf)}_applyPMREM(e){const t=this._renderer,s=t.autoClear;t.autoClear=!1;for(let o=1;o<this._lodPlanes.length;o++){const l=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]);this._blur(e,o-1,o,l,Ld[(o-1)%Ld.length])}t.autoClear=s}_blur(e,t,s,o,l){const d=this._pingPongRenderTarget;this._halfBlur(e,d,t,s,o,"latitudinal",l),this._halfBlur(d,e,s,s,o,"longitudinal",l)}_halfBlur(e,t,s,o,l,d,h){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==d&&"longitudinal"!==d&&console.error("blur direction must be either latitudinal or longitudinal!");const S=new es(this._lodPlanes[o],m),b=m.uniforms,D=this._sizeLods[s]-1,R=isFinite(l)?Math.PI/(2*D):2*Math.PI/39,O=l/R,P=isFinite(l)?1+Math.floor(3*O):20;P>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${P} samples when the maximum is set to 20`);const I=[];let B=0;for(let re=0;re<20;++re){const le=re/O,V=Math.exp(-le*le/2);I.push(V),0===re?B+=V:re<P&&(B+=2*V)}for(let re=0;re<I.length;re++)I[re]=I[re]/B;b.envMap.value=e.texture,b.samples.value=P,b.weights.value=I,b.latitudinal.value="latitudinal"===d,h&&(b.poleAxis.value=h);const{_lodMax:U}=this;b.dTheta.value=R,b.mipInt.value=U-s;const W=this._sizeLods[o];xf(t,3*W*(o>U-4?o-U+4:0),4*(this._cubeSize-W),3*W,2*W),p.setRenderTarget(t),p.render(S,Mf)}}function bm(c,e,t){const s=new to(c,e,t);return s.texture.mapping=as,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function xf(c,e,t,s,o){c.viewport.set(e,t,s,o),c.scissor.set(e,t,s,o)}function Nd(){return new Hs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:wn,depthTest:!1,depthWrite:!1})}function wm(){return new Hs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:wn,depthTest:!1,depthWrite:!1})}function Od(c){let e=new WeakMap,t=null;function l(h){const p=h.target;p.removeEventListener("dispose",l);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function s(h){if(h&&h.isTexture){const p=h.mapping,m=303===p||304===p,_=p===ti||p===dn;if(m||_){if(h.isRenderTargetTexture&&!0===h.needsPMREMUpdate){h.needsPMREMUpdate=!1;let S=e.get(h);return null===t&&(t=new El(c)),S=m?t.fromEquirectangular(h,S):t.fromCubemap(h,S),e.set(h,S),S.texture}if(e.has(h))return e.get(h).texture;{const S=h.image;if(m&&S&&S.height>0||_&&S&&function o(h){let p=0;for(let _=0;_<6;_++)void 0!==h[_]&&p++;return 6===p}(S)){null===t&&(t=new El(c));const b=m?t.fromEquirectangular(h):t.fromCubemap(h);return e.set(h,b),h.addEventListener("dispose",l),b.texture}return null}}}return h},dispose:function d(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Ef(c){const e={};function t(s){if(void 0!==e[s])return e[s];let o;switch(s){case"WEBGL_depth_texture":o=c.getExtension("WEBGL_depth_texture")||c.getExtension("MOZ_WEBGL_depth_texture")||c.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=c.getExtension("WEBGL_compressed_texture_s3tc")||c.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=c.getExtension("WEBGL_compressed_texture_pvrtc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=c.getExtension(s)}return e[s]=o,o}return{has:function(s){return null!==t(s)},init:function(s){s.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(s){const o=t(s);return null===o&&console.warn("THREE.WebGLRenderer: "+s+" extension not supported."),o}}}function Tm(c,e,t,s){const o={},l=new WeakMap;function d(S){const b=S.target;null!==b.index&&e.remove(b.index);for(const R in b.attributes)e.remove(b.attributes[R]);b.removeEventListener("dispose",d),delete o[b.id];const D=l.get(b);D&&(e.remove(D),l.delete(b)),s.releaseStatesOfGeometry(b),!0===b.isInstancedBufferGeometry&&delete b._maxInstanceCount,t.memory.geometries--}function m(S){const b=[],D=S.index,R=S.attributes.position;let O=0;if(null!==D){const B=D.array;O=D.version;for(let U=0,W=B.length;U<W;U+=3){const X=B[U+0],K=B[U+1],re=B[U+2];b.push(X,K,K,re,re,X)}}else{O=R.version;for(let U=0,W=R.array.length/3-1;U<W;U+=3){const X=U+0,K=U+1,re=U+2;b.push(X,K,K,re,re,X)}}const P=new(Go(b)?fc:gl)(b,1);P.version=O;const I=l.get(S);I&&e.remove(I),l.set(S,P)}return{get:function h(S,b){return!0===o[b.id]||(b.addEventListener("dispose",d),o[b.id]=!0,t.memory.geometries++),b},update:function p(S){const b=S.attributes;for(const R in b)e.update(b[R],c.ARRAY_BUFFER);const D=S.morphAttributes;for(const R in D){const O=D[R];for(let P=0,I=O.length;P<I;P++)e.update(O[P],c.ARRAY_BUFFER)}},getWireframeAttribute:function _(S){const b=l.get(S);if(b){const D=S.index;null!==D&&b.version<D.version&&m(S)}else m(S);return l.get(S)}}}function Cm(c,e,t,s){const o=s.isWebGL2;let l,h,p;this.setMode=function d(b){l=b},this.setIndex=function m(b){h=b.type,p=b.bytesPerElement},this.render=function _(b,D){c.drawElements(l,D,h,b*p),t.update(D,l,1)},this.renderInstances=function S(b,D,R){if(0===R)return;let O,P;if(o)O=c,P="drawElementsInstanced";else if(O=e.get("ANGLE_instanced_arrays"),P="drawElementsInstancedANGLE",null===O)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");O[P](l,D,h,b*p,R),t.update(D,l,R)}}function Dm(c){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function o(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function s(l,d,h){switch(t.calls++,d){case c.TRIANGLES:t.triangles+=h*(l/3);break;case c.LINES:t.lines+=h*(l/2);break;case c.LINE_STRIP:t.lines+=h*(l-1);break;case c.LINE_LOOP:t.lines+=h*l;break;case c.POINTS:t.points+=h*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function bl(c,e){return c[0]-e[0]}function Ey(c,e){return Math.abs(e[1])-Math.abs(c[1])}function Sy(c,e,t){const s={},o=new Float32Array(8),l=new WeakMap,d=new vi,h=[];for(let m=0;m<8;m++)h[m]=[m,0];return{update:function p(m,_,S){const b=m.morphTargetInfluences;if(!0===e.isWebGL2){const D=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,R=void 0!==D?D.length:0;let O=l.get(_);if(void 0===O||O.count!==R){let we=function(){Ge.dispose(),l.delete(_),_.removeEventListener("dispose",we)};void 0!==O&&O.texture.dispose();const B=void 0!==_.morphAttributes.position,U=void 0!==_.morphAttributes.normal,W=void 0!==_.morphAttributes.color,X=_.morphAttributes.position||[],K=_.morphAttributes.normal||[],re=_.morphAttributes.color||[];let le=0;!0===B&&(le=1),!0===U&&(le=2),!0===W&&(le=3);let V=_.attributes.position.count*le,te=1;V>e.maxTextureSize&&(te=Math.ceil(V/e.maxTextureSize),V=e.maxTextureSize);const Ae=new Float32Array(V*te*4*R),Ge=new sc(Ae,V,te,R);Ge.type=Qe,Ge.needsUpdate=!0;const ve=4*le;for(let Ie=0;Ie<R;Ie++){const lt=X[Ie],ot=K[Ie],it=re[Ie],dt=V*te*4*Ie;for(let vt=0;vt<lt.count;vt++){const jt=vt*ve;!0===B&&(d.fromBufferAttribute(lt,vt),Ae[dt+jt+0]=d.x,Ae[dt+jt+1]=d.y,Ae[dt+jt+2]=d.z,Ae[dt+jt+3]=0),!0===U&&(d.fromBufferAttribute(ot,vt),Ae[dt+jt+4]=d.x,Ae[dt+jt+5]=d.y,Ae[dt+jt+6]=d.z,Ae[dt+jt+7]=0),!0===W&&(d.fromBufferAttribute(it,vt),Ae[dt+jt+8]=d.x,Ae[dt+jt+9]=d.y,Ae[dt+jt+10]=d.z,Ae[dt+jt+11]=4===it.itemSize?d.w:1)}}O={count:R,texture:Ge,size:new et(V,te)},l.set(_,O),_.addEventListener("dispose",we)}let P=0;for(let B=0;B<b.length;B++)P+=b[B];const I=_.morphTargetsRelative?1:1-P;S.getUniforms().setValue(c,"morphTargetBaseInfluence",I),S.getUniforms().setValue(c,"morphTargetInfluences",b),S.getUniforms().setValue(c,"morphTargetsTexture",O.texture,t),S.getUniforms().setValue(c,"morphTargetsTextureSize",O.size)}else{const D=void 0===b?0:b.length;let R=s[_.id];if(void 0===R||R.length!==D){R=[];for(let U=0;U<D;U++)R[U]=[U,0];s[_.id]=R}for(let U=0;U<D;U++){const W=R[U];W[0]=U,W[1]=b[U]}R.sort(Ey);for(let U=0;U<8;U++)U<D&&R[U][1]?(h[U][0]=R[U][0],h[U][1]=R[U][1]):(h[U][0]=Number.MAX_SAFE_INTEGER,h[U][1]=0);h.sort(bl);const O=_.morphAttributes.position,P=_.morphAttributes.normal;let I=0;for(let U=0;U<8;U++){const W=h[U],X=W[0],K=W[1];X!==Number.MAX_SAFE_INTEGER&&K?(O&&_.getAttribute("morphTarget"+U)!==O[X]&&_.setAttribute("morphTarget"+U,O[X]),P&&_.getAttribute("morphNormal"+U)!==P[X]&&_.setAttribute("morphNormal"+U,P[X]),o[U]=K,I+=K):(O&&!0===_.hasAttribute("morphTarget"+U)&&_.deleteAttribute("morphTarget"+U),P&&!0===_.hasAttribute("morphNormal"+U)&&_.deleteAttribute("morphNormal"+U),o[U]=0)}const B=_.morphTargetsRelative?1:1-I;S.getUniforms().setValue(c,"morphTargetBaseInfluence",B),S.getUniforms().setValue(c,"morphTargetInfluences",o)}}}}function by(c,e,t,s){let o=new WeakMap;function h(p){const m=p.target;m.removeEventListener("dispose",h),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function l(p){const m=s.render.frame,S=e.get(p,p.geometry);return o.get(S)!==m&&(e.update(S),o.set(S,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",h)&&p.addEventListener("dispose",h),t.update(p.instanceMatrix,c.ARRAY_BUFFER),null!==p.instanceColor&&t.update(p.instanceColor,c.ARRAY_BUFFER)),S},dispose:function d(){o=new WeakMap}}}const Am=new eo,Im=new sc,Qo=new eu,wl=new Jh,Rm=[],Pm=[],Lm=new Float32Array(16),Nm=new Float32Array(9),Om=new Float32Array(4);function bc(c,e,t){const s=c[0];if(s<=0||s>0)return c;const o=e*t;let l=Rm[o];if(void 0===l&&(l=new Float32Array(o),Rm[o]=l),0!==e){s.toArray(l,0);for(let d=1,h=0;d!==e;++d)h+=t,c[d].toArray(l,h)}return l}function dr(c,e){if(c.length!==e.length)return!1;for(let t=0,s=c.length;t<s;t++)if(c[t]!==e[t])return!1;return!0}function br(c,e){for(let t=0,s=e.length;t<s;t++)c[t]=e[t]}function Fd(c,e){let t=Pm[e];void 0===t&&(t=new Int32Array(e),Pm[e]=t);for(let s=0;s!==e;++s)t[s]=c.allocateTextureUnit();return t}function wy(c,e){const t=this.cache;t[0]!==e&&(c.uniform1f(this.addr,e),t[0]=e)}function Ty(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(dr(t,e))return;c.uniform2fv(this.addr,e),br(t,e)}}function Ud(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(c.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(dr(t,e))return;c.uniform3fv(this.addr,e),br(t,e)}}function ba(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(dr(t,e))return;c.uniform4fv(this.addr,e),br(t,e)}}function Su(c,e){const t=this.cache,s=e.elements;if(void 0===s){if(dr(t,e))return;c.uniformMatrix2fv(this.addr,!1,e),br(t,e)}else{if(dr(t,s))return;Om.set(s),c.uniformMatrix2fv(this.addr,!1,Om),br(t,s)}}function Fm(c,e){const t=this.cache,s=e.elements;if(void 0===s){if(dr(t,e))return;c.uniformMatrix3fv(this.addr,!1,e),br(t,e)}else{if(dr(t,s))return;Nm.set(s),c.uniformMatrix3fv(this.addr,!1,Nm),br(t,s)}}function Um(c,e){const t=this.cache,s=e.elements;if(void 0===s){if(dr(t,e))return;c.uniformMatrix4fv(this.addr,!1,e),br(t,e)}else{if(dr(t,s))return;Lm.set(s),c.uniformMatrix4fv(this.addr,!1,Lm),br(t,s)}}function km(c,e){const t=this.cache;t[0]!==e&&(c.uniform1i(this.addr,e),t[0]=e)}function xM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(dr(t,e))return;c.uniform2iv(this.addr,e),br(t,e)}}function EM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(dr(t,e))return;c.uniform3iv(this.addr,e),br(t,e)}}function SM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(dr(t,e))return;c.uniform4iv(this.addr,e),br(t,e)}}function Sf(c,e){const t=this.cache;t[0]!==e&&(c.uniform1ui(this.addr,e),t[0]=e)}function bf(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(dr(t,e))return;c.uniform2uiv(this.addr,e),br(t,e)}}function bM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(dr(t,e))return;c.uniform3uiv(this.addr,e),br(t,e)}}function wM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(dr(t,e))return;c.uniform4uiv(this.addr,e),br(t,e)}}function Bm(c,e,t){const s=this.cache,o=t.allocateTextureUnit();s[0]!==o&&(c.uniform1i(this.addr,o),s[0]=o),t.setTexture2D(e||Am,o)}function Cy(c,e,t){const s=this.cache,o=t.allocateTextureUnit();s[0]!==o&&(c.uniform1i(this.addr,o),s[0]=o),t.setTexture3D(e||Qo,o)}function Dy(c,e,t){const s=this.cache,o=t.allocateTextureUnit();s[0]!==o&&(c.uniform1i(this.addr,o),s[0]=o),t.setTextureCube(e||wl,o)}function Ay(c,e,t){const s=this.cache,o=t.allocateTextureUnit();s[0]!==o&&(c.uniform1i(this.addr,o),s[0]=o),t.setTexture2DArray(e||Im,o)}function Hm(c,e){c.uniform1fv(this.addr,e)}function kd(c,e){const t=bc(e,this.size,2);c.uniform2fv(this.addr,t)}function zm(c,e){const t=bc(e,this.size,3);c.uniform3fv(this.addr,t)}function wf(c,e){const t=bc(e,this.size,4);c.uniform4fv(this.addr,t)}function Ry(c,e){const t=bc(e,this.size,4);c.uniformMatrix2fv(this.addr,!1,t)}function ir(c,e){const t=bc(e,this.size,9);c.uniformMatrix3fv(this.addr,!1,t)}function Py(c,e){const t=bc(e,this.size,16);c.uniformMatrix4fv(this.addr,!1,t)}function Ly(c,e){c.uniform1iv(this.addr,e)}function Tf(c,e){c.uniform2iv(this.addr,e)}function Vm(c,e){c.uniform3iv(this.addr,e)}function Ny(c,e){c.uniform4iv(this.addr,e)}function Oy(c,e){c.uniform1uiv(this.addr,e)}function Fy(c,e){c.uniform2uiv(this.addr,e)}function Uy(c,e){c.uniform3uiv(this.addr,e)}function Gm(c,e){c.uniform4uiv(this.addr,e)}function TM(c,e,t){const s=this.cache,o=e.length,l=Fd(t,o);dr(s,l)||(c.uniform1iv(this.addr,l),br(s,l));for(let d=0;d!==o;++d)t.setTexture2D(e[d]||Am,l[d])}function CM(c,e,t){const s=this.cache,o=e.length,l=Fd(t,o);dr(s,l)||(c.uniform1iv(this.addr,l),br(s,l));for(let d=0;d!==o;++d)t.setTexture3D(e[d]||Qo,l[d])}function bu(c,e,t){const s=this.cache,o=e.length,l=Fd(t,o);dr(s,l)||(c.uniform1iv(this.addr,l),br(s,l));for(let d=0;d!==o;++d)t.setTextureCube(e[d]||wl,l[d])}function Mi(c,e,t){const s=this.cache,o=e.length,l=Fd(t,o);dr(s,l)||(c.uniform1iv(this.addr,l),br(s,l));for(let d=0;d!==o;++d)t.setTexture2DArray(e[d]||Im,l[d])}class Wm{constructor(e,t,s){this.id=e,this.addr=s,this.cache=[],this.setValue=function Iy(c){switch(c){case 5126:return wy;case 35664:return Ty;case 35665:return Ud;case 35666:return ba;case 35674:return Su;case 35675:return Fm;case 35676:return Um;case 5124:case 35670:return km;case 35667:case 35671:return xM;case 35668:case 35672:return EM;case 35669:case 35673:return SM;case 5125:return Sf;case 36294:return bf;case 36295:return bM;case 36296:return wM;case 35678:case 36198:case 36298:case 36306:case 35682:return Bm;case 35679:case 36299:case 36307:return Cy;case 35680:case 36300:case 36308:case 36293:return Dy;case 36289:case 36303:case 36311:case 36292:return Ay}}(t.type)}}class $m{constructor(e,t,s){this.id=e,this.addr=s,this.cache=[],this.size=t.size,this.setValue=function wu(c){switch(c){case 5126:return Hm;case 35664:return kd;case 35665:return zm;case 35666:return wf;case 35674:return Ry;case 35675:return ir;case 35676:return Py;case 5124:case 35670:return Ly;case 35667:case 35671:return Tf;case 35668:case 35672:return Vm;case 35669:case 35673:return Ny;case 5125:return Oy;case 36294:return Fy;case 36295:return Uy;case 36296:return Gm;case 35678:case 36198:case 36298:case 36306:case 35682:return TM;case 35679:case 36299:case 36307:return CM;case 35680:case 36300:case 36308:case 36293:return bu;case 36289:case 36303:case 36311:case 36292:return Mi}}(t.type)}}class jm{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,s){const o=this.seq;for(let l=0,d=o.length;l!==d;++l){const h=o[l];h.setValue(e,t[h.id],s)}}}const Tu=/(\w+)(\])?(\[|\.)?/g;function Cf(c,e){c.seq.push(e),c.map[e.id]=e}function Xm(c,e,t){const s=c.name,o=s.length;for(Tu.lastIndex=0;;){const l=Tu.exec(s);let h=l[1];const m=l[3];if("]"===l[2]&&(h|=0),void 0===m||"["===m&&Tu.lastIndex+2===o){Cf(t,void 0===m?new Wm(h,c,e):new $m(h,c,e));break}{let S=t.map[h];void 0===S&&(S=new jm(h),Cf(t,S)),t=S}}}class Cu{constructor(e,t){this.seq=[],this.map={};const s=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<s;++o){const l=e.getActiveUniform(t,o);Xm(l,e.getUniformLocation(t,l.name),this)}}setValue(e,t,s,o){const l=this.map[t];void 0!==l&&l.setValue(e,s,o)}setOptional(e,t,s){const o=t[s];void 0!==o&&this.setValue(e,s,o)}static upload(e,t,s,o){for(let l=0,d=t.length;l!==d;++l){const h=t[l],p=s[h.id];!1!==p.needsUpdate&&h.setValue(e,p.value,o)}}static seqWithValue(e,t){const s=[];for(let o=0,l=e.length;o!==l;++o){const d=e[o];d.id in t&&s.push(d)}return s}}function Bd(c,e,t){const s=c.createShader(e);return c.shaderSource(s,t),c.compileShader(s),s}let DM=0;function Hd(c,e,t){const s=c.getShaderParameter(e,c.COMPILE_STATUS),o=c.getShaderInfoLog(e).trim();if(s&&""===o)return"";const l=/ERROR: 0:(\d+)/.exec(o);if(l){const d=parseInt(l[1]);return t.toUpperCase()+"\n\n"+o+"\n\n"+function Df(c,e){const t=c.split("\n"),s=[],o=Math.max(e-6,0),l=Math.min(e+6,t.length);for(let d=o;d<l;d++){const h=d+1;s.push(`${h===e?">":" "} ${h}: ${t[d]}`)}return s.join("\n")}(c.getShaderSource(e),d)}return o}function Ym(c,e){const t=function ky(c){switch(c){case ki:return["Linear","( value )"];case _n:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",c),["Linear","( value )"]}}(e);return"vec4 "+c+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function qm(c,e){let t;switch(e){case Bi:t="Linear";break;case Tr:t="Reinhard";break;case js:t="OptimizedCineon";break;case $n:t="ACESFilmic";break;case La:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+c+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Ya(c){return""!==c}function Zm(c,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return c.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function zd(c,e){return c.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Vd=/^[ \t]*#include +<([\w\d./]+)>/gm;function wa(c){return c.replace(Vd,If)}function If(c,e){const t=zn[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return wa(t)}const Rf=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Km(c){return c.replace(Rf,Hy)}function Hy(c,e,t,s){let o="";for(let l=parseInt(e);l<parseInt(t);l++)o+=s.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return o}function Pf(c){let e="precision "+c.precision+" float;\nprecision "+c.precision+" int;";return"highp"===c.precision?e+="\n#define HIGH_PRECISION":"mediump"===c.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===c.precision&&(e+="\n#define LOW_PRECISION"),e}function Jm(c,e,t,s){const o=c.getContext(),l=t.defines;let d=t.vertexShader,h=t.fragmentShader;const p=function wc(c){let e="SHADOWMAP_TYPE_BASIC";return c.shadowMapType===Me?e="SHADOWMAP_TYPE_PCF":c.shadowMapType===Ft?e="SHADOWMAP_TYPE_PCF_SOFT":c.shadowMapType===je&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function zy(c){let e="ENVMAP_TYPE_CUBE";if(c.envMap)switch(c.envMapMode){case ti:case dn:e="ENVMAP_TYPE_CUBE";break;case as:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),_=function Vy(c){let e="ENVMAP_MODE_REFLECTION";return c.envMap&&c.envMapMode===dn&&(e="ENVMAP_MODE_REFRACTION"),e}(t),S=function Gy(c){let e="ENVMAP_BLENDING_NONE";if(c.envMap)switch(c.combine){case pi:e="ENVMAP_BLENDING_MULTIPLY";break;case nt:e="ENVMAP_BLENDING_MIX";break;case un:e="ENVMAP_BLENDING_ADD"}return e}(t),b=function Lf(c){const e=c.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,s=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:s,maxMip:t}}(t),D=t.isWebGL2?"":function Tl(c){return[c.extensionDerivatives||c.envMapCubeUVHeight||c.bumpMap||c.normalMapTangentSpace||c.clearcoatNormalMap||c.flatShading||"physical"===c.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(c.extensionFragDepth||c.logarithmicDepthBuffer)&&c.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",c.extensionDrawBuffers&&c.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(c.extensionShaderTextureLOD||c.envMap||c.transmission)&&c.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ya).join("\n")}(t),R=function By(c){const e=[];for(const t in c){const s=c[t];!1!==s&&e.push("#define "+t+" "+s)}return e.join("\n")}(l),O=o.createProgram();let P,I,B=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(P=[R].filter(Ya).join("\n"),P.length>0&&(P+="\n"),I=[D,R].filter(Ya).join("\n"),I.length>0&&(I+="\n")):(P=[Pf(t),"#define SHADER_NAME "+t.shaderName,R,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+_:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ya).join("\n"),I=[D,Pf(t),"#define SHADER_NAME "+t.shaderName,R,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+_:"",t.envMap?"#define "+S:"",b?"#define CUBEUV_TEXEL_WIDTH "+b.texelWidth:"",b?"#define CUBEUV_TEXEL_HEIGHT "+b.texelHeight:"",b?"#define CUBEUV_MAX_MIP "+b.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ji?"#define TONE_MAPPING":"",t.toneMapping!==Ji?zn.tonemapping_pars_fragment:"",t.toneMapping!==Ji?qm("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",zn.encodings_pars_fragment,Ym("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Ya).join("\n")),d=wa(d),d=Zm(d,t),d=zd(d,t),h=wa(h),h=Zm(h,t),h=zd(h,t),d=Km(d),h=Km(h),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(B="#version 300 es\n",P=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+P,I=["#define varying in",t.glslVersion===ad?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===ad?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+I);const W=B+I+h,X=Bd(o,o.VERTEX_SHADER,B+P+d),K=Bd(o,o.FRAGMENT_SHADER,W);if(o.attachShader(O,X),o.attachShader(O,K),void 0!==t.index0AttributeName?o.bindAttribLocation(O,0,t.index0AttributeName):!0===t.morphTargets&&o.bindAttribLocation(O,0,"position"),o.linkProgram(O),c.debug.checkShaderErrors){const V=o.getProgramInfoLog(O).trim(),te=o.getShaderInfoLog(X).trim(),Ae=o.getShaderInfoLog(K).trim();let Ge=!0,ve=!0;if(!1===o.getProgramParameter(O,o.LINK_STATUS))if(Ge=!1,"function"==typeof c.debug.onShaderError)c.debug.onShaderError(o,O,X,K);else{const we=Hd(o,X,"vertex"),Ie=Hd(o,K,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(O,o.VALIDATE_STATUS)+"\n\nProgram Info Log: "+V+"\n"+we+"\n"+Ie)}else""!==V?console.warn("THREE.WebGLProgram: Program Info Log:",V):(""===te||""===Ae)&&(ve=!1);ve&&(this.diagnostics={runnable:Ge,programLog:V,vertexShader:{log:te,prefix:P},fragmentShader:{log:Ae,prefix:I}})}let re,le;return o.deleteShader(X),o.deleteShader(K),this.getUniforms=function(){return void 0===re&&(re=new Cu(o,O)),re},this.getAttributes=function(){return void 0===le&&(le=function Af(c,e){const t={},s=c.getProgramParameter(e,c.ACTIVE_ATTRIBUTES);for(let o=0;o<s;o++){const l=c.getActiveAttrib(e,o),d=l.name;let h=1;l.type===c.FLOAT_MAT2&&(h=2),l.type===c.FLOAT_MAT3&&(h=3),l.type===c.FLOAT_MAT4&&(h=4),t[d]={type:l.type,location:c.getAttribLocation(e,d),locationSize:h}}return t}(o,O)),le},this.destroy=function(){s.releaseStatesOfProgram(this),o.deleteProgram(O),this.program=void 0},this.name=t.shaderName,this.id=DM++,this.cacheKey=e,this.usedTimes=1,this.program=O,this.vertexShader=X,this.fragmentShader=K,this}let Wy=0;class Qm{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const s=e.fragmentShader,o=this._getShaderStage(e.vertexShader),l=this._getShaderStage(s),d=this._getShaderCacheForMaterial(e);return!1===d.has(o)&&(d.add(o),o.usedTimes++),!1===d.has(l)&&(d.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const s of t)s.usedTimes--,0===s.usedTimes&&this.shaderCache.delete(s.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let s=t.get(e);return void 0===s&&(s=new Set,t.set(e,s)),s}_getShaderStage(e){const t=this.shaderCache;let s=t.get(e);return void 0===s&&(s=new Nf(e),t.set(e,s)),s}}class Nf{constructor(e){this.id=Wy++,this.code=e,this.usedTimes=0}}function AM(c,e,t,s,o,l,d){const h=new ac,p=new Qm,m=[],_=o.isWebGL2,S=o.logarithmicDepthBuffer,b=o.vertexTextures;let D=o.precision;const R={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function O(V){return 1===V?"uv1":2===V?"uv2":3===V?"uv3":"uv"}return{getParameters:function P(V,te,Ae,Ge,ve){const we=Ge.fog,Ie=ve.geometry,ot=(V.isMeshStandardMaterial?t:e).get(V.envMap||(V.isMeshStandardMaterial?Ge.environment:null)),it=ot&&ot.mapping===as?ot.image.height:null,dt=R[V.type];null!==V.precision&&(D=o.getMaxPrecision(V.precision),D!==V.precision&&console.warn("THREE.WebGLProgram.getParameters:",V.precision,"not supported, using",D,"instead."));const vt=Ie.morphAttributes.position||Ie.morphAttributes.normal||Ie.morphAttributes.color,jt=void 0!==vt?vt.length:0;let Ne,ct,Pt,Lt,Bt=0;if(void 0!==Ie.morphAttributes.position&&(Bt=1),void 0!==Ie.morphAttributes.normal&&(Bt=2),void 0!==Ie.morphAttributes.color&&(Bt=3),dt){const Li=So[dt];Ne=Li.vertexShader,ct=Li.fragmentShader}else Ne=V.vertexShader,ct=V.fragmentShader,p.update(V),Pt=p.getVertexShaderID(V),Lt=p.getFragmentShaderID(V);const de=c.getRenderTarget(),Dn=!0===ve.isInstancedMesh,fn=!!V.map,tn=!!ot,mt=!!V.aoMap,ze=!!V.lightMap,ht=!!V.bumpMap,Zt=!!V.normalMap,Oe=!!V.displacementMap,En=!!V.emissiveMap,Sn=!!V.metalnessMap,vn=!!V.roughnessMap,On=V.clearcoat>0,fi=V.iridescence>0,ne=V.sheen>0,j=V.transmission>0,_e=On&&!!V.clearcoatMap,Mt=On&&!!V.clearcoatNormalMap,xt=On&&!!V.clearcoatRoughnessMap,Ut=fi&&!!V.iridescenceMap,Tn=fi&&!!V.iridescenceThicknessMap,Xt=ne&&!!V.sheenColorMap,He=ne&&!!V.sheenRoughnessMap,nn=!!V.specularMap,pn=!!V.specularColorMap,bn=!!V.specularIntensityMap,qt=j&&!!V.transmissionMap,cn=j&&!!V.thicknessMap,Ci=!!V.alphaMap,he=!!V.extensions,Fe=!!Ie.attributes.uv1,_t=!!Ie.attributes.uv2,Vt=!!Ie.attributes.uv3;return{isWebGL2:_,shaderID:dt,shaderName:V.type,vertexShader:Ne,fragmentShader:ct,defines:V.defines,customVertexShaderID:Pt,customFragmentShaderID:Lt,isRawShaderMaterial:!0===V.isRawShaderMaterial,glslVersion:V.glslVersion,precision:D,instancing:Dn,instancingColor:Dn&&null!==ve.instanceColor,supportsVertexTextures:b,outputColorSpace:null===de?c.outputColorSpace:!0===de.isXRRenderTarget?de.texture.colorSpace:ki,map:fn,matcap:!!V.matcap,envMap:tn,envMapMode:tn&&ot.mapping,envMapCubeUVHeight:it,aoMap:mt,lightMap:ze,bumpMap:ht,normalMap:Zt,displacementMap:b&&Oe,emissiveMap:En,normalMapObjectSpace:Zt&&1===V.normalMapType,normalMapTangentSpace:Zt&&V.normalMapType===vr,metalnessMap:Sn,roughnessMap:vn,clearcoat:On,clearcoatMap:_e,clearcoatNormalMap:Mt,clearcoatRoughnessMap:xt,iridescence:fi,iridescenceMap:Ut,iridescenceThicknessMap:Tn,sheen:ne,sheenColorMap:Xt,sheenRoughnessMap:He,specularMap:nn,specularColorMap:pn,specularIntensityMap:bn,transmission:j,transmissionMap:qt,thicknessMap:cn,gradientMap:!!V.gradientMap,opaque:!1===V.transparent&&1===V.blending,alphaMap:Ci,alphaTest:V.alphaTest>0,combine:V.combine,mapUv:fn&&O(V.map.channel),aoMapUv:mt&&O(V.aoMap.channel),lightMapUv:ze&&O(V.lightMap.channel),bumpMapUv:ht&&O(V.bumpMap.channel),normalMapUv:Zt&&O(V.normalMap.channel),displacementMapUv:Oe&&O(V.displacementMap.channel),emissiveMapUv:En&&O(V.emissiveMap.channel),metalnessMapUv:Sn&&O(V.metalnessMap.channel),roughnessMapUv:vn&&O(V.roughnessMap.channel),clearcoatMapUv:_e&&O(V.clearcoatMap.channel),clearcoatNormalMapUv:Mt&&O(V.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:xt&&O(V.clearcoatRoughnessMap.channel),iridescenceMapUv:Ut&&O(V.iridescenceMap.channel),iridescenceThicknessMapUv:Tn&&O(V.iridescenceThicknessMap.channel),sheenColorMapUv:Xt&&O(V.sheenColorMap.channel),sheenRoughnessMapUv:He&&O(V.sheenRoughnessMap.channel),specularMapUv:nn&&O(V.specularMap.channel),specularColorMapUv:pn&&O(V.specularColorMap.channel),specularIntensityMapUv:bn&&O(V.specularIntensityMap.channel),transmissionMapUv:qt&&O(V.transmissionMap.channel),thicknessMapUv:cn&&O(V.thicknessMap.channel),alphaMapUv:Ci&&O(V.alphaMap.channel),vertexTangents:Zt&&!!Ie.attributes.tangent,vertexColors:V.vertexColors,vertexAlphas:!0===V.vertexColors&&!!Ie.attributes.color&&4===Ie.attributes.color.itemSize,vertexUv1s:Fe,vertexUv2s:_t,vertexUv3s:Vt,pointsUvs:!0===ve.isPoints&&!!Ie.attributes.uv&&(fn||Ci),fog:!!we,useFog:!0===V.fog,fogExp2:we&&we.isFogExp2,flatShading:!0===V.flatShading,sizeAttenuation:!0===V.sizeAttenuation,logarithmicDepthBuffer:S,skinning:!0===ve.isSkinnedMesh,morphTargets:void 0!==Ie.morphAttributes.position,morphNormals:void 0!==Ie.morphAttributes.normal,morphColors:void 0!==Ie.morphAttributes.color,morphTargetsCount:jt,morphTextureStride:Bt,numDirLights:te.directional.length,numPointLights:te.point.length,numSpotLights:te.spot.length,numSpotLightMaps:te.spotLightMap.length,numRectAreaLights:te.rectArea.length,numHemiLights:te.hemi.length,numDirLightShadows:te.directionalShadowMap.length,numPointLightShadows:te.pointShadowMap.length,numSpotLightShadows:te.spotShadowMap.length,numSpotLightShadowsWithMaps:te.numSpotLightShadowsWithMaps,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:V.dithering,shadowMapEnabled:c.shadowMap.enabled&&Ae.length>0,shadowMapType:c.shadowMap.type,toneMapping:V.toneMapped?c.toneMapping:Ji,useLegacyLights:c.useLegacyLights,premultipliedAlpha:V.premultipliedAlpha,doubleSided:V.side===zt,flipSided:V.side===Je,useDepthPacking:V.depthPacking>=0,depthPacking:V.depthPacking||0,index0AttributeName:V.index0AttributeName,extensionDerivatives:he&&!0===V.extensions.derivatives,extensionFragDepth:he&&!0===V.extensions.fragDepth,extensionDrawBuffers:he&&!0===V.extensions.drawBuffers,extensionShaderTextureLOD:he&&!0===V.extensions.shaderTextureLOD,rendererExtensionFragDepth:_||s.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||s.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||s.has("EXT_shader_texture_lod"),customProgramCacheKey:V.customProgramCacheKey()}},getProgramCacheKey:function I(V){const te=[];if(V.shaderID?te.push(V.shaderID):(te.push(V.customVertexShaderID),te.push(V.customFragmentShaderID)),void 0!==V.defines)for(const Ae in V.defines)te.push(Ae),te.push(V.defines[Ae]);return!1===V.isRawShaderMaterial&&(function B(V,te){V.push(te.precision),V.push(te.outputColorSpace),V.push(te.envMapMode),V.push(te.envMapCubeUVHeight),V.push(te.mapUv),V.push(te.alphaMapUv),V.push(te.lightMapUv),V.push(te.aoMapUv),V.push(te.bumpMapUv),V.push(te.normalMapUv),V.push(te.displacementMapUv),V.push(te.emissiveMapUv),V.push(te.metalnessMapUv),V.push(te.roughnessMapUv),V.push(te.clearcoatMapUv),V.push(te.clearcoatNormalMapUv),V.push(te.clearcoatRoughnessMapUv),V.push(te.iridescenceMapUv),V.push(te.iridescenceThicknessMapUv),V.push(te.sheenColorMapUv),V.push(te.sheenRoughnessMapUv),V.push(te.specularMapUv),V.push(te.specularColorMapUv),V.push(te.specularIntensityMapUv),V.push(te.transmissionMapUv),V.push(te.thicknessMapUv),V.push(te.combine),V.push(te.fogExp2),V.push(te.sizeAttenuation),V.push(te.morphTargetsCount),V.push(te.morphAttributeCount),V.push(te.numDirLights),V.push(te.numPointLights),V.push(te.numSpotLights),V.push(te.numSpotLightMaps),V.push(te.numHemiLights),V.push(te.numRectAreaLights),V.push(te.numDirLightShadows),V.push(te.numPointLightShadows),V.push(te.numSpotLightShadows),V.push(te.numSpotLightShadowsWithMaps),V.push(te.shadowMapType),V.push(te.toneMapping),V.push(te.numClippingPlanes),V.push(te.numClipIntersection),V.push(te.depthPacking)}(te,V),function U(V,te){h.disableAll(),te.isWebGL2&&h.enable(0),te.supportsVertexTextures&&h.enable(1),te.instancing&&h.enable(2),te.instancingColor&&h.enable(3),te.matcap&&h.enable(4),te.envMap&&h.enable(5),te.normalMapObjectSpace&&h.enable(6),te.normalMapTangentSpace&&h.enable(7),te.clearcoat&&h.enable(8),te.iridescence&&h.enable(9),te.alphaTest&&h.enable(10),te.vertexColors&&h.enable(11),te.vertexAlphas&&h.enable(12),te.vertexUv1s&&h.enable(13),te.vertexUv2s&&h.enable(14),te.vertexUv3s&&h.enable(15),te.vertexTangents&&h.enable(16),V.push(h.mask),h.disableAll(),te.fog&&h.enable(0),te.useFog&&h.enable(1),te.flatShading&&h.enable(2),te.logarithmicDepthBuffer&&h.enable(3),te.skinning&&h.enable(4),te.morphTargets&&h.enable(5),te.morphNormals&&h.enable(6),te.morphColors&&h.enable(7),te.premultipliedAlpha&&h.enable(8),te.shadowMapEnabled&&h.enable(9),te.useLegacyLights&&h.enable(10),te.doubleSided&&h.enable(11),te.flipSided&&h.enable(12),te.useDepthPacking&&h.enable(13),te.dithering&&h.enable(14),te.transmission&&h.enable(15),te.sheen&&h.enable(16),te.opaque&&h.enable(17),te.pointsUvs&&h.enable(18),V.push(h.mask)}(te,V),te.push(c.outputColorSpace)),te.push(V.customProgramCacheKey),te.join()},getUniforms:function W(V){const te=R[V.type];let Ae;return Ae=te?Kh.clone(So[te].uniforms):V.uniforms,Ae},acquireProgram:function X(V,te){let Ae;for(let Ge=0,ve=m.length;Ge<ve;Ge++){const we=m[Ge];if(we.cacheKey===te){Ae=we,++Ae.usedTimes;break}}return void 0===Ae&&(Ae=new Jm(c,te,V,l),m.push(Ae)),Ae},releaseProgram:function K(V){if(0==--V.usedTimes){const te=m.indexOf(V);m[te]=m[m.length-1],m.pop(),V.destroy()}},releaseShaderCache:function re(V){p.remove(V)},programs:m,dispose:function le(){p.dispose()}}}function IM(){let c=new WeakMap;return{get:function e(l){let d=c.get(l);return void 0===d&&(d={},c.set(l,d)),d},remove:function t(l){c.delete(l)},update:function s(l,d,h){c.get(l)[d]=h},dispose:function o(){c=new WeakMap}}}function $y(c,e){return c.groupOrder!==e.groupOrder?c.groupOrder-e.groupOrder:c.renderOrder!==e.renderOrder?c.renderOrder-e.renderOrder:c.material.id!==e.material.id?c.material.id-e.material.id:c.z!==e.z?c.z-e.z:c.id-e.id}function eg(c,e){return c.groupOrder!==e.groupOrder?c.groupOrder-e.groupOrder:c.renderOrder!==e.renderOrder?c.renderOrder-e.renderOrder:c.z!==e.z?e.z-c.z:c.id-e.id}function jy(){const c=[];let e=0;const t=[],s=[],o=[];function d(S,b,D,R,O,P){let I=c[e];return void 0===I?(I={id:S.id,object:S,geometry:b,material:D,groupOrder:R,renderOrder:S.renderOrder,z:O,group:P},c[e]=I):(I.id=S.id,I.object=S,I.geometry=b,I.material=D,I.groupOrder=R,I.renderOrder=S.renderOrder,I.z=O,I.group=P),e++,I}return{opaque:t,transmissive:s,transparent:o,init:function l(){e=0,t.length=0,s.length=0,o.length=0},push:function h(S,b,D,R,O,P){const I=d(S,b,D,R,O,P);D.transmission>0?s.push(I):!0===D.transparent?o.push(I):t.push(I)},unshift:function p(S,b,D,R,O,P){const I=d(S,b,D,R,O,P);D.transmission>0?s.unshift(I):!0===D.transparent?o.unshift(I):t.unshift(I)},finish:function _(){for(let S=e,b=c.length;S<b;S++){const D=c[S];if(null===D.id)break;D.id=null,D.object=null,D.geometry=null,D.material=null,D.group=null}},sort:function m(S,b){t.length>1&&t.sort(S||$y),s.length>1&&s.sort(b||eg),o.length>1&&o.sort(b||eg)}}}function Xy(){let c=new WeakMap;return{get:function e(s,o){const l=c.get(s);let d;return void 0===l?(d=new jy,c.set(s,[d])):o>=l.length?(d=new jy,l.push(d)):d=l[o],d},dispose:function t(){c=new WeakMap}}}function RM(){const c={};return{get:function(e){if(void 0!==c[e.id])return c[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new J,color:new Ht};break;case"SpotLight":t={position:new J,direction:new J,color:new Ht,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new J,color:new Ht,distance:0,decay:0};break;case"HemisphereLight":t={direction:new J,skyColor:new Ht,groundColor:new Ht};break;case"RectAreaLight":t={color:new Ht,position:new J,halfWidth:new J,halfHeight:new J}}return c[e.id]=t,t}}}let Gd=0;function Yy(c,e){return(e.castShadow?2:0)-(c.castShadow?2:0)+(e.map?1:0)-(c.map?1:0)}function Of(c,e){const t=new RM,s=function PM(){const c={};return{get:function(e){if(void 0!==c[e.id])return c[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new et};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new et,shadowCameraNear:1,shadowCameraFar:1e3}}return c[e.id]=t,t}}}(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let _=0;_<9;_++)o.probe.push(new J);const l=new J,d=new Nt,h=new Nt;return{setup:function p(_,S){let b=0,D=0,R=0;for(let Ae=0;Ae<9;Ae++)o.probe[Ae].set(0,0,0);let O=0,P=0,I=0,B=0,U=0,W=0,X=0,K=0,re=0,le=0;_.sort(Yy);const V=!0===S?Math.PI:1;for(let Ae=0,Ge=_.length;Ae<Ge;Ae++){const ve=_[Ae],we=ve.color,Ie=ve.intensity,lt=ve.distance,ot=ve.shadow&&ve.shadow.map?ve.shadow.map.texture:null;if(ve.isAmbientLight)b+=we.r*Ie*V,D+=we.g*Ie*V,R+=we.b*Ie*V;else if(ve.isLightProbe)for(let it=0;it<9;it++)o.probe[it].addScaledVector(ve.sh.coefficients[it],Ie);else if(ve.isDirectionalLight){const it=t.get(ve);if(it.color.copy(ve.color).multiplyScalar(ve.intensity*V),ve.castShadow){const dt=ve.shadow,vt=s.get(ve);vt.shadowBias=dt.bias,vt.shadowNormalBias=dt.normalBias,vt.shadowRadius=dt.radius,vt.shadowMapSize=dt.mapSize,o.directionalShadow[O]=vt,o.directionalShadowMap[O]=ot,o.directionalShadowMatrix[O]=ve.shadow.matrix,W++}o.directional[O]=it,O++}else if(ve.isSpotLight){const it=t.get(ve);it.position.setFromMatrixPosition(ve.matrixWorld),it.color.copy(we).multiplyScalar(Ie*V),it.distance=lt,it.coneCos=Math.cos(ve.angle),it.penumbraCos=Math.cos(ve.angle*(1-ve.penumbra)),it.decay=ve.decay,o.spot[I]=it;const dt=ve.shadow;if(ve.map&&(o.spotLightMap[re]=ve.map,re++,dt.updateMatrices(ve),ve.castShadow&&le++),o.spotLightMatrix[I]=dt.matrix,ve.castShadow){const vt=s.get(ve);vt.shadowBias=dt.bias,vt.shadowNormalBias=dt.normalBias,vt.shadowRadius=dt.radius,vt.shadowMapSize=dt.mapSize,o.spotShadow[I]=vt,o.spotShadowMap[I]=ot,K++}I++}else if(ve.isRectAreaLight){const it=t.get(ve);it.color.copy(we).multiplyScalar(Ie),it.halfWidth.set(.5*ve.width,0,0),it.halfHeight.set(0,.5*ve.height,0),o.rectArea[B]=it,B++}else if(ve.isPointLight){const it=t.get(ve);if(it.color.copy(ve.color).multiplyScalar(ve.intensity*V),it.distance=ve.distance,it.decay=ve.decay,ve.castShadow){const dt=ve.shadow,vt=s.get(ve);vt.shadowBias=dt.bias,vt.shadowNormalBias=dt.normalBias,vt.shadowRadius=dt.radius,vt.shadowMapSize=dt.mapSize,vt.shadowCameraNear=dt.camera.near,vt.shadowCameraFar=dt.camera.far,o.pointShadow[P]=vt,o.pointShadowMap[P]=ot,o.pointShadowMatrix[P]=ve.shadow.matrix,X++}o.point[P]=it,P++}else if(ve.isHemisphereLight){const it=t.get(ve);it.skyColor.copy(ve.color).multiplyScalar(Ie*V),it.groundColor.copy(ve.groundColor).multiplyScalar(Ie*V),o.hemi[U]=it,U++}}B>0&&(e.isWebGL2||!0===c.has("OES_texture_float_linear")?(o.rectAreaLTC1=Rt.LTC_FLOAT_1,o.rectAreaLTC2=Rt.LTC_FLOAT_2):!0===c.has("OES_texture_half_float_linear")?(o.rectAreaLTC1=Rt.LTC_HALF_1,o.rectAreaLTC2=Rt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=b,o.ambient[1]=D,o.ambient[2]=R;const te=o.hash;(te.directionalLength!==O||te.pointLength!==P||te.spotLength!==I||te.rectAreaLength!==B||te.hemiLength!==U||te.numDirectionalShadows!==W||te.numPointShadows!==X||te.numSpotShadows!==K||te.numSpotMaps!==re)&&(o.directional.length=O,o.spot.length=I,o.rectArea.length=B,o.point.length=P,o.hemi.length=U,o.directionalShadow.length=W,o.directionalShadowMap.length=W,o.pointShadow.length=X,o.pointShadowMap.length=X,o.spotShadow.length=K,o.spotShadowMap.length=K,o.directionalShadowMatrix.length=W,o.pointShadowMatrix.length=X,o.spotLightMatrix.length=K+re-le,o.spotLightMap.length=re,o.numSpotLightShadowsWithMaps=le,te.directionalLength=O,te.pointLength=P,te.spotLength=I,te.rectAreaLength=B,te.hemiLength=U,te.numDirectionalShadows=W,te.numPointShadows=X,te.numSpotShadows=K,te.numSpotMaps=re,o.version=Gd++)},setupView:function m(_,S){let b=0,D=0,R=0,O=0,P=0;const I=S.matrixWorldInverse;for(let B=0,U=_.length;B<U;B++){const W=_[B];if(W.isDirectionalLight){const X=o.directional[b];X.direction.setFromMatrixPosition(W.matrixWorld),l.setFromMatrixPosition(W.target.matrixWorld),X.direction.sub(l),X.direction.transformDirection(I),b++}else if(W.isSpotLight){const X=o.spot[R];X.position.setFromMatrixPosition(W.matrixWorld),X.position.applyMatrix4(I),X.direction.setFromMatrixPosition(W.matrixWorld),l.setFromMatrixPosition(W.target.matrixWorld),X.direction.sub(l),X.direction.transformDirection(I),R++}else if(W.isRectAreaLight){const X=o.rectArea[O];X.position.setFromMatrixPosition(W.matrixWorld),X.position.applyMatrix4(I),h.identity(),d.copy(W.matrixWorld),d.premultiply(I),h.extractRotation(d),X.halfWidth.set(.5*W.width,0,0),X.halfHeight.set(0,.5*W.height,0),X.halfWidth.applyMatrix4(h),X.halfHeight.applyMatrix4(h),O++}else if(W.isPointLight){const X=o.point[D];X.position.setFromMatrixPosition(W.matrixWorld),X.position.applyMatrix4(I),D++}else if(W.isHemisphereLight){const X=o.hemi[P];X.direction.setFromMatrixPosition(W.matrixWorld),X.direction.transformDirection(I),P++}}},state:o}}function Wd(c,e){const t=new Of(c,e),s=[],o=[];return{init:function l(){s.length=0,o.length=0},state:{lightsArray:s,shadowsArray:o,lights:t},setupLights:function p(S){t.setup(s,S)},setupLightsView:function m(S){t.setupView(s,S)},pushLight:function d(S){s.push(S)},pushShadow:function h(S){o.push(S)}}}function Du(c,e){let t=new WeakMap;return{get:function s(l,d=0){const h=t.get(l);let p;return void 0===h?(p=new Wd(c,e),t.set(l,[p])):d>=h.length?(p=new Wd(c,e),h.push(p)):p=h[d],p},dispose:function o(){t=new WeakMap}}}class $d extends ml{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class jd extends ml{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Iu(c,e,t){let s=new Yp;const o=new et,l=new et,d=new vi,h=new $d({depthPacking:3201}),p=new jd,m={},_=t.maxTextureSize,S={[Le]:Je,[Je]:Le,[zt]:zt},b=new Hs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new et},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),D=b.clone();D.defines.HORIZONTAL_PASS=1;const R=new Yn;R.setAttribute("position",new Ct(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const O=new es(R,b),P=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Me;let I=this.type;function B(X,K){const re=e.update(O);b.defines.VSM_SAMPLES!==X.blurSamples&&(b.defines.VSM_SAMPLES=X.blurSamples,D.defines.VSM_SAMPLES=X.blurSamples,b.needsUpdate=!0,D.needsUpdate=!0),null===X.mapPass&&(X.mapPass=new to(o.x,o.y)),b.uniforms.shadow_pass.value=X.map.texture,b.uniforms.resolution.value=X.mapSize,b.uniforms.radius.value=X.radius,c.setRenderTarget(X.mapPass),c.clear(),c.renderBufferDirect(K,null,re,b,O,null),D.uniforms.shadow_pass.value=X.mapPass.texture,D.uniforms.resolution.value=X.mapSize,D.uniforms.radius.value=X.radius,c.setRenderTarget(X.map),c.clear(),c.renderBufferDirect(K,null,re,D,O,null)}function U(X,K,re,le){let V=null;const te=!0===re.isPointLight?X.customDistanceMaterial:X.customDepthMaterial;if(void 0!==te)V=te;else if(V=!0===re.isPointLight?p:h,c.localClippingEnabled&&!0===K.clipShadows&&Array.isArray(K.clippingPlanes)&&0!==K.clippingPlanes.length||K.displacementMap&&0!==K.displacementScale||K.alphaMap&&K.alphaTest>0||K.map&&K.alphaTest>0){const Ae=V.uuid,Ge=K.uuid;let ve=m[Ae];void 0===ve&&(ve={},m[Ae]=ve);let we=ve[Ge];void 0===we&&(we=V.clone(),ve[Ge]=we),V=we}return V.visible=K.visible,V.wireframe=K.wireframe,V.side=le===je?null!==K.shadowSide?K.shadowSide:K.side:null!==K.shadowSide?K.shadowSide:S[K.side],V.alphaMap=K.alphaMap,V.alphaTest=K.alphaTest,V.map=K.map,V.clipShadows=K.clipShadows,V.clippingPlanes=K.clippingPlanes,V.clipIntersection=K.clipIntersection,V.displacementMap=K.displacementMap,V.displacementScale=K.displacementScale,V.displacementBias=K.displacementBias,V.wireframeLinewidth=K.wireframeLinewidth,V.linewidth=K.linewidth,!0===re.isPointLight&&!0===V.isMeshDistanceMaterial&&(c.properties.get(V).light=re),V}function W(X,K,re,le,V){if(!1===X.visible)return;if(X.layers.test(K.layers)&&(X.isMesh||X.isLine||X.isPoints)&&(X.castShadow||X.receiveShadow&&V===je)&&(!X.frustumCulled||s.intersectsObject(X))){X.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,X.matrixWorld);const Ge=e.update(X),ve=X.material;if(Array.isArray(ve)){const we=Ge.groups;for(let Ie=0,lt=we.length;Ie<lt;Ie++){const ot=we[Ie],it=ve[ot.materialIndex];if(it&&it.visible){const dt=U(X,it,le,V);c.renderBufferDirect(re,null,Ge,dt,X,ot)}}}else if(ve.visible){const we=U(X,ve,le,V);c.renderBufferDirect(re,null,Ge,we,X,null)}}const Ae=X.children;for(let Ge=0,ve=Ae.length;Ge<ve;Ge++)W(Ae[Ge],K,re,le,V)}this.render=function(X,K,re){if(!1===P.enabled||!1===P.autoUpdate&&!1===P.needsUpdate||0===X.length)return;const le=c.getRenderTarget(),V=c.getActiveCubeFace(),te=c.getActiveMipmapLevel(),Ae=c.state;Ae.setBlending(wn),Ae.buffers.color.setClear(1,1,1,1),Ae.buffers.depth.setTest(!0),Ae.setScissorTest(!1);const Ge=I!==je&&this.type===je,ve=I===je&&this.type!==je;for(let we=0,Ie=X.length;we<Ie;we++){const lt=X[we],ot=lt.shadow;if(void 0===ot){console.warn("THREE.WebGLShadowMap:",lt,"has no shadow.");continue}if(!1===ot.autoUpdate&&!1===ot.needsUpdate)continue;o.copy(ot.mapSize);const it=ot.getFrameExtents();if(o.multiply(it),l.copy(ot.mapSize),(o.x>_||o.y>_)&&(o.x>_&&(l.x=Math.floor(_/it.x),o.x=l.x*it.x,ot.mapSize.x=l.x),o.y>_&&(l.y=Math.floor(_/it.y),o.y=l.y*it.y,ot.mapSize.y=l.y)),null===ot.map||!0===Ge||!0===ve){const vt=this.type!==je?{minFilter:ri,magFilter:ri}:{};null!==ot.map&&ot.map.dispose(),ot.map=new to(o.x,o.y,vt),ot.map.texture.name=lt.name+".shadowMap",ot.camera.updateProjectionMatrix()}c.setRenderTarget(ot.map),c.clear();const dt=ot.getViewportCount();for(let vt=0;vt<dt;vt++){const jt=ot.getViewport(vt);d.set(l.x*jt.x,l.y*jt.y,l.x*jt.z,l.y*jt.w),Ae.viewport(d),ot.updateMatrices(lt,vt),s=ot.getFrustum(),W(K,re,ot.camera,lt,this.type)}!0!==ot.isPointLightShadow&&this.type===je&&B(ot,re),ot.needsUpdate=!1}I=this.type,P.needsUpdate=!1,c.setRenderTarget(le,V,te)}}function tg(c,e,t){const s=t.isWebGL2,h=new function o(){let he=!1;const Fe=new vi;let _t=null;const Vt=new vi(0,0,0,0);return{setMask:function(sn){_t!==sn&&!he&&(c.colorMask(sn,sn,sn,sn),_t=sn)},setLocked:function(sn){he=sn},setClear:function(sn,Li,xi,hr,il){!0===il&&(sn*=hr,Li*=hr,xi*=hr),Fe.set(sn,Li,xi,hr),!1===Vt.equals(Fe)&&(c.clearColor(sn,Li,xi,hr),Vt.copy(Fe))},reset:function(){he=!1,_t=null,Vt.set(-1,0,0,0)}}},p=new function l(){let he=!1,Fe=null,_t=null,Vt=null;return{setTest:function(sn){sn?de(c.DEPTH_TEST):Dn(c.DEPTH_TEST)},setMask:function(sn){Fe!==sn&&!he&&(c.depthMask(sn),Fe=sn)},setFunc:function(sn){if(_t!==sn){switch(sn){case 0:c.depthFunc(c.NEVER);break;case 1:c.depthFunc(c.ALWAYS);break;case 2:c.depthFunc(c.LESS);break;case 3:default:c.depthFunc(c.LEQUAL);break;case 4:c.depthFunc(c.EQUAL);break;case 5:c.depthFunc(c.GEQUAL);break;case 6:c.depthFunc(c.GREATER);break;case 7:c.depthFunc(c.NOTEQUAL)}_t=sn}},setLocked:function(sn){he=sn},setClear:function(sn){Vt!==sn&&(c.clearDepth(sn),Vt=sn)},reset:function(){he=!1,Fe=null,_t=null,Vt=null}}},m=new function d(){let he=!1,Fe=null,_t=null,Vt=null,sn=null,Li=null,xi=null,hr=null,il=null;return{setTest:function(sr){he||(sr?de(c.STENCIL_TEST):Dn(c.STENCIL_TEST))},setMask:function(sr){Fe!==sr&&!he&&(c.stencilMask(sr),Fe=sr)},setFunc:function(sr,fo,Ao){(_t!==sr||Vt!==fo||sn!==Ao)&&(c.stencilFunc(sr,fo,Ao),_t=sr,Vt=fo,sn=Ao)},setOp:function(sr,fo,Ao){(Li!==sr||xi!==fo||hr!==Ao)&&(c.stencilOp(sr,fo,Ao),Li=sr,xi=fo,hr=Ao)},setLocked:function(sr){he=sr},setClear:function(sr){il!==sr&&(c.clearStencil(sr),il=sr)},reset:function(){he=!1,Fe=null,_t=null,Vt=null,sn=null,Li=null,xi=null,hr=null,il=null}}},_=new WeakMap,S=new WeakMap;let b={},D={},R=new WeakMap,O=[],P=null,I=!1,B=null,U=null,W=null,X=null,K=null,re=null,le=null,V=!1,te=null,Ae=null,Ge=null,ve=null,we=null;const Ie=c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let lt=!1,ot=0;const it=c.getParameter(c.VERSION);-1!==it.indexOf("WebGL")?(ot=parseFloat(/^WebGL (\d)/.exec(it)[1]),lt=ot>=1):-1!==it.indexOf("OpenGL ES")&&(ot=parseFloat(/^OpenGL ES (\d)/.exec(it)[1]),lt=ot>=2);let dt=null,vt={};const jt=c.getParameter(c.SCISSOR_BOX),Bt=c.getParameter(c.VIEWPORT),Ne=(new vi).fromArray(jt),ct=(new vi).fromArray(Bt);function Pt(he,Fe,_t,Vt){const sn=new Uint8Array(4),Li=c.createTexture();c.bindTexture(he,Li),c.texParameteri(he,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(he,c.TEXTURE_MAG_FILTER,c.NEAREST);for(let xi=0;xi<_t;xi++)!s||he!==c.TEXTURE_3D&&he!==c.TEXTURE_2D_ARRAY?c.texImage2D(Fe+xi,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,sn):c.texImage3D(Fe,0,c.RGBA,1,1,Vt,0,c.RGBA,c.UNSIGNED_BYTE,sn);return Li}const Lt={};function de(he){!0!==b[he]&&(c.enable(he),b[he]=!0)}function Dn(he){!1!==b[he]&&(c.disable(he),b[he]=!1)}Lt[c.TEXTURE_2D]=Pt(c.TEXTURE_2D,c.TEXTURE_2D,1),Lt[c.TEXTURE_CUBE_MAP]=Pt(c.TEXTURE_CUBE_MAP,c.TEXTURE_CUBE_MAP_POSITIVE_X,6),s&&(Lt[c.TEXTURE_2D_ARRAY]=Pt(c.TEXTURE_2D_ARRAY,c.TEXTURE_2D_ARRAY,1,1),Lt[c.TEXTURE_3D]=Pt(c.TEXTURE_3D,c.TEXTURE_3D,1,1)),h.setClear(0,0,0,1),p.setClear(1),m.setClear(0),de(c.DEPTH_TEST),p.setFunc(3),Oe(!1),En(1),de(c.CULL_FACE),ht(wn);const mt={100:c.FUNC_ADD,101:c.FUNC_SUBTRACT,102:c.FUNC_REVERSE_SUBTRACT};if(s)mt[103]=c.MIN,mt[104]=c.MAX;else{const he=e.get("EXT_blend_minmax");null!==he&&(mt[103]=he.MIN_EXT,mt[104]=he.MAX_EXT)}const ze={200:c.ZERO,201:c.ONE,202:c.SRC_COLOR,204:c.SRC_ALPHA,210:c.SRC_ALPHA_SATURATE,208:c.DST_COLOR,206:c.DST_ALPHA,203:c.ONE_MINUS_SRC_COLOR,205:c.ONE_MINUS_SRC_ALPHA,209:c.ONE_MINUS_DST_COLOR,207:c.ONE_MINUS_DST_ALPHA};function ht(he,Fe,_t,Vt,sn,Li,xi,hr){if(he!==wn){if(!1===I&&(de(c.BLEND),I=!0),5===he)sn=sn||Fe,Li=Li||_t,xi=xi||Vt,(Fe!==U||sn!==K)&&(c.blendEquationSeparate(mt[Fe],mt[sn]),U=Fe,K=sn),(_t!==W||Vt!==X||Li!==re||xi!==le)&&(c.blendFuncSeparate(ze[_t],ze[Vt],ze[Li],ze[xi]),W=_t,X=Vt,re=Li,le=xi),B=he,V=!1;else if(he!==B||hr!==V){if((100!==U||100!==K)&&(c.blendEquation(c.FUNC_ADD),U=100,K=100),hr)switch(he){case 1:c.blendFuncSeparate(c.ONE,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case 2:c.blendFunc(c.ONE,c.ONE);break;case 3:c.blendFuncSeparate(c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);break;case 4:c.blendFuncSeparate(c.ZERO,c.SRC_COLOR,c.ZERO,c.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",he)}else switch(he){case 1:c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case 2:c.blendFunc(c.SRC_ALPHA,c.ONE);break;case 3:c.blendFuncSeparate(c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);break;case 4:c.blendFunc(c.ZERO,c.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",he)}W=null,X=null,re=null,le=null,B=he,V=hr}}else!0===I&&(Dn(c.BLEND),I=!1)}function Oe(he){te!==he&&(c.frontFace(he?c.CW:c.CCW),te=he)}function En(he){0!==he?(de(c.CULL_FACE),he!==Ae&&c.cullFace(1===he?c.BACK:2===he?c.FRONT:c.FRONT_AND_BACK)):Dn(c.CULL_FACE),Ae=he}function vn(he,Fe,_t){he?(de(c.POLYGON_OFFSET_FILL),(ve!==Fe||we!==_t)&&(c.polygonOffset(Fe,_t),ve=Fe,we=_t)):Dn(c.POLYGON_OFFSET_FILL)}return{buffers:{color:h,depth:p,stencil:m},enable:de,disable:Dn,bindFramebuffer:function fn(he,Fe){return D[he]!==Fe&&(c.bindFramebuffer(he,Fe),D[he]=Fe,s&&(he===c.DRAW_FRAMEBUFFER&&(D[c.FRAMEBUFFER]=Fe),he===c.FRAMEBUFFER&&(D[c.DRAW_FRAMEBUFFER]=Fe)),!0)},drawBuffers:function Dt(he,Fe){let _t=O,Vt=!1;if(he)if(_t=R.get(Fe),void 0===_t&&(_t=[],R.set(Fe,_t)),he.isWebGLMultipleRenderTargets){const sn=he.texture;if(_t.length!==sn.length||_t[0]!==c.COLOR_ATTACHMENT0){for(let Li=0,xi=sn.length;Li<xi;Li++)_t[Li]=c.COLOR_ATTACHMENT0+Li;_t.length=sn.length,Vt=!0}}else _t[0]!==c.COLOR_ATTACHMENT0&&(_t[0]=c.COLOR_ATTACHMENT0,Vt=!0);else _t[0]!==c.BACK&&(_t[0]=c.BACK,Vt=!0);Vt&&(t.isWebGL2?c.drawBuffers(_t):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(_t))},useProgram:function tn(he){return P!==he&&(c.useProgram(he),P=he,!0)},setBlending:ht,setMaterial:function Zt(he,Fe){he.side===zt?Dn(c.CULL_FACE):de(c.CULL_FACE);let _t=he.side===Je;Fe&&(_t=!_t),Oe(_t),1===he.blending&&!1===he.transparent?ht(wn):ht(he.blending,he.blendEquation,he.blendSrc,he.blendDst,he.blendEquationAlpha,he.blendSrcAlpha,he.blendDstAlpha,he.premultipliedAlpha),p.setFunc(he.depthFunc),p.setTest(he.depthTest),p.setMask(he.depthWrite),h.setMask(he.colorWrite);const Vt=he.stencilWrite;m.setTest(Vt),Vt&&(m.setMask(he.stencilWriteMask),m.setFunc(he.stencilFunc,he.stencilRef,he.stencilFuncMask),m.setOp(he.stencilFail,he.stencilZFail,he.stencilZPass)),vn(he.polygonOffset,he.polygonOffsetFactor,he.polygonOffsetUnits),!0===he.alphaToCoverage?de(c.SAMPLE_ALPHA_TO_COVERAGE):Dn(c.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Oe,setCullFace:En,setLineWidth:function Sn(he){he!==Ge&&(lt&&c.lineWidth(he),Ge=he)},setPolygonOffset:vn,setScissorTest:function On(he){he?de(c.SCISSOR_TEST):Dn(c.SCISSOR_TEST)},activeTexture:function fi(he){void 0===he&&(he=c.TEXTURE0+Ie-1),dt!==he&&(c.activeTexture(he),dt=he)},bindTexture:function ne(he,Fe,_t){void 0===_t&&(_t=null===dt?c.TEXTURE0+Ie-1:dt);let Vt=vt[_t];void 0===Vt&&(Vt={type:void 0,texture:void 0},vt[_t]=Vt),(Vt.type!==he||Vt.texture!==Fe)&&(dt!==_t&&(c.activeTexture(_t),dt=_t),c.bindTexture(he,Fe||Lt[he]),Vt.type=he,Vt.texture=Fe)},unbindTexture:function j(){const he=vt[dt];void 0!==he&&void 0!==he.type&&(c.bindTexture(he.type,null),he.type=void 0,he.texture=void 0)},compressedTexImage2D:function _e(){try{c.compressedTexImage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},compressedTexImage3D:function Mt(){try{c.compressedTexImage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texImage2D:function pn(){try{c.texImage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texImage3D:function bn(){try{c.texImage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},updateUBOMapping:function qn(he,Fe){let _t=S.get(Fe);void 0===_t&&(_t=new WeakMap,S.set(Fe,_t));let Vt=_t.get(he);void 0===Vt&&(Vt=c.getUniformBlockIndex(Fe,he.name),_t.set(he,Vt))},uniformBlockBinding:function Ci(he,Fe){const Vt=S.get(Fe).get(he);_.get(Fe)!==Vt&&(c.uniformBlockBinding(Fe,Vt,he.__bindingPointIndex),_.set(Fe,Vt))},texStorage2D:function He(){try{c.texStorage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texStorage3D:function nn(){try{c.texStorage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texSubImage2D:function xt(){try{c.texSubImage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},texSubImage3D:function Ut(){try{c.texSubImage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},compressedTexSubImage2D:function Tn(){try{c.compressedTexSubImage2D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},compressedTexSubImage3D:function Xt(){try{c.compressedTexSubImage3D.apply(c,arguments)}catch(he){console.error("THREE.WebGLState:",he)}},scissor:function qt(he){!1===Ne.equals(he)&&(c.scissor(he.x,he.y,he.z,he.w),Ne.copy(he))},viewport:function cn(he){!1===ct.equals(he)&&(c.viewport(he.x,he.y,he.z,he.w),ct.copy(he))},reset:function rr(){c.disable(c.BLEND),c.disable(c.CULL_FACE),c.disable(c.DEPTH_TEST),c.disable(c.POLYGON_OFFSET_FILL),c.disable(c.SCISSOR_TEST),c.disable(c.STENCIL_TEST),c.disable(c.SAMPLE_ALPHA_TO_COVERAGE),c.blendEquation(c.FUNC_ADD),c.blendFunc(c.ONE,c.ZERO),c.blendFuncSeparate(c.ONE,c.ZERO,c.ONE,c.ZERO),c.colorMask(!0,!0,!0,!0),c.clearColor(0,0,0,0),c.depthMask(!0),c.depthFunc(c.LESS),c.clearDepth(1),c.stencilMask(4294967295),c.stencilFunc(c.ALWAYS,0,4294967295),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),c.clearStencil(0),c.cullFace(c.BACK),c.frontFace(c.CCW),c.polygonOffset(0,0),c.activeTexture(c.TEXTURE0),c.bindFramebuffer(c.FRAMEBUFFER,null),!0===s&&(c.bindFramebuffer(c.DRAW_FRAMEBUFFER,null),c.bindFramebuffer(c.READ_FRAMEBUFFER,null)),c.useProgram(null),c.lineWidth(1),c.scissor(0,0,c.canvas.width,c.canvas.height),c.viewport(0,0,c.canvas.width,c.canvas.height),b={},dt=null,vt={},D={},R=new WeakMap,O=[],P=null,I=!1,B=null,U=null,W=null,X=null,K=null,re=null,le=null,V=!1,te=null,Ae=null,Ge=null,ve=null,we=null,Ne.set(0,0,c.canvas.width,c.canvas.height),ct.set(0,0,c.canvas.width,c.canvas.height),h.reset(),p.reset(),m.reset()}}}function Ff(c,e,t,s,o,l,d){const h=o.isWebGL2,p=o.maxTextures,m=o.maxCubemapSize,_=o.maxTextureSize,S=o.maxSamples,b=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,D=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),R=new WeakMap;let O;const P=new WeakMap;let I=!1;try{I=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function B(ne,j){return I?new OffscreenCanvas(ne,j):Wo("canvas")}function U(ne,j,_e,Mt){let xt=1;if((ne.width>Mt||ne.height>Mt)&&(xt=Mt/Math.max(ne.width,ne.height)),xt<1||!0===j){if(typeof HTMLImageElement<"u"&&ne instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ne instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ne instanceof ImageBitmap){const Ut=j?Jc:Math.floor,Tn=Ut(xt*ne.width),Xt=Ut(xt*ne.height);void 0===O&&(O=B(Tn,Xt));const He=_e?B(Tn,Xt):O;return He.width=Tn,He.height=Xt,He.getContext("2d").drawImage(ne,0,0,Tn,Xt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ne.width+"x"+ne.height+") to ("+Tn+"x"+Xt+")."),He}return"data"in ne&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ne.width+"x"+ne.height+")."),ne}return ne}function W(ne){return yo(ne.width)&&yo(ne.height)}function K(ne,j){return ne.generateMipmaps&&j&&ne.minFilter!==ri&&ne.minFilter!==si}function re(ne){c.generateMipmap(ne)}function le(ne,j,_e,Mt,xt=!1){if(!1===h)return j;if(null!==ne){if(void 0!==c[ne])return c[ne];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ne+"'")}let Ut=j;return j===c.RED&&(_e===c.FLOAT&&(Ut=c.R32F),_e===c.HALF_FLOAT&&(Ut=c.R16F),_e===c.UNSIGNED_BYTE&&(Ut=c.R8)),j===c.RG&&(_e===c.FLOAT&&(Ut=c.RG32F),_e===c.HALF_FLOAT&&(Ut=c.RG16F),_e===c.UNSIGNED_BYTE&&(Ut=c.RG8)),j===c.RGBA&&(_e===c.FLOAT&&(Ut=c.RGBA32F),_e===c.HALF_FLOAT&&(Ut=c.RGBA16F),_e===c.UNSIGNED_BYTE&&(Ut=Mt===_n&&!1===xt?c.SRGB8_ALPHA8:c.RGBA8),_e===c.UNSIGNED_SHORT_4_4_4_4&&(Ut=c.RGBA4),_e===c.UNSIGNED_SHORT_5_5_5_1&&(Ut=c.RGB5_A1)),(Ut===c.R16F||Ut===c.R32F||Ut===c.RG16F||Ut===c.RG32F||Ut===c.RGBA16F||Ut===c.RGBA32F)&&e.get("EXT_color_buffer_float"),Ut}function V(ne,j,_e){return!0===K(ne,_e)||ne.isFramebufferTexture&&ne.minFilter!==ri&&ne.minFilter!==si?Math.log2(Math.max(j.width,j.height))+1:void 0!==ne.mipmaps&&ne.mipmaps.length>0?ne.mipmaps.length:ne.isCompressedTexture&&Array.isArray(ne.image)?j.mipmaps.length:1}function te(ne){return ne===ri||1004===ne||1005===ne?c.NEAREST:c.LINEAR}function Ae(ne){const j=ne.target;j.removeEventListener("dispose",Ae),function ve(ne){const j=s.get(ne);if(void 0===j.__webglInit)return;const _e=ne.source,Mt=P.get(_e);if(Mt){const xt=Mt[j.__cacheKey];xt.usedTimes--,0===xt.usedTimes&&we(ne),0===Object.keys(Mt).length&&P.delete(_e)}s.remove(ne)}(j),j.isVideoTexture&&R.delete(j)}function Ge(ne){const j=ne.target;j.removeEventListener("dispose",Ge),function Ie(ne){const j=ne.texture,_e=s.get(ne),Mt=s.get(j);if(void 0!==Mt.__webglTexture&&(c.deleteTexture(Mt.__webglTexture),d.memory.textures--),ne.depthTexture&&ne.depthTexture.dispose(),ne.isWebGLCubeRenderTarget)for(let xt=0;xt<6;xt++)c.deleteFramebuffer(_e.__webglFramebuffer[xt]),_e.__webglDepthbuffer&&c.deleteRenderbuffer(_e.__webglDepthbuffer[xt]);else{if(c.deleteFramebuffer(_e.__webglFramebuffer),_e.__webglDepthbuffer&&c.deleteRenderbuffer(_e.__webglDepthbuffer),_e.__webglMultisampledFramebuffer&&c.deleteFramebuffer(_e.__webglMultisampledFramebuffer),_e.__webglColorRenderbuffer)for(let xt=0;xt<_e.__webglColorRenderbuffer.length;xt++)_e.__webglColorRenderbuffer[xt]&&c.deleteRenderbuffer(_e.__webglColorRenderbuffer[xt]);_e.__webglDepthRenderbuffer&&c.deleteRenderbuffer(_e.__webglDepthRenderbuffer)}if(ne.isWebGLMultipleRenderTargets)for(let xt=0,Ut=j.length;xt<Ut;xt++){const Tn=s.get(j[xt]);Tn.__webglTexture&&(c.deleteTexture(Tn.__webglTexture),d.memory.textures--),s.remove(j[xt])}s.remove(j),s.remove(ne)}(j)}function we(ne){const j=s.get(ne);c.deleteTexture(j.__webglTexture),delete P.get(ne.source)[j.__cacheKey],d.memory.textures--}let lt=0;function vt(ne,j){const _e=s.get(ne);if(ne.isVideoTexture&&function On(ne){const j=d.render.frame;R.get(ne)!==j&&(R.set(ne,j),ne.update())}(ne),!1===ne.isRenderTargetTexture&&ne.version>0&&_e.__version!==ne.version){const Mt=ne.image;if(null===Mt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Mt.complete)return void Dn(_e,ne,j);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(c.TEXTURE_2D,_e.__webglTexture,c.TEXTURE0+j)}const ct={1e3:c.REPEAT,[Gi]:c.CLAMP_TO_EDGE,1002:c.MIRRORED_REPEAT},Pt={[ri]:c.NEAREST,1004:c.NEAREST_MIPMAP_NEAREST,1005:c.NEAREST_MIPMAP_LINEAR,[si]:c.LINEAR,1007:c.LINEAR_MIPMAP_NEAREST,[ce]:c.LINEAR_MIPMAP_LINEAR};function Lt(ne,j,_e){if(_e?(c.texParameteri(ne,c.TEXTURE_WRAP_S,ct[j.wrapS]),c.texParameteri(ne,c.TEXTURE_WRAP_T,ct[j.wrapT]),(ne===c.TEXTURE_3D||ne===c.TEXTURE_2D_ARRAY)&&c.texParameteri(ne,c.TEXTURE_WRAP_R,ct[j.wrapR]),c.texParameteri(ne,c.TEXTURE_MAG_FILTER,Pt[j.magFilter]),c.texParameteri(ne,c.TEXTURE_MIN_FILTER,Pt[j.minFilter])):(c.texParameteri(ne,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(ne,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),(ne===c.TEXTURE_3D||ne===c.TEXTURE_2D_ARRAY)&&c.texParameteri(ne,c.TEXTURE_WRAP_R,c.CLAMP_TO_EDGE),(j.wrapS!==Gi||j.wrapT!==Gi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),c.texParameteri(ne,c.TEXTURE_MAG_FILTER,te(j.magFilter)),c.texParameteri(ne,c.TEXTURE_MIN_FILTER,te(j.minFilter)),j.minFilter!==ri&&j.minFilter!==si&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Mt=e.get("EXT_texture_filter_anisotropic");if(j.magFilter===ri||1005!==j.minFilter&&j.minFilter!==ce||j.type===Qe&&!1===e.has("OES_texture_float_linear")||!1===h&&j.type===qe&&!1===e.has("OES_texture_half_float_linear"))return;(j.anisotropy>1||s.get(j).__currentAnisotropy)&&(c.texParameterf(ne,Mt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(j.anisotropy,o.getMaxAnisotropy())),s.get(j).__currentAnisotropy=j.anisotropy)}}function de(ne,j){let _e=!1;void 0===ne.__webglInit&&(ne.__webglInit=!0,j.addEventListener("dispose",Ae));const Mt=j.source;let xt=P.get(Mt);void 0===xt&&(xt={},P.set(Mt,xt));const Ut=function dt(ne){const j=[];return j.push(ne.wrapS),j.push(ne.wrapT),j.push(ne.wrapR||0),j.push(ne.magFilter),j.push(ne.minFilter),j.push(ne.anisotropy),j.push(ne.internalFormat),j.push(ne.format),j.push(ne.type),j.push(ne.generateMipmaps),j.push(ne.premultiplyAlpha),j.push(ne.flipY),j.push(ne.unpackAlignment),j.push(ne.colorSpace),j.join()}(j);if(Ut!==ne.__cacheKey){void 0===xt[Ut]&&(xt[Ut]={texture:c.createTexture(),usedTimes:0},d.memory.textures++,_e=!0),xt[Ut].usedTimes++;const Tn=xt[ne.__cacheKey];void 0!==Tn&&(xt[ne.__cacheKey].usedTimes--,0===Tn.usedTimes&&we(j)),ne.__cacheKey=Ut,ne.__webglTexture=xt[Ut].texture}return _e}function Dn(ne,j,_e){let Mt=c.TEXTURE_2D;(j.isDataArrayTexture||j.isCompressedArrayTexture)&&(Mt=c.TEXTURE_2D_ARRAY),j.isData3DTexture&&(Mt=c.TEXTURE_3D);const xt=de(ne,j),Ut=j.source;t.bindTexture(Mt,ne.__webglTexture,c.TEXTURE0+_e);const Tn=s.get(Ut);if(Ut.version!==Tn.__version||!0===xt){t.activeTexture(c.TEXTURE0+_e),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,j.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,j.unpackAlignment),c.pixelStorei(c.UNPACK_COLORSPACE_CONVERSION_WEBGL,c.NONE);const Xt=function X(ne){return!h&&(ne.wrapS!==Gi||ne.wrapT!==Gi||ne.minFilter!==ri&&ne.minFilter!==si)}(j)&&!1===W(j.image);let He=U(j.image,Xt,!1,_);He=fi(j,He);const nn=W(He)||h,pn=l.convert(j.format,j.colorSpace);let cn,bn=l.convert(j.type),qt=le(j.internalFormat,pn,bn,j.colorSpace);Lt(Mt,j,nn);const qn=j.mipmaps,Ci=h&&!0!==j.isVideoTexture,rr=void 0===Tn.__version||!0===xt,he=V(j,He,nn);if(j.isDepthTexture)qt=c.DEPTH_COMPONENT,h?qt=j.type===Qe?c.DEPTH_COMPONENT32F:j.type===De?c.DEPTH_COMPONENT24:j.type===gn?c.DEPTH24_STENCIL8:c.DEPTH_COMPONENT16:j.type===Qe&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),j.format===er&&qt===c.DEPTH_COMPONENT&&1012!==j.type&&j.type!==De&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),j.type=De,bn=l.convert(j.type)),j.format===cs&&qt===c.DEPTH_COMPONENT&&(qt=c.DEPTH_STENCIL,j.type!==gn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),j.type=gn,bn=l.convert(j.type))),rr&&(Ci?t.texStorage2D(c.TEXTURE_2D,1,qt,He.width,He.height):t.texImage2D(c.TEXTURE_2D,0,qt,He.width,He.height,0,pn,bn,null));else if(j.isDataTexture)if(qn.length>0&&nn){Ci&&rr&&t.texStorage2D(c.TEXTURE_2D,he,qt,qn[0].width,qn[0].height);for(let Fe=0,_t=qn.length;Fe<_t;Fe++)cn=qn[Fe],Ci?t.texSubImage2D(c.TEXTURE_2D,Fe,0,0,cn.width,cn.height,pn,bn,cn.data):t.texImage2D(c.TEXTURE_2D,Fe,qt,cn.width,cn.height,0,pn,bn,cn.data);j.generateMipmaps=!1}else Ci?(rr&&t.texStorage2D(c.TEXTURE_2D,he,qt,He.width,He.height),t.texSubImage2D(c.TEXTURE_2D,0,0,0,He.width,He.height,pn,bn,He.data)):t.texImage2D(c.TEXTURE_2D,0,qt,He.width,He.height,0,pn,bn,He.data);else if(j.isCompressedTexture)if(j.isCompressedArrayTexture){Ci&&rr&&t.texStorage3D(c.TEXTURE_2D_ARRAY,he,qt,qn[0].width,qn[0].height,He.depth);for(let Fe=0,_t=qn.length;Fe<_t;Fe++)cn=qn[Fe],j.format!==gi?null!==pn?Ci?t.compressedTexSubImage3D(c.TEXTURE_2D_ARRAY,Fe,0,0,0,cn.width,cn.height,He.depth,pn,cn.data,0,0):t.compressedTexImage3D(c.TEXTURE_2D_ARRAY,Fe,qt,cn.width,cn.height,He.depth,0,cn.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ci?t.texSubImage3D(c.TEXTURE_2D_ARRAY,Fe,0,0,0,cn.width,cn.height,He.depth,pn,bn,cn.data):t.texImage3D(c.TEXTURE_2D_ARRAY,Fe,qt,cn.width,cn.height,He.depth,0,pn,bn,cn.data)}else{Ci&&rr&&t.texStorage2D(c.TEXTURE_2D,he,qt,qn[0].width,qn[0].height);for(let Fe=0,_t=qn.length;Fe<_t;Fe++)cn=qn[Fe],j.format!==gi?null!==pn?Ci?t.compressedTexSubImage2D(c.TEXTURE_2D,Fe,0,0,cn.width,cn.height,pn,cn.data):t.compressedTexImage2D(c.TEXTURE_2D,Fe,qt,cn.width,cn.height,0,cn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ci?t.texSubImage2D(c.TEXTURE_2D,Fe,0,0,cn.width,cn.height,pn,bn,cn.data):t.texImage2D(c.TEXTURE_2D,Fe,qt,cn.width,cn.height,0,pn,bn,cn.data)}else if(j.isDataArrayTexture)Ci?(rr&&t.texStorage3D(c.TEXTURE_2D_ARRAY,he,qt,He.width,He.height,He.depth),t.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,0,He.width,He.height,He.depth,pn,bn,He.data)):t.texImage3D(c.TEXTURE_2D_ARRAY,0,qt,He.width,He.height,He.depth,0,pn,bn,He.data);else if(j.isData3DTexture)Ci?(rr&&t.texStorage3D(c.TEXTURE_3D,he,qt,He.width,He.height,He.depth),t.texSubImage3D(c.TEXTURE_3D,0,0,0,0,He.width,He.height,He.depth,pn,bn,He.data)):t.texImage3D(c.TEXTURE_3D,0,qt,He.width,He.height,He.depth,0,pn,bn,He.data);else if(j.isFramebufferTexture){if(rr)if(Ci)t.texStorage2D(c.TEXTURE_2D,he,qt,He.width,He.height);else{let Fe=He.width,_t=He.height;for(let Vt=0;Vt<he;Vt++)t.texImage2D(c.TEXTURE_2D,Vt,qt,Fe,_t,0,pn,bn,null),Fe>>=1,_t>>=1}}else if(qn.length>0&&nn){Ci&&rr&&t.texStorage2D(c.TEXTURE_2D,he,qt,qn[0].width,qn[0].height);for(let Fe=0,_t=qn.length;Fe<_t;Fe++)cn=qn[Fe],Ci?t.texSubImage2D(c.TEXTURE_2D,Fe,0,0,pn,bn,cn):t.texImage2D(c.TEXTURE_2D,Fe,qt,pn,bn,cn);j.generateMipmaps=!1}else Ci?(rr&&t.texStorage2D(c.TEXTURE_2D,he,qt,He.width,He.height),t.texSubImage2D(c.TEXTURE_2D,0,0,0,pn,bn,He)):t.texImage2D(c.TEXTURE_2D,0,qt,pn,bn,He);K(j,nn)&&re(Mt),Tn.__version=Ut.version,j.onUpdate&&j.onUpdate(j)}ne.__version=j.version}function Dt(ne,j,_e,Mt,xt){const Ut=l.convert(_e.format,_e.colorSpace),Tn=l.convert(_e.type),Xt=le(_e.internalFormat,Ut,Tn,_e.colorSpace);s.get(j).__hasExternalTextures||(xt===c.TEXTURE_3D||xt===c.TEXTURE_2D_ARRAY?t.texImage3D(xt,0,Xt,j.width,j.height,j.depth,0,Ut,Tn,null):t.texImage2D(xt,0,Xt,j.width,j.height,0,Ut,Tn,null)),t.bindFramebuffer(c.FRAMEBUFFER,ne),vn(j)?b.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,Mt,xt,s.get(_e).__webglTexture,0,Sn(j)):(xt===c.TEXTURE_2D||xt>=c.TEXTURE_CUBE_MAP_POSITIVE_X&&xt<=c.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&c.framebufferTexture2D(c.FRAMEBUFFER,Mt,xt,s.get(_e).__webglTexture,0),t.bindFramebuffer(c.FRAMEBUFFER,null)}function tn(ne,j,_e){if(c.bindRenderbuffer(c.RENDERBUFFER,ne),j.depthBuffer&&!j.stencilBuffer){let Mt=c.DEPTH_COMPONENT16;if(_e||vn(j)){const xt=j.depthTexture;xt&&xt.isDepthTexture&&(xt.type===Qe?Mt=c.DEPTH_COMPONENT32F:xt.type===De&&(Mt=c.DEPTH_COMPONENT24));const Ut=Sn(j);vn(j)?b.renderbufferStorageMultisampleEXT(c.RENDERBUFFER,Ut,Mt,j.width,j.height):c.renderbufferStorageMultisample(c.RENDERBUFFER,Ut,Mt,j.width,j.height)}else c.renderbufferStorage(c.RENDERBUFFER,Mt,j.width,j.height);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,ne)}else if(j.depthBuffer&&j.stencilBuffer){const Mt=Sn(j);_e&&!1===vn(j)?c.renderbufferStorageMultisample(c.RENDERBUFFER,Mt,c.DEPTH24_STENCIL8,j.width,j.height):vn(j)?b.renderbufferStorageMultisampleEXT(c.RENDERBUFFER,Mt,c.DEPTH24_STENCIL8,j.width,j.height):c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,j.width,j.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,ne)}else{const Mt=!0===j.isWebGLMultipleRenderTargets?j.texture:[j.texture];for(let xt=0;xt<Mt.length;xt++){const Ut=Mt[xt],Tn=l.convert(Ut.format,Ut.colorSpace),Xt=l.convert(Ut.type),He=le(Ut.internalFormat,Tn,Xt,Ut.colorSpace),nn=Sn(j);_e&&!1===vn(j)?c.renderbufferStorageMultisample(c.RENDERBUFFER,nn,He,j.width,j.height):vn(j)?b.renderbufferStorageMultisampleEXT(c.RENDERBUFFER,nn,He,j.width,j.height):c.renderbufferStorage(c.RENDERBUFFER,He,j.width,j.height)}}c.bindRenderbuffer(c.RENDERBUFFER,null)}function ze(ne){const j=s.get(ne),_e=!0===ne.isWebGLCubeRenderTarget;if(ne.depthTexture&&!j.__autoAllocateDepthBuffer){if(_e)throw new Error("target.depthTexture not supported in Cube render targets");!function mt(ne,j){if(j&&j.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(c.FRAMEBUFFER,ne),!j.depthTexture||!j.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!s.get(j.depthTexture).__webglTexture||j.depthTexture.image.width!==j.width||j.depthTexture.image.height!==j.height)&&(j.depthTexture.image.width=j.width,j.depthTexture.image.height=j.height,j.depthTexture.needsUpdate=!0),vt(j.depthTexture,0);const Mt=s.get(j.depthTexture).__webglTexture,xt=Sn(j);if(j.depthTexture.format===er)vn(j)?b.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,Mt,0,xt):c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,Mt,0);else{if(j.depthTexture.format!==cs)throw new Error("Unknown depthTexture format");vn(j)?b.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,Mt,0,xt):c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,Mt,0)}}(j.__webglFramebuffer,ne)}else if(_e){j.__webglDepthbuffer=[];for(let Mt=0;Mt<6;Mt++)t.bindFramebuffer(c.FRAMEBUFFER,j.__webglFramebuffer[Mt]),j.__webglDepthbuffer[Mt]=c.createRenderbuffer(),tn(j.__webglDepthbuffer[Mt],ne,!1)}else t.bindFramebuffer(c.FRAMEBUFFER,j.__webglFramebuffer),j.__webglDepthbuffer=c.createRenderbuffer(),tn(j.__webglDepthbuffer,ne,!1);t.bindFramebuffer(c.FRAMEBUFFER,null)}function Sn(ne){return Math.min(S,ne.samples)}function vn(ne){const j=s.get(ne);return h&&ne.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==j.__useRenderToTexture}function fi(ne,j){const _e=ne.colorSpace,Mt=ne.format,xt=ne.type;return!0===ne.isCompressedTexture||1035===ne.format||_e!==ki&&""!==_e&&(_e===_n?!1===h?!0===e.has("EXT_sRGB")&&Mt===gi?(ne.format=1035,ne.minFilter=si,ne.generateMipmaps=!1):j=dl.sRGBToLinear(j):(Mt!==gi||xt!==ue)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",_e)),j}this.allocateTextureUnit=function it(){const ne=lt;return ne>=p&&console.warn("THREE.WebGLTextures: Trying to use "+ne+" texture units while this GPU supports only "+p),lt+=1,ne},this.resetTextureUnits=function ot(){lt=0},this.setTexture2D=vt,this.setTexture2DArray=function jt(ne,j){const _e=s.get(ne);ne.version>0&&_e.__version!==ne.version?Dn(_e,ne,j):t.bindTexture(c.TEXTURE_2D_ARRAY,_e.__webglTexture,c.TEXTURE0+j)},this.setTexture3D=function Bt(ne,j){const _e=s.get(ne);ne.version>0&&_e.__version!==ne.version?Dn(_e,ne,j):t.bindTexture(c.TEXTURE_3D,_e.__webglTexture,c.TEXTURE0+j)},this.setTextureCube=function Ne(ne,j){const _e=s.get(ne);ne.version>0&&_e.__version!==ne.version?function fn(ne,j,_e){if(6!==j.image.length)return;const Mt=de(ne,j),xt=j.source;t.bindTexture(c.TEXTURE_CUBE_MAP,ne.__webglTexture,c.TEXTURE0+_e);const Ut=s.get(xt);if(xt.version!==Ut.__version||!0===Mt){t.activeTexture(c.TEXTURE0+_e),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,j.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,j.unpackAlignment),c.pixelStorei(c.UNPACK_COLORSPACE_CONVERSION_WEBGL,c.NONE);const Tn=j.isCompressedTexture||j.image[0].isCompressedTexture,Xt=j.image[0]&&j.image[0].isDataTexture,He=[];for(let Fe=0;Fe<6;Fe++)He[Fe]=Tn||Xt?Xt?j.image[Fe].image:j.image[Fe]:U(j.image[Fe],!1,!0,m),He[Fe]=fi(j,He[Fe]);const nn=He[0],pn=W(nn)||h,bn=l.convert(j.format,j.colorSpace),qt=l.convert(j.type),cn=le(j.internalFormat,bn,qt,j.colorSpace),qn=h&&!0!==j.isVideoTexture,Ci=void 0===Ut.__version||!0===Mt;let he,rr=V(j,nn,pn);if(Lt(c.TEXTURE_CUBE_MAP,j,pn),Tn){qn&&Ci&&t.texStorage2D(c.TEXTURE_CUBE_MAP,rr,cn,nn.width,nn.height);for(let Fe=0;Fe<6;Fe++){he=He[Fe].mipmaps;for(let _t=0;_t<he.length;_t++){const Vt=he[_t];j.format!==gi?null!==bn?qn?t.compressedTexSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,_t,0,0,Vt.width,Vt.height,bn,Vt.data):t.compressedTexImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,_t,cn,Vt.width,Vt.height,0,Vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):qn?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,_t,0,0,Vt.width,Vt.height,bn,qt,Vt.data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,_t,cn,Vt.width,Vt.height,0,bn,qt,Vt.data)}}}else{he=j.mipmaps,qn&&Ci&&(he.length>0&&rr++,t.texStorage2D(c.TEXTURE_CUBE_MAP,rr,cn,He[0].width,He[0].height));for(let Fe=0;Fe<6;Fe++)if(Xt){qn?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,0,0,0,He[Fe].width,He[Fe].height,bn,qt,He[Fe].data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,0,cn,He[Fe].width,He[Fe].height,0,bn,qt,He[Fe].data);for(let _t=0;_t<he.length;_t++){const sn=he[_t].image[Fe].image;qn?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,_t+1,0,0,sn.width,sn.height,bn,qt,sn.data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,_t+1,cn,sn.width,sn.height,0,bn,qt,sn.data)}}else{qn?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,0,0,0,bn,qt,He[Fe]):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,0,cn,bn,qt,He[Fe]);for(let _t=0;_t<he.length;_t++){const Vt=he[_t];qn?t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,_t+1,0,0,bn,qt,Vt.image[Fe]):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,_t+1,cn,bn,qt,Vt.image[Fe])}}}K(j,pn)&&re(c.TEXTURE_CUBE_MAP),Ut.__version=xt.version,j.onUpdate&&j.onUpdate(j)}ne.__version=j.version}(_e,ne,j):t.bindTexture(c.TEXTURE_CUBE_MAP,_e.__webglTexture,c.TEXTURE0+j)},this.rebindTextures=function ht(ne,j,_e){const Mt=s.get(ne);void 0!==j&&Dt(Mt.__webglFramebuffer,ne,ne.texture,c.COLOR_ATTACHMENT0,c.TEXTURE_2D),void 0!==_e&&ze(ne)},this.setupRenderTarget=function Zt(ne){const j=ne.texture,_e=s.get(ne),Mt=s.get(j);ne.addEventListener("dispose",Ge),!0!==ne.isWebGLMultipleRenderTargets&&(void 0===Mt.__webglTexture&&(Mt.__webglTexture=c.createTexture()),Mt.__version=j.version,d.memory.textures++);const xt=!0===ne.isWebGLCubeRenderTarget,Ut=!0===ne.isWebGLMultipleRenderTargets,Tn=W(ne)||h;if(xt){_e.__webglFramebuffer=[];for(let Xt=0;Xt<6;Xt++)_e.__webglFramebuffer[Xt]=c.createFramebuffer()}else{if(_e.__webglFramebuffer=c.createFramebuffer(),Ut)if(o.drawBuffers){const Xt=ne.texture;for(let He=0,nn=Xt.length;He<nn;He++){const pn=s.get(Xt[He]);void 0===pn.__webglTexture&&(pn.__webglTexture=c.createTexture(),d.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(h&&ne.samples>0&&!1===vn(ne)){const Xt=Ut?j:[j];_e.__webglMultisampledFramebuffer=c.createFramebuffer(),_e.__webglColorRenderbuffer=[],t.bindFramebuffer(c.FRAMEBUFFER,_e.__webglMultisampledFramebuffer);for(let He=0;He<Xt.length;He++){const nn=Xt[He];_e.__webglColorRenderbuffer[He]=c.createRenderbuffer(),c.bindRenderbuffer(c.RENDERBUFFER,_e.__webglColorRenderbuffer[He]);const pn=l.convert(nn.format,nn.colorSpace),bn=l.convert(nn.type),qt=le(nn.internalFormat,pn,bn,nn.colorSpace,!0===ne.isXRRenderTarget),cn=Sn(ne);c.renderbufferStorageMultisample(c.RENDERBUFFER,cn,qt,ne.width,ne.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+He,c.RENDERBUFFER,_e.__webglColorRenderbuffer[He])}c.bindRenderbuffer(c.RENDERBUFFER,null),ne.depthBuffer&&(_e.__webglDepthRenderbuffer=c.createRenderbuffer(),tn(_e.__webglDepthRenderbuffer,ne,!0)),t.bindFramebuffer(c.FRAMEBUFFER,null)}}if(xt){t.bindTexture(c.TEXTURE_CUBE_MAP,Mt.__webglTexture),Lt(c.TEXTURE_CUBE_MAP,j,Tn);for(let Xt=0;Xt<6;Xt++)Dt(_e.__webglFramebuffer[Xt],ne,j,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+Xt);K(j,Tn)&&re(c.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ut){const Xt=ne.texture;for(let He=0,nn=Xt.length;He<nn;He++){const pn=Xt[He],bn=s.get(pn);t.bindTexture(c.TEXTURE_2D,bn.__webglTexture),Lt(c.TEXTURE_2D,pn,Tn),Dt(_e.__webglFramebuffer,ne,pn,c.COLOR_ATTACHMENT0+He,c.TEXTURE_2D),K(pn,Tn)&&re(c.TEXTURE_2D)}t.unbindTexture()}else{let Xt=c.TEXTURE_2D;(ne.isWebGL3DRenderTarget||ne.isWebGLArrayRenderTarget)&&(h?Xt=ne.isWebGL3DRenderTarget?c.TEXTURE_3D:c.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Xt,Mt.__webglTexture),Lt(Xt,j,Tn),Dt(_e.__webglFramebuffer,ne,j,c.COLOR_ATTACHMENT0,Xt),K(j,Tn)&&re(Xt),t.unbindTexture()}ne.depthBuffer&&ze(ne)},this.updateRenderTargetMipmap=function Oe(ne){const j=W(ne)||h,_e=!0===ne.isWebGLMultipleRenderTargets?ne.texture:[ne.texture];for(let Mt=0,xt=_e.length;Mt<xt;Mt++){const Ut=_e[Mt];if(K(Ut,j)){const Tn=ne.isWebGLCubeRenderTarget?c.TEXTURE_CUBE_MAP:c.TEXTURE_2D,Xt=s.get(Ut).__webglTexture;t.bindTexture(Tn,Xt),re(Tn),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function En(ne){if(h&&ne.samples>0&&!1===vn(ne)){const j=ne.isWebGLMultipleRenderTargets?ne.texture:[ne.texture],_e=ne.width,Mt=ne.height;let xt=c.COLOR_BUFFER_BIT;const Ut=[],Tn=ne.stencilBuffer?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT,Xt=s.get(ne),He=!0===ne.isWebGLMultipleRenderTargets;if(He)for(let nn=0;nn<j.length;nn++)t.bindFramebuffer(c.FRAMEBUFFER,Xt.__webglMultisampledFramebuffer),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+nn,c.RENDERBUFFER,null),t.bindFramebuffer(c.FRAMEBUFFER,Xt.__webglFramebuffer),c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0+nn,c.TEXTURE_2D,null,0);t.bindFramebuffer(c.READ_FRAMEBUFFER,Xt.__webglMultisampledFramebuffer),t.bindFramebuffer(c.DRAW_FRAMEBUFFER,Xt.__webglFramebuffer);for(let nn=0;nn<j.length;nn++){Ut.push(c.COLOR_ATTACHMENT0+nn),ne.depthBuffer&&Ut.push(Tn);const pn=void 0!==Xt.__ignoreDepthValues&&Xt.__ignoreDepthValues;if(!1===pn&&(ne.depthBuffer&&(xt|=c.DEPTH_BUFFER_BIT),ne.stencilBuffer&&(xt|=c.STENCIL_BUFFER_BIT)),He&&c.framebufferRenderbuffer(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.RENDERBUFFER,Xt.__webglColorRenderbuffer[nn]),!0===pn&&(c.invalidateFramebuffer(c.READ_FRAMEBUFFER,[Tn]),c.invalidateFramebuffer(c.DRAW_FRAMEBUFFER,[Tn])),He){const bn=s.get(j[nn]).__webglTexture;c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,bn,0)}c.blitFramebuffer(0,0,_e,Mt,0,0,_e,Mt,xt,c.NEAREST),D&&c.invalidateFramebuffer(c.READ_FRAMEBUFFER,Ut)}if(t.bindFramebuffer(c.READ_FRAMEBUFFER,null),t.bindFramebuffer(c.DRAW_FRAMEBUFFER,null),He)for(let nn=0;nn<j.length;nn++){t.bindFramebuffer(c.FRAMEBUFFER,Xt.__webglMultisampledFramebuffer),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+nn,c.RENDERBUFFER,Xt.__webglColorRenderbuffer[nn]);const pn=s.get(j[nn]).__webglTexture;t.bindFramebuffer(c.FRAMEBUFFER,Xt.__webglFramebuffer),c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0+nn,c.TEXTURE_2D,pn,0)}t.bindFramebuffer(c.DRAW_FRAMEBUFFER,Xt.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ze,this.setupFrameBufferTexture=Dt,this.useMultisampledRTT=vn}function Yd(c,e,t){const s=t.isWebGL2;return{convert:function o(l,d=""){let h;if(l===ue)return c.UNSIGNED_BYTE;if(1017===l)return c.UNSIGNED_SHORT_4_4_4_4;if(1018===l)return c.UNSIGNED_SHORT_5_5_5_1;if(1010===l)return c.BYTE;if(1011===l)return c.SHORT;if(1012===l)return c.UNSIGNED_SHORT;if(1013===l)return c.INT;if(l===De)return c.UNSIGNED_INT;if(l===Qe)return c.FLOAT;if(l===qe)return s?c.HALF_FLOAT:(h=e.get("OES_texture_half_float"),null!==h?h.HALF_FLOAT_OES:null);if(1021===l)return c.ALPHA;if(l===gi)return c.RGBA;if(1024===l)return c.LUMINANCE;if(1025===l)return c.LUMINANCE_ALPHA;if(l===er)return c.DEPTH_COMPONENT;if(l===cs)return c.DEPTH_STENCIL;if(1035===l)return h=e.get("EXT_sRGB"),null!==h?h.SRGB_ALPHA_EXT:null;if(1028===l)return c.RED;if(1029===l)return c.RED_INTEGER;if(1030===l)return c.RG;if(1031===l)return c.RG_INTEGER;if(1033===l)return c.RGBA_INTEGER;if(33776===l||33777===l||33778===l||33779===l)if(d===_n){if(h=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===h)return null;if(33776===l)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(h=e.get("WEBGL_compressed_texture_s3tc"),null===h)return null;if(33776===l)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===l)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===l)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===l)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===l||35841===l||35842===l||35843===l){if(h=e.get("WEBGL_compressed_texture_pvrtc"),null===h)return null;if(35840===l)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===l)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===l)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===l)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===l)return h=e.get("WEBGL_compressed_texture_etc1"),null!==h?h.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===l||37496===l){if(h=e.get("WEBGL_compressed_texture_etc"),null===h)return null;if(37492===l)return d===_n?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(37496===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}if(37808===l||37809===l||37810===l||37811===l||37812===l||37813===l||37814===l||37815===l||37816===l||37817===l||37818===l||37819===l||37820===l||37821===l){if(h=e.get("WEBGL_compressed_texture_astc"),null===h)return null;if(37808===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===l)return d===_n?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===l){if(h=e.get("EXT_texture_compression_bptc"),null===h)return null;if(36492===l)return d===_n?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===l||36284===l||36285===l||36286===l){if(h=e.get("EXT_texture_compression_rgtc"),null===h)return null;if(36492===l)return h.COMPRESSED_RED_RGTC1_EXT;if(36284===l)return h.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===l)return h.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===l)return h.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return l===gn?s?c.UNSIGNED_INT_24_8:(h=e.get("WEBGL_depth_texture"),null!==h?h.UNSIGNED_INT_24_8_WEBGL:null):void 0!==c[l]?c[l]:null}}}class LM extends Sr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Cl extends ws{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Uf={type:"move"};class qd{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Cl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Cl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new J,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new J),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Cl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new J,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new J),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const s of e.hand.values())this._getHandJoint(t,s)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,s){let o=null,l=null,d=null;const h=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(m&&e.hand){d=!0;for(const O of e.hand.values()){const P=t.getJointPose(O,s),I=this._getHandJoint(m,O);null!==P&&(I.matrix.fromArray(P.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,I.jointRadius=P.radius),I.visible=null!==P}const b=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),D=.02,R=.005;m.inputState.pinching&&b>D+R?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&b<=D-R&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,s),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));null!==h&&(o=t.getPose(e.targetRaySpace,s),null===o&&null!==l&&(o=l),null!==o&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,o.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(o.linearVelocity)):h.hasLinearVelocity=!1,o.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(o.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(Uf)))}return null!==h&&(h.visible=null!==o),null!==p&&(p.visible=null!==l),null!==m&&(m.visible=null!==d),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const s=new Cl;s.matrixAutoUpdate=!1,s.visible=!1,e.joints[t.jointName]=s,e.add(s)}return e.joints[t.jointName]}}class qy extends eo{constructor(e,t,s,o,l,d,h,p,m,_){if((_=void 0!==_?_:er)!==er&&_!==cs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===s&&_===er&&(s=De),void 0===s&&_===cs&&(s=gn),super(null,o,l,d,h,p,_,s,m),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==h?h:ri,this.minFilter=void 0!==p?p:ri,this.flipY=!1,this.generateMipmaps=!1}}class Zy extends ha{constructor(e,t){super();const s=this;let o=null,l=1,d=null,h="local-floor",p=1,m=null,_=null,S=null,b=null,D=null,R=null;const O=t.getContextAttributes();let P=null,I=null;const B=[],U=[],W=new Set,X=new Map,K=new Sr;K.layers.enable(1),K.viewport=new vi;const re=new Sr;re.layers.enable(2),re.viewport=new vi;const le=[K,re],V=new LM;V.layers.enable(1),V.layers.enable(2);let te=null,Ae=null;function Ge(Ne){const ct=U.indexOf(Ne.inputSource);if(-1===ct)return;const Pt=B[ct];void 0!==Pt&&(Pt.update(Ne.inputSource,Ne.frame,m||d),Pt.dispatchEvent({type:Ne.type,data:Ne.inputSource}))}function ve(){o.removeEventListener("select",Ge),o.removeEventListener("selectstart",Ge),o.removeEventListener("selectend",Ge),o.removeEventListener("squeeze",Ge),o.removeEventListener("squeezestart",Ge),o.removeEventListener("squeezeend",Ge),o.removeEventListener("end",ve),o.removeEventListener("inputsourceschange",we);for(let Ne=0;Ne<B.length;Ne++){const ct=U[Ne];null!==ct&&(U[Ne]=null,B[Ne].disconnect(ct))}te=null,Ae=null,e.setRenderTarget(P),D=null,b=null,S=null,o=null,I=null,Bt.stop(),s.isPresenting=!1,s.dispatchEvent({type:"sessionend"})}function we(Ne){for(let ct=0;ct<Ne.removed.length;ct++){const Pt=Ne.removed[ct],Lt=U.indexOf(Pt);Lt>=0&&(U[Lt]=null,B[Lt].disconnect(Pt))}for(let ct=0;ct<Ne.added.length;ct++){const Pt=Ne.added[ct];let Lt=U.indexOf(Pt);if(-1===Lt){for(let Dn=0;Dn<B.length;Dn++){if(Dn>=U.length){U.push(Pt),Lt=Dn;break}if(null===U[Dn]){U[Dn]=Pt,Lt=Dn;break}}if(-1===Lt)break}const de=B[Lt];de&&de.connect(Pt)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ne){let ct=B[Ne];return void 0===ct&&(ct=new qd,B[Ne]=ct),ct.getTargetRaySpace()},this.getControllerGrip=function(Ne){let ct=B[Ne];return void 0===ct&&(ct=new qd,B[Ne]=ct),ct.getGripSpace()},this.getHand=function(Ne){let ct=B[Ne];return void 0===ct&&(ct=new qd,B[Ne]=ct),ct.getHandSpace()},this.setFramebufferScaleFactor=function(Ne){l=Ne,!0===s.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ne){h=Ne,!0===s.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m||d},this.setReferenceSpace=function(Ne){m=Ne},this.getBaseLayer=function(){return null!==b?b:D},this.getBinding=function(){return S},this.getFrame=function(){return R},this.getSession=function(){return o},this.setSession=function(){var Ne=function wt(c){return function(){var e=this,t=arguments;return new Promise(function(s,o){var l=c.apply(e,t);function d(p){We(l,s,o,d,h,"next",p)}function h(p){We(l,s,o,d,h,"throw",p)}d(void 0)})}}(function*(ct){if(o=ct,null!==o){if(P=e.getRenderTarget(),o.addEventListener("select",Ge),o.addEventListener("selectstart",Ge),o.addEventListener("selectend",Ge),o.addEventListener("squeeze",Ge),o.addEventListener("squeezestart",Ge),o.addEventListener("squeezeend",Ge),o.addEventListener("end",ve),o.addEventListener("inputsourceschange",we),!0!==O.xrCompatible&&(yield t.makeXRCompatible()),void 0===o.renderState.layers||!1===e.capabilities.isWebGL2)D=new XRWebGLLayer(o,t,{antialias:void 0!==o.renderState.layers||O.antialias,alpha:!0,depth:O.depth,stencil:O.stencil,framebufferScaleFactor:l}),o.updateRenderState({baseLayer:D}),I=new to(D.framebufferWidth,D.framebufferHeight,{format:gi,type:ue,colorSpace:e.outputColorSpace,stencilBuffer:O.stencil});else{let Pt=null,Lt=null,de=null;O.depth&&(de=O.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Pt=O.stencil?cs:er,Lt=O.stencil?gn:De);const Dn={colorFormat:t.RGBA8,depthFormat:de,scaleFactor:l};S=new XRWebGLBinding(o,t),b=S.createProjectionLayer(Dn),o.updateRenderState({layers:[b]}),I=new to(b.textureWidth,b.textureHeight,{format:gi,type:ue,depthTexture:new qy(b.textureWidth,b.textureHeight,Lt,void 0,void 0,void 0,void 0,void 0,void 0,Pt),stencilBuffer:O.stencil,colorSpace:e.outputColorSpace,samples:O.antialias?4:0}),e.properties.get(I).__ignoreDepthValues=b.ignoreDepthValues}I.isXRRenderTarget=!0,this.setFoveation(p),m=null,d=yield o.requestReferenceSpace(h),Bt.setContext(o),Bt.start(),s.isPresenting=!0,s.dispatchEvent({type:"sessionstart"})}});return function(ct){return Ne.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==o)return o.environmentBlendMode};const Ie=new J,lt=new J;function it(Ne,ct){null===ct?Ne.matrixWorld.copy(Ne.matrix):Ne.matrixWorld.multiplyMatrices(ct.matrixWorld,Ne.matrix),Ne.matrixWorldInverse.copy(Ne.matrixWorld).invert()}this.updateCamera=function(Ne){if(null===o)return;V.near=re.near=K.near=Ne.near,V.far=re.far=K.far=Ne.far,(te!==V.near||Ae!==V.far)&&(o.updateRenderState({depthNear:V.near,depthFar:V.far}),te=V.near,Ae=V.far);const ct=Ne.parent,Pt=V.cameras;it(V,ct);for(let Lt=0;Lt<Pt.length;Lt++)it(Pt[Lt],ct);2===Pt.length?function ot(Ne,ct,Pt){Ie.setFromMatrixPosition(ct.matrixWorld),lt.setFromMatrixPosition(Pt.matrixWorld);const Lt=Ie.distanceTo(lt),de=ct.projectionMatrix.elements,Dn=Pt.projectionMatrix.elements,fn=de[14]/(de[10]-1),Dt=de[14]/(de[10]+1),tn=(de[9]+1)/de[5],mt=(de[9]-1)/de[5],ze=(de[8]-1)/de[0],ht=(Dn[8]+1)/Dn[0],Zt=fn*ze,Oe=fn*ht,En=Lt/(-ze+ht),Sn=En*-ze;ct.matrixWorld.decompose(Ne.position,Ne.quaternion,Ne.scale),Ne.translateX(Sn),Ne.translateZ(En),Ne.matrixWorld.compose(Ne.position,Ne.quaternion,Ne.scale),Ne.matrixWorldInverse.copy(Ne.matrixWorld).invert();const vn=fn+En,On=Dt+En;Ne.projectionMatrix.makePerspective(Zt-Sn,Oe+(Lt-Sn),tn*Dt/On*vn,mt*Dt/On*vn,vn,On),Ne.projectionMatrixInverse.copy(Ne.projectionMatrix).invert()}(V,K,re):V.projectionMatrix.copy(K.projectionMatrix),function dt(Ne,ct,Pt){null===Pt?Ne.matrix.copy(ct.matrixWorld):(Ne.matrix.copy(Pt.matrixWorld),Ne.matrix.invert(),Ne.matrix.multiply(ct.matrixWorld)),Ne.matrix.decompose(Ne.position,Ne.quaternion,Ne.scale),Ne.updateMatrixWorld(!0);const Lt=Ne.children;for(let de=0,Dn=Lt.length;de<Dn;de++)Lt[de].updateMatrixWorld(!0);Ne.projectionMatrix.copy(ct.projectionMatrix),Ne.projectionMatrixInverse.copy(ct.projectionMatrixInverse),Ne.isPerspectiveCamera&&(Ne.fov=2*fa*Math.atan(1/Ne.projectionMatrix.elements[5]),Ne.zoom=1)}(Ne,V,ct)},this.getCamera=function(){return V},this.getFoveation=function(){if(null!==b||null!==D)return p},this.setFoveation=function(Ne){p=Ne,null!==b&&(b.fixedFoveation=Ne),null!==D&&void 0!==D.fixedFoveation&&(D.fixedFoveation=Ne)},this.getPlanes=function(){return W};let vt=null;const Bt=new ur;Bt.setAnimationLoop(function jt(Ne,ct){if(_=ct.getViewerPose(m||d),R=ct,null!==_){const Pt=_.views;null!==D&&(e.setRenderTargetFramebuffer(I,D.framebuffer),e.setRenderTarget(I));let Lt=!1;Pt.length!==V.cameras.length&&(V.cameras.length=0,Lt=!0);for(let de=0;de<Pt.length;de++){const Dn=Pt[de];let fn=null;if(null!==D)fn=D.getViewport(Dn);else{const tn=S.getViewSubImage(b,Dn);fn=tn.viewport,0===de&&(e.setRenderTargetTextures(I,tn.colorTexture,b.ignoreDepthValues?void 0:tn.depthStencilTexture),e.setRenderTarget(I))}let Dt=le[de];void 0===Dt&&(Dt=new Sr,Dt.layers.enable(de),Dt.viewport=new vi,le[de]=Dt),Dt.matrix.fromArray(Dn.transform.matrix),Dt.matrix.decompose(Dt.position,Dt.quaternion,Dt.scale),Dt.projectionMatrix.fromArray(Dn.projectionMatrix),Dt.projectionMatrixInverse.copy(Dt.projectionMatrix).invert(),Dt.viewport.set(fn.x,fn.y,fn.width,fn.height),0===de&&(V.matrix.copy(Dt.matrix),V.matrix.decompose(V.position,V.quaternion,V.scale)),!0===Lt&&V.cameras.push(Dt)}}for(let Pt=0;Pt<B.length;Pt++){const Lt=U[Pt],de=B[Pt];null!==Lt&&void 0!==de&&de.update(Lt,ct,m||d)}if(vt&&vt(Ne,ct),ct.detectedPlanes){s.dispatchEvent({type:"planesdetected",data:ct.detectedPlanes});let Pt=null;for(const Lt of W)ct.detectedPlanes.has(Lt)||(null===Pt&&(Pt=[]),Pt.push(Lt));if(null!==Pt)for(const Lt of Pt)W.delete(Lt),X.delete(Lt),s.dispatchEvent({type:"planeremoved",data:Lt});for(const Lt of ct.detectedPlanes)if(W.has(Lt)){const de=X.get(Lt);Lt.lastChangedTime>de&&(X.set(Lt,Lt.lastChangedTime),s.dispatchEvent({type:"planechanged",data:Lt}))}else W.add(Lt),X.set(Lt,ct.lastChangedTime),s.dispatchEvent({type:"planeadded",data:Lt})}R=null}),this.setAnimationLoop=function(Ne){vt=Ne},this.dispose=function(){}}}function ng(c,e){function t(P,I){!0===P.matrixAutoUpdate&&P.updateMatrix(),I.value.copy(P.matrix)}function l(P,I){P.opacity.value=I.opacity,I.color&&P.diffuse.value.copy(I.color),I.emissive&&P.emissive.value.copy(I.emissive).multiplyScalar(I.emissiveIntensity),I.map&&(P.map.value=I.map,t(I.map,P.mapTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap,t(I.alphaMap,P.alphaMapTransform)),I.bumpMap&&(P.bumpMap.value=I.bumpMap,t(I.bumpMap,P.bumpMapTransform),P.bumpScale.value=I.bumpScale,I.side===Je&&(P.bumpScale.value*=-1)),I.normalMap&&(P.normalMap.value=I.normalMap,t(I.normalMap,P.normalMapTransform),P.normalScale.value.copy(I.normalScale),I.side===Je&&P.normalScale.value.negate()),I.displacementMap&&(P.displacementMap.value=I.displacementMap,t(I.displacementMap,P.displacementMapTransform),P.displacementScale.value=I.displacementScale,P.displacementBias.value=I.displacementBias),I.emissiveMap&&(P.emissiveMap.value=I.emissiveMap,t(I.emissiveMap,P.emissiveMapTransform)),I.specularMap&&(P.specularMap.value=I.specularMap,t(I.specularMap,P.specularMapTransform)),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest);const B=e.get(I).envMap;if(B&&(P.envMap.value=B,P.flipEnvMap.value=B.isCubeTexture&&!1===B.isRenderTargetTexture?-1:1,P.reflectivity.value=I.reflectivity,P.ior.value=I.ior,P.refractionRatio.value=I.refractionRatio),I.lightMap){P.lightMap.value=I.lightMap;const U=!0===c.useLegacyLights?Math.PI:1;P.lightMapIntensity.value=I.lightMapIntensity*U,t(I.lightMap,P.lightMapTransform)}I.aoMap&&(P.aoMap.value=I.aoMap,P.aoMapIntensity.value=I.aoMapIntensity,t(I.aoMap,P.aoMapTransform))}return{refreshFogUniforms:function s(P,I){I.color.getRGB(P.fogColor.value,Zh(c)),I.isFog?(P.fogNear.value=I.near,P.fogFar.value=I.far):I.isFogExp2&&(P.fogDensity.value=I.density)},refreshMaterialUniforms:function o(P,I,B,U,W){I.isMeshBasicMaterial||I.isMeshLambertMaterial?l(P,I):I.isMeshToonMaterial?(l(P,I),function S(P,I){I.gradientMap&&(P.gradientMap.value=I.gradientMap)}(P,I)):I.isMeshPhongMaterial?(l(P,I),function _(P,I){P.specular.value.copy(I.specular),P.shininess.value=Math.max(I.shininess,1e-4)}(P,I)):I.isMeshStandardMaterial?(l(P,I),function b(P,I){P.metalness.value=I.metalness,I.metalnessMap&&(P.metalnessMap.value=I.metalnessMap,t(I.metalnessMap,P.metalnessMapTransform)),P.roughness.value=I.roughness,I.roughnessMap&&(P.roughnessMap.value=I.roughnessMap,t(I.roughnessMap,P.roughnessMapTransform)),e.get(I).envMap&&(P.envMapIntensity.value=I.envMapIntensity)}(P,I),I.isMeshPhysicalMaterial&&function D(P,I,B){P.ior.value=I.ior,I.sheen>0&&(P.sheenColor.value.copy(I.sheenColor).multiplyScalar(I.sheen),P.sheenRoughness.value=I.sheenRoughness,I.sheenColorMap&&(P.sheenColorMap.value=I.sheenColorMap,t(I.sheenColorMap,P.sheenColorMapTransform)),I.sheenRoughnessMap&&(P.sheenRoughnessMap.value=I.sheenRoughnessMap,t(I.sheenRoughnessMap,P.sheenRoughnessMapTransform))),I.clearcoat>0&&(P.clearcoat.value=I.clearcoat,P.clearcoatRoughness.value=I.clearcoatRoughness,I.clearcoatMap&&(P.clearcoatMap.value=I.clearcoatMap,t(I.clearcoatMap,P.clearcoatMapTransform)),I.clearcoatRoughnessMap&&(P.clearcoatRoughnessMap.value=I.clearcoatRoughnessMap,t(I.clearcoatRoughnessMap,P.clearcoatRoughnessMapTransform)),I.clearcoatNormalMap&&(P.clearcoatNormalMap.value=I.clearcoatNormalMap,t(I.clearcoatNormalMap,P.clearcoatNormalMapTransform),P.clearcoatNormalScale.value.copy(I.clearcoatNormalScale),I.side===Je&&P.clearcoatNormalScale.value.negate())),I.iridescence>0&&(P.iridescence.value=I.iridescence,P.iridescenceIOR.value=I.iridescenceIOR,P.iridescenceThicknessMinimum.value=I.iridescenceThicknessRange[0],P.iridescenceThicknessMaximum.value=I.iridescenceThicknessRange[1],I.iridescenceMap&&(P.iridescenceMap.value=I.iridescenceMap,t(I.iridescenceMap,P.iridescenceMapTransform)),I.iridescenceThicknessMap&&(P.iridescenceThicknessMap.value=I.iridescenceThicknessMap,t(I.iridescenceThicknessMap,P.iridescenceThicknessMapTransform))),I.transmission>0&&(P.transmission.value=I.transmission,P.transmissionSamplerMap.value=B.texture,P.transmissionSamplerSize.value.set(B.width,B.height),I.transmissionMap&&(P.transmissionMap.value=I.transmissionMap,t(I.transmissionMap,P.transmissionMapTransform)),P.thickness.value=I.thickness,I.thicknessMap&&(P.thicknessMap.value=I.thicknessMap,t(I.thicknessMap,P.thicknessMapTransform)),P.attenuationDistance.value=I.attenuationDistance,P.attenuationColor.value.copy(I.attenuationColor)),P.specularIntensity.value=I.specularIntensity,P.specularColor.value.copy(I.specularColor),I.specularColorMap&&(P.specularColorMap.value=I.specularColorMap,t(I.specularColorMap,P.specularColorMapTransform)),I.specularIntensityMap&&(P.specularIntensityMap.value=I.specularIntensityMap,t(I.specularIntensityMap,P.specularIntensityMapTransform))}(P,I,W)):I.isMeshMatcapMaterial?(l(P,I),function R(P,I){I.matcap&&(P.matcap.value=I.matcap)}(P,I)):I.isMeshDepthMaterial?l(P,I):I.isMeshDistanceMaterial?(l(P,I),function O(P,I){const B=e.get(I).light;P.referencePosition.value.setFromMatrixPosition(B.matrixWorld),P.nearDistance.value=B.shadow.camera.near,P.farDistance.value=B.shadow.camera.far}(P,I)):I.isMeshNormalMaterial?l(P,I):I.isLineBasicMaterial?(function d(P,I){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,I.map&&(P.map.value=I.map,t(I.map,P.mapTransform))}(P,I),I.isLineDashedMaterial&&function h(P,I){P.dashSize.value=I.dashSize,P.totalSize.value=I.dashSize+I.gapSize,P.scale.value=I.scale}(P,I)):I.isPointsMaterial?function p(P,I,B,U){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,P.size.value=I.size*B,P.scale.value=.5*U,I.map&&(P.map.value=I.map,t(I.map,P.uvTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest)}(P,I,B,U):I.isSpriteMaterial?function m(P,I){P.diffuse.value.copy(I.color),P.opacity.value=I.opacity,P.rotation.value=I.rotation,I.map&&(P.map.value=I.map,t(I.map,P.mapTransform)),I.alphaMap&&(P.alphaMap.value=I.alphaMap),I.alphaTest>0&&(P.alphaTest.value=I.alphaTest)}(P,I):I.isShadowMaterial?(P.color.value.copy(I.color),P.opacity.value=I.opacity):I.isShaderMaterial&&(I.uniformsNeedUpdate=!1)}}}function ig(c,e,t,s){let o={},l={},d=[];const h=t.isWebGL2?c.getParameter(c.MAX_UNIFORM_BUFFER_BINDINGS):0;function D(B,U,W){const X=B.value;if(void 0===W[U]){if("number"==typeof X)W[U]=X;else{const K=Array.isArray(X)?X:[X],re=[];for(let le=0;le<K.length;le++)re.push(K[le].clone());W[U]=re}return!0}if("number"==typeof X){if(W[U]!==X)return W[U]=X,!0}else{const K=Array.isArray(W[U])?W[U]:[W[U]],re=Array.isArray(X)?X:[X];for(let le=0;le<K.length;le++){const V=K[le];if(!1===V.equals(re[le]))return V.copy(re[le]),!0}}return!1}function O(B){const U={boundary:0,storage:0};return"number"==typeof B?(U.boundary=4,U.storage=4):B.isVector2?(U.boundary=8,U.storage=8):B.isVector3||B.isColor?(U.boundary=16,U.storage=12):B.isVector4?(U.boundary=16,U.storage=16):B.isMatrix3?(U.boundary=48,U.storage=48):B.isMatrix4?(U.boundary=64,U.storage=64):B.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",B),U}function P(B){const U=B.target;U.removeEventListener("dispose",P);const W=d.indexOf(U.__bindingPointIndex);d.splice(W,1),c.deleteBuffer(o[U.id]),delete o[U.id],delete l[U.id]}return{bind:function p(B,U){s.uniformBlockBinding(B,U.program)},update:function m(B,U){let W=o[B.id];void 0===W&&(function R(B){const U=B.uniforms;let W=0;let K=0;for(let re=0,le=U.length;re<le;re++){const V=U[re],te={boundary:0,storage:0},Ae=Array.isArray(V.value)?V.value:[V.value];for(let Ge=0,ve=Ae.length;Ge<ve;Ge++){const Ie=O(Ae[Ge]);te.boundary+=Ie.boundary,te.storage+=Ie.storage}V.__data=new Float32Array(te.storage/Float32Array.BYTES_PER_ELEMENT),V.__offset=W,re>0&&(K=W%16,0!==K&&16-K-te.boundary<0&&(W+=16-K,V.__offset=W)),W+=te.storage}K=W%16,K>0&&(W+=16-K),B.__size=W,B.__cache={}}(B),W=function _(B){const U=function S(){for(let B=0;B<h;B++)if(-1===d.indexOf(B))return d.push(B),B;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();B.__bindingPointIndex=U;const W=c.createBuffer(),X=B.__size,K=B.usage;return c.bindBuffer(c.UNIFORM_BUFFER,W),c.bufferData(c.UNIFORM_BUFFER,X,K),c.bindBuffer(c.UNIFORM_BUFFER,null),c.bindBufferBase(c.UNIFORM_BUFFER,U,W),W}(B),o[B.id]=W,B.addEventListener("dispose",P)),s.updateUBOMapping(B,U.program);const K=e.render.frame;l[B.id]!==K&&(function b(B){const W=B.uniforms,X=B.__cache;c.bindBuffer(c.UNIFORM_BUFFER,o[B.id]);for(let K=0,re=W.length;K<re;K++){const le=W[K];if(!0===D(le,K,X)){const V=le.__offset,te=Array.isArray(le.value)?le.value:[le.value];let Ae=0;for(let Ge=0;Ge<te.length;Ge++){const ve=te[Ge],we=O(ve);"number"==typeof ve?(le.__data[0]=ve,c.bufferSubData(c.UNIFORM_BUFFER,V+Ae,le.__data)):ve.isMatrix3?(le.__data[0]=ve.elements[0],le.__data[1]=ve.elements[1],le.__data[2]=ve.elements[2],le.__data[3]=ve.elements[0],le.__data[4]=ve.elements[3],le.__data[5]=ve.elements[4],le.__data[6]=ve.elements[5],le.__data[7]=ve.elements[0],le.__data[8]=ve.elements[6],le.__data[9]=ve.elements[7],le.__data[10]=ve.elements[8],le.__data[11]=ve.elements[0]):(ve.toArray(le.__data,Ae),Ae+=we.storage/Float32Array.BYTES_PER_ELEMENT)}c.bufferSubData(c.UNIFORM_BUFFER,V,le.__data)}}c.bindBuffer(c.UNIFORM_BUFFER,null)}(B),l[B.id]=K)},dispose:function I(){for(const B in o)c.deleteBuffer(o[B]);d=[],o={},l={}}}}function Ky(){const c=Wo("canvas");return c.style.display="block",c}class rg{constructor(e={}){const{canvas:t=Ky(),context:s=null,depth:o=!0,stencil:l=!0,alpha:d=!1,antialias:h=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:m=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:S=!1}=e;let b;this.isWebGLRenderer=!0,b=null!==s?s.getContextAttributes().alpha:d;let D=null,R=null;const O=[],P=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=_n,this.useLegacyLights=!0,this.toneMapping=Ji,this.toneMappingExposure=1;const I=this;let B=!1,U=0,W=0,X=null,K=-1,re=null;const le=new vi,V=new vi;let te=null,Ae=t.width,Ge=t.height,ve=1,we=null,Ie=null;const lt=new vi(0,0,Ae,Ge),ot=new vi(0,0,Ae,Ge);let it=!1;const dt=new Yp;let vt=!1,jt=!1,Bt=null;const Ne=new Nt,ct=new J,Pt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Lt(){return null===X?ve:1}let fn,Dt,tn,mt,ze,ht,Zt,Oe,En,Sn,vn,On,fi,ne,j,_e,Mt,xt,Ut,Tn,Xt,He,nn,pn,de=s;function Dn(Q,be){for(let ke=0;ke<Q.length;ke++){const Ke=t.getContext(Q[ke],be);if(null!==Ke)return Ke}return null}try{const Q={alpha:!0,depth:o,stencil:l,antialias:h,premultipliedAlpha:p,preserveDrawingBuffer:m,powerPreference:_,failIfMajorPerformanceCaveat:S};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r152"),t.addEventListener("webglcontextlost",cn,!1),t.addEventListener("webglcontextrestored",qn,!1),t.addEventListener("webglcontextcreationerror",Ci,!1),null===de){const be=["webgl2","webgl","experimental-webgl"];if(!0===I.isWebGL1Renderer&&be.shift(),de=Dn(be,Q),null===de)throw Dn(be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===de.getShaderPrecisionFormat&&(de.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Q){throw console.error("THREE.WebGLRenderer: "+Q.message),Q}function bn(){fn=new Ef(de),Dt=new Rd(de,fn,e),fn.init(Dt),He=new Yd(de,fn,Dt),tn=new tg(de,fn,Dt),mt=new Dm(de),ze=new IM,ht=new Ff(de,fn,tn,ze,Dt,He,mt),Zt=new yf(I),Oe=new Od(I),En=new Cv(de,Dt),nn=new xm(de,fn,En,Dt),Sn=new Tm(de,En,mt,nn),vn=new by(de,Sn,En,mt),Ut=new Sy(de,Dt,ht),_e=new Em(ze),On=new AM(I,Zt,Oe,fn,Dt,nn,_e),fi=new ng(I,ze),ne=new Xy,j=new Du(fn,Dt),xt=new Eu(I,Zt,Oe,tn,vn,b,p),Mt=new Iu(I,vn,Dt),pn=new ig(de,mt,Dt,tn),Tn=new vf(de,fn,mt,Dt),Xt=new Cm(de,fn,mt,Dt),mt.programs=On.programs,I.capabilities=Dt,I.extensions=fn,I.properties=ze,I.renderLists=ne,I.shadowMap=Mt,I.state=tn,I.info=mt}bn();const qt=new Zy(I,de);function cn(Q){Q.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),B=!0}function qn(){console.log("THREE.WebGLRenderer: Context Restored."),B=!1;const Q=mt.autoReset,be=Mt.enabled,ke=Mt.autoUpdate,ye=Mt.needsUpdate,Ke=Mt.type;bn(),mt.autoReset=Q,Mt.enabled=be,Mt.autoUpdate=ke,Mt.needsUpdate=ye,Mt.type=Ke}function Ci(Q){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Q.statusMessage)}function rr(Q){const be=Q.target;be.removeEventListener("dispose",rr),function he(Q){(function Fe(Q){const be=ze.get(Q).programs;void 0!==be&&(be.forEach(function(ke){On.releaseProgram(ke)}),Q.isShaderMaterial&&On.releaseShaderCache(Q))})(Q),ze.remove(Q)}(be)}this.xr=qt,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){const Q=fn.get("WEBGL_lose_context");Q&&Q.loseContext()},this.forceContextRestore=function(){const Q=fn.get("WEBGL_lose_context");Q&&Q.restoreContext()},this.getPixelRatio=function(){return ve},this.setPixelRatio=function(Q){void 0!==Q&&(ve=Q,this.setSize(Ae,Ge,!1))},this.getSize=function(Q){return Q.set(Ae,Ge)},this.setSize=function(Q,be,ke=!0){qt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Ae=Q,Ge=be,t.width=Math.floor(Q*ve),t.height=Math.floor(be*ve),!0===ke&&(t.style.width=Q+"px",t.style.height=be+"px"),this.setViewport(0,0,Q,be))},this.getDrawingBufferSize=function(Q){return Q.set(Ae*ve,Ge*ve).floor()},this.setDrawingBufferSize=function(Q,be,ke){Ae=Q,Ge=be,ve=ke,t.width=Math.floor(Q*ke),t.height=Math.floor(be*ke),this.setViewport(0,0,Q,be)},this.getCurrentViewport=function(Q){return Q.copy(le)},this.getViewport=function(Q){return Q.copy(lt)},this.setViewport=function(Q,be,ke,ye){Q.isVector4?lt.set(Q.x,Q.y,Q.z,Q.w):lt.set(Q,be,ke,ye),tn.viewport(le.copy(lt).multiplyScalar(ve).floor())},this.getScissor=function(Q){return Q.copy(ot)},this.setScissor=function(Q,be,ke,ye){Q.isVector4?ot.set(Q.x,Q.y,Q.z,Q.w):ot.set(Q,be,ke,ye),tn.scissor(V.copy(ot).multiplyScalar(ve).floor())},this.getScissorTest=function(){return it},this.setScissorTest=function(Q){tn.setScissorTest(it=Q)},this.setOpaqueSort=function(Q){we=Q},this.setTransparentSort=function(Q){Ie=Q},this.getClearColor=function(Q){return Q.copy(xt.getClearColor())},this.setClearColor=function(){xt.setClearColor.apply(xt,arguments)},this.getClearAlpha=function(){return xt.getClearAlpha()},this.setClearAlpha=function(){xt.setClearAlpha.apply(xt,arguments)},this.clear=function(Q=!0,be=!0,ke=!0){let ye=0;Q&&(ye|=de.COLOR_BUFFER_BIT),be&&(ye|=de.DEPTH_BUFFER_BIT),ke&&(ye|=de.STENCIL_BUFFER_BIT),de.clear(ye)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",cn,!1),t.removeEventListener("webglcontextrestored",qn,!1),t.removeEventListener("webglcontextcreationerror",Ci,!1),ne.dispose(),j.dispose(),ze.dispose(),Zt.dispose(),Oe.dispose(),vn.dispose(),nn.dispose(),pn.dispose(),On.dispose(),qt.dispose(),qt.removeEventListener("sessionstart",sn),qt.removeEventListener("sessionend",Li),Bt&&(Bt.dispose(),Bt=null),xi.stop()},this.renderBufferDirect=function(Q,be,ke,ye,Ke,mn){null===be&&(be=Pt);const yn=Ke.isMesh&&Ke.matrixWorld.determinant()<0,Pn=function s_(Q,be,ke,ye,Ke){!0!==be.isScene&&(be=Pt),ht.resetTextureUnits();const mn=be.fog,Pn=null===X?I.outputColorSpace:!0===X.isXRRenderTarget?X.texture.colorSpace:ki,Wn=(ye.isMeshStandardMaterial?Oe:Zt).get(ye.envMap||(ye.isMeshStandardMaterial?be.environment:null)),Zn=!0===ye.vertexColors&&!!ke.attributes.color&&4===ke.attributes.color.itemSize,Bn=!!ye.normalMap&&!!ke.attributes.tangent,ii=!!ke.morphAttributes.position,Di=!!ke.morphAttributes.normal,ys=!!ke.morphAttributes.color,Io=ye.toneMapped?I.toneMapping:Ji,Wc=ke.morphAttributes.position||ke.morphAttributes.normal||ke.morphAttributes.color,fr=void 0!==Wc?Wc.length:0,oi=ze.get(ye),Fp=R.state.lights;!0!==vt||!0!==jt&&Q===re||_e.setState(ye,Q,Q===re&&ye.id===K);let Fr=!1;ye.version===oi.__version?(oi.needsLights&&oi.lightsStateVersion!==Fp.state.version||oi.outputColorSpace!==Pn||Ke.isInstancedMesh&&!1===oi.instancing||!Ke.isInstancedMesh&&!0===oi.instancing||Ke.isSkinnedMesh&&!1===oi.skinning||!Ke.isSkinnedMesh&&!0===oi.skinning||oi.envMap!==Wn||!0===ye.fog&&oi.fog!==mn||void 0!==oi.numClippingPlanes&&(oi.numClippingPlanes!==_e.numPlanes||oi.numIntersection!==_e.numIntersection)||oi.vertexAlphas!==Zn||oi.vertexTangents!==Bn||oi.morphTargets!==ii||oi.morphNormals!==Di||oi.morphColors!==ys||oi.toneMapping!==Io||!0===Dt.isWebGL2&&oi.morphTargetsCount!==fr)&&(Fr=!0):(Fr=!0,oi.__version=ye.version);let Ro=oi.currentProgram;!0===Fr&&(Ro=id(ye,be,Ke));let mv=!1,$c=!1,Up=!1;const ss=Ro.getUniforms(),Gl=oi.uniforms;if(tn.useProgram(Ro.program)&&(mv=!0,$c=!0,Up=!0),ye.id!==K&&(K=ye.id,$c=!0),mv||re!==Q){if(ss.setValue(de,"projectionMatrix",Q.projectionMatrix),Dt.logarithmicDepthBuffer&&ss.setValue(de,"logDepthBufFC",2/(Math.log(Q.far+1)/Math.LN2)),re!==Q&&(re=Q,$c=!0,Up=!0),ye.isShaderMaterial||ye.isMeshPhongMaterial||ye.isMeshToonMaterial||ye.isMeshStandardMaterial||ye.envMap){const Gs=ss.map.cameraPosition;void 0!==Gs&&Gs.setValue(de,ct.setFromMatrixPosition(Q.matrixWorld))}(ye.isMeshPhongMaterial||ye.isMeshToonMaterial||ye.isMeshLambertMaterial||ye.isMeshBasicMaterial||ye.isMeshStandardMaterial||ye.isShaderMaterial)&&ss.setValue(de,"isOrthographic",!0===Q.isOrthographicCamera),(ye.isMeshPhongMaterial||ye.isMeshToonMaterial||ye.isMeshLambertMaterial||ye.isMeshBasicMaterial||ye.isMeshStandardMaterial||ye.isShaderMaterial||ye.isShadowMaterial||Ke.isSkinnedMesh)&&ss.setValue(de,"viewMatrix",Q.matrixWorldInverse)}if(Ke.isSkinnedMesh){ss.setOptional(de,Ke,"bindMatrix"),ss.setOptional(de,Ke,"bindMatrixInverse");const Gs=Ke.skeleton;Gs&&(Dt.floatVertexTextures?(null===Gs.boneTexture&&Gs.computeBoneTexture(),ss.setValue(de,"boneTexture",Gs.boneTexture,ht),ss.setValue(de,"boneTextureSize",Gs.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const kh=ke.morphAttributes;if((void 0!==kh.position||void 0!==kh.normal||void 0!==kh.color&&!0===Dt.isWebGL2)&&Ut.update(Ke,ke,Ro),($c||oi.receiveShadow!==Ke.receiveShadow)&&(oi.receiveShadow=Ke.receiveShadow,ss.setValue(de,"receiveShadow",Ke.receiveShadow)),ye.isMeshGouraudMaterial&&null!==ye.envMap&&(Gl.envMap.value=Wn,Gl.flipEnvMap.value=Wn.isCubeTexture&&!1===Wn.isRenderTargetTexture?-1:1),$c&&(ss.setValue(de,"toneMappingExposure",I.toneMappingExposure),oi.needsLights&&function pv(Q,be){Q.ambientLightColor.needsUpdate=be,Q.lightProbe.needsUpdate=be,Q.directionalLights.needsUpdate=be,Q.directionalLightShadows.needsUpdate=be,Q.pointLights.needsUpdate=be,Q.pointLightShadows.needsUpdate=be,Q.spotLights.needsUpdate=be,Q.spotLightShadows.needsUpdate=be,Q.rectAreaLights.needsUpdate=be,Q.hemisphereLights.needsUpdate=be}(Gl,Up),mn&&!0===ye.fog&&fi.refreshFogUniforms(Gl,mn),fi.refreshMaterialUniforms(Gl,ye,ve,Ge,Bt),Cu.upload(de,oi.uniformsList,Gl,ht)),ye.isShaderMaterial&&!0===ye.uniformsNeedUpdate&&(Cu.upload(de,oi.uniformsList,Gl,ht),ye.uniformsNeedUpdate=!1),ye.isSpriteMaterial&&ss.setValue(de,"center",Ke.center),ss.setValue(de,"modelViewMatrix",Ke.modelViewMatrix),ss.setValue(de,"normalMatrix",Ke.normalMatrix),ss.setValue(de,"modelMatrix",Ke.matrixWorld),ye.isShaderMaterial||ye.isRawShaderMaterial){const Gs=ye.uniformsGroups;for(let rd=0,a_=Gs.length;rd<a_;rd++)if(Dt.isWebGL2){const kp=Gs[rd];pn.update(kp,Ro),pn.bind(kp,Ro)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ro}(Q,be,ke,ye,Ke);tn.setMaterial(ye,yn);let Wn=ke.index,Zn=1;!0===ye.wireframe&&(Wn=Sn.getWireframeAttribute(ke),Zn=2);const Bn=ke.drawRange,ii=ke.attributes.position;let Di=Bn.start*Zn,ys=(Bn.start+Bn.count)*Zn;null!==mn&&(Di=Math.max(Di,mn.start*Zn),ys=Math.min(ys,(mn.start+mn.count)*Zn)),null!==Wn?(Di=Math.max(Di,0),ys=Math.min(ys,Wn.count)):null!=ii&&(Di=Math.max(Di,0),ys=Math.min(ys,ii.count));const Io=ys-Di;if(Io<0||Io===1/0)return;nn.setup(Ke,ye,Pn,ke,Wn);let Wc,fr=Tn;if(null!==Wn&&(Wc=En.get(Wn),fr=Xt,fr.setIndex(Wc)),Ke.isMesh)!0===ye.wireframe?(tn.setLineWidth(ye.wireframeLinewidth*Lt()),fr.setMode(de.LINES)):fr.setMode(de.TRIANGLES);else if(Ke.isLine){let oi=ye.linewidth;void 0===oi&&(oi=1),tn.setLineWidth(oi*Lt()),fr.setMode(Ke.isLineSegments?de.LINES:Ke.isLineLoop?de.LINE_LOOP:de.LINE_STRIP)}else Ke.isPoints?fr.setMode(de.POINTS):Ke.isSprite&&fr.setMode(de.TRIANGLES);if(Ke.isInstancedMesh)fr.renderInstances(Di,Io,Ke.count);else if(ke.isInstancedBufferGeometry){const Fp=Math.min(ke.instanceCount,void 0!==ke._maxInstanceCount?ke._maxInstanceCount:1/0);fr.renderInstances(Di,Io,Fp)}else fr.render(Di,Io)},this.compile=function(Q,be){function ke(ye,Ke,mn){!0===ye.transparent&&ye.side===zt&&!1===ye.forceSinglePass?(ye.side=Je,ye.needsUpdate=!0,id(ye,Ke,mn),ye.side=Le,ye.needsUpdate=!0,id(ye,Ke,mn),ye.side=zt):id(ye,Ke,mn)}R=j.get(Q),R.init(),P.push(R),Q.traverseVisible(function(ye){ye.isLight&&ye.layers.test(be.layers)&&(R.pushLight(ye),ye.castShadow&&R.pushShadow(ye))}),R.setupLights(I.useLegacyLights),Q.traverse(function(ye){const Ke=ye.material;if(Ke)if(Array.isArray(Ke))for(let mn=0;mn<Ke.length;mn++)ke(Ke[mn],Q,ye);else ke(Ke,Q,ye)}),P.pop(),R=null};let _t=null;function sn(){xi.stop()}function Li(){xi.start()}const xi=new ur;function hr(Q,be,ke,ye){if(!1===Q.visible)return;if(Q.layers.test(be.layers))if(Q.isGroup)ke=Q.renderOrder;else if(Q.isLOD)!0===Q.autoUpdate&&Q.update(be);else if(Q.isLight)R.pushLight(Q),Q.castShadow&&R.pushShadow(Q);else if(Q.isSprite){if(!Q.frustumCulled||dt.intersectsSprite(Q)){ye&&ct.setFromMatrixPosition(Q.matrixWorld).applyMatrix4(Ne);const yn=vn.update(Q),Pn=Q.material;Pn.visible&&D.push(Q,yn,Pn,ke,ct.z,null)}}else if((Q.isMesh||Q.isLine||Q.isPoints)&&(!Q.frustumCulled||dt.intersectsObject(Q))){Q.isSkinnedMesh&&Q.skeleton.frame!==mt.render.frame&&(Q.skeleton.update(),Q.skeleton.frame=mt.render.frame);const yn=vn.update(Q),Pn=Q.material;if(ye&&(null===yn.boundingSphere&&yn.computeBoundingSphere(),ct.copy(yn.boundingSphere.center).applyMatrix4(Q.matrixWorld).applyMatrix4(Ne)),Array.isArray(Pn)){const Wn=yn.groups;for(let Zn=0,Bn=Wn.length;Zn<Bn;Zn++){const ii=Wn[Zn],Di=Pn[ii.materialIndex];Di&&Di.visible&&D.push(Q,yn,Di,ke,ct.z,ii)}}else Pn.visible&&D.push(Q,yn,Pn,ke,ct.z,null)}const mn=Q.children;for(let yn=0,Pn=mn.length;yn<Pn;yn++)hr(mn[yn],be,ke,ye)}function il(Q,be,ke,ye){const Ke=Q.opaque,mn=Q.transmissive,yn=Q.transparent;R.setupLightsView(ke),!0===vt&&_e.setGlobalState(I.clippingPlanes,ke),mn.length>0&&function sr(Q,be,ke,ye){if(null===Bt){const Pn=Dt.isWebGL2;Bt=new to(1024,1024,{generateMipmaps:!0,type:fn.has("EXT_color_buffer_half_float")?qe:ue,minFilter:ce,samples:Pn&&!0===h?4:0})}const Ke=I.getRenderTarget();I.setRenderTarget(Bt),I.clear();const mn=I.toneMapping;I.toneMapping=Ji,fo(Q,ke,ye),ht.updateMultisampleRenderTarget(Bt),ht.updateRenderTargetMipmap(Bt);let yn=!1;for(let Pn=0,Wn=be.length;Pn<Wn;Pn++){const Zn=be[Pn],Bn=Zn.object,ii=Zn.geometry,Di=Zn.material,ys=Zn.group;if(Di.side===zt&&Bn.layers.test(ye.layers)){const Io=Di.side;Di.side=Je,Di.needsUpdate=!0,Ao(Bn,ke,ye,ii,Di,ys),Di.side=Io,Di.needsUpdate=!0,yn=!0}}!0===yn&&(ht.updateMultisampleRenderTarget(Bt),ht.updateRenderTargetMipmap(Bt)),I.setRenderTarget(Ke),I.toneMapping=mn}(Ke,mn,be,ke),ye&&tn.viewport(le.copy(ye)),Ke.length>0&&fo(Ke,be,ke),mn.length>0&&fo(mn,be,ke),yn.length>0&&fo(yn,be,ke),tn.buffers.depth.setTest(!0),tn.buffers.depth.setMask(!0),tn.buffers.color.setMask(!0),tn.setPolygonOffset(!1)}function fo(Q,be,ke){const ye=!0===be.isScene?be.overrideMaterial:null;for(let Ke=0,mn=Q.length;Ke<mn;Ke++){const yn=Q[Ke],Pn=yn.object,Wn=yn.geometry,Zn=null===ye?yn.material:ye,Bn=yn.group;Pn.layers.test(ke.layers)&&Ao(Pn,be,ke,Wn,Zn,Bn)}}function Ao(Q,be,ke,ye,Ke,mn){Q.onBeforeRender(I,be,ke,ye,Ke,mn),Q.modelViewMatrix.multiplyMatrices(ke.matrixWorldInverse,Q.matrixWorld),Q.normalMatrix.getNormalMatrix(Q.modelViewMatrix),Ke.onBeforeRender(I,be,ke,ye,Q,mn),!0===Ke.transparent&&Ke.side===zt&&!1===Ke.forceSinglePass?(Ke.side=Je,Ke.needsUpdate=!0,I.renderBufferDirect(ke,be,ye,Ke,Q,mn),Ke.side=Le,Ke.needsUpdate=!0,I.renderBufferDirect(ke,be,ye,Ke,Q,mn),Ke.side=zt):I.renderBufferDirect(ke,be,ye,Ke,Q,mn),Q.onAfterRender(I,be,ke,ye,Ke,mn)}function id(Q,be,ke){!0!==be.isScene&&(be=Pt);const ye=ze.get(Q),Ke=R.state.lights,yn=Ke.state.version,Pn=On.getParameters(Q,Ke.state,R.state.shadowsArray,be,ke),Wn=On.getProgramCacheKey(Pn);let Zn=ye.programs;ye.environment=Q.isMeshStandardMaterial?be.environment:null,ye.fog=be.fog,ye.envMap=(Q.isMeshStandardMaterial?Oe:Zt).get(Q.envMap||ye.environment),void 0===Zn&&(Q.addEventListener("dispose",rr),Zn=new Map,ye.programs=Zn);let Bn=Zn.get(Wn);if(void 0!==Bn){if(ye.currentProgram===Bn&&ye.lightsStateVersion===yn)return Op(Q,Pn),Bn}else Pn.uniforms=On.getUniforms(Q),Q.onBuild(ke,Pn,I),Q.onBeforeCompile(Pn,I),Bn=On.acquireProgram(Pn,Wn),Zn.set(Wn,Bn),ye.uniforms=Pn.uniforms;const ii=ye.uniforms;(!Q.isShaderMaterial&&!Q.isRawShaderMaterial||!0===Q.clipping)&&(ii.clippingPlanes=_e.uniform),Op(Q,Pn),ye.needsLights=function o_(Q){return Q.isMeshLambertMaterial||Q.isMeshToonMaterial||Q.isMeshPhongMaterial||Q.isMeshStandardMaterial||Q.isShadowMaterial||Q.isShaderMaterial&&!0===Q.lights}(Q),ye.lightsStateVersion=yn,ye.needsLights&&(ii.ambientLightColor.value=Ke.state.ambient,ii.lightProbe.value=Ke.state.probe,ii.directionalLights.value=Ke.state.directional,ii.directionalLightShadows.value=Ke.state.directionalShadow,ii.spotLights.value=Ke.state.spot,ii.spotLightShadows.value=Ke.state.spotShadow,ii.rectAreaLights.value=Ke.state.rectArea,ii.ltc_1.value=Ke.state.rectAreaLTC1,ii.ltc_2.value=Ke.state.rectAreaLTC2,ii.pointLights.value=Ke.state.point,ii.pointLightShadows.value=Ke.state.pointShadow,ii.hemisphereLights.value=Ke.state.hemi,ii.directionalShadowMap.value=Ke.state.directionalShadowMap,ii.directionalShadowMatrix.value=Ke.state.directionalShadowMatrix,ii.spotShadowMap.value=Ke.state.spotShadowMap,ii.spotLightMatrix.value=Ke.state.spotLightMatrix,ii.spotLightMap.value=Ke.state.spotLightMap,ii.pointShadowMap.value=Ke.state.pointShadowMap,ii.pointShadowMatrix.value=Ke.state.pointShadowMatrix);const Di=Bn.getUniforms(),ys=Cu.seqWithValue(Di.seq,ii);return ye.currentProgram=Bn,ye.uniformsList=ys,Bn}function Op(Q,be){const ke=ze.get(Q);ke.outputColorSpace=be.outputColorSpace,ke.instancing=be.instancing,ke.skinning=be.skinning,ke.morphTargets=be.morphTargets,ke.morphNormals=be.morphNormals,ke.morphColors=be.morphColors,ke.morphTargetsCount=be.morphTargetsCount,ke.numClippingPlanes=be.numClippingPlanes,ke.numIntersection=be.numClipIntersection,ke.vertexAlphas=be.vertexAlphas,ke.vertexTangents=be.vertexTangents,ke.toneMapping=be.toneMapping}xi.setAnimationLoop(function Vt(Q){_t&&_t(Q)}),typeof self<"u"&&xi.setContext(self),this.setAnimationLoop=function(Q){_t=Q,qt.setAnimationLoop(Q),null===Q?xi.stop():xi.start()},qt.addEventListener("sessionstart",sn),qt.addEventListener("sessionend",Li),this.render=function(Q,be){if(void 0===be||!0===be.isCamera){if(!0!==B){if(!0===Q.matrixWorldAutoUpdate&&Q.updateMatrixWorld(),null===be.parent&&!0===be.matrixWorldAutoUpdate&&be.updateMatrixWorld(),!0===qt.enabled&&!0===qt.isPresenting&&(!0===qt.cameraAutoUpdate&&qt.updateCamera(be),be=qt.getCamera()),!0===Q.isScene&&Q.onBeforeRender(I,Q,be,X),R=j.get(Q,P.length),R.init(),P.push(R),Ne.multiplyMatrices(be.projectionMatrix,be.matrixWorldInverse),dt.setFromProjectionMatrix(Ne),jt=this.localClippingEnabled,vt=_e.init(this.clippingPlanes,jt),D=ne.get(Q,O.length),D.init(),O.push(D),hr(Q,be,0,I.sortObjects),D.finish(),!0===I.sortObjects&&D.sort(we,Ie),!0===vt&&_e.beginShadows(),Mt.render(R.state.shadowsArray,Q,be),!0===vt&&_e.endShadows(),!0===this.info.autoReset&&this.info.reset(),xt.render(D,Q),R.setupLights(I.useLegacyLights),be.isArrayCamera){const ye=be.cameras;for(let Ke=0,mn=ye.length;Ke<mn;Ke++){const yn=ye[Ke];il(D,Q,yn,yn.viewport)}}else il(D,Q,be);null!==X&&(ht.updateMultisampleRenderTarget(X),ht.updateRenderTargetMipmap(X)),!0===Q.isScene&&Q.onAfterRender(I,Q,be),nn.resetDefaultState(),K=-1,re=null,P.pop(),R=P.length>0?P[P.length-1]:null,O.pop(),D=O.length>0?O[O.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return U},this.getActiveMipmapLevel=function(){return W},this.getRenderTarget=function(){return X},this.setRenderTargetTextures=function(Q,be,ke){ze.get(Q.texture).__webglTexture=be,ze.get(Q.depthTexture).__webglTexture=ke;const ye=ze.get(Q);ye.__hasExternalTextures=!0,ye.__hasExternalTextures&&(ye.__autoAllocateDepthBuffer=void 0===ke,ye.__autoAllocateDepthBuffer||!0===fn.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ye.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Q,be){const ke=ze.get(Q);ke.__webglFramebuffer=be,ke.__useDefaultFramebuffer=void 0===be},this.setRenderTarget=function(Q,be=0,ke=0){X=Q,U=be,W=ke;let ye=!0,Ke=null,mn=!1,yn=!1;if(Q){const Wn=ze.get(Q);void 0!==Wn.__useDefaultFramebuffer?(tn.bindFramebuffer(de.FRAMEBUFFER,null),ye=!1):void 0===Wn.__webglFramebuffer?ht.setupRenderTarget(Q):Wn.__hasExternalTextures&&ht.rebindTextures(Q,ze.get(Q.texture).__webglTexture,ze.get(Q.depthTexture).__webglTexture);const Zn=Q.texture;(Zn.isData3DTexture||Zn.isDataArrayTexture||Zn.isCompressedArrayTexture)&&(yn=!0);const Bn=ze.get(Q).__webglFramebuffer;Q.isWebGLCubeRenderTarget?(Ke=Bn[be],mn=!0):Ke=Dt.isWebGL2&&Q.samples>0&&!1===ht.useMultisampledRTT(Q)?ze.get(Q).__webglMultisampledFramebuffer:Bn,le.copy(Q.viewport),V.copy(Q.scissor),te=Q.scissorTest}else le.copy(lt).multiplyScalar(ve).floor(),V.copy(ot).multiplyScalar(ve).floor(),te=it;if(tn.bindFramebuffer(de.FRAMEBUFFER,Ke)&&Dt.drawBuffers&&ye&&tn.drawBuffers(Q,Ke),tn.viewport(le),tn.scissor(V),tn.setScissorTest(te),mn){const Wn=ze.get(Q.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_CUBE_MAP_POSITIVE_X+be,Wn.__webglTexture,ke)}else if(yn){const Wn=ze.get(Q.texture);de.framebufferTextureLayer(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,Wn.__webglTexture,ke||0,be||0)}K=-1},this.readRenderTargetPixels=function(Q,be,ke,ye,Ke,mn,yn){if(!Q||!Q.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Pn=ze.get(Q).__webglFramebuffer;if(Q.isWebGLCubeRenderTarget&&void 0!==yn&&(Pn=Pn[yn]),Pn){tn.bindFramebuffer(de.FRAMEBUFFER,Pn);try{const Wn=Q.texture,Zn=Wn.format,Bn=Wn.type;if(Zn!==gi&&He.convert(Zn)!==de.getParameter(de.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ii=Bn===qe&&(fn.has("EXT_color_buffer_half_float")||Dt.isWebGL2&&fn.has("EXT_color_buffer_float"));if(!(Bn===ue||He.convert(Bn)===de.getParameter(de.IMPLEMENTATION_COLOR_READ_TYPE)||Bn===Qe&&(Dt.isWebGL2||fn.has("OES_texture_float")||fn.has("WEBGL_color_buffer_float"))||ii))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");be>=0&&be<=Q.width-ye&&ke>=0&&ke<=Q.height-Ke&&de.readPixels(be,ke,ye,Ke,He.convert(Zn),He.convert(Bn),mn)}finally{const Wn=null!==X?ze.get(X).__webglFramebuffer:null;tn.bindFramebuffer(de.FRAMEBUFFER,Wn)}}},this.copyFramebufferToTexture=function(Q,be,ke=0){const ye=Math.pow(2,-ke),Ke=Math.floor(be.image.width*ye),mn=Math.floor(be.image.height*ye);ht.setTexture2D(be,0),de.copyTexSubImage2D(de.TEXTURE_2D,ke,0,0,Q.x,Q.y,Ke,mn),tn.unbindTexture()},this.copyTextureToTexture=function(Q,be,ke,ye=0){const Ke=be.image.width,mn=be.image.height,yn=He.convert(ke.format),Pn=He.convert(ke.type);ht.setTexture2D(ke,0),de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,ke.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ke.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,ke.unpackAlignment),be.isDataTexture?de.texSubImage2D(de.TEXTURE_2D,ye,Q.x,Q.y,Ke,mn,yn,Pn,be.image.data):be.isCompressedTexture?de.compressedTexSubImage2D(de.TEXTURE_2D,ye,Q.x,Q.y,be.mipmaps[0].width,be.mipmaps[0].height,yn,be.mipmaps[0].data):de.texSubImage2D(de.TEXTURE_2D,ye,Q.x,Q.y,yn,Pn,be.image),0===ye&&ke.generateMipmaps&&de.generateMipmap(de.TEXTURE_2D),tn.unbindTexture()},this.copyTextureToTexture3D=function(Q,be,ke,ye,Ke=0){if(I.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const mn=Q.max.x-Q.min.x+1,yn=Q.max.y-Q.min.y+1,Pn=Q.max.z-Q.min.z+1,Wn=He.convert(ye.format),Zn=He.convert(ye.type);let Bn;if(ye.isData3DTexture)ht.setTexture3D(ye,0),Bn=de.TEXTURE_3D;else{if(!ye.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ht.setTexture2DArray(ye,0),Bn=de.TEXTURE_2D_ARRAY}de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,ye.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ye.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,ye.unpackAlignment);const ii=de.getParameter(de.UNPACK_ROW_LENGTH),Di=de.getParameter(de.UNPACK_IMAGE_HEIGHT),ys=de.getParameter(de.UNPACK_SKIP_PIXELS),Io=de.getParameter(de.UNPACK_SKIP_ROWS),Wc=de.getParameter(de.UNPACK_SKIP_IMAGES),fr=ke.isCompressedTexture?ke.mipmaps[0]:ke.image;de.pixelStorei(de.UNPACK_ROW_LENGTH,fr.width),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,fr.height),de.pixelStorei(de.UNPACK_SKIP_PIXELS,Q.min.x),de.pixelStorei(de.UNPACK_SKIP_ROWS,Q.min.y),de.pixelStorei(de.UNPACK_SKIP_IMAGES,Q.min.z),ke.isDataTexture||ke.isData3DTexture?de.texSubImage3D(Bn,Ke,be.x,be.y,be.z,mn,yn,Pn,Wn,Zn,fr.data):ke.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),de.compressedTexSubImage3D(Bn,Ke,be.x,be.y,be.z,mn,yn,Pn,Wn,fr.data)):de.texSubImage3D(Bn,Ke,be.x,be.y,be.z,mn,yn,Pn,Wn,Zn,fr),de.pixelStorei(de.UNPACK_ROW_LENGTH,ii),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,Di),de.pixelStorei(de.UNPACK_SKIP_PIXELS,ys),de.pixelStorei(de.UNPACK_SKIP_ROWS,Io),de.pixelStorei(de.UNPACK_SKIP_IMAGES,Wc),0===Ke&&ye.generateMipmaps&&de.generateMipmap(Bn),tn.unbindTexture()},this.initTexture=function(Q){Q.isCubeTexture?ht.setTextureCube(Q,0):Q.isData3DTexture?ht.setTexture3D(Q,0):Q.isDataArrayTexture||Q.isCompressedArrayTexture?ht.setTexture2DArray(Q,0):ht.setTexture2D(Q,0),tn.unbindTexture()},this.resetState=function(){U=0,W=0,X=null,tn.reset(),nn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===_n?ln:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===ln?_n:ki}}(class NM extends rg{}).prototype.isWebGL1Renderer=!0;class Zd extends ws{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class up extends ml{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ht(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vr,this.normalScale=new et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function uo(c,e,t){return fp(c)?new c.constructor(c.subarray(e,void 0!==t?t:c.length)):c.slice(e,t)}function Ul(c,e,t){return!c||!t&&c.constructor===e?c:"number"==typeof e.BYTES_PER_ELEMENT?new e(c):Array.prototype.slice.call(c)}function fp(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}class pp{constructor(e,t,s,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==o?o:new t.constructor(s),this.sampleValues=t,this.valueSize=s,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let s=this._cachedIndex,o=t[s],l=t[s-1];e:{t:{let d;n:{i:if(!(e<o)){for(let h=s+2;;){if(void 0===o){if(e<l)break i;return s=t.length,this._cachedIndex=s,this.copySampleValue_(s-1)}if(s===h)break;if(l=o,o=t[++s],e<o)break t}d=t.length;break n}if(e>=l)break e;{const h=t[1];e<h&&(s=2,l=h);for(let p=s-2;;){if(void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(s===p)break;if(o=l,l=t[--s-1],e>=l)break t}d=s,s=0}}for(;s<d;){const h=s+d>>>1;e<t[h]?d=h:s=h+1}if(o=t[s],l=t[s-1],void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===o)return s=t.length,this._cachedIndex=s,this.copySampleValue_(s-1)}this._cachedIndex=s,this.intervalChanged_(s,l,o)}return this.interpolate_(s,l,e,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,s=this.sampleValues,o=this.valueSize,l=e*o;for(let d=0;d!==o;++d)t[d]=s[l+d];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Mh extends pp{constructor(e,t,s,o){super(e,t,s,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,s){const o=this.parameterPositions;let l=e-2,d=e+1,h=o[l],p=o[d];if(void 0===h)switch(this.getSettings_().endingStart){case 2401:l=e,h=2*t-s;break;case 2402:l=o.length-2,h=t+o[l]-o[l+1];break;default:l=e,h=s}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:d=e,p=2*s-t;break;case 2402:d=1,p=s+o[1]-o[0];break;default:d=e-1,p=t}const m=.5*(s-t),_=this.valueSize;this._weightPrev=m/(t-h),this._weightNext=m/(p-s),this._offsetPrev=l*_,this._offsetNext=d*_}interpolate_(e,t,s,o){const l=this.resultBuffer,d=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,_=this._offsetPrev,S=this._offsetNext,b=this._weightPrev,D=this._weightNext,R=(s-t)/(o-t),O=R*R,P=O*R,I=-b*P+2*b*O-b*R,B=(1+b)*P+(-1.5-2*b)*O+(-.5+b)*R+1,U=(-1-D)*P+(1.5+D)*O+.5*R,W=D*P-D*O;for(let X=0;X!==h;++X)l[X]=I*d[_+X]+B*d[m+X]+U*d[p+X]+W*d[S+X];return l}}class Fg extends pp{constructor(e,t,s,o){super(e,t,s,o)}interpolate_(e,t,s,o){const l=this.resultBuffer,d=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,_=(s-t)/(o-t),S=1-_;for(let b=0;b!==h;++b)l[b]=d[m+b]*S+d[p+b]*_;return l}}class A0 extends pp{constructor(e,t,s,o){super(e,t,s,o)}interpolate_(e){return this.copySampleValue_(e-1)}}class ho{constructor(e,t,s,o){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ul(t,this.TimeBufferType),this.values=Ul(s,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let s;if(t.toJSON!==this.toJSON)s=t.toJSON(e);else{s={name:e.name,times:Ul(e.times,Array),values:Ul(e.values,Array)};const o=e.getInterpolation();o!==e.DefaultInterpolation&&(s.interpolation=o)}return s.type=e.ValueTypeName,s}InterpolantFactoryMethodDiscrete(e){return new A0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Fg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Mh(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const s="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(s);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",s),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let s=0,o=t.length;s!==o;++s)t[s]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let s=0,o=t.length;s!==o;++s)t[s]*=e}return this}trim(e,t){const s=this.times,o=s.length;let l=0,d=o-1;for(;l!==o&&s[l]<e;)++l;for(;-1!==d&&s[d]>t;)--d;if(++d,0!==l||d!==o){l>=d&&(d=Math.max(d,1),l=d-1);const h=this.getValueSize();this.times=uo(s,l,d),this.values=uo(this.values,l*h,d*h)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const s=this.times,o=this.values,l=s.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let d=null;for(let h=0;h!==l;h++){const p=s[h];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,p),e=!1;break}if(null!==d&&d>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,p,d),e=!1;break}d=p}if(void 0!==o&&fp(o))for(let h=0,p=o.length;h!==p;++h){const m=o[h];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,m),e=!1;break}}return e}optimize(){const e=uo(this.times),t=uo(this.values),s=this.getValueSize(),o=2302===this.getInterpolation(),l=e.length-1;let d=1;for(let h=1;h<l;++h){let p=!1;const m=e[h];if(m!==e[h+1]&&(1!==h||m!==e[0]))if(o)p=!0;else{const S=h*s,b=S-s,D=S+s;for(let R=0;R!==s;++R){const O=t[S+R];if(O!==t[b+R]||O!==t[D+R]){p=!0;break}}}if(p){if(h!==d){e[d]=e[h];const S=h*s,b=d*s;for(let D=0;D!==s;++D)t[b+D]=t[S+D]}++d}}if(l>0){e[d]=e[l];for(let h=l*s,p=d*s,m=0;m!==s;++m)t[p+m]=t[h+m];++d}return d!==e.length?(this.times=uo(e,0,d),this.values=uo(t,0,d*s)):(this.times=e,this.values=t),this}clone(){const e=uo(this.times,0),t=uo(this.values,0),o=new(0,this.constructor)(this.name,e,t);return o.createInterpolant=this.createInterpolant,o}}ho.prototype.TimeBufferType=Float32Array,ho.prototype.ValueBufferType=Float32Array,ho.prototype.DefaultInterpolation=2301;class Oc extends ho{}Oc.prototype.ValueTypeName="bool",Oc.prototype.ValueBufferType=Array,Oc.prototype.DefaultInterpolation=2300,Oc.prototype.InterpolantFactoryMethodLinear=void 0,Oc.prototype.InterpolantFactoryMethodSmooth=void 0;(class bo extends ho{}).prototype.ValueTypeName="color";(class el extends ho{}).prototype.ValueTypeName="number";class rs extends pp{constructor(e,t,s,o){super(e,t,s,o)}interpolate_(e,t,s,o){const l=this.resultBuffer,d=this.sampleValues,h=this.valueSize,p=(s-t)/(o-t);let m=e*h;for(let _=m+h;m!==_;m+=4)Zr.slerpFlat(l,0,d,m-h,d,m,p);return l}}class wo extends ho{InterpolantFactoryMethodLinear(e){return new rs(this.times,this.values,this.getValueSize(),e)}}wo.prototype.ValueTypeName="quaternion",wo.prototype.DefaultInterpolation=2301,wo.prototype.InterpolantFactoryMethodSmooth=void 0;class Da extends ho{}Da.prototype.ValueTypeName="string",Da.prototype.ValueBufferType=Array,Da.prototype.DefaultInterpolation=2300,Da.prototype.InterpolantFactoryMethodLinear=void 0,Da.prototype.InterpolantFactoryMethodSmooth=void 0;(class vs extends ho{}).prototype.ValueTypeName="vector";const To={enabled:!1,files:{},add:function(c,e){!1!==this.enabled&&(this.files[c]=e)},get:function(c){if(!1!==this.enabled)return this.files[c]},remove:function(c){delete this.files[c]},clear:function(){this.files={}}};class kl{constructor(e,t,s){const o=this;let p,l=!1,d=0,h=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=s,this.itemStart=function(_){h++,!1===l&&void 0!==o.onStart&&o.onStart(_,d,h),l=!0},this.itemEnd=function(_){d++,void 0!==o.onProgress&&o.onProgress(_,d,h),d===h&&(l=!1,void 0!==o.onLoad&&o.onLoad())},this.itemError=function(_){void 0!==o.onError&&o.onError(_)},this.resolveURL=function(_){return p?p(_):_},this.setURLModifier=function(_){return p=_,this},this.addHandler=function(_,S){return m.push(_,S),this},this.removeHandler=function(_){const S=m.indexOf(_);return-1!==S&&m.splice(S,2),this},this.getHandler=function(_){for(let S=0,b=m.length;S<b;S+=2){const D=m[S],R=m[S+1];if(D.global&&(D.lastIndex=0),D.test(_))return R}return null}}}const Bc=new kl;class Bl{constructor(e){this.manager=void 0!==e?e:Bc,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const s=this;return new Promise(function(o,l){s.load(e,o,t,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}class Hc extends Error{constructor(e,t){super(e),this.response=t}}class Zu extends Bl{constructor(e){super(e)}load(e,t,s,o){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,d=To.get(e);if(void 0!==d)return l.manager.itemStart(e),setTimeout(function(){t&&t(d),l.manager.itemEnd(e)},0),d;const h=Wo("img");function p(){_(),To.add(e,this),t&&t(this),l.manager.itemEnd(e)}function m(S){_(),o&&o(S),l.manager.itemError(e),l.manager.itemEnd(e)}function _(){h.removeEventListener("load",p,!1),h.removeEventListener("error",m,!1)}return h.addEventListener("load",p,!1),h.addEventListener("error",m,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(h.crossOrigin=this.crossOrigin),l.manager.itemStart(e),h.src=e,h}}class Ug extends Bl{constructor(e){super(e)}load(e,t,s,o){const l=new eo,d=new Zu(this.manager);return d.setCrossOrigin(this.crossOrigin),d.setPath(this.path),d.load(e,function(h){l.image=h,l.needsUpdate=!0,void 0!==t&&t(l)},s,o),l}}class mp extends ws{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ht(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const xh=new Nt,Eh=new J,Bg=new J;class N0{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new et(512,512),this.map=null,this.mapPass=null,this.matrix=new Nt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Yp,this._frameExtents=new et(1,1),this._viewportCount=1,this._viewports=[new vi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,s=this.matrix;Eh.setFromMatrixPosition(e.matrixWorld),t.position.copy(Eh),Bg.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Bg),t.updateMatrixWorld(),xh.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(xh),s.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),s.multiply(xh)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const Hg=new Nt,Sh=new J,gp=new J;class $M extends N0{constructor(){super(new Sr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new et(4,2),this._viewportCount=6,this._viewports=[new vi(2,1,1,1),new vi(0,1,1,1),new vi(3,1,1,1),new vi(1,1,1,1),new vi(3,0,1,1),new vi(1,0,1,1)],this._cubeDirections=[new J(1,0,0),new J(-1,0,0),new J(0,0,1),new J(0,0,-1),new J(0,1,0),new J(0,-1,0)],this._cubeUps=[new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,0,1),new J(0,0,-1)]}updateMatrices(e,t=0){const s=this.camera,o=this.matrix,l=e.distance||s.far;l!==s.far&&(s.far=l,s.updateProjectionMatrix()),Sh.setFromMatrixPosition(e.matrixWorld),s.position.copy(Sh),gp.copy(s.position),gp.add(this._cubeDirections[t]),s.up.copy(this._cubeUps[t]),s.lookAt(gp),s.updateMatrixWorld(),o.makeTranslation(-Sh.x,-Sh.y,-Sh.z),Hg.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Hg)}}class zg extends mp{constructor(e,t,s=0,o=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=s,this.decay=o,this.shadow=new $M}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class F0 extends N0{constructor(){super(new Ml(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Vg extends mp{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ws.DEFAULT_UP),this.updateMatrix(),this.target=new ws,this.shadow=new F0}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Xg{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Yg(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Yg();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Yg(){return(typeof performance>"u"?Date:performance).now()}const Ah="\\[\\]\\.:\\/",H0=new RegExp("["+Ah+"]","g"),wp="[^"+Ah+"]",z0="[^"+Ah.replace("\\.","")+"]",V0=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",wp)+/(WCOD+)?/.source.replace("WCOD",z0)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",wp)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",wp)+"$"),G0=["material","materials","bones","map"];class Jg{constructor(e,t,s){const o=s||Pi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,o)}getValue(e,t){this.bind();const o=this._bindings[this._targetGroup.nCachedObjects_];void 0!==o&&o.getValue(e,t)}setValue(e,t){const s=this._bindings;for(let o=this._targetGroup.nCachedObjects_,l=s.length;o!==l;++o)s[o].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,s=e.length;t!==s;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,s=e.length;t!==s;++t)e[t].unbind()}}let Pi=(()=>{class c{constructor(t,s,o){this.path=s,this.parsedPath=o||c.parseTrackName(s),this.node=c.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,s,o){return t&&t.isAnimationObjectGroup?new c.Composite(t,s,o):new c(t,s,o)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(H0,"")}static parseTrackName(t){const s=V0.exec(t);if(null===s)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const o={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]},l=o.nodeName&&o.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const d=o.nodeName.substring(l+1);-1!==G0.indexOf(d)&&(o.nodeName=o.nodeName.substring(0,l),o.objectName=d)}if(null===o.propertyName||0===o.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return o}static findNode(t,s){if(void 0===s||""===s||"."===s||-1===s||s===t.name||s===t.uuid)return t;if(t.skeleton){const o=t.skeleton.getBoneByName(s);if(void 0!==o)return o}if(t.children){const o=function(d){for(let h=0;h<d.length;h++){const p=d[h];if(p.name===s||p.uuid===s)return p;const m=o(p.children);if(m)return m}return null},l=o(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,s){t[s]=this.targetObject[this.propertyName]}_getValue_array(t,s){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)t[s++]=o[l]}_getValue_arrayElement(t,s){t[s]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,s){this.resolvedProperty.toArray(t,s)}_setValue_direct(t,s){this.targetObject[this.propertyName]=t[s]}_setValue_direct_setNeedsUpdate(t,s){this.targetObject[this.propertyName]=t[s],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,s){this.targetObject[this.propertyName]=t[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,s){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=t[s++]}_setValue_array_setNeedsUpdate(t,s){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=t[s++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,s){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=t[s++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,s){this.resolvedProperty[this.propertyIndex]=t[s]}_setValue_arrayElement_setNeedsUpdate(t,s){this.resolvedProperty[this.propertyIndex]=t[s],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,s){this.resolvedProperty[this.propertyIndex]=t[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,s){this.resolvedProperty.fromArray(t,s)}_setValue_fromArray_setNeedsUpdate(t,s){this.resolvedProperty.fromArray(t,s),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,s){this.resolvedProperty.fromArray(t,s),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,s){this.bind(),this.getValue(t,s)}_setValue_unbound(t,s){this.bind(),this.setValue(t,s)}bind(){let t=this.node;const s=this.parsedPath,o=s.objectName,l=s.propertyName;let d=s.propertyIndex;if(t||(t=c.findNode(this.rootNode,s.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(o){let _=s.objectIndex;switch(o){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let S=0;S<t.length;S++)if(t[S].name===_){_=S;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[o])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[o]}if(void 0!==_){if(void 0===t[_])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[_]}}const h=t[l];if(void 0===h)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+s.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==d){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[d]&&(d=t.morphTargetDictionary[d])}m=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=d}else void 0!==h.fromArray&&void 0!==h.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(m=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return c.Composite=Jg,c})();Pi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Pi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Pi.prototype.GetterByBindingType=[Pi.prototype._getValue_direct,Pi.prototype._getValue_array,Pi.prototype._getValue_arrayElement,Pi.prototype._getValue_toArray],Pi.prototype.SetterByBindingTypeAndVersioning=[[Pi.prototype._setValue_direct,Pi.prototype._setValue_direct_setNeedsUpdate,Pi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Pi.prototype._setValue_array,Pi.prototype._setValue_array_setNeedsUpdate,Pi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Pi.prototype._setValue_arrayElement,Pi.prototype._setValue_arrayElement_setNeedsUpdate,Pi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Pi.prototype._setValue_fromArray,Pi.prototype._setValue_fromArray_setNeedsUpdate,Pi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"152"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="152");const i_=["rendererContainer"];let uv=(()=>{class c{constructor(t){this.renderer2=t,this.portalParticles=[],this.smokeParticles=[]}ngAfterViewInit(){this.initScene()}initScene(){this.scene=new Zd,this.sceneLight=new Vg(8174700,.5),this.sceneLight.position.set(0,0,1),this.scene.add(this.sceneLight),this.portalLight=new zg(1797920,30,600,1.7),this.portalLight.position.set(0,0,250),this.scene.add(this.portalLight),this.cam=new Sr(80,1.2,1,1e4),this.cam.position.z=1e3,this.scene.add(this.cam),this.renderer=new rg,this.renderer.setClearColor(0,0),this.renderer.setSize(500,500),this.rendererContainer&&this.renderer2.appendChild(this.rendererContainer.nativeElement,this.renderer.domElement),this.particleSetup()}particleSetup(){(new Ug).load("./assets/smoke.png",s=>{let o=new Ko(350,350),l=new up({map:s,transparent:!0}),d=new Ko(1e3,1e3),h=new up({map:s,transparent:!0});for(let p=880;p>250;p--){let m=new es(o,l);m.position.set(.5*p*Math.cos(4*p*Math.PI/180),.5*p*Math.sin(4*p*Math.PI/180),.1*p),m.rotation.z=360*Math.random(),this.portalParticles.push(m),this.scene?.add(m)}for(let p=0;p<40;p++){let m=new es(d,h);m.position.set(1e3*Math.random()-500,400*Math.random()-200,25),m.rotation.z=360*Math.random(),m.material.opacity=.6,this.portalParticles.push(m),this.scene?.add(m)}this.clock=new Xg,this.animate()})}animate(){let t=this.clock?.getDelta()||0;this.portalParticles.forEach(s=>{s.rotation.z-=1.5*t}),this.smokeParticles.forEach(s=>{s.rotation.z-=.2*t}),Math.random()>.9&&this.portalLight&&(this.portalLight.power=350+500*Math.random()),this.cam&&this.renderer&&this.scene&&this.renderer?.render(this.scene,this.cam),requestAnimationFrame(()=>this.animate())}ngOnDestroy(){this.rendererContainer&&this.renderer2.removeChild(this.rendererContainer.nativeElement,this.renderer?.domElement)}}return c.\u0275fac=function(t){return new(t||c)(x.Y36(x.Qsj))},c.\u0275cmp=x.Xpm({type:c,selectors:[["app-rick-portal"]],viewQuery:function(t,s){if(1&t&&x.Gf(i_,5),2&t){let o;x.iGM(o=x.CRH())&&(s.rendererContainer=o.first)}},standalone:!0,features:[x.jDz],decls:2,vars:0,consts:[[1,"render-container"],["rendererContainer",""]],template:function(t,s){1&t&&x._UZ(0,"div",0,1)},dependencies:[Pe.ez],styles:[".render-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}"],changeDetection:0}),c})();var dv=$(7905);function Uh(c,e){1&c&&x._UZ(0,"app-rick-portal")}const hv=[{path:"characters",loadComponent:()=>Promise.all([$.e(592),$.e(438)]).then($.bind($,4438)).then(c=>c.CharacterComponent)},{path:"locations",loadComponent:()=>Promise.all([$.e(592),$.e(778)]).then($.bind($,7778)).then(c=>c.LocationComponent)},{path:"episodes",loadComponent:()=>Promise.all([$.e(592),$.e(5)]).then($.bind($,2005)).then(c=>c.EpisodeComponent)},{path:"favorites",loadComponent:()=>$.e(47).then($.bind($,5047)).then(c=>c.FavoriteComponent)},{path:"statistics",loadComponent:()=>$.e(16).then($.bind($,1016)).then(c=>c.StatisticsComponent)},{path:"",loadComponent:()=>$.e(263).then($.bind($,8263)).then(c=>c.HomeComponent)}];(0,ut.Cg)((()=>{class c{constructor(t){this.loaderSvc=t,this.isLoader=this.loaderSvc.isLoading$}}return c.\u0275fac=function(t){return new(t||c)(x.Y36(dv.D))},c.\u0275cmp=x.Xpm({type:c,selectors:[["app-root"]],standalone:!0,features:[x.jDz],decls:5,vars:1,consts:[[1,"application-content"],[4,"ngIf"]],template:function(t,s){1&t&&(x._UZ(0,"app-header"),x.TgZ(1,"div",0),x.YNc(2,Uh,1,0,"app-rick-portal",1),x._UZ(3,"router-outlet"),x.qZA(),x._UZ(4,"app-footer")),2&t&&(x.xp6(2),x.Q6J("ngIf",s.isLoader()))},dependencies:[Pe.ez,Pe.O5,pe.lC,Ve,me,Et.JF,uv],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1}.application-content[_ngcontent-%COMP%]{flex:1}.white-text[_ngcontent-%COMP%]{color:#fff}"],changeDetection:0}),c})(),{providers:[(0,x.RIp)(ut.b2,(()=>{class c{}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=x.oAB({type:c}),c.\u0275inj=x.cJS({imports:[pe.Bz.forRoot(hv),pe.Bz]}),c})())]}).catch(c=>console.error(c))},9751:(Jt,$e,$)=>{$.d($e,{y:()=>Et});var x=$(930),pe=$(727),Pe=$(8822),Ve=$(9635),Ce=$(2416),Te=$(576),at=$(2806);let Et=(()=>{class We{constructor(pt){pt&&(this._subscribe=pt)}lift(pt){const Wt=new We;return Wt.source=this,Wt.operator=pt,Wt}subscribe(pt,Wt,Ln){const St=function me(We){return We&&We instanceof x.Lv||function tt(We){return We&&(0,Te.m)(We.next)&&(0,Te.m)(We.error)&&(0,Te.m)(We.complete)}(We)&&(0,pe.Nn)(We)}(pt)?pt:new x.Hp(pt,Wt,Ln);return(0,at.x)(()=>{const{operator:In,source:Jn}=this;St.add(In?In.call(St,Jn):Jn?this._subscribe(St):this._trySubscribe(St))}),St}_trySubscribe(pt){try{return this._subscribe(pt)}catch(Wt){pt.error(Wt)}}forEach(pt,Wt){return new(Wt=ut(Wt))((Ln,St)=>{const In=new x.Hp({next:Jn=>{try{pt(Jn)}catch(ui){St(ui),In.unsubscribe()}},error:St,complete:Ln});this.subscribe(In)})}_subscribe(pt){var Wt;return null===(Wt=this.source)||void 0===Wt?void 0:Wt.subscribe(pt)}[Pe.L](){return this}pipe(...pt){return(0,Ve.U)(pt)(this)}toPromise(pt){return new(pt=ut(pt))((Wt,Ln)=>{let St;this.subscribe(In=>St=In,In=>Ln(In),()=>Wt(St))})}}return We.create=wt=>new We(wt),We})();function ut(We){var wt;return null!==(wt=We??Ce.config.Promise)&&void 0!==wt?wt:Promise}},7579:(Jt,$e,$)=>{$.d($e,{x:()=>at});var x=$(9751),pe=$(727);const Ve=(0,$(3888).d)(ut=>function(){ut(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ce=$(8737),Te=$(2806);let at=(()=>{class ut extends x.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(me){const We=new Et(this,this);return We.operator=me,We}_throwIfClosed(){if(this.closed)throw new Ve}next(me){(0,Te.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const We of this.currentObservers)We.next(me)}})}error(me){(0,Te.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=me;const{observers:We}=this;for(;We.length;)We.shift().error(me)}})}complete(){(0,Te.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:me}=this;for(;me.length;)me.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var me;return(null===(me=this.observers)||void 0===me?void 0:me.length)>0}_trySubscribe(me){return this._throwIfClosed(),super._trySubscribe(me)}_subscribe(me){return this._throwIfClosed(),this._checkFinalizedStatuses(me),this._innerSubscribe(me)}_innerSubscribe(me){const{hasError:We,isStopped:wt,observers:pt}=this;return We||wt?pe.Lc:(this.currentObservers=null,pt.push(me),new pe.w0(()=>{this.currentObservers=null,(0,Ce.P)(pt,me)}))}_checkFinalizedStatuses(me){const{hasError:We,thrownError:wt,isStopped:pt}=this;We?me.error(wt):pt&&me.complete()}asObservable(){const me=new x.y;return me.source=this,me}}return ut.create=(tt,me)=>new Et(tt,me),ut})();class Et extends at{constructor(tt,me){super(),this.destination=tt,this.source=me}next(tt){var me,We;null===(We=null===(me=this.destination)||void 0===me?void 0:me.next)||void 0===We||We.call(me,tt)}error(tt){var me,We;null===(We=null===(me=this.destination)||void 0===me?void 0:me.error)||void 0===We||We.call(me,tt)}complete(){var tt,me;null===(me=null===(tt=this.destination)||void 0===tt?void 0:tt.complete)||void 0===me||me.call(tt)}_subscribe(tt){var me,We;return null!==(We=null===(me=this.source)||void 0===me?void 0:me.subscribe(tt))&&void 0!==We?We:pe.Lc}}},930:(Jt,$e,$)=>{$.d($e,{Hp:()=>Ln,Lv:()=>We});var x=$(576),pe=$(727),Pe=$(2416),Ve=$(7849),Ce=$(5032);const Te=ut("C",void 0,void 0);function ut(Ot,Me,Ft){return{kind:Ot,value:Me,error:Ft}}var tt=$(3410),me=$(2806);class We extends pe.w0{constructor(Me){super(),this.isStopped=!1,Me?(this.destination=Me,(0,pe.Nn)(Me)&&Me.add(this)):this.destination=ui}static create(Me,Ft,je){return new Ln(Me,Ft,je)}next(Me){this.isStopped?Jn(function Et(Ot){return ut("N",Ot,void 0)}(Me),this):this._next(Me)}error(Me){this.isStopped?Jn(function at(Ot){return ut("E",void 0,Ot)}(Me),this):(this.isStopped=!0,this._error(Me))}complete(){this.isStopped?Jn(Te,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Me){this.destination.next(Me)}_error(Me){try{this.destination.error(Me)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const wt=Function.prototype.bind;function pt(Ot,Me){return wt.call(Ot,Me)}class Wt{constructor(Me){this.partialObserver=Me}next(Me){const{partialObserver:Ft}=this;if(Ft.next)try{Ft.next(Me)}catch(je){St(je)}}error(Me){const{partialObserver:Ft}=this;if(Ft.error)try{Ft.error(Me)}catch(je){St(je)}else St(Me)}complete(){const{partialObserver:Me}=this;if(Me.complete)try{Me.complete()}catch(Ft){St(Ft)}}}class Ln extends We{constructor(Me,Ft,je){let Le;if(super(),(0,x.m)(Me)||!Me)Le={next:Me??void 0,error:Ft??void 0,complete:je??void 0};else{let Je;this&&Pe.config.useDeprecatedNextContext?(Je=Object.create(Me),Je.unsubscribe=()=>this.unsubscribe(),Le={next:Me.next&&pt(Me.next,Je),error:Me.error&&pt(Me.error,Je),complete:Me.complete&&pt(Me.complete,Je)}):Le=Me}this.destination=new Wt(Le)}}function St(Ot){Pe.config.useDeprecatedSynchronousErrorHandling?(0,me.O)(Ot):(0,Ve.h)(Ot)}function Jn(Ot,Me){const{onStoppedNotification:Ft}=Pe.config;Ft&&tt.z.setTimeout(()=>Ft(Ot,Me))}const ui={closed:!0,next:Ce.Z,error:function In(Ot){throw Ot},complete:Ce.Z}},727:(Jt,$e,$)=>{$.d($e,{Lc:()=>Te,w0:()=>Ce,Nn:()=>at});var x=$(576);const Pe=(0,$(3888).d)(ut=>function(me){ut(this),this.message=me?`${me.length} errors occurred during unsubscription:\n${me.map((We,wt)=>`${wt+1}) ${We.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=me});var Ve=$(8737);class Ce{constructor(tt){this.initialTeardown=tt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let tt;if(!this.closed){this.closed=!0;const{_parentage:me}=this;if(me)if(this._parentage=null,Array.isArray(me))for(const pt of me)pt.remove(this);else me.remove(this);const{initialTeardown:We}=this;if((0,x.m)(We))try{We()}catch(pt){tt=pt instanceof Pe?pt.errors:[pt]}const{_finalizers:wt}=this;if(wt){this._finalizers=null;for(const pt of wt)try{Et(pt)}catch(Wt){tt=tt??[],Wt instanceof Pe?tt=[...tt,...Wt.errors]:tt.push(Wt)}}if(tt)throw new Pe(tt)}}add(tt){var me;if(tt&&tt!==this)if(this.closed)Et(tt);else{if(tt instanceof Ce){if(tt.closed||tt._hasParent(this))return;tt._addParent(this)}(this._finalizers=null!==(me=this._finalizers)&&void 0!==me?me:[]).push(tt)}}_hasParent(tt){const{_parentage:me}=this;return me===tt||Array.isArray(me)&&me.includes(tt)}_addParent(tt){const{_parentage:me}=this;this._parentage=Array.isArray(me)?(me.push(tt),me):me?[me,tt]:tt}_removeParent(tt){const{_parentage:me}=this;me===tt?this._parentage=null:Array.isArray(me)&&(0,Ve.P)(me,tt)}remove(tt){const{_finalizers:me}=this;me&&(0,Ve.P)(me,tt),tt instanceof Ce&&tt._removeParent(this)}}Ce.EMPTY=(()=>{const ut=new Ce;return ut.closed=!0,ut})();const Te=Ce.EMPTY;function at(ut){return ut instanceof Ce||ut&&"closed"in ut&&(0,x.m)(ut.remove)&&(0,x.m)(ut.add)&&(0,x.m)(ut.unsubscribe)}function Et(ut){(0,x.m)(ut)?ut():ut.unsubscribe()}},2416:(Jt,$e,$)=>{$.d($e,{config:()=>x});const x={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},7272:(Jt,$e,$)=>{$.d($e,{z:()=>Ce});var x=$(8189),Pe=$(3269),Ve=$(2076);function Ce(...Te){return function pe(){return(0,x.J)(1)}()((0,Ve.D)(Te,(0,Pe.yG)(Te)))}},515:(Jt,$e,$)=>{$.d($e,{E:()=>pe});const pe=new($(9751).y)(Ce=>Ce.complete())},2076:(Jt,$e,$)=>{$.d($e,{D:()=>je});var x=$(8421),pe=$(9672),Pe=$(4482),Ve=$(5403);function Ce(Le,Je=0){return(0,Pe.e)((zt,Tt)=>{zt.subscribe((0,Ve.x)(Tt,wn=>(0,pe.f)(Tt,Le,()=>Tt.next(wn),Je),()=>(0,pe.f)(Tt,Le,()=>Tt.complete(),Je),wn=>(0,pe.f)(Tt,Le,()=>Tt.error(wn),Je)))})}function Te(Le,Je=0){return(0,Pe.e)((zt,Tt)=>{Tt.add(Le.schedule(()=>zt.subscribe(Tt),Je))})}var ut=$(9751),me=$(2202),We=$(576);function pt(Le,Je){if(!Le)throw new Error("Iterable cannot be null");return new ut.y(zt=>{(0,pe.f)(zt,Je,()=>{const Tt=Le[Symbol.asyncIterator]();(0,pe.f)(zt,Je,()=>{Tt.next().then(wn=>{wn.done?zt.complete():zt.next(wn.value)})},0,!0)})})}var Wt=$(3670),Ln=$(8239),St=$(1144),In=$(6495),Jn=$(2206),ui=$(4532),Ot=$(3260);function je(Le,Je){return Je?function Ft(Le,Je){if(null!=Le){if((0,Wt.c)(Le))return function at(Le,Je){return(0,x.Xf)(Le).pipe(Te(Je),Ce(Je))}(Le,Je);if((0,St.z)(Le))return function tt(Le,Je){return new ut.y(zt=>{let Tt=0;return Je.schedule(function(){Tt===Le.length?zt.complete():(zt.next(Le[Tt++]),zt.closed||this.schedule())})})}(Le,Je);if((0,Ln.t)(Le))return function Et(Le,Je){return(0,x.Xf)(Le).pipe(Te(Je),Ce(Je))}(Le,Je);if((0,Jn.D)(Le))return pt(Le,Je);if((0,In.T)(Le))return function wt(Le,Je){return new ut.y(zt=>{let Tt;return(0,pe.f)(zt,Je,()=>{Tt=Le[me.h](),(0,pe.f)(zt,Je,()=>{let wn,Fn;try{({value:wn,done:Fn}=Tt.next())}catch(Qn){return void zt.error(Qn)}Fn?zt.complete():zt.next(wn)},0,!0)}),()=>(0,We.m)(Tt?.return)&&Tt.return()})}(Le,Je);if((0,Ot.L)(Le))return function Me(Le,Je){return pt((0,Ot.Q)(Le),Je)}(Le,Je)}throw(0,ui.z)(Le)}(Le,Je):(0,x.Xf)(Le)}},8421:(Jt,$e,$)=>{$.d($e,{Xf:()=>wt});var x=$(655),pe=$(1144),Pe=$(8239),Ve=$(9751),Ce=$(3670),Te=$(2206),at=$(4532),Et=$(6495),ut=$(3260),tt=$(576),me=$(7849),We=$(8822);function wt(Ot){if(Ot instanceof Ve.y)return Ot;if(null!=Ot){if((0,Ce.c)(Ot))return function pt(Ot){return new Ve.y(Me=>{const Ft=Ot[We.L]();if((0,tt.m)(Ft.subscribe))return Ft.subscribe(Me);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ot);if((0,pe.z)(Ot))return function Wt(Ot){return new Ve.y(Me=>{for(let Ft=0;Ft<Ot.length&&!Me.closed;Ft++)Me.next(Ot[Ft]);Me.complete()})}(Ot);if((0,Pe.t)(Ot))return function Ln(Ot){return new Ve.y(Me=>{Ot.then(Ft=>{Me.closed||(Me.next(Ft),Me.complete())},Ft=>Me.error(Ft)).then(null,me.h)})}(Ot);if((0,Te.D)(Ot))return In(Ot);if((0,Et.T)(Ot))return function St(Ot){return new Ve.y(Me=>{for(const Ft of Ot)if(Me.next(Ft),Me.closed)return;Me.complete()})}(Ot);if((0,ut.L)(Ot))return function Jn(Ot){return In((0,ut.Q)(Ot))}(Ot)}throw(0,at.z)(Ot)}function In(Ot){return new Ve.y(Me=>{(function ui(Ot,Me){var Ft,je,Le,Je;return(0,x.mG)(this,void 0,void 0,function*(){try{for(Ft=(0,x.KL)(Ot);!(je=yield Ft.next()).done;)if(Me.next(je.value),Me.closed)return}catch(zt){Le={error:zt}}finally{try{je&&!je.done&&(Je=Ft.return)&&(yield Je.call(Ft))}finally{if(Le)throw Le.error}}Me.complete()})})(Ot,Me).catch(Ft=>Me.error(Ft))})}},9646:(Jt,$e,$)=>{$.d($e,{of:()=>Pe});var x=$(3269),pe=$(2076);function Pe(...Ve){const Ce=(0,x.yG)(Ve);return(0,pe.D)(Ve,Ce)}},5403:(Jt,$e,$)=>{$.d($e,{x:()=>pe});var x=$(930);function pe(Ve,Ce,Te,at,Et){return new Pe(Ve,Ce,Te,at,Et)}class Pe extends x.Lv{constructor(Ce,Te,at,Et,ut,tt){super(Ce),this.onFinalize=ut,this.shouldUnsubscribe=tt,this._next=Te?function(me){try{Te(me)}catch(We){Ce.error(We)}}:super._next,this._error=Et?function(me){try{Et(me)}catch(We){Ce.error(We)}finally{this.unsubscribe()}}:super._error,this._complete=at?function(){try{at()}catch(me){Ce.error(me)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ce;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Te}=this;super.unsubscribe(),!Te&&(null===(Ce=this.onFinalize)||void 0===Ce||Ce.call(this))}}}},4351:(Jt,$e,$)=>{$.d($e,{b:()=>Pe});var x=$(5577),pe=$(576);function Pe(Ve,Ce){return(0,pe.m)(Ce)?(0,x.z)(Ve,Ce,1):(0,x.z)(Ve,1)}},6590:(Jt,$e,$)=>{$.d($e,{d:()=>Pe});var x=$(4482),pe=$(5403);function Pe(Ve){return(0,x.e)((Ce,Te)=>{let at=!1;Ce.subscribe((0,pe.x)(Te,Et=>{at=!0,Te.next(Et)},()=>{at||Te.next(Ve),Te.complete()}))})}},9300:(Jt,$e,$)=>{$.d($e,{h:()=>Pe});var x=$(4482),pe=$(5403);function Pe(Ve,Ce){return(0,x.e)((Te,at)=>{let Et=0;Te.subscribe((0,pe.x)(at,ut=>Ve.call(Ce,ut,Et++)&&at.next(ut)))})}},8746:(Jt,$e,$)=>{$.d($e,{x:()=>pe});var x=$(4482);function pe(Pe){return(0,x.e)((Ve,Ce)=>{try{Ve.subscribe(Ce)}finally{Ce.add(Pe)}})}},590:(Jt,$e,$)=>{$.d($e,{P:()=>at});var x=$(6805),pe=$(9300),Pe=$(5698),Ve=$(6590),Ce=$(8068),Te=$(4671);function at(Et,ut){const tt=arguments.length>=2;return me=>me.pipe(Et?(0,pe.h)((We,wt)=>Et(We,wt,me)):Te.y,(0,Pe.q)(1),tt?(0,Ve.d)(ut):(0,Ce.T)(()=>new x.K))}},4004:(Jt,$e,$)=>{$.d($e,{U:()=>Pe});var x=$(4482),pe=$(5403);function Pe(Ve,Ce){return(0,x.e)((Te,at)=>{let Et=0;Te.subscribe((0,pe.x)(at,ut=>{at.next(Ve.call(Ce,ut,Et++))}))})}},9718:(Jt,$e,$)=>{$.d($e,{h:()=>pe});var x=$(4004);function pe(Pe){return(0,x.U)(()=>Pe)}},8189:(Jt,$e,$)=>{$.d($e,{J:()=>Pe});var x=$(5577),pe=$(4671);function Pe(Ve=1/0){return(0,x.z)(pe.y,Ve)}},5577:(Jt,$e,$)=>{$.d($e,{z:()=>Et});var x=$(4004),pe=$(8421),Pe=$(4482),Ve=$(9672),Ce=$(5403),at=$(576);function Et(ut,tt,me=1/0){return(0,at.m)(tt)?Et((We,wt)=>(0,x.U)((pt,Wt)=>tt(We,pt,wt,Wt))((0,pe.Xf)(ut(We,wt))),me):("number"==typeof tt&&(me=tt),(0,Pe.e)((We,wt)=>function Te(ut,tt,me,We,wt,pt,Wt,Ln){const St=[];let In=0,Jn=0,ui=!1;const Ot=()=>{ui&&!St.length&&!In&&tt.complete()},Me=je=>In<We?Ft(je):St.push(je),Ft=je=>{pt&&tt.next(je),In++;let Le=!1;(0,pe.Xf)(me(je,Jn++)).subscribe((0,Ce.x)(tt,Je=>{wt?.(Je),pt?Me(Je):tt.next(Je)},()=>{Le=!0},void 0,()=>{if(Le)try{for(In--;St.length&&In<We;){const Je=St.shift();Wt?(0,Ve.f)(tt,Wt,()=>Ft(Je)):Ft(Je)}Ot()}catch(Je){tt.error(Je)}}))};return ut.subscribe((0,Ce.x)(tt,Me,()=>{ui=!0,Ot()})),()=>{Ln?.()}}(We,wt,ut,me)))}},3099:(Jt,$e,$)=>{$.d($e,{B:()=>Ce});var x=$(8421),pe=$(7579),Pe=$(930),Ve=$(4482);function Ce(at={}){const{connector:Et=(()=>new pe.x),resetOnError:ut=!0,resetOnComplete:tt=!0,resetOnRefCountZero:me=!0}=at;return We=>{let wt,pt,Wt,Ln=0,St=!1,In=!1;const Jn=()=>{pt?.unsubscribe(),pt=void 0},ui=()=>{Jn(),wt=Wt=void 0,St=In=!1},Ot=()=>{const Me=wt;ui(),Me?.unsubscribe()};return(0,Ve.e)((Me,Ft)=>{Ln++,!In&&!St&&Jn();const je=Wt=Wt??Et();Ft.add(()=>{Ln--,0===Ln&&!In&&!St&&(pt=Te(Ot,me))}),je.subscribe(Ft),!wt&&Ln>0&&(wt=new Pe.Hp({next:Le=>je.next(Le),error:Le=>{In=!0,Jn(),pt=Te(ui,ut,Le),je.error(Le)},complete:()=>{St=!0,Jn(),pt=Te(ui,tt),je.complete()}}),(0,x.Xf)(Me).subscribe(wt))})(We)}}function Te(at,Et,...ut){if(!0===Et)return void at();if(!1===Et)return;const tt=new Pe.Hp({next:()=>{tt.unsubscribe(),at()}});return(0,x.Xf)(Et(...ut)).subscribe(tt)}},3900:(Jt,$e,$)=>{$.d($e,{w:()=>Ve});var x=$(8421),pe=$(4482),Pe=$(5403);function Ve(Ce,Te){return(0,pe.e)((at,Et)=>{let ut=null,tt=0,me=!1;const We=()=>me&&!ut&&Et.complete();at.subscribe((0,Pe.x)(Et,wt=>{ut?.unsubscribe();let pt=0;const Wt=tt++;(0,x.Xf)(Ce(wt,Wt)).subscribe(ut=(0,Pe.x)(Et,Ln=>Et.next(Te?Te(wt,Ln,Wt,pt++):Ln),()=>{ut=null,We()}))},()=>{me=!0,We()}))})}},5698:(Jt,$e,$)=>{$.d($e,{q:()=>Ve});var x=$(515),pe=$(4482),Pe=$(5403);function Ve(Ce){return Ce<=0?()=>x.E:(0,pe.e)((Te,at)=>{let Et=0;Te.subscribe((0,Pe.x)(at,ut=>{++Et<=Ce&&(at.next(ut),Ce<=Et&&at.complete())}))})}},8505:(Jt,$e,$)=>{$.d($e,{b:()=>Ce});var x=$(576),pe=$(4482),Pe=$(5403),Ve=$(4671);function Ce(Te,at,Et){const ut=(0,x.m)(Te)||at||Et?{next:Te,error:at,complete:Et}:Te;return ut?(0,pe.e)((tt,me)=>{var We;null===(We=ut.subscribe)||void 0===We||We.call(ut);let wt=!0;tt.subscribe((0,Pe.x)(me,pt=>{var Wt;null===(Wt=ut.next)||void 0===Wt||Wt.call(ut,pt),me.next(pt)},()=>{var pt;wt=!1,null===(pt=ut.complete)||void 0===pt||pt.call(ut),me.complete()},pt=>{var Wt;wt=!1,null===(Wt=ut.error)||void 0===Wt||Wt.call(ut,pt),me.error(pt)},()=>{var pt,Wt;wt&&(null===(pt=ut.unsubscribe)||void 0===pt||pt.call(ut)),null===(Wt=ut.finalize)||void 0===Wt||Wt.call(ut)}))}):Ve.y}},8068:(Jt,$e,$)=>{$.d($e,{T:()=>Ve});var x=$(6805),pe=$(4482),Pe=$(5403);function Ve(Te=Ce){return(0,pe.e)((at,Et)=>{let ut=!1;at.subscribe((0,Pe.x)(Et,tt=>{ut=!0,Et.next(tt)},()=>ut?Et.complete():Et.error(Te())))})}function Ce(){return new x.K}},3410:(Jt,$e,$)=>{$.d($e,{z:()=>x});const x={setTimeout(pe,Pe,...Ve){const{delegate:Ce}=x;return Ce?.setTimeout?Ce.setTimeout(pe,Pe,...Ve):setTimeout(pe,Pe,...Ve)},clearTimeout(pe){const{delegate:Pe}=x;return(Pe?.clearTimeout||clearTimeout)(pe)},delegate:void 0}},2202:(Jt,$e,$)=>{$.d($e,{h:()=>pe});const pe=function x(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Jt,$e,$)=>{$.d($e,{L:()=>x});const x="function"==typeof Symbol&&Symbol.observable||"@@observable"},6805:(Jt,$e,$)=>{$.d($e,{K:()=>pe});const pe=(0,$(3888).d)(Pe=>function(){Pe(this),this.name="EmptyError",this.message="no elements in sequence"})},3269:(Jt,$e,$)=>{$.d($e,{_6:()=>Te,jO:()=>Ve,yG:()=>Ce});var x=$(576),pe=$(3532);function Pe(at){return at[at.length-1]}function Ve(at){return(0,x.m)(Pe(at))?at.pop():void 0}function Ce(at){return(0,pe.K)(Pe(at))?at.pop():void 0}function Te(at,Et){return"number"==typeof Pe(at)?at.pop():Et}},4742:(Jt,$e,$)=>{$.d($e,{D:()=>Ce});const{isArray:x}=Array,{getPrototypeOf:pe,prototype:Pe,keys:Ve}=Object;function Ce(at){if(1===at.length){const Et=at[0];if(x(Et))return{args:Et,keys:null};if(function Te(at){return at&&"object"==typeof at&&pe(at)===Pe}(Et)){const ut=Ve(Et);return{args:ut.map(tt=>Et[tt]),keys:ut}}}return{args:at,keys:null}}},8737:(Jt,$e,$)=>{function x(pe,Pe){if(pe){const Ve=pe.indexOf(Pe);0<=Ve&&pe.splice(Ve,1)}}$.d($e,{P:()=>x})},3888:(Jt,$e,$)=>{function x(pe){const Ve=pe(Ce=>{Error.call(Ce),Ce.stack=(new Error).stack});return Ve.prototype=Object.create(Error.prototype),Ve.prototype.constructor=Ve,Ve}$.d($e,{d:()=>x})},1810:(Jt,$e,$)=>{function x(pe,Pe){return pe.reduce((Ve,Ce,Te)=>(Ve[Ce]=Pe[Te],Ve),{})}$.d($e,{n:()=>x})},2806:(Jt,$e,$)=>{$.d($e,{O:()=>Ve,x:()=>Pe});var x=$(2416);let pe=null;function Pe(Ce){if(x.config.useDeprecatedSynchronousErrorHandling){const Te=!pe;if(Te&&(pe={errorThrown:!1,error:null}),Ce(),Te){const{errorThrown:at,error:Et}=pe;if(pe=null,at)throw Et}}else Ce()}function Ve(Ce){x.config.useDeprecatedSynchronousErrorHandling&&pe&&(pe.errorThrown=!0,pe.error=Ce)}},9672:(Jt,$e,$)=>{function x(pe,Pe,Ve,Ce=0,Te=!1){const at=Pe.schedule(function(){Ve(),Te?pe.add(this.schedule(null,Ce)):this.unsubscribe()},Ce);if(pe.add(at),!Te)return at}$.d($e,{f:()=>x})},4671:(Jt,$e,$)=>{function x(pe){return pe}$.d($e,{y:()=>x})},1144:(Jt,$e,$)=>{$.d($e,{z:()=>x});const x=pe=>pe&&"number"==typeof pe.length&&"function"!=typeof pe},2206:(Jt,$e,$)=>{$.d($e,{D:()=>pe});var x=$(576);function pe(Pe){return Symbol.asyncIterator&&(0,x.m)(Pe?.[Symbol.asyncIterator])}},576:(Jt,$e,$)=>{function x(pe){return"function"==typeof pe}$.d($e,{m:()=>x})},3670:(Jt,$e,$)=>{$.d($e,{c:()=>Pe});var x=$(8822),pe=$(576);function Pe(Ve){return(0,pe.m)(Ve[x.L])}},6495:(Jt,$e,$)=>{$.d($e,{T:()=>Pe});var x=$(2202),pe=$(576);function Pe(Ve){return(0,pe.m)(Ve?.[x.h])}},8239:(Jt,$e,$)=>{$.d($e,{t:()=>pe});var x=$(576);function pe(Pe){return(0,x.m)(Pe?.then)}},3260:(Jt,$e,$)=>{$.d($e,{L:()=>Ve,Q:()=>Pe});var x=$(655),pe=$(576);function Pe(Ce){return(0,x.FC)(this,arguments,function*(){const at=Ce.getReader();try{for(;;){const{value:Et,done:ut}=yield(0,x.qq)(at.read());if(ut)return yield(0,x.qq)(void 0);yield yield(0,x.qq)(Et)}}finally{at.releaseLock()}})}function Ve(Ce){return(0,pe.m)(Ce?.getReader)}},3532:(Jt,$e,$)=>{$.d($e,{K:()=>pe});var x=$(576);function pe(Pe){return Pe&&(0,x.m)(Pe.schedule)}},4482:(Jt,$e,$)=>{$.d($e,{A:()=>pe,e:()=>Pe});var x=$(576);function pe(Ve){return(0,x.m)(Ve?.lift)}function Pe(Ve){return Ce=>{if(pe(Ce))return Ce.lift(function(Te){try{return Ve(Te,this)}catch(at){this.error(at)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Jt,$e,$)=>{$.d($e,{Z:()=>Ve});var x=$(4004);const{isArray:pe}=Array;function Ve(Ce){return(0,x.U)(Te=>function Pe(Ce,Te){return pe(Te)?Ce(...Te):Ce(Te)}(Ce,Te))}},5032:(Jt,$e,$)=>{function x(){}$.d($e,{Z:()=>x})},9635:(Jt,$e,$)=>{$.d($e,{U:()=>Pe,z:()=>pe});var x=$(4671);function pe(...Ve){return Pe(Ve)}function Pe(Ve){return 0===Ve.length?x.y:1===Ve.length?Ve[0]:function(Te){return Ve.reduce((at,Et)=>Et(at),Te)}}},7849:(Jt,$e,$)=>{$.d($e,{h:()=>Pe});var x=$(2416),pe=$(3410);function Pe(Ve){pe.z.setTimeout(()=>{const{onUnhandledError:Ce}=x.config;if(!Ce)throw Ve;Ce(Ve)})}},4532:(Jt,$e,$)=>{function x(pe){return new TypeError(`You provided ${null!==pe&&"object"==typeof pe?"an invalid object":`'${pe}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}$.d($e,{z:()=>x})},655:(Jt,$e,$)=>{function We(Se,Re,Ue,Xe){return new(Ue||(Ue=Promise))(function(gt,Kt){function on(Ei){try{an(Xe.next(Ei))}catch(Vn){Kt(Vn)}}function Un(Ei){try{an(Xe.throw(Ei))}catch(Vn){Kt(Vn)}}function an(Ei){Ei.done?gt(Ei.value):function yt(gt){return gt instanceof Ue?gt:new Ue(function(Kt){Kt(gt)})}(Ei.value).then(on,Un)}an((Xe=Xe.apply(Se,Re||[])).next())})}function Ot(Se){return this instanceof Ot?(this.v=Se,this):new Ot(Se)}function Me(Se,Re,Ue){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var yt,Xe=Ue.apply(Se,Re||[]),gt=[];return yt={},Kt("next"),Kt("throw"),Kt("return"),yt[Symbol.asyncIterator]=function(){return this},yt;function Kt(Qt){Xe[Qt]&&(yt[Qt]=function(pr){return new Promise(function(jr,Xr){gt.push([Qt,pr,jr,Xr])>1||on(Qt,pr)})})}function on(Qt,pr){try{!function Un(Qt){Qt.value instanceof Ot?Promise.resolve(Qt.value.v).then(an,Ei):Vn(gt[0][2],Qt)}(Xe[Qt](pr))}catch(jr){Vn(gt[0][3],jr)}}function an(Qt){on("next",Qt)}function Ei(Qt){on("throw",Qt)}function Vn(Qt,pr){Qt(pr),gt.shift(),gt.length&&on(gt[0][0],gt[0][1])}}function je(Se){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ue,Re=Se[Symbol.asyncIterator];return Re?Re.call(Se):(Se=function Ln(Se){var Re="function"==typeof Symbol&&Symbol.iterator,Ue=Re&&Se[Re],Xe=0;if(Ue)return Ue.call(Se);if(Se&&"number"==typeof Se.length)return{next:function(){return Se&&Xe>=Se.length&&(Se=void 0),{value:Se&&Se[Xe++],done:!Se}}};throw new TypeError(Re?"Object is not iterable.":"Symbol.iterator is not defined.")}(Se),Ue={},Xe("next"),Xe("throw"),Xe("return"),Ue[Symbol.asyncIterator]=function(){return this},Ue);function Xe(gt){Ue[gt]=Se[gt]&&function(Kt){return new Promise(function(on,Un){!function yt(gt,Kt,on,Un){Promise.resolve(Un).then(function(an){gt({value:an,done:on})},Kt)}(on,Un,(Kt=Se[gt](Kt)).done,Kt.value)})}}}$.d($e,{FC:()=>Me,KL:()=>je,mG:()=>We,qq:()=>Ot})},4755:(Jt,$e,$)=>{$.d($e,{Do:()=>Ln,EM:()=>ka,HT:()=>Ve,JF:()=>ua,K0:()=>Te,Mx:()=>us,O5:()=>sa,OU:()=>Ii,Ov:()=>gr,PM:()=>Ua,S$:()=>wt,V_:()=>Et,Ye:()=>St,Zd:()=>jo,b0:()=>Wt,bD:()=>ki,ez:()=>_n,q:()=>Pe,sg:()=>Na,w_:()=>Ce});var x=$(2504);let pe=null;function Pe(){return pe}function Ve(w){pe||(pe=w)}class Ce{}const Te=new x.OlP("DocumentToken");let at=(()=>{class w{historyGo(A){throw new Error("Not implemented")}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275prov=x.Yz7({token:w,factory:function(){return(0,x.f3M)(ut)},providedIn:"platform"}),w})();const Et=new x.OlP("Location Initialized");let ut=(()=>{class w extends at{constructor(){super(),this._doc=(0,x.f3M)(Te),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Pe().getBaseHref(this._doc)}onPopState(A){const k=Pe().getGlobalEventTarget(this._doc,"window");return k.addEventListener("popstate",A,!1),()=>k.removeEventListener("popstate",A)}onHashChange(A){const k=Pe().getGlobalEventTarget(this._doc,"window");return k.addEventListener("hashchange",A,!1),()=>k.removeEventListener("hashchange",A)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(A){this._location.pathname=A}pushState(A,k,Y){this._history.pushState(A,k,Y)}replaceState(A,k,Y){this._history.replaceState(A,k,Y)}forward(){this._history.forward()}back(){this._history.back()}historyGo(A=0){this._history.go(A)}getState(){return this._history.state}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275prov=x.Yz7({token:w,factory:function(){return new w},providedIn:"platform"}),w})();function tt(w,F){if(0==w.length)return F;if(0==F.length)return w;let A=0;return w.endsWith("/")&&A++,F.startsWith("/")&&A++,2==A?w+F.substring(1):1==A?w+F:w+"/"+F}function me(w){const F=w.match(/#|\?|$/),A=F&&F.index||w.length;return w.slice(0,A-("/"===w[A-1]?1:0))+w.slice(A)}function We(w){return w&&"?"!==w[0]?"?"+w:w}let wt=(()=>{class w{historyGo(A){throw new Error("Not implemented")}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275prov=x.Yz7({token:w,factory:function(){return(0,x.f3M)(Wt)},providedIn:"root"}),w})();const pt=new x.OlP("appBaseHref");let Wt=(()=>{class w extends wt{constructor(A,k){super(),this._platformLocation=A,this._removeListenerFns=[],this._baseHref=k??this._platformLocation.getBaseHrefFromDOM()??(0,x.f3M)(Te).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(A){this._removeListenerFns.push(this._platformLocation.onPopState(A),this._platformLocation.onHashChange(A))}getBaseHref(){return this._baseHref}prepareExternalUrl(A){return tt(this._baseHref,A)}path(A=!1){const k=this._platformLocation.pathname+We(this._platformLocation.search),Y=this._platformLocation.hash;return Y&&A?`${k}${Y}`:k}pushState(A,k,Y,ge){const xe=this.prepareExternalUrl(Y+We(ge));this._platformLocation.pushState(A,k,xe)}replaceState(A,k,Y,ge){const xe=this.prepareExternalUrl(Y+We(ge));this._platformLocation.replaceState(A,k,xe)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(A=0){this._platformLocation.historyGo?.(A)}}return w.\u0275fac=function(A){return new(A||w)(x.LFG(at),x.LFG(pt,8))},w.\u0275prov=x.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Ln=(()=>{class w extends wt{constructor(A,k){super(),this._platformLocation=A,this._baseHref="",this._removeListenerFns=[],null!=k&&(this._baseHref=k)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(A){this._removeListenerFns.push(this._platformLocation.onPopState(A),this._platformLocation.onHashChange(A))}getBaseHref(){return this._baseHref}path(A=!1){let k=this._platformLocation.hash;return null==k&&(k="#"),k.length>0?k.substring(1):k}prepareExternalUrl(A){const k=tt(this._baseHref,A);return k.length>0?"#"+k:k}pushState(A,k,Y,ge){let xe=this.prepareExternalUrl(Y+We(ge));0==xe.length&&(xe=this._platformLocation.pathname),this._platformLocation.pushState(A,k,xe)}replaceState(A,k,Y,ge){let xe=this.prepareExternalUrl(Y+We(ge));0==xe.length&&(xe=this._platformLocation.pathname),this._platformLocation.replaceState(A,k,xe)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(A=0){this._platformLocation.historyGo?.(A)}}return w.\u0275fac=function(A){return new(A||w)(x.LFG(at),x.LFG(pt,8))},w.\u0275prov=x.Yz7({token:w,factory:w.\u0275fac}),w})(),St=(()=>{class w{constructor(A){this._subject=new x.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=A;const k=this._locationStrategy.getBaseHref();this._basePath=function Ot(w){if(new RegExp("^(https?:)?//").test(w)){const[,A]=w.split(/\/\/[^\/]+/);return A}return w}(me(ui(k))),this._locationStrategy.onPopState(Y=>{this._subject.emit({url:this.path(!0),pop:!0,state:Y.state,type:Y.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(A=!1){return this.normalize(this._locationStrategy.path(A))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(A,k=""){return this.path()==this.normalize(A+We(k))}normalize(A){return w.stripTrailingSlash(function Jn(w,F){if(!w||!F.startsWith(w))return F;const A=F.substring(w.length);return""===A||["/",";","?","#"].includes(A[0])?A:F}(this._basePath,ui(A)))}prepareExternalUrl(A){return A&&"/"!==A[0]&&(A="/"+A),this._locationStrategy.prepareExternalUrl(A)}go(A,k="",Y=null){this._locationStrategy.pushState(Y,"",A,k),this._notifyUrlChangeListeners(this.prepareExternalUrl(A+We(k)),Y)}replaceState(A,k="",Y=null){this._locationStrategy.replaceState(Y,"",A,k),this._notifyUrlChangeListeners(this.prepareExternalUrl(A+We(k)),Y)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(A=0){this._locationStrategy.historyGo?.(A)}onUrlChange(A){return this._urlChangeListeners.push(A),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(k=>{this._notifyUrlChangeListeners(k.url,k.state)})),()=>{const k=this._urlChangeListeners.indexOf(A);this._urlChangeListeners.splice(k,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(A="",k){this._urlChangeListeners.forEach(Y=>Y(A,k))}subscribe(A,k,Y){return this._subject.subscribe({next:A,error:k,complete:Y})}}return w.normalizeQueryParams=We,w.joinWithSlash=tt,w.stripTrailingSlash=me,w.\u0275fac=function(A){return new(A||w)(x.LFG(wt))},w.\u0275prov=x.Yz7({token:w,factory:function(){return function In(){return new St((0,x.LFG)(wt))}()},providedIn:"root"}),w})();function ui(w){return w.replace(/\/index.html$/,"")}function us(w,F){F=encodeURIComponent(F);for(const A of w.split(";")){const k=A.indexOf("="),[Y,ge]=-1==k?[A,""]:[A.slice(0,k),A.slice(k+1)];if(Y.trim()===F)return decodeURIComponent(ge)}return null}class sl{constructor(F,A,k,Y){this.$implicit=F,this.ngForOf=A,this.index=k,this.count=Y}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Na=(()=>{class w{set ngForOf(A){this._ngForOf=A,this._ngForOfDirty=!0}set ngForTrackBy(A){this._trackByFn=A}get ngForTrackBy(){return this._trackByFn}constructor(A,k,Y){this._viewContainer=A,this._template=k,this._differs=Y,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(A){A&&(this._template=A)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const A=this._ngForOf;!this._differ&&A&&(this._differ=this._differs.find(A).create(this.ngForTrackBy))}if(this._differ){const A=this._differ.diff(this._ngForOf);A&&this._applyChanges(A)}}_applyChanges(A){const k=this._viewContainer;A.forEachOperation((Y,ge,xe)=>{if(null==Y.previousIndex)k.createEmbeddedView(this._template,new sl(Y.item,this._ngForOf,-1,-1),null===xe?void 0:xe);else if(null==xe)k.remove(null===ge?void 0:ge);else if(null!==ge){const kt=k.get(ge);k.move(kt,xe),No(kt,Y)}});for(let Y=0,ge=k.length;Y<ge;Y++){const kt=k.get(Y).context;kt.index=Y,kt.count=ge,kt.ngForOf=this._ngForOf}A.forEachIdentityChange(Y=>{No(k.get(Y.currentIndex),Y)})}static ngTemplateContextGuard(A,k){return!0}}return w.\u0275fac=function(A){return new(A||w)(x.Y36(x.s_b),x.Y36(x.Rgc),x.Y36(x.ZZ4))},w.\u0275dir=x.lG2({type:w,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),w})();function No(w,F){w.context.$implicit=F.item}let sa=(()=>{class w{constructor(A,k){this._viewContainer=A,this._context=new ol,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=k}set ngIf(A){this._context.$implicit=this._context.ngIf=A,this._updateView()}set ngIfThen(A){Oa("ngIfThen",A),this._thenTemplateRef=A,this._thenViewRef=null,this._updateView()}set ngIfElse(A){Oa("ngIfElse",A),this._elseTemplateRef=A,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(A,k){return!0}}return w.\u0275fac=function(A){return new(A||w)(x.Y36(x.s_b),x.Y36(x.Rgc))},w.\u0275dir=x.lG2({type:w,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),w})();class ol{constructor(){this.$implicit=null,this.ngIf=null}}function Oa(w,F){if(F&&!F.createEmbeddedView)throw new Error(`${w} must be a TemplateRef, but received '${(0,x.AaK)(F)}'.`)}function kr(w,F){return new x.vHH(2100,!1)}class ni{createSubscription(F,A){return F.subscribe({next:A,error:k=>{throw k}})}dispose(F){F.unsubscribe()}}class qi{createSubscription(F,A){return F.then(A,k=>{throw k})}dispose(F){}}const Rr=new qi,go=new ni;let gr=(()=>{class w{constructor(A){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=A}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(A){return this._obj?A!==this._obj?(this._dispose(),this.transform(A)):this._latestValue:(A&&this._subscribe(A),this._latestValue)}_subscribe(A){this._obj=A,this._strategy=this._selectStrategy(A),this._subscription=this._strategy.createSubscription(A,k=>this._updateLatestValue(A,k))}_selectStrategy(A){if((0,x.QGY)(A))return Rr;if((0,x.F4k)(A))return go;throw kr()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(A,k){A===this._obj&&(this._latestValue=k,this._ref.markForCheck())}}return w.\u0275fac=function(A){return new(A||w)(x.Y36(x.sBO,16))},w.\u0275pipe=x.Yjl({name:"async",type:w,pure:!1,standalone:!0}),w})(),Ii=(()=>{class w{transform(A,k,Y){if(null==A)return null;if(!this.supports(A))throw kr();return A.slice(k,Y)}supports(A){return"string"==typeof A||Array.isArray(A)}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275pipe=x.Yjl({name:"slice",type:w,pure:!1,standalone:!0}),w})(),_n=(()=>{class w{}return w.\u0275fac=function(A){return new(A||w)},w.\u0275mod=x.oAB({type:w}),w.\u0275inj=x.cJS({}),w})();const ki="browser",Zs="server";function Ua(w){return w===Zs}let ka=(()=>{class w{}return w.\u0275prov=(0,x.Yz7)({token:w,providedIn:"root",factory:()=>new Yl((0,x.LFG)(Te),window)}),w})();class Yl{constructor(F,A){this.document=F,this.window=A,this.offset=()=>[0,0]}setOffset(F){this.offset=Array.isArray(F)?()=>F:F}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(F){this.supportsScrolling()&&this.window.scrollTo(F[0],F[1])}scrollToAnchor(F){if(!this.supportsScrolling())return;const A=function Ba(w,F){const A=w.getElementById(F)||w.getElementsByName(F)[0];if(A)return A;if("function"==typeof w.createTreeWalker&&w.body&&"function"==typeof w.body.attachShadow){const k=w.createTreeWalker(w.body,NodeFilter.SHOW_ELEMENT);let Y=k.currentNode;for(;Y;){const ge=Y.shadowRoot;if(ge){const xe=ge.getElementById(F)||ge.querySelector(`[name="${F}"]`);if(xe)return xe}Y=k.nextNode()}}return null}(this.document,F);A&&(this.scrollToElement(A),A.focus())}setHistoryScrollRestoration(F){if(this.supportScrollRestoration()){const A=this.window.history;A&&A.scrollRestoration&&(A.scrollRestoration=F)}}scrollToElement(F){const A=F.getBoundingClientRect(),k=A.left+this.window.pageXOffset,Y=A.top+this.window.pageYOffset,ge=this.offset();this.window.scrollTo(k-ge[0],Y-ge[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const F=hs(this.window.history)||hs(Object.getPrototypeOf(this.window.history));return!(!F||!F.writable&&!F.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function hs(w){return Object.getOwnPropertyDescriptor(w,"scrollRestoration")}class ua{}const Ho=w=>w.src,fs=new x.OlP("ImageLoader",{providedIn:"root",factory:()=>Ho}),ec=new x.OlP("NG_OPTIMIZED_PRELOADED_IMAGES",{providedIn:"root",factory:()=>new Set});let Jc=(()=>{class w{constructor(){this.preloadedImages=(0,x.f3M)(ec),this.document=(0,x.f3M)(Te)}createPreloadLinkTag(A,k,Y,ge){if(this.preloadedImages.has(k))return;this.preloadedImages.add(k);const xe=A.createElement("link");A.setAttribute(xe,"as","image"),A.setAttribute(xe,"href",k),A.setAttribute(xe,"rel","preload"),A.setAttribute(xe,"fetchpriority","high"),ge&&A.setAttribute(xe,"imageSizes",ge),Y&&A.setAttribute(xe,"imageSrcset",Y),A.appendChild(this.document.head,xe)}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275prov=x.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})();const Ri=/^((\s*\d+w\s*(,|$)){1,})$/,Gn=[1,2],Fs={breakpoints:[16,32,48,64,96,128,256,384,640,750,828,1080,1200,1920,2048,3840]},$o=new x.OlP("ImageConfig",{providedIn:"root",factory:()=>Fs});let jo=(()=>{class w{constructor(){this.imageLoader=(0,x.f3M)(fs),this.config=function ud(w){let F={};return w.breakpoints&&(F.breakpoints=w.breakpoints.sort((A,k)=>A-k)),Object.assign({},Fs,w,F)}((0,x.f3M)($o)),this.renderer=(0,x.f3M)(x.Qsj),this.imgElement=(0,x.f3M)(x.SBq).nativeElement,this.injector=(0,x.f3M)(x.zs3),this.isServer=Ua((0,x.f3M)(x.Lbi)),this.preloadLinkChecker=(0,x.f3M)(Jc),this.lcpObserver=null,this._renderedSrc=null,this._priority=!1,this._disableOptimizedSrcset=!1,this._fill=!1}set width(A){this._width=nc(A)}get width(){return this._width}set height(A){this._height=nc(A)}get height(){return this._height}set priority(A){this._priority=va(A)}get priority(){return this._priority}set disableOptimizedSrcset(A){this._disableOptimizedSrcset=va(A)}get disableOptimizedSrcset(){return this._disableOptimizedSrcset}set fill(A){this._fill=va(A)}get fill(){return this._fill}ngOnInit(){this.setHostAttributes()}setHostAttributes(){this.fill?this.sizes||(this.sizes="100vw"):(this.setHostAttribute("width",this.width.toString()),this.setHostAttribute("height",this.height.toString())),this.setHostAttribute("loading",this.getLoadingBehavior()),this.setHostAttribute("fetchpriority",this.getFetchPriority()),this.setHostAttribute("ng-img","true");const A=this.getRewrittenSrc();let k;this.setHostAttribute("src",A),this.sizes&&this.setHostAttribute("sizes",this.sizes),this.ngSrcset?k=this.getRewrittenSrcset():this.shouldGenerateAutomaticSrcset()&&(k=this.getAutomaticSrcset()),k&&this.setHostAttribute("srcset",k),this.isServer&&this.priority&&this.preloadLinkChecker.createPreloadLinkTag(this.renderer,A,k,this.sizes)}ngOnChanges(A){}callImageLoader(A){let k=A;return this.loaderParams&&(k.loaderParams=this.loaderParams),this.imageLoader(k)}getLoadingBehavior(){return this.priority||void 0===this.loading?this.priority?"eager":"lazy":this.loading}getFetchPriority(){return this.priority?"high":"auto"}getRewrittenSrc(){return this._renderedSrc||(this._renderedSrc=this.callImageLoader({src:this.ngSrc})),this._renderedSrc}getRewrittenSrcset(){const A=Ri.test(this.ngSrcset);return this.ngSrcset.split(",").filter(Y=>""!==Y).map(Y=>{Y=Y.trim();const ge=A?parseFloat(Y):parseFloat(Y)*this.width;return`${this.callImageLoader({src:this.ngSrc,width:ge})} ${Y}`}).join(", ")}getAutomaticSrcset(){return this.sizes?this.getResponsiveSrcset():this.getFixedSrcset()}getResponsiveSrcset(){const{breakpoints:A}=this.config;let k=A;return"100vw"===this.sizes?.trim()&&(k=A.filter(ge=>ge>=640)),k.map(ge=>`${this.callImageLoader({src:this.ngSrc,width:ge})} ${ge}w`).join(", ")}getFixedSrcset(){return Gn.map(k=>`${this.callImageLoader({src:this.ngSrc,width:this.width*k})} ${k}x`).join(", ")}shouldGenerateAutomaticSrcset(){return!this._disableOptimizedSrcset&&!this.srcset&&this.imageLoader!==Ho&&!(this.width>1920||this.height>1080)}ngOnDestroy(){}setHostAttribute(A,k){this.renderer.setAttribute(this.imgElement,A,k)}}return w.\u0275fac=function(A){return new(A||w)},w.\u0275dir=x.lG2({type:w,selectors:[["img","ngSrc",""]],hostVars:8,hostBindings:function(A,k){2&A&&x.Udp("position",k.fill?"absolute":null)("width",k.fill?"100%":null)("height",k.fill?"100%":null)("inset",k.fill?"0px":null)},inputs:{ngSrc:"ngSrc",ngSrcset:"ngSrcset",sizes:"sizes",width:"width",height:"height",loading:"loading",priority:"priority",loaderParams:"loaderParams",disableOptimizedSrcset:"disableOptimizedSrcset",fill:"fill",src:"src",srcset:"srcset"},standalone:!0,features:[x.TTD]}),w})();function nc(w){return"string"==typeof w?parseInt(w,10):w}function va(w){return null!=w&&"false"!=`${w}`}},3144:(Jt,$e,$)=>{$.d($e,{JF:()=>ls,eN:()=>Xe});var x=$(2504),pe=$(9646),Pe=$(2076),Ve=$(9751),Ce=$(4351),Te=$(9300),at=$(4004),Et=$(3900),ut=$(4755);class tt{}class me{}class We{constructor(q){this.normalizedNames=new Map,this.lazyUpdate=null,q?this.lazyInit="string"==typeof q?()=>{this.headers=new Map,q.split("\n").forEach(ie=>{const De=ie.indexOf(":");if(De>0){const Qe=ie.slice(0,De),qe=Qe.toLowerCase(),bt=ie.slice(De+1).trim();this.maybeSetNormalizedName(Qe,qe),this.headers.has(qe)?this.headers.get(qe).push(bt):this.headers.set(qe,[bt])}})}:()=>{this.headers=new Map,Object.entries(q).forEach(([ie,De])=>{let Qe;if(Qe="string"==typeof De?[De]:"number"==typeof De?[De.toString()]:De.map(qe=>qe.toString()),Qe.length>0){const qe=ie.toLowerCase();this.headers.set(qe,Qe),this.maybeSetNormalizedName(ie,qe)}})}:this.headers=new Map}has(q){return this.init(),this.headers.has(q.toLowerCase())}get(q){this.init();const ie=this.headers.get(q.toLowerCase());return ie&&ie.length>0?ie[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(q){return this.init(),this.headers.get(q.toLowerCase())||null}append(q,ie){return this.clone({name:q,value:ie,op:"a"})}set(q,ie){return this.clone({name:q,value:ie,op:"s"})}delete(q,ie){return this.clone({name:q,value:ie,op:"d"})}maybeSetNormalizedName(q,ie){this.normalizedNames.has(ie)||this.normalizedNames.set(ie,q)}init(){this.lazyInit&&(this.lazyInit instanceof We?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(q=>this.applyUpdate(q)),this.lazyUpdate=null))}copyFrom(q){q.init(),Array.from(q.headers.keys()).forEach(ie=>{this.headers.set(ie,q.headers.get(ie)),this.normalizedNames.set(ie,q.normalizedNames.get(ie))})}clone(q){const ie=new We;return ie.lazyInit=this.lazyInit&&this.lazyInit instanceof We?this.lazyInit:this,ie.lazyUpdate=(this.lazyUpdate||[]).concat([q]),ie}applyUpdate(q){const ie=q.name.toLowerCase();switch(q.op){case"a":case"s":let De=q.value;if("string"==typeof De&&(De=[De]),0===De.length)return;this.maybeSetNormalizedName(q.name,ie);const Qe=("a"===q.op?this.headers.get(ie):void 0)||[];Qe.push(...De),this.headers.set(ie,Qe);break;case"d":const qe=q.value;if(qe){let bt=this.headers.get(ie);if(!bt)return;bt=bt.filter(mi=>-1===qe.indexOf(mi)),0===bt.length?(this.headers.delete(ie),this.normalizedNames.delete(ie)):this.headers.set(ie,bt)}else this.headers.delete(ie),this.normalizedNames.delete(ie)}}forEach(q){this.init(),Array.from(this.normalizedNames.keys()).forEach(ie=>q(this.normalizedNames.get(ie),this.headers.get(ie)))}}class pt{encodeKey(q){return In(q)}encodeValue(q){return In(q)}decodeKey(q){return decodeURIComponent(q)}decodeValue(q){return decodeURIComponent(q)}}const Ln=/%(\d[a-f0-9])/gi,St={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function In(oe){return encodeURIComponent(oe).replace(Ln,(q,ie)=>St[ie]??q)}function Jn(oe){return`${oe}`}class ui{constructor(q={}){if(this.updates=null,this.cloneFrom=null,this.encoder=q.encoder||new pt,q.fromString){if(q.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Wt(oe,q){const ie=new Map;return oe.length>0&&oe.replace(/^\?/,"").split("&").forEach(Qe=>{const qe=Qe.indexOf("="),[bt,mi]=-1==qe?[q.decodeKey(Qe),""]:[q.decodeKey(Qe.slice(0,qe)),q.decodeValue(Qe.slice(qe+1))],gn=ie.get(bt)||[];gn.push(mi),ie.set(bt,gn)}),ie}(q.fromString,this.encoder)}else q.fromObject?(this.map=new Map,Object.keys(q.fromObject).forEach(ie=>{const De=q.fromObject[ie],Qe=Array.isArray(De)?De.map(Jn):[Jn(De)];this.map.set(ie,Qe)})):this.map=null}has(q){return this.init(),this.map.has(q)}get(q){this.init();const ie=this.map.get(q);return ie?ie[0]:null}getAll(q){return this.init(),this.map.get(q)||null}keys(){return this.init(),Array.from(this.map.keys())}append(q,ie){return this.clone({param:q,value:ie,op:"a"})}appendAll(q){const ie=[];return Object.keys(q).forEach(De=>{const Qe=q[De];Array.isArray(Qe)?Qe.forEach(qe=>{ie.push({param:De,value:qe,op:"a"})}):ie.push({param:De,value:Qe,op:"a"})}),this.clone(ie)}set(q,ie){return this.clone({param:q,value:ie,op:"s"})}delete(q,ie){return this.clone({param:q,value:ie,op:"d"})}toString(){return this.init(),this.keys().map(q=>{const ie=this.encoder.encodeKey(q);return this.map.get(q).map(De=>ie+"="+this.encoder.encodeValue(De)).join("&")}).filter(q=>""!==q).join("&")}clone(q){const ie=new ui({encoder:this.encoder});return ie.cloneFrom=this.cloneFrom||this,ie.updates=(this.updates||[]).concat(q),ie}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(q=>this.map.set(q,this.cloneFrom.map.get(q))),this.updates.forEach(q=>{switch(q.op){case"a":case"s":const ie=("a"===q.op?this.map.get(q.param):void 0)||[];ie.push(Jn(q.value)),this.map.set(q.param,ie);break;case"d":if(void 0===q.value){this.map.delete(q.param);break}{let De=this.map.get(q.param)||[];const Qe=De.indexOf(Jn(q.value));-1!==Qe&&De.splice(Qe,1),De.length>0?this.map.set(q.param,De):this.map.delete(q.param)}}}),this.cloneFrom=this.updates=null)}}class Me{constructor(){this.map=new Map}set(q,ie){return this.map.set(q,ie),this}get(q){return this.map.has(q)||this.map.set(q,q.defaultValue()),this.map.get(q)}delete(q){return this.map.delete(q),this}has(q){return this.map.has(q)}keys(){return this.map.keys()}}function je(oe){return typeof ArrayBuffer<"u"&&oe instanceof ArrayBuffer}function Le(oe){return typeof Blob<"u"&&oe instanceof Blob}function Je(oe){return typeof FormData<"u"&&oe instanceof FormData}class Tt{constructor(q,ie,De,Qe){let qe;if(this.url=ie,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=q.toUpperCase(),function Ft(oe){switch(oe){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Qe?(this.body=void 0!==De?De:null,qe=Qe):qe=De,qe&&(this.reportProgress=!!qe.reportProgress,this.withCredentials=!!qe.withCredentials,qe.responseType&&(this.responseType=qe.responseType),qe.headers&&(this.headers=qe.headers),qe.context&&(this.context=qe.context),qe.params&&(this.params=qe.params)),this.headers||(this.headers=new We),this.context||(this.context=new Me),this.params){const bt=this.params.toString();if(0===bt.length)this.urlWithParams=ie;else{const mi=ie.indexOf("?");this.urlWithParams=ie+(-1===mi?"?":mi<ie.length-1?"&":"")+bt}}else this.params=new ui,this.urlWithParams=ie}serializeBody(){return null===this.body?null:je(this.body)||Le(this.body)||Je(this.body)||function zt(oe){return typeof URLSearchParams<"u"&&oe instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ui?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Je(this.body)?null:Le(this.body)?this.body.type||null:je(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ui?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(q={}){const ie=q.method||this.method,De=q.url||this.url,Qe=q.responseType||this.responseType,qe=void 0!==q.body?q.body:this.body,bt=void 0!==q.withCredentials?q.withCredentials:this.withCredentials,mi=void 0!==q.reportProgress?q.reportProgress:this.reportProgress;let gn=q.headers||this.headers,mr=q.params||this.params;const gi=q.context??this.context;return void 0!==q.setHeaders&&(gn=Object.keys(q.setHeaders).reduce((Vi,Ar)=>Vi.set(Ar,q.setHeaders[Ar]),gn)),q.setParams&&(mr=Object.keys(q.setParams).reduce((Vi,Ar)=>Vi.set(Ar,q.setParams[Ar]),mr)),new Tt(ie,De,qe,{params:mr,headers:gn,context:gi,reportProgress:mi,responseType:Qe,withCredentials:bt})}}var wn=(()=>((wn=wn||{})[wn.Sent=0]="Sent",wn[wn.UploadProgress=1]="UploadProgress",wn[wn.ResponseHeader=2]="ResponseHeader",wn[wn.DownloadProgress=3]="DownloadProgress",wn[wn.Response=4]="Response",wn[wn.User=5]="User",wn))();class Fn{constructor(q,ie=200,De="OK"){this.headers=q.headers||new We,this.status=void 0!==q.status?q.status:ie,this.statusText=q.statusText||De,this.url=q.url||null,this.ok=this.status>=200&&this.status<300}}class Qn extends Fn{constructor(q={}){super(q),this.type=wn.ResponseHeader}clone(q={}){return new Qn({headers:q.headers||this.headers,status:void 0!==q.status?q.status:this.status,statusText:q.statusText||this.statusText,url:q.url||this.url||void 0})}}class Se extends Fn{constructor(q={}){super(q),this.type=wn.Response,this.body=void 0!==q.body?q.body:null}clone(q={}){return new Se({body:void 0!==q.body?q.body:this.body,headers:q.headers||this.headers,status:void 0!==q.status?q.status:this.status,statusText:q.statusText||this.statusText,url:q.url||this.url||void 0})}}class Re extends Fn{constructor(q){super(q,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${q.url||"(unknown url)"}`:`Http failure response for ${q.url||"(unknown url)"}: ${q.status} ${q.statusText}`,this.error=q.error||null}}function Ue(oe,q){return{body:q,headers:oe.headers,context:oe.context,observe:oe.observe,params:oe.params,reportProgress:oe.reportProgress,responseType:oe.responseType,withCredentials:oe.withCredentials}}let Xe=(()=>{class oe{constructor(ie){this.handler=ie}request(ie,De,Qe={}){let qe;if(ie instanceof Tt)qe=ie;else{let gn,mr;gn=Qe.headers instanceof We?Qe.headers:new We(Qe.headers),Qe.params&&(mr=Qe.params instanceof ui?Qe.params:new ui({fromObject:Qe.params})),qe=new Tt(ie,De,void 0!==Qe.body?Qe.body:null,{headers:gn,context:Qe.context,params:mr,reportProgress:Qe.reportProgress,responseType:Qe.responseType||"json",withCredentials:Qe.withCredentials})}const bt=(0,pe.of)(qe).pipe((0,Ce.b)(gn=>this.handler.handle(gn)));if(ie instanceof Tt||"events"===Qe.observe)return bt;const mi=bt.pipe((0,Te.h)(gn=>gn instanceof Se));switch(Qe.observe||"body"){case"body":switch(qe.responseType){case"arraybuffer":return mi.pipe((0,at.U)(gn=>{if(null!==gn.body&&!(gn.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return gn.body}));case"blob":return mi.pipe((0,at.U)(gn=>{if(null!==gn.body&&!(gn.body instanceof Blob))throw new Error("Response is not a Blob.");return gn.body}));case"text":return mi.pipe((0,at.U)(gn=>{if(null!==gn.body&&"string"!=typeof gn.body)throw new Error("Response is not a string.");return gn.body}));default:return mi.pipe((0,at.U)(gn=>gn.body))}case"response":return mi;default:throw new Error(`Unreachable: unhandled observe type ${Qe.observe}}`)}}delete(ie,De={}){return this.request("DELETE",ie,De)}get(ie,De={}){return this.request("GET",ie,De)}head(ie,De={}){return this.request("HEAD",ie,De)}jsonp(ie,De){return this.request("JSONP",ie,{params:(new ui).append(De,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(ie,De={}){return this.request("OPTIONS",ie,De)}patch(ie,De,Qe={}){return this.request("PATCH",ie,Ue(Qe,De))}post(ie,De,Qe={}){return this.request("POST",ie,Ue(Qe,De))}put(ie,De,Qe={}){return this.request("PUT",ie,Ue(Qe,De))}}return oe.\u0275fac=function(ie){return new(ie||oe)(x.LFG(tt))},oe.\u0275prov=x.Yz7({token:oe,factory:oe.\u0275fac}),oe})();function yt(oe,q){return q(oe)}function gt(oe,q){return(ie,De)=>q.intercept(ie,{handle:Qe=>oe(Qe,De)})}const on=new x.OlP(""),Un=new x.OlP(""),an=new x.OlP("");function Ei(){let oe=null;return(q,ie)=>(null===oe&&(oe=((0,x.f3M)(on,{optional:!0})??[]).reduceRight(gt,yt)),oe(q,ie))}let Vn=(()=>{class oe extends tt{constructor(ie,De){super(),this.backend=ie,this.injector=De,this.chain=null}handle(ie){if(null===this.chain){const De=Array.from(new Set([...this.injector.get(Un),...this.injector.get(an,[])]));this.chain=De.reduceRight((Qe,qe)=>function Kt(oe,q,ie){return(De,Qe)=>ie.runInContext(()=>q(De,qe=>oe(qe,Qe)))}(Qe,qe,this.injector),yt)}return this.chain(ie,De=>this.backend.handle(De))}}return oe.\u0275fac=function(ie){return new(ie||oe)(x.LFG(me),x.LFG(x.lqb))},oe.\u0275prov=x.Yz7({token:oe,factory:oe.\u0275fac}),oe})();const Lo=/^\)\]\}',?\n/;let Ni=(()=>{class oe{constructor(ie){this.xhrFactory=ie}handle(ie){if("JSONP"===ie.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");const De=this.xhrFactory;return(De.\u0275loadImpl?(0,Pe.D)(De.\u0275loadImpl()):(0,pe.of)(null)).pipe((0,Et.w)(()=>new Ve.y(qe=>{const bt=De.build();if(bt.open(ie.method,ie.urlWithParams),ie.withCredentials&&(bt.withCredentials=!0),ie.headers.forEach((di,bi)=>bt.setRequestHeader(di,bi.join(","))),ie.headers.has("Accept")||bt.setRequestHeader("Accept","application/json, text/plain, */*"),!ie.headers.has("Content-Type")){const di=ie.detectContentTypeHeader();null!==di&&bt.setRequestHeader("Content-Type",di)}if(ie.responseType){const di=ie.responseType.toLowerCase();bt.responseType="json"!==di?di:"text"}const mi=ie.serializeBody();let gn=null;const mr=()=>{if(null!==gn)return gn;const di=bt.statusText||"OK",bi=new We(bt.getAllResponseHeaders()),us=function Ps(oe){return"responseURL"in oe&&oe.responseURL?oe.responseURL:/^X-Request-URL:/m.test(oe.getAllResponseHeaders())?oe.getResponseHeader("X-Request-URL"):null}(bt)||ie.url;return gn=new Qn({headers:bi,status:bt.status,statusText:di,url:us}),gn},gi=()=>{let{headers:di,status:bi,statusText:us,url:Ms}=mr(),$i=null;204!==bi&&($i=typeof bt.response>"u"?bt.responseText:bt.response),0===bi&&(bi=$i?200:0);let xs=bi>=200&&bi<300;if("json"===ie.responseType&&"string"==typeof $i){const Ir=$i;$i=$i.replace(Lo,"");try{$i=""!==$i?JSON.parse($i):null}catch(ra){$i=Ir,xs&&(xs=!1,$i={error:ra,text:$i})}}xs?(qe.next(new Se({body:$i,headers:di,status:bi,statusText:us,url:Ms||void 0})),qe.complete()):qe.error(new Re({error:$i,headers:di,status:bi,statusText:us,url:Ms||void 0}))},Vi=di=>{const{url:bi}=mr(),us=new Re({error:di,status:bt.status||0,statusText:bt.statusText||"Unknown Error",url:bi||void 0});qe.error(us)};let Ar=!1;const er=di=>{Ar||(qe.next(mr()),Ar=!0);let bi={type:wn.DownloadProgress,loaded:di.loaded};di.lengthComputable&&(bi.total=di.total),"text"===ie.responseType&&bt.responseText&&(bi.partialText=bt.responseText),qe.next(bi)},cs=di=>{let bi={type:wn.UploadProgress,loaded:di.loaded};di.lengthComputable&&(bi.total=di.total),qe.next(bi)};let Ls;bt.addEventListener("load",gi),bt.addEventListener("error",Vi),bt.addEventListener("timeout",Vi),bt.addEventListener("abort",Vi),ie.reportProgress&&(bt.addEventListener("progress",er),null!==mi&&bt.upload&&bt.upload.addEventListener("progress",cs));const Ys=()=>{Ls??=function pi(){const oe=setTimeout(()=>{},wr);return()=>clearTimeout(oe)}()},Yr=()=>{Ls?.()};return bt.addEventListener("loadstart",Ys),bt.addEventListener("loadend",Yr),bt.send(mi),qe.next({type:wn.Sent}),()=>{bt.removeEventListener("loadstart",Ys),bt.removeEventListener("loadend",Yr),bt.removeEventListener("error",Vi),bt.removeEventListener("abort",Vi),bt.removeEventListener("load",gi),bt.removeEventListener("timeout",Vi),Ls?.(),ie.reportProgress&&(bt.removeEventListener("progress",er),null!==mi&&bt.upload&&bt.upload.removeEventListener("progress",cs)),bt.readyState!==bt.DONE&&bt.abort()}})))}}return oe.\u0275fac=function(ie){return new(ie||oe)(x.LFG(ut.JF))},oe.\u0275prov=x.Yz7({token:oe,factory:oe.\u0275fac}),oe})();const wr=2147483647,nt=new x.OlP("XSRF_ENABLED"),Ji=new x.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Tr=new x.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class js{}let $n=(()=>{class oe{constructor(ie,De,Qe){this.doc=ie,this.platform=De,this.cookieName=Qe,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const ie=this.doc.cookie||"";return ie!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,ut.Mx)(ie,this.cookieName),this.lastCookieString=ie),this.lastToken}}return oe.\u0275fac=function(ie){return new(ie||oe)(x.LFG(ut.K0),x.LFG(x.Lbi),x.LFG(Ji))},oe.\u0275prov=x.Yz7({token:oe,factory:oe.\u0275fac}),oe})();function La(oe,q){const ie=oe.url.toLowerCase();if(!(0,x.f3M)(nt)||"GET"===oe.method||"HEAD"===oe.method||ie.startsWith("http://")||ie.startsWith("https://"))return q(oe);const De=(0,x.f3M)(js).getToken(),Qe=(0,x.f3M)(Tr);return null!=De&&!oe.headers.has(Qe)&&(oe=oe.clone({headers:oe.headers.set(Qe,De)})),q(oe)}var ti=(()=>((ti=ti||{})[ti.Interceptors=0]="Interceptors",ti[ti.LegacyInterceptors=1]="LegacyInterceptors",ti[ti.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",ti[ti.NoXsrfProtection=3]="NoXsrfProtection",ti[ti.JsonpSupport=4]="JsonpSupport",ti[ti.RequestsMadeViaParent=5]="RequestsMadeViaParent",ti))();function dn(oe,q){return{\u0275kind:oe,\u0275providers:q}}function kn(...oe){const q=[Xe,Ni,Vn,{provide:tt,useExisting:Vn},{provide:me,useExisting:Ni},{provide:Un,useValue:La,multi:!0},{provide:nt,useValue:!0},{provide:js,useClass:$n}];for(const ie of oe)q.push(...ie.\u0275providers);return(0,x.MR2)(q)}const as=new x.OlP("LEGACY_INTERCEPTOR_FN");let ls=(()=>{class oe{}return oe.\u0275fac=function(ie){return new(ie||oe)},oe.\u0275mod=x.oAB({type:oe}),oe.\u0275inj=x.cJS({providers:[kn(dn(ti.LegacyInterceptors,[{provide:as,useFactory:Ei},{provide:Un,useExisting:as,multi:!0}]))]}),oe})()},2504:(Jt,$e,$)=>{$.d($e,{tb:()=>F_,AFp:()=>Jm,ip1:()=>gE,hGG:()=>Tw,z2F:()=>Vh,Ojb:()=>$y,sBO:()=>dw,Sil:()=>Gb,EJc:()=>zb,Xts:()=>wu,SBq:()=>Za,lqb:()=>wa,qLn:()=>Al,vpe:()=>rl,XFs:()=>nt,OlP:()=>Mi,zs3:()=>$r,ZZ4:()=>V_,aQg:()=>G_,soG:()=>_v,YKP:()=>yx,h0i:()=>Bh,PXZ:()=>nw,R0b:()=>Rs,FiY:()=>bd,Lbi:()=>Nf,g9A:()=>Qm,Qsj:()=>ag,FYo:()=>Jd,JOm:()=>Jo,q3G:()=>ir,tp0:()=>wd,Rgc:()=>zp,dDg:()=>Jb,eoX:()=>CE,GfV:()=>Fu,s_b:()=>vv,ifc:()=>De,MMx:()=>Mx,Lck:()=>CS,Gpc:()=>Ln,RIp:()=>Cf,f3M:()=>ai,$WT:()=>go,MR2:()=>Tu,qFp:()=>Uw,tdS:()=>va,c2e:()=>vE,zSh:()=>Af,HDt:()=>QE,wAp:()=>Oe,vHH:()=>Me,lri:()=>wE,rWj:()=>TE,JZr:()=>Ot,EiD:()=>zm,mCW:()=>Ud,qzn:()=>wl,JVY:()=>Pm,pB0:()=>bc,eBb:()=>Nm,L6k:()=>Lm,LAX:()=>Om,D6c:()=>Ow,cg1:()=>tn,kuF:()=>Ft,kL8:()=>ze,dqk:()=>$n,iPO:()=>sw,Z0I:()=>os,eJc:()=>w_,QGY:()=>Pi,F4k:()=>W0,RDi:()=>wm,AaK:()=>wt,z3N:()=>Qo,qOj:()=>dp,TTD:()=>_o,_Bn:()=>vx,jDz:()=>xx,xp6:()=>jf,uIk:()=>Fc,ekj:()=>lv,Suo:()=>Yx,Xpm:()=>qr,lG2:()=>$l,Yz7:()=>ei,cJS:()=>$s,oAB:()=>mo,Yjl:()=>kr,Y36:()=>Ka,_UZ:()=>bp,qZA:()=>Sp,TgZ:()=>Ep,EpF:()=>Jg,n5z:()=>yl,LFG:()=>Wi,$8M:()=>Kh,$Z:()=>hg,NdJ:()=>Dp,CRH:()=>qx,kcU:()=>pd,O4$:()=>fd,oxw:()=>j0,ALo:()=>Lx,lcZ:()=>Nx,Dn7:()=>Ox,Q6J:()=>Dh,iGM:()=>jx,MAs:()=>nl,KtG:()=>ps,CHM:()=>ya,LSH:()=>Tf,P3R:()=>Gm,Udp:()=>av,YNc:()=>tl,W1O:()=>Qx,_uU:()=>fv,Oqu:()=>s,Gf:()=>Xx});var x=$(7579),pe=$(727),Pe=$(9751),Ve=$(8189),Ce=$(8421),Te=$(515),at=$(3269),Et=$(2076),tt=$(3099);function me(n){for(let i in n)if(n[i]===me)return i;throw Error("Could not find renamed property on target object.")}function We(n,i){for(const r in i)i.hasOwnProperty(r)&&!n.hasOwnProperty(r)&&(n[r]=i[r])}function wt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(wt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const i=n.toString();if(null==i)return""+i;const r=i.indexOf("\n");return-1===r?i:i.substring(0,r)}function pt(n,i){return null==n||""===n?null===i?"":i:null==i||""===i?n:n+" "+i}const Wt=me({__forward_ref__:me});function Ln(n){return n.__forward_ref__=Ln,n.toString=function(){return wt(this())},n}function St(n){return In(n)?n():n}function In(n){return"function"==typeof n&&n.hasOwnProperty(Wt)&&n.__forward_ref__===Ln}function Jn(n){return n&&!!n.\u0275providers}const Ot="https://g.co/ng/security#xss";class Me extends Error{constructor(i,r){super(Ft(i,r)),this.code=i}}function Ft(n,i){return`NG0${Math.abs(n)}${i?": "+i:""}`}function je(n){return"string"==typeof n?n:null==n?"":String(n)}function wn(n,i){throw new Me(-201,!1)}function Vn(n,i){null==n&&function Qt(n,i,r,a){throw new Error(`ASSERTION ERROR: ${n}`+(null==a?"":` [Expected=> ${r} ${a} ${i} <=Actual]`))}(i,n,null,"!=")}function ei(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function $s(n){return{providers:n.providers||[],imports:n.imports||[]}}function Yt(n){return Po(n,Ps)||Po(n,wr)}function os(n){return null!==Yt(n)}function Po(n,i){return n.hasOwnProperty(i)?n[i]:null}function Lo(n){return n&&(n.hasOwnProperty(Ni)||n.hasOwnProperty(pi))?n[Ni]:null}const Ps=me({\u0275prov:me}),Ni=me({\u0275inj:me}),wr=me({ngInjectableDef:me}),pi=me({ngInjectorDef:me});var nt=(()=>((nt=nt||{})[nt.Default=0]="Default",nt[nt.Host=1]="Host",nt[nt.Self=2]="Self",nt[nt.SkipSelf=4]="SkipSelf",nt[nt.Optional=8]="Optional",nt))();let un;function Bi(n){const i=un;return un=n,i}function Tr(n,i,r){const a=Yt(n);return a&&"root"==a.providedIn?void 0===a.value?a.value=a.factory():a.value:r&nt.Optional?null:void 0!==i?i:void wn(wt(n))}const $n=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),dn={},kn="__NG_DI_FLAG__",or="ngTempTokenPath",Qi=/\n/gm,Cr="__source";let ri;function Dr(n){const i=ri;return ri=n,i}function ls(n,i=nt.Default){if(void 0===ri)throw new Me(-203,!1);return null===ri?Tr(n,void 0,i):ri.get(n,i&nt.Optional?null:void 0,i)}function Wi(n,i=nt.Default){return(function Ji(){return un}()||ls)(St(n),i)}function ai(n,i=nt.Default){return Wi(n,Ee(i))}function Ee(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function ce(n){const i=[];for(let r=0;r<n.length;r++){const a=St(n[r]);if(Array.isArray(a)){if(0===a.length)throw new Me(900,!1);let u,f=nt.Default;for(let g=0;g<a.length;g++){const M=a[g],T=ue(M);"number"==typeof T?-1===T?u=M.token:f|=T:u=M}i.push(Wi(u,f))}else i.push(Wi(a))}return i}function ee(n,i){return n[kn]=i,n.prototype[kn]=i,n}function ue(n){return n[kn]}function q(n){return{toString:n}.toString()}var ie=(()=>((ie=ie||{})[ie.OnPush=0]="OnPush",ie[ie.Default=1]="Default",ie))(),De=(()=>{return(n=De||(De={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",De;var n})();const Qe={},qe=[],bt=me({\u0275cmp:me}),mi=me({\u0275dir:me}),gn=me({\u0275pipe:me}),mr=me({\u0275mod:me}),gi=me({\u0275fac:me}),Vi=me({__NG_ELEMENT_ID__:me}),Ar=me({__NG_ENV_ID__:me});function er(n,i,r){let a=n.length;for(;;){const u=n.indexOf(i,r);if(-1===u)return u;if(0===u||n.charCodeAt(u-1)<=32){const f=i.length;if(u+f===a||n.charCodeAt(u+f)<=32)return u}r=u+1}}function cs(n,i,r){let a=0;for(;a<r.length;){const u=r[a];if("number"==typeof u){if(0!==u)break;a++;const f=r[a++],g=r[a++],M=r[a++];n.setAttribute(i,g,M,f)}else{const f=u,g=r[++a];Ys(f)?n.setProperty(i,f,g):n.setAttribute(i,f,g),a++}}return a}function Ls(n){return 3===n||4===n||6===n}function Ys(n){return 64===n.charCodeAt(0)}function Yr(n,i){if(null!==i&&0!==i.length)if(null===n||0===n.length)n=i.slice();else{let r=-1;for(let a=0;a<i.length;a++){const u=i[a];"number"==typeof u?r=u:0===r||di(n,r,u,null,-1===r||2===r?i[++a]:null)}}return n}function di(n,i,r,a,u){let f=0,g=n.length;if(-1===i)g=-1;else for(;f<n.length;){const M=n[f++];if("number"==typeof M){if(M===i){g=-1;break}if(M>i){g=f-1;break}}}for(;f<n.length;){const M=n[f];if("number"==typeof M)break;if(M===r){if(null===a)return void(null!==u&&(n[f+1]=u));if(a===n[f+1])return void(n[f+2]=u)}f++,null!==a&&f++,null!==u&&f++}-1!==g&&(n.splice(g,0,i),f=g+1),n.splice(f++,0,r),null!==a&&n.splice(f++,0,a),null!==u&&n.splice(f++,0,u)}const bi="ng-template";function us(n,i,r){let a=0,u=!0;for(;a<n.length;){let f=n[a++];if("string"==typeof f&&u){const g=n[a++];if(r&&"class"===f&&-1!==er(g.toLowerCase(),i,0))return!0}else{if(1===f){for(;a<n.length&&"string"==typeof(f=n[a++]);)if(f.toLowerCase()===i)return!0;return!1}"number"==typeof f&&(u=!1)}}return!1}function Ms(n){return 4===n.type&&n.value!==bi}function $i(n,i,r){return i===(4!==n.type||r?n.value:bi)}function xs(n,i,r){let a=4;const u=n.attrs||[],f=function No(n){for(let i=0;i<n.length;i++)if(Ls(n[i]))return i;return n.length}(u);let g=!1;for(let M=0;M<i.length;M++){const T=i[M];if("number"!=typeof T){if(!g)if(4&a){if(a=2|1&a,""!==T&&!$i(n,T,r)||""===T&&1===i.length){if(Ir(a))return!1;g=!0}}else{const N=8&a?T:i[++M];if(8&a&&null!==n.attrs){if(!us(n.attrs,N,r)){if(Ir(a))return!1;g=!0}continue}const Z=ra(8&a?"class":T,u,Ms(n),r);if(-1===Z){if(Ir(a))return!1;g=!0;continue}if(""!==N){let ae;ae=Z>f?"":u[Z+1].toLowerCase();const fe=8&a?ae:null;if(fe&&-1!==er(fe,N,0)||2&a&&N!==ae){if(Ir(a))return!1;g=!0}}}}else{if(!g&&!Ir(a)&&!Ir(T))return!1;if(g&&Ir(T))continue;g=!1,a=T|1&a}}return Ir(a)||g}function Ir(n){return 0==(1&n)}function ra(n,i,r,a){if(null===i)return-1;let u=0;if(a||!r){let f=!1;for(;u<i.length;){const g=i[u];if(g===n)return u;if(3===g||6===g)f=!0;else{if(1===g||2===g){let M=i[++u];for(;"string"==typeof M;)M=i[++u];continue}if(4===g)break;if(0===g){u+=4;continue}}u+=f?1:2}return-1}return function Xc(n,i){let r=n.indexOf(4);if(r>-1)for(r++;r<n.length;){const a=n[r];if("number"==typeof a)return-1;if(a===i)return r;r++}return-1}(i,n)}function sl(n,i,r=!1){for(let a=0;a<i.length;a++)if(xs(n,i[a],r))return!0;return!1}function ol(n,i){return n?":not("+i.trim()+")":i}function Oa(n){let i=n[0],r=1,a=2,u="",f=!1;for(;r<n.length;){let g=n[r];if("string"==typeof g)if(2&a){const M=n[++r];u+="["+g+(M.length>0?'="'+M+'"':"")+"]"}else 8&a?u+="."+g:4&a&&(u+=" "+g);else""!==u&&!Ir(g)&&(i+=ol(f,u),u=""),a=g,f=f||!Ir(a);r++}return""!==u&&(i+=ol(f,u)),i}function qr(n){return q(()=>{const i=ll(n),r={...i,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ie.OnPush,directiveDefs:null,pipeDefs:null,dependencies:i.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||De.Emulated,styles:n.styles||qe,_:null,schemas:n.schemas||null,tView:null,id:""};jl(r);const a=n.dependencies;return r.directiveDefs=Fa(a,!1),r.pipeDefs=Fa(a,!0),r.id=function cl(n){let i=0;const r=JSON.stringify([n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.exportAs,n.inputs,n.outputs,Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery]);for(const u of r)i=Math.imul(31,i)+u.charCodeAt(0)<<0;return i+=2147483648,"c"+i}(r),r})}function po(n){return ni(n)||qi(n)}function Oo(n){return null!==n}function mo(n){return q(()=>({type:n.type,bootstrap:n.bootstrap||qe,declarations:n.declarations||qe,imports:n.imports||qe,exports:n.exports||qe,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Wl(n,i){if(null==n)return Qe;const r={};for(const a in n)if(n.hasOwnProperty(a)){let u=n[a],f=u;Array.isArray(u)&&(f=u[1],u=u[0]),r[u]=a,i&&(i[u]=f)}return r}function $l(n){return q(()=>{const i=ll(n);return jl(i),i})}function kr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function ni(n){return n[bt]||null}function qi(n){return n[mi]||null}function Rr(n){return n[gn]||null}function go(n){const i=ni(n)||qi(n)||Rr(n);return null!==i&&i.standalone}function gr(n,i){const r=n[mr]||null;if(!r&&!0===i)throw new Error(`Type ${wt(n)} does not have '\u0275mod' property.`);return r}function ll(n){const i={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||qe,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Wl(n.inputs,i),outputs:Wl(n.outputs)}}function jl(n){n.features?.forEach(i=>i(n))}function Fa(n,i){if(!n)return null;const r=i?Rr:po;return()=>("function"==typeof n?n():n).map(a=>r(a)).filter(Oo)}const Oi=0,At=1,hn=2,li=3,ar=4,tr=5,Fi=6,Fo=7,Ui=8,Uo=9,Br=10,ln=11,la=12,vo=13,vr=14,Ii=15,ds=16,_n=17,ki=18,Zs=19,Yc=20,Hr=21,Ks=22,Ua=23,ko=24,jn=25,ka=1,Yl=2,hs=7,Ba=8,ca=9,ji=11;function zr(n){return Array.isArray(n)&&"object"==typeof n[ka]}function lr(n){return Array.isArray(n)&&!0===n[ka]}function qc(n){return 0!=(4&n.flags)}function Bo(n){return n.componentOffset>-1}function Ho(n){return 1==(1&n.flags)}function fs(n){return!!n.template}function da(n){return 0!=(512&n[hn])}function Vo(n,i){return n.hasOwnProperty(gi)?n[gi]:null}const Jl=Symbol("SIGNAL");function ul(n,i,r={}){return i[Jl]=n,Object.assign(i,r)}function Ql(n,i){return(null===n||"object"!=typeof n)&&Object.is(n,i)}let yo=$n.WeakRef??class pa{constructor(i){this.ref=i}deref(){return this.ref}},tc=0,Ri=null,Cn=!1;function Xi(n){const i=Ri;return Ri=n,i}class et{constructor(){this.id=tc++,this.ref=function ec(n){return new yo(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[i,r]of this.producers){const a=r.producerNode.deref();if(void 0!==a&&r.atTrackingVersion===this.trackingVersion){if(a.producerPollStatus(r.seenValueVersion))return!0}else this.producers.delete(i),a?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const i=Cn;Cn=!0;try{for(const[r,a]of this.consumers){const u=a.consumerNode.deref();void 0!==u&&u.trackingVersion===a.atTrackingVersion?u.onConsumerDependencyMayHaveChanged():(this.consumers.delete(r),u?.producers.delete(this.id))}}finally{Cn=i}}producerAccessed(){if(Cn)throw new Error("");if(null===Ri)return;let i=Ri.producers.get(this.id);void 0===i?(i={consumerNode:Ri.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Ri.trackingVersion},Ri.producers.set(this.id,i),this.consumers.set(Ri.id,i)):(i.seenValueVersion=this.valueVersion,i.atTrackingVersion=Ri.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Ri?.consumerAllowSignalWrites}producerPollStatus(i){return this.valueVersion!==i||(this.onProducerUpdateValueVersion(),this.valueVersion!==i)}}let Js=function Wo(){throw new Error};function Fs(){Js()}class nc extends et{constructor(i,r){super(),this.value=i,this.equal=r,this.consumerAllowSignalWrites=!1}onConsumerDependencyMayHaveChanged(){}onProducerUpdateValueVersion(){}set(i){this.producerUpdatesAllowed||Fs(),this.equal(this.value,i)||(this.value=i,this.valueVersion++,this.producerMayHaveChanged())}update(i){this.producerUpdatesAllowed||Fs(),this.set(i(this.value))}mutate(i){this.producerUpdatesAllowed||Fs(),i(this.value),this.valueVersion++,this.producerMayHaveChanged()}asReadonly(){return void 0===this.readonlySignal&&(this.readonlySignal=ul(this,()=>this.signal())),this.readonlySignal}signal(){return this.producerAccessed(),this.value}}function va(n,i){const r=new nc(n,i?.equal??Ql);return ul(r,r.signal.bind(r),{set:r.set.bind(r),update:r.update.bind(r),mutate:r.mutate.bind(r),asReadonly:r.asReadonly.bind(r)})}const ic=()=>{};class dd extends et{constructor(i,r,a){super(),this.watch=i,this.schedule=r,this.dirty=!1,this.cleanupFn=ic,this.registerOnCleanup=u=>{this.cleanupFn=u},this.consumerAllowSignalWrites=a}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const i=Xi(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=ic,this.watch(this.registerOnCleanup)}finally{Xi(i)}}cleanup(){this.cleanupFn()}}class Ss{constructor(i,r,a){this.previousValue=i,this.currentValue=r,this.firstChange=a}isFirstChange(){return this.firstChange}}function _o(){return dl}function dl(n){return n.type.prototype.ngOnChanges&&(n.setInput=hl),Qs}function Qs(){const n=eo(this),i=n?.current;if(i){const r=n.previous;if(r===Qe)n.previous=i;else for(let a in i)r[a]=i[a];n.current=null,this.ngOnChanges(i)}}function hl(n,i,r,a){const u=this.declaredInputs[r],f=eo(n)||function vi(n,i){return n[rc]=i}(n,{previous:Qe,current:null}),g=f.current||(f.current={}),M=f.previous,T=M[u];g[u]=new Ss(T&&T.currentValue,i,M===Qe),n[a]=i}_o.ngInherit=!0;const rc="__ngSimpleChanges__";function eo(n){return n[rc]||null}const Us=function(n,i,r){},eu="svg";function Ti(n){for(;Array.isArray(n);)n=n[Oi];return n}function J(n,i){return Ti(i[n])}function w(n,i){return Ti(i[n.index])}function A(n,i){return n.data[i]}function k(n,i){return n[i]}function Y(n,i){const r=i[n];return zr(r)?r:r[Oi]}function xe(n){return 128==(128&n[hn])}function Nn(n,i){return null==i?null:n[i]}function Hn(n){n[_n]=0}function Rn(n){1024&n[hn]||(n[hn]|=1024,yi(n,1))}function Mn(n){1024&n[hn]&&(n[hn]&=-1025,yi(n,-1))}function yi(n,i){let r=n[li];if(null===r)return;r[tr]+=i;let a=r;for(r=r[li];null!==r&&(1===i&&1===a[tr]||-1===i&&0===a[tr]);)r[tr]+=i,a=r,r=r[li]}const $t={lFrame:ro(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function cr(){return $t.bindingsEnabled}function Ye(){return $t.lFrame.lView}function Nt(){return $t.lFrame.tView}function ya(n){return $t.lFrame.contextLView=n,n[Ui]}function ps(n){return $t.lFrame.contextLView=null,n}function Lr(){let n=$h();for(;null!==n&&64===n.type;)n=n.parent;return n}function $h(){return $t.lFrame.currentTNode}function Vr(n,i){const r=$t.lFrame;r.currentTNode=n,r.isParent=i}function Nr(){return $t.lFrame.isParent}function Jr(){const n=$t.lFrame;let i=n.bindingRootIndex;return-1===i&&(i=n.bindingRootIndex=n.tView.bindingStartIndex),i}function Gr(){return $t.lFrame.bindingIndex++}function jh(n,i){const r=$t.lFrame;r.bindingIndex=r.bindingRootIndex=n,fl(i)}function fl(n){$t.lFrame.currentDirectiveIndex=n}function Yh(){return $t.lFrame.currentQueryIndex}function ou(n){$t.lFrame.currentQueryIndex=n}function ws(n){const i=n[At];return 2===i.type?i.declTNode:1===i.type?n[Fi]:null}function Ts(n,i,r){if(r&nt.SkipSelf){let u=i,f=n;for(;!(u=u.parent,null!==u||r&nt.Host||(u=ws(f),null===u||(f=f[vr],10&u.type))););if(null===u)return!1;i=u,n=f}const a=$t.lFrame=pl();return a.currentTNode=i,a.lView=n,!0}function io(n){const i=pl(),r=n[At];$t.lFrame=i,i.currentTNode=r.firstChild,i.lView=n,i.tView=r,i.contextLView=n,i.bindingIndex=r.bindingStartIndex,i.inI18n=!1}function pl(){const n=$t.lFrame,i=null===n?null:n.child;return null===i?ro(n):i}function ro(n){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=i),i}function Ma(){const n=$t.lFrame;return $t.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const xa=Ma;function cc(){const n=Ma();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Mr(){return $t.lFrame.selectedIndex}function so(n){$t.lFrame.selectedIndex=n}function Xn(){const n=$t.lFrame;return A(n.tView,n.selectedIndex)}function fd(){$t.lFrame.currentNamespace=eu}function pd(){!function oo(){$t.lFrame.currentNamespace=null}()}let cu=!0;function Ht(){return cu}function y(n){cu=n}function v(n,i){for(let r=i.directiveStart,a=i.directiveEnd;r<a;r++){const f=n.data[r].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:M,ngAfterViewInit:T,ngAfterViewChecked:N,ngOnDestroy:H}=f;g&&(n.contentHooks??=[]).push(-r,g),M&&((n.contentHooks??=[]).push(r,M),(n.contentCheckHooks??=[]).push(r,M)),T&&(n.viewHooks??=[]).push(-r,T),N&&((n.viewHooks??=[]).push(r,N),(n.viewCheckHooks??=[]).push(r,N)),null!=H&&(n.destroyHooks??=[]).push(r,H)}}function C(n,i,r){G(n,i,3,r)}function L(n,i,r,a){(3&n[hn])===r&&G(n,i,r,a)}function z(n,i){let r=n[hn];(3&r)===i&&(r&=4095,r+=1,n[hn]=r)}function G(n,i,r,a){const f=a??-1,g=i.length-1;let M=0;for(let T=void 0!==a?65535&n[_n]:0;T<g;T++)if("number"==typeof i[T+1]){if(M=i[T],null!=a&&M>=a)break}else i[T]<0&&(n[_n]+=65536),(M<f||-1==f)&&(Ze(n,r,i,T),n[_n]=(4294901760&n[_n])+T+2),T++}function se(n,i){Us(4,n,i);const r=Xi(null);try{i.call(n)}finally{Xi(r),Us(5,n,i)}}function Ze(n,i,r,a){const u=r[a]<0,f=r[a+1],M=n[u?-r[a]:r[a]];u?n[hn]>>12<n[_n]>>16&&(3&n[hn])===i&&(n[hn]+=4096,se(M,f)):se(M,f)}const Ct=-1;class Gt{constructor(i,r,a){this.factory=i,this.resolving=!1,this.canSeeViewProviders=r,this.injectImpl=a}}function bv(n){return n!==Ct}function gd(n){return 32767&n}function pc(n,i){let r=function ao(n){return n>>16}(n),a=i;for(;r>0;)a=a[vr],r--;return a}let Wa=!0;function Qr(n){const i=Wa;return Wa=n,i}const xr=255,Yn=5;let Wp=0;const Er={};function uu(n,i){const r=vl(n,i);if(-1!==r)return r;const a=i[At];a.firstCreatePass&&(n.injectorIndex=i.length,$a(a.data,n),$a(i,null),$a(a.blueprint,null));const u=ja(n,i),f=n.injectorIndex;if(bv(u)){const g=gd(u),M=pc(u,i),T=M[At].data;for(let N=0;N<8;N++)i[f+N]=M[g+N]|T[g+N]}return i[f+8]=u,f}function $a(n,i){n.push(0,0,0,0,0,0,0,0,i)}function vl(n,i){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===i[n.injectorIndex+8]?-1:n.injectorIndex}function ja(n,i){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let r=0,a=null,u=i;for(;null!==u;){if(a=Zh(u),null===a)return Ct;if(r++,u=u[vr],-1!==a.injectorIndex)return a.injectorIndex|r<<16}return Ct}function du(n,i,r){!function yd(n,i,r){let a;"string"==typeof r?a=r.charCodeAt(0)||0:r.hasOwnProperty(Vi)&&(a=r[Vi]),null==a&&(a=r[Vi]=Wp++);const u=a&xr;i.data[n+(u>>Yn)]|=1<<u}(n,i,r)}function hu(n,i,r){if(r&nt.Optional||void 0!==n)return n;wn()}function fu(n,i,r,a){if(r&nt.Optional&&void 0===a&&(a=null),!(r&(nt.Self|nt.Host))){const u=n[Uo],f=Bi(void 0);try{return u?u.get(i,a,r&nt.Optional):Tr(i,a,r&nt.Optional)}finally{Bi(f)}}return hu(a,0,r)}function pu(n,i,r,a=nt.Default,u){if(null!==n){if(2048&i[hn]){const g=function wv(n,i,r,a,u){let f=n,g=i;for(;null!==f&&null!==g&&2048&g[hn]&&!(512&g[hn]);){const M=qh(f,g,r,a|nt.Self,Er);if(M!==Er)return M;let T=f.parent;if(!T){const N=g[Yc];if(N){const H=N.get(r,Er,a);if(H!==Er)return H}T=Zh(g),g=g[vr]}f=T}return u}(n,i,r,a,Er);if(g!==Er)return g}const f=qh(n,i,r,a,Er);if(f!==Er)return f}return fu(i,r,a,u)}function qh(n,i,r,a,u){const f=function Md(n){if("string"==typeof n)return n.charCodeAt(0)||0;const i=n.hasOwnProperty(Vi)?n[Vi]:void 0;return"number"==typeof i?i>=0?i&xr:mc:i}(r);if("function"==typeof f){if(!Ts(i,n,a))return a&nt.Host?hu(u,0,a):fu(i,r,a,u);try{const g=f(a);if(null!=g||a&nt.Optional)return g;wn()}finally{xa()}}else if("number"==typeof f){let g=null,M=vl(n,i),T=Ct,N=a&nt.Host?i[Ii][Fi]:null;for((-1===M||a&nt.SkipSelf)&&(T=-1===M?ja(n,i):i[M+8],T!==Ct&&jp(a,!1)?(g=i[At],M=gd(T),i=pc(T,i)):M=-1);-1!==M;){const H=i[At];if(es(f,M,H.data)){const Z=$p(M,i,r,g,a,N);if(Z!==Er)return Z}T=i[M+8],T!==Ct&&jp(a,i[At].data[M+8]===N)&&es(f,M,i)?(g=H,M=gd(T),i=pc(T,i)):M=-1}}return u}function $p(n,i,r,a,u,f){const g=i[At],M=g.data[n+8],H=mu(M,g,r,null==a?Bo(M)&&Wa:a!=g&&0!=(3&M.type),u&nt.Host&&f===M);return null!==H?Zo(i,g,H,M):Er}function mu(n,i,r,a,u){const f=n.providerIndexes,g=i.data,M=1048575&f,T=n.directiveStart,H=f>>20,ae=u?M+H:n.directiveEnd;for(let fe=a?M:M+H;fe<ae;fe++){const Be=g[fe];if(fe<T&&r===Be||fe>=T&&Be.type===r)return fe}if(u){const fe=g[T];if(fe&&fs(fe)&&fe.type===r)return T}return null}function Zo(n,i,r,a){let u=n[r];const f=i.data;if(function hi(n){return n instanceof Gt}(u)){const g=u;g.resolving&&function Je(n,i){const r=i?`. Dependency path: ${i.join(" > ")} > ${n}`:"";throw new Me(-200,`Circular dependency in DI detected for ${n}${r}`)}(function Le(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():je(n)}(f[r]));const M=Qr(g.canSeeViewProviders);g.resolving=!0;const T=g.injectImpl?Bi(g.injectImpl):null;Ts(n,a,nt.Default);try{u=n[r]=g.factory(void 0,f,n,a),i.firstCreatePass&&r>=a.directiveStart&&function E(n,i,r){const{ngOnChanges:a,ngOnInit:u,ngDoCheck:f}=i.type.prototype;if(a){const g=dl(i);(r.preOrderHooks??=[]).push(n,g),(r.preOrderCheckHooks??=[]).push(n,g)}u&&(r.preOrderHooks??=[]).push(0-n,u),f&&((r.preOrderHooks??=[]).push(n,f),(r.preOrderCheckHooks??=[]).push(n,f))}(r,f[r],i)}finally{null!==T&&Bi(T),Qr(M),g.resolving=!1,xa()}}return u}function es(n,i,r){return!!(r[i+(n>>Yn)]&1<<n)}function jp(n,i){return!(n&nt.Self||n&nt.Host&&i)}class Ea{constructor(i,r){this._tNode=i,this._lView=r}get(i,r,a){return pu(this._tNode,this._lView,i,Ee(a),r)}}function mc(){return new Ea(Lr(),Ye())}function yl(n){return q(()=>{const i=n.prototype.constructor,r=i[gi]||Wr(i),a=Object.prototype;let u=Object.getPrototypeOf(n.prototype).constructor;for(;u&&u!==a;){const f=u[gi]||Wr(u);if(f&&f!==r)return f;u=Object.getPrototypeOf(u)}return f=>new f})}function Wr(n){return In(n)?()=>{const i=Wr(St(n));return i&&i()}:Vo(n)}function Zh(n){const i=n[At],r=i.type;return 2===r?i.declTNode:1===r?n[Fi]:null}function Kh(n){return function _d(n,i){if("class"===i)return n.classes;if("style"===i)return n.styles;const r=n.attrs;if(r){const a=r.length;let u=0;for(;u<a;){const f=r[u];if(Ls(f))break;if(0===f)u+=2;else if("number"==typeof f)for(u++;u<a&&"string"==typeof r[u];)u++;else{if(f===i)return r[u+1];u+=2}}}return null}(Lr(),n)}const vc="__parameters__";function xo(n,i,r){return q(()=>{const a=function Sr(n){return function(...r){if(n){const a=n(...r);for(const u in a)this[u]=a[u]}}}(i);function u(...f){if(this instanceof u)return a.apply(this,f),this;const g=new u(...f);return M.annotation=g,M;function M(T,N,H){const Z=T.hasOwnProperty(vc)?T[vc]:Object.defineProperty(T,vc,{value:[]})[vc];for(;Z.length<=H;)Z.push(null);return(Z[H]=Z[H]||[]).push(g),T}}return r&&(u.prototype=Object.create(r.prototype)),u.prototype.ngMetadataName=n,u.annotationCls=u,u})}function vu(n,i){n.forEach(r=>Array.isArray(r)?vu(r,i):i(r))}function qp(n,i,r){i>=n.length?n.push(r):n.splice(i,0,r)}function Ed(n,i){return i>=n.length-1?n.pop():n.splice(i,1)[0]}function zs(n,i,r){let a=_c(n,i);return a>=0?n[1|a]=r:(a=~a,function Iv(n,i,r,a){let u=n.length;if(u==i)n.push(r,a);else if(1===u)n.push(a,n[0]),n[0]=r;else{for(u--,n.push(n[u-1],n[u]);u>i;)n[u]=n[u-2],u--;n[i]=r,n[i+1]=a}}(n,a,i,r)),a}function ef(n,i){const r=_c(n,i);if(r>=0)return n[1|r]}function _c(n,i){return function Zp(n,i,r){let a=0,u=n.length>>r;for(;u!==a;){const f=a+(u-a>>1),g=n[f<<r];if(i===g)return f<<r;g>i?u=f:a=f+1}return~(u<<r)}(n,i,1)}const bd=ee(xo("Optional"),8),wd=ee(xo("SkipSelf"),4);function Dd(n){return 128==(128&n.flags)}var Jo=(()=>((Jo=Jo||{})[Jo.Important=1]="Important",Jo[Jo.DashCase=2]="DashCase",Jo))();const cf=new Map;let ey=0;const df="__ngContext__";function ts(n,i){zr(i)?(n[df]=i[Zs],function ny(n){cf.set(n[Zs],n)}(i)):n[df]=i}let hf;function ff(n,i){return hf(n,i)}function Id(n){const i=n[li];return lr(i)?i[li]:i}function mm(n){return dy(n[la])}function gm(n){return dy(n[ar])}function dy(n){for(;null!==n&&!lr(n);)n=n[ar];return n}function xu(n,i,r,a,u){if(null!=a){let f,g=!1;lr(a)?f=a:zr(a)&&(g=!0,a=a[Oi]);const M=Ti(a);0===n&&null!==r?null==u?gy(i,r,M):Ec(i,r,M,u||null,!0):1===n&&null!==r?Ec(i,r,M,u||null,!0):2===n?function Rd(n,i,r){const a=gf(n,i);a&&function _M(n,i,r,a){n.removeChild(i,r,a)}(n,a,i,r)}(i,M,g):3===n&&i.destroyNode(M),null!=f&&function xl(n,i,r,a,u){const f=r[hs];f!==Ti(r)&&xu(i,n,a,f,u);for(let M=ji;M<r.length;M++){const T=r[M];Ml(T[At],T,n,i,a,f)}}(i,n,f,r,u)}}function mf(n,i,r){return n.createElement(i,r)}function fy(n,i){const r=n[ca],a=r.indexOf(i);Mn(i),r.splice(a,1)}function ym(n,i){if(n.length<=ji)return;const r=ji+i,a=n[r];if(a){const u=a[ds];null!==u&&u!==n&&fy(u,a),i>0&&(n[r-1][ar]=a[ar]);const f=Ed(n,ji+i);!function dM(n,i){Ml(n,i,i[ln],2,null,null),i[Oi]=null,i[Fi]=null}(a[At],a);const g=f[ki];null!==g&&g.detachView(f[At]),a[li]=null,a[ar]=null,a[hn]&=-129}return a}function py(n,i){if(!(256&i[hn])){const r=i[ln];i[Ua]?.destroy(),i[ko]?.destroy(),r.destroyNode&&Ml(n,i,r,3,null,null),function pM(n){let i=n[la];if(!i)return _m(n[At],n);for(;i;){let r=null;if(zr(i))r=i[la];else{const a=i[ji];a&&(r=a)}if(!r){for(;i&&!i[ar]&&i!==n;)zr(i)&&_m(i[At],i),i=i[li];null===i&&(i=n),zr(i)&&_m(i[At],i),r=i&&i[ar]}i=r}}(i)}}function _m(n,i){if(!(256&i[hn])){i[hn]&=-129,i[hn]|=256,function yM(n,i){let r;if(null!=n&&null!=(r=n.destroyHooks))for(let a=0;a<r.length;a+=2){const u=i[r[a]];if(!(u instanceof Gt)){const f=r[a+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const M=u[f[g]],T=f[g+1];Us(4,M,T);try{T.call(M)}finally{Us(5,M,T)}}else{Us(4,u,f);try{f.call(u)}finally{Us(5,u,f)}}}}}(n,i),function vM(n,i){const r=n.cleanup,a=i[Fo];if(null!==r)for(let f=0;f<r.length-1;f+=2)if("string"==typeof r[f]){const g=r[f+3];g>=0?a[g]():a[-g].unsubscribe(),f+=2}else r[f].call(a[r[f+1]]);null!==a&&(i[Fo]=null);const u=i[Hr];if(null!==u){for(let f=0;f<u.length;f++)(0,u[f])();i[Hr]=null}}(n,i),1===i[At].type&&i[ln].destroy();const r=i[ds];if(null!==r&&lr(i[li])){r!==i[li]&&fy(r,i);const a=i[ki];null!==a&&a.detachView(n)}!function iy(n){cf.delete(n[Zs])}(i)}}function Mm(n,i,r){return function my(n,i,r){let a=i;for(;null!==a&&40&a.type;)a=(i=a).parent;if(null===a)return r[Oi];{const{componentOffset:u}=a;if(u>-1){const{encapsulation:f}=n.data[a.directiveStart+u];if(f===De.None||f===De.Emulated)return null}return w(a,r)}}(n,i.parent,r)}function Ec(n,i,r,a,u){n.insertBefore(i,r,a,u)}function gy(n,i,r){n.appendChild(i,r)}function vy(n,i,r,a,u){null!==a?Ec(n,i,r,a,u):gy(n,i,r)}function gf(n,i){return n.parentNode(i)}let Rt,Sa,Nd,Od,zn=function _y(n,i,r){return 40&n.type?w(n,r):null};function _l(n,i,r,a){const u=Mm(n,a,i),f=i[ln],M=function yy(n,i,r){return zn(n,i,r)}(a.parent||i[Fi],a,i);if(null!=u)if(Array.isArray(r))for(let T=0;T<r.length;T++)vy(f,u,r[T],M,!1);else vy(f,u,r,M,!1);void 0!==Rt&&Rt(f,a,i,r,u)}function Eu(n,i){if(null!==i){const r=i.type;if(3&r)return w(i,n);if(4&r)return vf(-1,n[i.index]);if(8&r){const a=i.child;if(null!==a)return Eu(n,a);{const u=n[i.index];return lr(u)?vf(-1,u):Ti(u)}}if(32&r)return ff(i,n)()||Ti(n[i.index]);{const a=xm(n,i);return null!==a?Array.isArray(a)?a[0]:Eu(Id(n[Ii]),a):Eu(n,i.next)}}return null}function xm(n,i){return null!==i?n[Ii][Fi].projection[i.projection]:null}function vf(n,i){const r=ji+n+1;if(r<i.length){const a=i[r],u=a[At].firstChild;if(null!==u)return Eu(a,u)}return i[hs]}function yf(n,i,r,a,u,f,g){for(;null!=r;){const M=a[r.index],T=r.type;if(g&&0===i&&(M&&ts(Ti(M),a),r.flags|=2),32!=(32&r.flags))if(8&T)yf(n,i,r.child,a,u,f,!1),xu(i,n,u,M,f);else if(32&T){const N=ff(r,a);let H;for(;H=N();)xu(i,n,u,H,f);xu(i,n,u,M,f)}else 16&T?_f(n,i,a,r,u,f):xu(i,n,u,M,f);r=g?r.projectionNext:r.next}}function Ml(n,i,r,a,u,f){yf(r,a,n.firstChild,i,u,f,!1)}function _f(n,i,r,a,u,f){const g=r[Ii],T=g[Fi].projection[a.projection];if(Array.isArray(T))for(let N=0;N<T.length;N++)xu(i,n,u,T[N],f);else{let N=T;const H=g[li];Dd(a)&&(N.flags|=128),yf(n,i,N,H,u,f,!0)}}function Pd(n,i,r){""===r?n.removeAttribute(i,"class"):n.setAttribute(i,"class",r)}function Xa(n,i,r){const{mergedAttrs:a,classes:u,styles:f}=r;null!==a&&cs(n,i,a),null!==u&&Pd(n,i,u),null!==f&&function Sm(n,i,r){n.setAttribute(i,"style",r)}(n,i,f)}function El(n){return function Ld(){if(void 0===Sa&&(Sa=null,$n.trustedTypes))try{Sa=$n.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Sa}()?.createHTML(n)||n}function wm(n){Nd=n}function Dm(n){return function Ef(){if(void 0===Od&&(Od=null,$n.trustedTypes))try{Od=$n.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Od}()?.createScriptURL(n)||n}class bl{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ot})`}}class Ey extends bl{getTypeName(){return"HTML"}}class Sy extends bl{getTypeName(){return"Style"}}class by extends bl{getTypeName(){return"Script"}}class Am extends bl{getTypeName(){return"URL"}}class Im extends bl{getTypeName(){return"ResourceURL"}}function Qo(n){return n instanceof bl?n.changingThisBreaksApplicationSecurity:n}function wl(n,i){const r=function Rm(n){return n instanceof bl&&n.getTypeName()||null}(n);if(null!=r&&r!==i){if("ResourceURL"===r&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${r} (see ${Ot})`)}return r===i}function Pm(n){return new Ey(n)}function Lm(n){return new Sy(n)}function Nm(n){return new by(n)}function Om(n){return new Am(n)}function bc(n){return new Im(n)}class br{constructor(i){this.inertDocumentHelper=i}getInertBodyElement(i){i="<body><remove></remove>"+i;try{const r=(new window.DOMParser).parseFromString(El(i),"text/html").body;return null===r?this.inertDocumentHelper.getInertBodyElement(i):(r.removeChild(r.firstChild),r)}catch{return null}}}class Fd{constructor(i){this.defaultDoc=i,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(i){const r=this.inertDocument.createElement("template");return r.innerHTML=El(i),r}}const Ty=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Ud(n){return(n=String(n)).match(Ty)?n:"unsafe:"+n}function ba(n){const i={};for(const r of n.split(","))i[r]=!0;return i}function Su(...n){const i={};for(const r of n)for(const a in r)r.hasOwnProperty(a)&&(i[a]=!0);return i}const Fm=ba("area,br,col,hr,img,wbr"),Um=ba("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),km=ba("rp,rt"),Sf=Su(Fm,Su(Um,ba("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Su(km,ba("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Su(km,Um)),bf=ba("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Bm=Su(bf,ba("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ba("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Cy=ba("script,style,template");class Dy{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(i){let r=i.firstChild,a=!0;for(;r;)if(r.nodeType===Node.ELEMENT_NODE?a=this.startElement(r):r.nodeType===Node.TEXT_NODE?this.chars(r.nodeValue):this.sanitizedSomething=!0,a&&r.firstChild)r=r.firstChild;else for(;r;){r.nodeType===Node.ELEMENT_NODE&&this.endElement(r);let u=this.checkClobberedElement(r,r.nextSibling);if(u){r=u;break}r=this.checkClobberedElement(r,r.parentNode)}return this.buf.join("")}startElement(i){const r=i.nodeName.toLowerCase();if(!Sf.hasOwnProperty(r))return this.sanitizedSomething=!0,!Cy.hasOwnProperty(r);this.buf.push("<"),this.buf.push(r);const a=i.attributes;for(let u=0;u<a.length;u++){const f=a.item(u),g=f.name,M=g.toLowerCase();if(!Bm.hasOwnProperty(M)){this.sanitizedSomething=!0;continue}let T=f.value;bf[M]&&(T=Ud(T)),this.buf.push(" ",g,'="',Hm(T),'"')}return this.buf.push(">"),!0}endElement(i){const r=i.nodeName.toLowerCase();Sf.hasOwnProperty(r)&&!Fm.hasOwnProperty(r)&&(this.buf.push("</"),this.buf.push(r),this.buf.push(">"))}chars(i){this.buf.push(Hm(i))}checkClobberedElement(i,r){if(r&&(i.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`);return r}}const Ay=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Iy=/([^\#-~ |!])/g;function Hm(n){return n.replace(/&/g,"&amp;").replace(Ay,function(i){return"&#"+(1024*(i.charCodeAt(0)-55296)+(i.charCodeAt(1)-56320)+65536)+";"}).replace(Iy,function(i){return"&#"+i.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let kd;function zm(n,i){let r=null;try{kd=kd||function dr(n){const i=new Fd(n);return function wy(){try{return!!(new window.DOMParser).parseFromString(El(""),"text/html")}catch{return!1}}()?new br(i):i}(n);let a=i?String(i):"";r=kd.getInertBodyElement(a);let u=5,f=a;do{if(0===u)throw new Error("Failed to sanitize html because the input is unstable");u--,a=f,f=r.innerHTML,r=kd.getInertBodyElement(a)}while(a!==f);return El((new Dy).sanitizeChildren(wf(r)||r))}finally{if(r){const a=wf(r)||r;for(;a.firstChild;)a.removeChild(a.firstChild)}}}function wf(n){return"content"in n&&function Ry(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var ir=(()=>((ir=ir||{})[ir.NONE=0]="NONE",ir[ir.HTML=1]="HTML",ir[ir.STYLE=2]="STYLE",ir[ir.SCRIPT=3]="SCRIPT",ir[ir.URL=4]="URL",ir[ir.RESOURCE_URL=5]="RESOURCE_URL",ir))();function Tf(n){const i=bu();return i?i.sanitize(ir.URL,n)||"":wl(n,"URL")?Qo(n):Ud(je(n))}function Vm(n){const i=bu();if(i)return Dm(i.sanitize(ir.RESOURCE_URL,n)||"");if(wl(n,"ResourceURL"))return Dm(Qo(n));throw new Me(904,!1)}function Gm(n,i,r){return function Uy(n,i){return"src"===i&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===i&&("base"===n||"link"===n)?Vm:Tf}(i,r)(n)}function bu(){const n=Ye();return n&&n[Br].sanitizer}class Mi{constructor(i,r){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof r?this.__NG_ELEMENT_ID__=r:void 0!==r&&(this.\u0275prov=ei({token:this,providedIn:r.providedIn||"root",factory:r.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const wu=new Mi("ENVIRONMENT_INITIALIZER"),Wm=new Mi("INJECTOR",-1),$m=new Mi("INJECTOR_DEF_TYPES");class jm{get(i,r=dn){if(r===dn){const a=new Error(`NullInjectorError: No provider for ${wt(i)}!`);throw a.name="NullInjectorError",a}return r}}function Tu(n){return{\u0275providers:n}}function Cf(...n){return{\u0275providers:Xm(0,n),\u0275fromNgModule:!0}}function Xm(n,...i){const r=[],a=new Set;let u;return vu(i,f=>{const g=f;Bd(g,r,[],a)&&(u||=[],u.push(g))}),void 0!==u&&Cu(u,r),r}function Cu(n,i){for(let r=0;r<n.length;r++){const{providers:u}=n[r];Df(u,f=>{i.push(f)})}}function Bd(n,i,r,a){if(!(n=St(n)))return!1;let u=null,f=Lo(n);const g=!f&&ni(n);if(f||g){if(g&&!g.standalone)return!1;u=n}else{const T=n.ngModule;if(f=Lo(T),!f)return!1;u=T}const M=a.has(u);if(g){if(M)return!1;if(a.add(u),g.dependencies){const T="function"==typeof g.dependencies?g.dependencies():g.dependencies;for(const N of T)Bd(N,i,r,a)}}else{if(!f)return!1;{if(null!=f.imports&&!M){let N;a.add(u);try{vu(f.imports,H=>{Bd(H,i,r,a)&&(N||=[],N.push(H))})}finally{}void 0!==N&&Cu(N,i)}if(!M){const N=Vo(u)||(()=>new u);i.push({provide:u,useFactory:N,deps:qe},{provide:$m,useValue:u,multi:!0},{provide:wu,useValue:()=>Wi(u),multi:!0})}const T=f.providers;null==T||M||Df(T,H=>{i.push(H)})}}return u!==n&&void 0!==n.providers}function Df(n,i){for(let r of n)Jn(r)&&(r=r.\u0275providers),Array.isArray(r)?Df(r,i):i(r)}const ky=me({provide:String,useValue:me});function Hd(n){return null!==n&&"object"==typeof n&&ky in n}function Tl(n){return"function"==typeof n}const Af=new Mi("Set Injector scope."),Ya={},Zm={};let zd;function Vd(){return void 0===zd&&(zd=new jm),zd}class wa{}class If extends wa{get destroyed(){return this._destroyed}constructor(i,r,a,u){super(),this.parent=r,this.source=a,this.scopes=u,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Lf(i,g=>this.processProvider(g)),this.records.set(Wm,wc(void 0,this)),u.has("environment")&&this.records.set(wa,wc(void 0,this));const f=this.records.get(Af);null!=f&&"string"==typeof f.value&&this.scopes.add(f.value),this.injectorDefTypes=new Set(this.get($m.multi,qe,nt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();for(const i of this._onDestroyHooks)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(i){return this.assertNotDestroyed(),this._onDestroyHooks.push(i),()=>this.removeOnDestroy(i)}runInContext(i){this.assertNotDestroyed();const r=Dr(this),a=Bi(void 0);try{return i()}finally{Dr(r),Bi(a)}}get(i,r=dn,a=nt.Default){if(this.assertNotDestroyed(),i.hasOwnProperty(Ar))return i[Ar](this);a=Ee(a);const u=Dr(this),f=Bi(void 0);try{if(!(a&nt.SkipSelf)){let M=this.records.get(i);if(void 0===M){const T=function Gy(n){return"function"==typeof n||"object"==typeof n&&n instanceof Mi}(i)&&Yt(i);M=T&&this.injectableDefInScope(T)?wc(Rf(i),Ya):null,this.records.set(i,M)}if(null!=M)return this.hydrate(i,M)}return(a&nt.Self?Vd():this.parent).get(i,r=a&nt.Optional&&r===dn?null:r)}catch(g){if("NullInjectorError"===g.name){if((g[or]=g[or]||[]).unshift(wt(i)),u)throw g;return function rt(n,i,r,a){const u=n[or];throw i[Cr]&&u.unshift(i[Cr]),n.message=function oe(n,i,r,a=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let u=wt(i);if(Array.isArray(i))u=i.map(wt).join(" -> ");else if("object"==typeof i){let f=[];for(let g in i)if(i.hasOwnProperty(g)){let M=i[g];f.push(g+":"+("string"==typeof M?JSON.stringify(M):wt(M)))}u=`{${f.join(", ")}}`}return`${r}${a?"("+a+")":""}[${u}]: ${n.replace(Qi,"\n  ")}`}("\n"+n.message,u,r,a),n.ngTokenPath=u,n[or]=null,n}(g,i,"R3InjectorError",this.source)}throw g}finally{Bi(f),Dr(u)}}resolveInjectorInitializers(){const i=Dr(this),r=Bi(void 0);try{const a=this.get(wu.multi,qe,nt.Self);for(const u of a)u()}finally{Dr(i),Bi(r)}}toString(){const i=[],r=this.records;for(const a of r.keys())i.push(wt(a));return`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Me(205,!1)}processProvider(i){let r=Tl(i=St(i))?i:St(i&&i.provide);const a=function Hy(n){return Hd(n)?wc(void 0,n.useValue):wc(Pf(n),Ya)}(i);if(Tl(i)||!0!==i.multi)this.records.get(r);else{let u=this.records.get(r);u||(u=wc(void 0,Ya,!0),u.factory=()=>ce(u.multi),this.records.set(r,u)),r=i,u.multi.push(i)}this.records.set(r,a)}hydrate(i,r){return r.value===Ya&&(r.value=Zm,r.value=r.factory()),"object"==typeof r.value&&r.value&&function Vy(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(r.value)&&this._ngOnDestroyHooks.add(r.value),r.value}injectableDefInScope(i){if(!i.providedIn)return!1;const r=St(i.providedIn);return"string"==typeof r?"any"===r||this.scopes.has(r):this.injectorDefTypes.has(r)}removeOnDestroy(i){const r=this._onDestroyHooks.indexOf(i);-1!==r&&this._onDestroyHooks.splice(r,1)}}function Rf(n){const i=Yt(n),r=null!==i?i.factory:Vo(n);if(null!==r)return r;if(n instanceof Mi)throw new Me(204,!1);if(n instanceof Function)return function Km(n){const i=n.length;if(i>0)throw function yu(n,i){const r=[];for(let a=0;a<n;a++)r.push(i);return r}(i,"?"),new Me(204,!1);const r=function _s(n){return n&&(n[Ps]||n[wr])||null}(n);return null!==r?()=>r.factory(n):()=>new n}(n);throw new Me(204,!1)}function Pf(n,i,r){let a;if(Tl(n)){const u=St(n);return Vo(u)||Rf(u)}if(Hd(n))a=()=>St(n.useValue);else if(function qm(n){return!(!n||!n.useFactory)}(n))a=()=>n.useFactory(...ce(n.deps||[]));else if(function Ym(n){return!(!n||!n.useExisting)}(n))a=()=>Wi(St(n.useExisting));else{const u=St(n&&(n.useClass||n.provide));if(!function zy(n){return!!n.deps}(n))return Vo(u)||Rf(u);a=()=>new u(...ce(n.deps))}return a}function wc(n,i,r=!1){return{factory:n,value:i,multi:r?[]:void 0}}function Lf(n,i){for(const r of n)Array.isArray(r)?Lf(r,i):r&&Jn(r)?Lf(r.\u0275providers,i):i(r)}const Jm=new Mi("AppId",{providedIn:"root",factory:()=>Wy}),Wy="ng",Qm=new Mi("Platform Initializer"),Nf=new Mi("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),$y=new Mi("CSP nonce",{providedIn:"root",factory:()=>function Sl(){if(void 0!==Nd)return Nd;if(typeof document<"u")return document;throw new Me(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let qd=(n,i)=>null;function ng(n,i){return qd(n,i)}class Tc{}class Cc{}class Nu{resolveComponentFactory(i){throw function Dc(n){const i=Error(`No component factory found for ${wt(n)}.`);return i.ngComponent=n,i}(i)}}let Ou=(()=>{class n{}return n.NULL=new Nu,n})();function Kd(){return ea(Lr(),Ye())}function ea(n,i){return new Za(w(n,i))}let Za=(()=>{class n{constructor(r){this.nativeElement=r}}return n.__NG_ELEMENT_ID__=Kd,n})();function og(n){return n instanceof Za?n.nativeElement:n}class Jd{}let ag=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Jy(){const n=Ye(),r=Y(Lr().index,n);return(zr(r)?r:n)[ln]}(),n})(),Qd=(()=>{class n{}return n.\u0275prov=ei({token:n,providedIn:"root",factory:()=>null}),n})();class Fu{constructor(i){this.full=i,this.major=i.split(".")[0],this.minor=i.split(".")[1],this.patch=i.split(".").slice(2).join(".")}}const lg=new Fu("16.0.1"),Bf={};function Ac(n){for(;n;){n[hn]|=64;const i=Id(n);if(da(n)&&!i)return n;n=i}return null}function zf(n){return n.ngOriginalError}class Al{constructor(){this._console=console}handleError(i){const r=this._findOriginalError(i);this._console.error("ERROR",i),r&&this._console.error("ORIGINAL ERROR",r)}_findOriginalError(i){let r=i&&zf(i);for(;r&&zf(r);)r=zf(r);return r||null}}const Vf=new Mi("",{providedIn:"root",factory:()=>!1});function ta(n){return n instanceof Function?n():n}class $f extends et{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(i){this._lView=i}onConsumerDependencyMayHaveChanged(){Ac(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(i,r,a){const u=Xi(this);this.trackingVersion++;try{i(r,a)}finally{Xi(u)}}destroy(){this.trackingVersion++}}let Hu=null;function th(){return Hu??=new $f,Hu}function zu(n,i){return n[i]??th()}function Vu(n,i){const r=th();r.hasReadASignal&&(n[i]=Hu,r.lView=n,Hu=new $f)}const An={};function jf(n){Xf(Nt(),Ye(),Mr()+n,!1)}function Xf(n,i,r,a){if(!a)if(3==(3&i[hn])){const f=n.preOrderCheckHooks;null!==f&&C(i,f,r)}else{const f=n.preOrderHooks;null!==f&&L(i,f,0,r)}so(r)}function r0(n,i=null,r=null,a){const u=s0(n,i,r,a);return u.resolveInjectorInitializers(),u}function s0(n,i=null,r=null,a,u=new Set){const f=[r||qe,Cf(n)];return a=a||("object"==typeof n?void 0:wt(n)),new If(f,i||Vd(),a||null,u)}let $r=(()=>{class n{static create(r,a){if(Array.isArray(r))return r0({name:""},a,r,"");{const u=r.name??"";return r0({name:u},r.parent,r.providers,u)}}}return n.THROW_IF_NOT_FOUND=dn,n.NULL=new jm,n.\u0275prov=ei({token:n,providedIn:"any",factory:()=>Wi(Wm)}),n.__NG_ELEMENT_ID__=-1,n})();function Ka(n,i=nt.Default){const r=Ye();return null===r?Wi(n,i):pu(Lr(),r,St(n),i)}function hg(){throw new Error("invalid")}function Il(n,i,r,a,u,f,g,M,T,N,H){const Z=i.blueprint.slice();return Z[Oi]=u,Z[hn]=140|a,(null!==N||n&&2048&n[hn])&&(Z[hn]|=2048),Hn(Z),Z[li]=Z[vr]=n,Z[Ui]=r,Z[Br]=g||n&&n[Br],Z[ln]=M||n&&n[ln],Z[Uo]=T||n&&n[Uo]||null,Z[Fi]=f,Z[Zs]=function ty(){return ey++}(),Z[Ks]=H,Z[Yc]=N,Z[Ii]=2==i.type?n[Ii]:Z,Z}function Ja(n,i,r,a,u){let f=n.data[i];if(null===f)f=function Wu(n,i,r,a,u){const f=$h(),g=Nr(),T=n.data[i]=function ep(n,i,r,a,u,f){let g=i?i.injectorIndex:-1,M=0;return function Xo(){return null!==$t.skipHydrationRootTNode}()&&(M|=128),{type:r,index:a,insertBeforeIndex:null,injectorIndex:g,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:M,providerIndexes:0,value:u,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,r,i,a,u);return null===n.firstChild&&(n.firstChild=T),null!==f&&(g?null==f.child&&null!==T.parent&&(f.child=T):null===f.next&&(f.next=T,T.prev=f)),T}(n,i,r,a,u),function _a(){return $t.lFrame.inI18n}()&&(f.flags|=32);else if(64&f.type){f.type=r,f.value=a,f.attrs=u;const g=function bs(){const n=$t.lFrame,i=n.currentTNode;return n.isParent?i:i.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return Vr(f,!0),f}function Rl(n,i,r,a){if(0===r)return-1;const u=i.length;for(let f=0;f<r;f++)i.push(a),n.blueprint.push(a),n.data.push(null);return u}function fg(n,i,r,a,u){const f=zu(i,Ua),g=Mr(),M=2&a;try{if(so(-1),M&&i.length>jn&&Xf(n,i,jn,!1),Us(M?2:0,u),M)f.runInContext(r,a,u);else{const N=Xi(null);try{r(a,u)}finally{Xi(N)}}}finally{M&&null===i[Ua]&&Vu(i,Ua),so(g),Us(M?3:1,u)}}function ih(n,i,r){if(qc(i)){const a=Xi(null);try{const f=i.directiveEnd;for(let g=i.directiveStart;g<f;g++){const M=n.data[g];M.contentQueries&&M.contentQueries(1,r[g],g)}}finally{Xi(a)}}}function Jf(n,i,r){cr()&&(function Ll(n,i,r,a){const u=r.directiveStart,f=r.directiveEnd;Bo(r)&&function Mg(n,i,r){const a=w(i,n),g=uh(n,Il(n,pg(r),null,r.onPush?64:16,a,i,null,n[Br].rendererFactory.createRenderer(a,r),null,null,null));n[i.index]=g}(i,r,n.data[u+r.componentOffset]),n.firstCreatePass||uu(r,i),ts(a,i);const g=r.initialInputs;for(let M=u;M<f;M++){const T=n.data[M],N=Zo(i,n,M,r);ts(N,i),null!==g&&f0(0,M-u,N,T,0,g),fs(T)&&(Y(r.index,i)[Ui]=Zo(i,n,M,r))}}(n,i,r,w(r,i)),64==(64&r.flags)&&oh(n,i,r))}function Qf(n,i,r=w){const a=i.localNames;if(null!==a){let u=i.index+1;for(let f=0;f<a.length;f+=2){const g=a[f+1],M=-1===g?r(i,n):n[g];n[u++]=M}}}function pg(n){const i=n.tView;return null===i||i.incompleteFirstPass?n.tView=Pl(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):i}function Pl(n,i,r,a,u,f,g,M,T,N,H){const Z=jn+a,ae=Z+u,fe=function o0(n,i){const r=[];for(let a=0;a<i;a++)r.push(a<n?null:An);return r}(Z,ae),Be="function"==typeof N?N():N;return fe[At]={type:n,blueprint:fe,template:r,queries:null,viewQuery:M,declTNode:i,data:fe.slice().fill(null,Z),bindingStartIndex:Z,expandoStartIndex:ae,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:T,consts:Be,incompleteFirstPass:!1,ssrId:H}}let mg=n=>null;function vg(n,i,r,a){for(let u in n)if(n.hasOwnProperty(u)){r=null===r?{}:r;const f=n[u];null===a?tp(r,i,u,f):a.hasOwnProperty(u)&&tp(r,i,a[u],f)}return r}function tp(n,i,r,a){n.hasOwnProperty(r)?n[r].push(i,a):n[r]=[i,a]}function ju(n,i,r,a){if(cr()){const u=null===a?null:{"":-1},f=function lh(n,i){const r=n.directiveRegistry;let a=null,u=null;if(r)for(let f=0;f<r.length;f++){const g=r[f];if(sl(i,g.selectors,!1))if(a||(a=[]),fs(g))if(null!==g.findHostDirectiveDefs){const M=[];u=u||new Map,g.findHostDirectiveDefs(g,M,u),a.unshift(...M,g),Yu(n,i,M.length)}else a.unshift(g),Yu(n,i,0);else u=u||new Map,g.findHostDirectiveDefs?.(g,a,u),a.push(g)}return null===a?null:[a,u]}(n,r);let g,M;null===f?g=M=null:[g,M]=f,null!==g&&sh(n,i,r,g,u,M),u&&function ch(n,i,r){if(i){const a=n.localNames=[];for(let u=0;u<i.length;u+=2){const f=r[i[u+1]];if(null==f)throw new Me(-301,!1);a.push(i[u],f)}}}(r,a,u)}r.mergedAttrs=Yr(r.mergedAttrs,r.attrs)}function sh(n,i,r,a,u,f){for(let N=0;N<a.length;N++)du(uu(r,i),n,a[N].type);!function Rc(n,i,r){n.flags|=1,n.directiveStart=i,n.directiveEnd=i+r,n.providerIndexes=i}(r,n.data.length,a.length);for(let N=0;N<a.length;N++){const H=a[N];H.providersResolver&&H.providersResolver(H)}let g=!1,M=!1,T=Rl(n,i,a.length,null);for(let N=0;N<a.length;N++){const H=a[N];r.mergedAttrs=Yr(r.mergedAttrs,H.hostAttrs),h0(n,r,i,T,H),d0(T,H,u),null!==H.contentQueries&&(r.flags|=4),(null!==H.hostBindings||null!==H.hostAttrs||0!==H.hostVars)&&(r.flags|=64);const Z=H.type.prototype;!g&&(Z.ngOnChanges||Z.ngOnInit||Z.ngDoCheck)&&((n.preOrderHooks??=[]).push(r.index),g=!0),!M&&(Z.ngOnChanges||Z.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(r.index),M=!0),T++}!function yg(n,i,r){const u=i.directiveEnd,f=n.data,g=i.attrs,M=[];let T=null,N=null;for(let H=i.directiveStart;H<u;H++){const Z=f[H],ae=r?r.get(Z):null,Be=ae?ae.outputs:null;T=vg(Z.inputs,H,T,ae?ae.inputs:null),N=vg(Z.outputs,H,N,Be);const ft=null===T||null===g||Ms(i)?null:p0(T,H,g);M.push(ft)}null!==T&&(T.hasOwnProperty("class")&&(i.flags|=8),T.hasOwnProperty("style")&&(i.flags|=16)),i.initialInputs=M,i.inputs=T,i.outputs=N}(n,r,f)}function oh(n,i,r){const a=r.directiveStart,u=r.directiveEnd,f=r.index,g=function Xh(){return $t.lFrame.currentDirectiveIndex}();try{so(f);for(let M=a;M<u;M++){const T=n.data[M],N=i[M];fl(M),(null!==T.hostBindings||0!==T.hostVars||null!==T.hostAttrs)&&ah(T,N)}}finally{so(-1),fl(g)}}function ah(n,i){null!==n.hostBindings&&n.hostBindings(1,i)}function Yu(n,i,r){i.componentOffset=r,(n.components??=[]).push(i.index)}function d0(n,i,r){if(r){if(i.exportAs)for(let a=0;a<i.exportAs.length;a++)r[i.exportAs[a]]=n;fs(i)&&(r[""]=n)}}function h0(n,i,r,a,u){n.data[a]=u;const f=u.factory||(u.factory=Vo(u.type)),g=new Gt(f,fs(u),Ka);n.blueprint[a]=g,r[a]=g,function Xu(n,i,r,a,u){const f=u.hostBindings;if(f){let g=n.hostBindingOpCodes;null===g&&(g=n.hostBindingOpCodes=[]);const M=~i.index;(function ip(n){let i=n.length;for(;i>0;){const r=n[--i];if("number"==typeof r&&r<0)return r}return 0})(g)!=M&&g.push(M),g.push(r,a,f)}}(n,i,a,Rl(n,r,u.hostVars,An),u)}function is(n,i,r,a,u,f){const g=w(n,i);!function Nl(n,i,r,a,u,f,g){if(null==f)n.removeAttribute(i,u,r);else{const M=null==g?je(f):g(f,a||"",u);n.setAttribute(i,u,M,r)}}(i[ln],g,f,n.value,r,a,u)}function f0(n,i,r,a,u,f){const g=f[i];if(null!==g)for(let M=0;M<g.length;)xg(a,r,g[M++],g[M++],g[M++])}function xg(n,i,r,a,u){const f=Xi(null);try{null!==n.setInput?n.setInput(i,u,r,a):i[a]=u}finally{Xi(f)}}function p0(n,i,r){let a=null,u=0;for(;u<r.length;){const f=r[u];if(0!==f)if(5!==f){if("number"==typeof f)break;if(n.hasOwnProperty(f)){null===a&&(a=[]);const g=n[f];for(let M=0;M<g.length;M+=2)if(g[M]===i){a.push(f,g[M+1],r[u+1]);break}}u+=2}else u+=2;else u+=4}return a}function Eg(n,i,r,a){return[n,!0,!1,i,null,0,a,r,null,null,null]}function Sg(n,i){const r=n.contentQueries;if(null!==r)for(let a=0;a<r.length;a+=2){const f=r[a+1];if(-1!==f){const g=n.data[f];ou(r[a]),g.contentQueries(2,i[f],f)}}}function uh(n,i){return n[la]?n[vo][ar]=i:n[la]=i,n[vo]=i,i}function rp(n,i,r){ou(0);const a=Xi(null);try{i(n,r)}finally{Xi(a)}}function bg(n){return n[Fo]||(n[Fo]=[])}function wg(n){return n.cleanup||(n.cleanup=[])}function dh(n,i){const r=n[Uo],a=r?r.get(Al,null):null;a&&a.handleError(i)}function sp(n,i,r,a,u){for(let f=0;f<r.length;){const g=r[f++],M=r[f++];xg(n.data[g],i[g],a,M,u)}}function m0(n,i){const r=Y(i,n),a=r[At];!function Yi(n,i){for(let r=i.length;r<n.blueprint.length;r++)i.push(n.blueprint[r])}(a,r);const u=r[Oi];null!==u&&null===r[Ks]&&(r[Ks]=ng(u,r[Uo])),Pc(a,r,r[Ui])}function Pc(n,i,r){io(i);try{const a=n.viewQuery;null!==a&&rp(1,a,r);const u=n.template;null!==u&&fg(n,i,u,1,r),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Sg(n,i),n.staticViewQueries&&rp(2,n.viewQuery,r);const f=n.components;null!==f&&function Cg(n,i){for(let r=0;r<i.length;r++)m0(n,i[r])}(i,f)}catch(a){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),a}finally{i[hn]&=-5,cc()}}let Lc=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(r,a,u){const f=typeof Zone>"u"?null:Zone.current,g=new dd(r,N=>{this.all.has(N)&&this.queue.set(N,f)},u);let M;this.all.add(g),g.notify();const T=()=>{g.cleanup(),M?.(),this.all.delete(g),this.queue.delete(g)};return M=a?.onDestroy(T),{destroy:T}}flush(){if(0!==this.queue.size)for(const[r,a]of this.queue)this.queue.delete(r),a?a.run(()=>r.run()):r.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=ei({token:n,providedIn:"root",factory:()=>new n}),n})();function qu(n,i,r){let a=r?n.styles:null,u=r?n.classes:null,f=0;if(null!==i)for(let g=0;g<i.length;g++){const M=i[g];"number"==typeof M?f=M:1==f?u=pt(u,M):2==f&&(a=pt(a,M+": "+i[++g]+";"))}r?n.styles=a:n.stylesWithoutHost=a,r?n.classes=u:n.classesWithoutHost=u}function Nc(n,i,r,a,u=!1){for(;null!==r;){const f=i[r.index];if(null!==f&&a.push(Ti(f)),lr(f)){for(let M=ji;M<f.length;M++){const T=f[M],N=T[At].firstChild;null!==N&&Nc(T[At],T,N,a)}f[hs]!==f[Oi]&&a.push(f[hs])}const g=r.type;if(8&g)Nc(n,i,r.child,a);else if(32&g){const M=ff(r,i);let T;for(;T=M();)a.push(T)}else if(16&g){const M=xm(i,r);if(Array.isArray(M))a.push(...M);else{const T=Id(i[Ii]);Nc(T[At],T,M,a,!0)}}r=u?r.projectionNext:r.next}return a}function Qa(n,i,r,a=!0){const u=i[Br].rendererFactory;u.begin&&u.begin();try{co(n,i,n.template,r)}catch(g){throw a&&dh(i,g),g}finally{u.end&&u.end(),i[Br].effectManager?.flush()}}function co(n,i,r,a){const u=i[hn];if(256!=(256&u)){i[Br].effectManager?.flush(),io(i);try{Hn(i),function Ga(n){return $t.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==r&&fg(n,i,r,2,a);const g=3==(3&u);if(g){const N=n.preOrderCheckHooks;null!==N&&C(i,N,null)}else{const N=n.preOrderHooks;null!==N&&L(i,N,0,null),z(i,0)}if(function Ig(n){for(let i=mm(n);null!==i;i=gm(i)){if(!i[Yl])continue;const r=i[ca];for(let a=0;a<r.length;a++){Rn(r[a])}}}(i),function Ag(n){for(let i=mm(n);null!==i;i=gm(i))for(let r=ji;r<i.length;r++){const a=i[r],u=a[At];xe(a)&&co(u,a,u.template,a[Ui])}}(i),null!==n.contentQueries&&Sg(n,i),g){const N=n.contentCheckHooks;null!==N&&C(i,N)}else{const N=n.contentHooks;null!==N&&L(i,N,1),z(i,1)}!function Kf(n,i){const r=n.hostBindingOpCodes;if(null===r)return;const a=zu(i,ko);try{for(let u=0;u<r.length;u++){const f=r[u];if(f<0)so(~f);else{const g=f,M=r[++u],T=r[++u];jh(M,g),a.runInContext(T,2,i[g])}}}finally{null===i[ko]&&Vu(i,ko),so(-1)}}(n,i);const M=n.components;null!==M&&function y0(n,i){for(let r=0;r<i.length;r++)op(n,i[r])}(i,M);const T=n.viewQuery;if(null!==T&&rp(2,T,a),g){const N=n.viewCheckHooks;null!==N&&C(i,N)}else{const N=n.viewHooks;null!==N&&L(i,N,2),z(i,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),i[hn]&=-73,Mn(i)}finally{cc()}}}function op(n,i){const r=Y(i,n);if(xe(r)){const a=r[At];80&r[hn]?co(a,r,a.template,r[Ui]):r[tr]>0&&ap(r)}}function ap(n){for(let a=mm(n);null!==a;a=gm(a))for(let u=ji;u<a.length;u++){const f=a[u];if(xe(f))if(1024&f[hn]){const g=f[At];co(g,f,g.template,f[Ui])}else f[tr]>0&&ap(f)}const r=n[At].components;if(null!==r)for(let a=0;a<r.length;a++){const u=Y(r[a],n);xe(u)&&u[tr]>0&&ap(u)}}class Ol{get rootNodes(){const i=this._lView,r=i[At];return Nc(r,i,r.firstChild,[])}constructor(i,r){this._lView=i,this._cdRefInjectingView=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ui]}set context(i){this._lView[Ui]=i}get destroyed(){return 256==(256&this._lView[hn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[li];if(lr(i)){const r=i[Ba],a=r?r.indexOf(this):-1;a>-1&&(ym(i,a),Ed(r,a))}this._attachedToViewContainer=!1}py(this._lView[At],this._lView)}onDestroy(i){!function ci(n,i){if(256==(256&n[hn]))throw new Me(911,!1);null===n[Hr]&&(n[Hr]=[]),n[Hr].push(i)}(this._lView,i)}markForCheck(){Ac(this._cdRefInjectingView||this._lView)}detach(){this._lView[hn]&=-129}reattach(){this._lView[hn]|=128}detectChanges(){Qa(this._lView[At],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Me(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function fM(n,i){Ml(n,i,i[ln],2,null,null)}(this._lView[At],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new Me(902,!1);this._appRef=i}}class ph extends Ol{constructor(i){super(i),this._view=i}detectChanges(){const i=this._view;Qa(i[At],i,i[Ui],!1)}checkNoChanges(){}get context(){return null}}class mh extends Ou{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const r=ni(i);return new Fl(r,this.ngModule)}}function gh(n){const i=[];for(let r in n)n.hasOwnProperty(r)&&i.push({propName:n[r],templateName:r});return i}class vh{constructor(i,r){this.injector=i,this.parentInjector=r}get(i,r,a){a=Ee(a);const u=this.injector.get(i,Bf,a);return u!==Bf||r===Bf?u:this.parentInjector.get(i,r,a)}}class Fl extends Cc{get inputs(){return gh(this.componentDef.inputs)}get outputs(){return gh(this.componentDef.outputs)}constructor(i,r){super(),this.componentDef=i,this.ngModule=r,this.componentType=i.type,this.selector=function oa(n){return n.map(Oa).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!r}create(i,r,a,u){let f=(u=u||this.ngModule)instanceof wa?u:u?.injector;f&&null!==this.componentDef.getStandaloneInjector&&(f=this.componentDef.getStandaloneInjector(f)||f);const g=f?new vh(i,f):i,M=g.get(Jd,null);if(null===M)throw new Me(407,!1);const H={rendererFactory:M,sanitizer:g.get(Qd,null),effectManager:g.get(Lc,null)},Z=M.createRenderer(null,this.componentDef),ae=this.componentDef.selectors[0][0]||"div",fe=a?function a0(n,i,r,a){const f=a.get(Vf,!1)||r===De.ShadowDom,g=n.selectRootElement(i,f);return function l0(n){mg(n)}(g),g}(Z,a,this.componentDef.encapsulation,g):mf(Z,ae,function _0(n){const i=n.toLowerCase();return"svg"===i?eu:"math"===i?"math":null}(ae)),Be=this.componentDef.onPush?576:528,ft=Pl(0,null,null,1,0,null,null,null,null,null,null),It=Il(null,ft,null,Be,null,null,H,Z,g,null,null);let rn,st;io(It);try{const xn=this.componentDef;let Kn,Ai=null;xn.findHostDirectiveDefs?(Kn=[],Ai=new Map,xn.findHostDirectiveDefs(xn,Kn,Ai),Kn.push(xn)):Kn=[xn];const Pa=function cp(n,i){const r=n[At],a=jn;return n[a]=i,Ja(r,a,2,"#host",null)}(It,fe),tS=function M0(n,i,r,a,u,f,g){const M=u[At];!function Pg(n,i,r,a){for(const u of n)i.mergedAttrs=Yr(i.mergedAttrs,u.hostAttrs);null!==i.mergedAttrs&&(qu(i,i.mergedAttrs,!0),null!==r&&Xa(a,r,i))}(a,n,i,g);let T=null;null!==i&&(T=ng(i,u[Uo]));const N=f.rendererFactory.createRenderer(i,r),H=Il(u,pg(r),null,r.onPush?64:16,u[n.index],n,f,N,null,null,T);return M.firstCreatePass&&Yu(M,n,a.length-1),uh(u,H),u[n.index]=H}(Pa,fe,xn,Kn,It,H,Z);st=A(ft,jn),fe&&function x0(n,i,r,a){if(a)cs(n,r,["ng-version",lg.full]);else{const{attrs:u,classes:f}=function qs(n){const i=[],r=[];let a=1,u=2;for(;a<n.length;){let f=n[a];if("string"==typeof f)2===u?""!==f&&i.push(f,n[++a]):8===u&&r.push(f);else{if(!Ir(u))break;u=f}a++}return{attrs:i,classes:r}}(i.selectors[0]);u&&cs(n,r,u),f&&f.length>0&&Pd(n,r,f.join(" "))}}(Z,xn,fe,a),void 0!==r&&function E0(n,i,r){const a=n.projection=[];for(let u=0;u<i.length;u++){const f=r[u];a.push(null!=f?Array.from(f):null)}}(st,this.ngContentSelectors,r),rn=function Lg(n,i,r,a,u,f){const g=Lr(),M=u[At],T=w(g,u);sh(M,u,g,r,null,a);for(let H=0;H<r.length;H++)ts(Zo(u,M,g.directiveStart+H,g),u);oh(M,u,g),T&&ts(T,u);const N=Zo(u,M,g.directiveStart+g.componentOffset,g);if(n[Ui]=u[Ui]=N,null!==f)for(const H of f)H(N,i);return ih(M,g,n),N}(tS,xn,Kn,Ai,It,[up]),Pc(ft,It,null)}finally{cc()}return new lp(this.componentType,rn,ea(st,It),It,st)}}class lp extends Tc{constructor(i,r,a,u,f){super(),this.location=a,this._rootLView=u,this._tNode=f,this.previousInputValues=null,this.instance=r,this.hostView=this.changeDetectorRef=new ph(u),this.componentType=i}setInput(i,r){const a=this._tNode.inputs;let u;if(null!==a&&(u=a[i])){if(this.previousInputValues??=new Map,this.previousInputValues.has(i)&&Object.is(this.previousInputValues.get(i),r))return;const f=this._rootLView;sp(f[At],f,u,i,r),this.previousInputValues.set(i,r),Ac(Y(this._tNode.index,f))}}get injector(){return new Ea(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}function up(){const n=Lr();v(Ye()[At],n)}function dp(n){let i=function Ng(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),r=!0;const a=[n];for(;i;){let u;if(fs(n))u=i.\u0275cmp||i.\u0275dir;else{if(i.\u0275cmp)throw new Me(903,!1);u=i.\u0275dir}if(u){if(r){a.push(u);const g=n;g.inputs=hp(n.inputs),g.declaredInputs=hp(n.declaredInputs),g.outputs=hp(n.outputs);const M=u.hostBindings;M&&T0(n,M);const T=u.viewQuery,N=u.contentQueries;if(T&&b0(n,T),N&&w0(n,N),We(n.inputs,u.inputs),We(n.declaredInputs,u.declaredInputs),We(n.outputs,u.outputs),fs(u)&&u.data.animation){const H=n.data;H.animation=(H.animation||[]).concat(u.data.animation)}}const f=u.features;if(f)for(let g=0;g<f.length;g++){const M=f[g];M&&M.ngInherit&&M(n),M===dp&&(r=!1)}}i=Object.getPrototypeOf(i)}!function S0(n){let i=0,r=null;for(let a=n.length-1;a>=0;a--){const u=n[a];u.hostVars=i+=u.hostVars,u.hostAttrs=Yr(u.hostAttrs,r=Yr(r,u.hostAttrs))}}(a)}function hp(n){return n===Qe?{}:n===qe?[]:n}function b0(n,i){const r=n.viewQuery;n.viewQuery=r?(a,u)=>{i(a,u),r(a,u)}:i}function w0(n,i){const r=n.contentQueries;n.contentQueries=r?(a,u,f)=>{i(a,u,f),r(a,u,f)}:i}function T0(n,i){const r=n.hostBindings;n.hostBindings=r?(a,u)=>{i(a,u),r(a,u)}:i}function Mh(n){return!!ho(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function ho(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function bo(n,i,r){return n[i]=r}function rs(n,i,r){return!Object.is(n[i],r)&&(n[i]=r,!0)}function Da(n,i,r,a,u){const f=function wo(n,i,r,a){const u=rs(n,i,r);return rs(n,i+1,a)||u}(n,i,r,a);return rs(n,i+2,u)||f}function Fc(n,i,r,a){const u=Ye();return rs(u,Gr(),i)&&(Nt(),is(Xn(),u,n,i,r,a)),Fc}function tl(n,i,r,a,u,f,g,M){const T=Ye(),N=Nt(),H=n+jn,Z=N.firstCreatePass?function Yg(n,i,r,a,u,f,g,M,T){const N=i.consts,H=Ja(i,n,4,g||null,Nn(N,M));ju(i,r,H,Nn(N,T)),v(i,H);const Z=H.tView=Pl(2,H,a,u,f,i.directiveRegistry,i.pipeRegistry,null,i.schemas,N,null);return null!==i.queries&&(i.queries.template(i,H),Z.queries=i.queries.embeddedTView(H)),H}(H,N,T,i,r,a,u,f,g):N.data[H];Vr(Z,!1);const ae=Mp(N,T,Z,n);Ht()&&_l(N,T,ae,Z),ts(ae,T),uh(T,T[H]=Eg(ae,T,ae,Z)),Ho(Z)&&Jf(N,T,Z),null!=g&&Qf(T,Z,M)}let Mp=function qg(n,i,r,a){return y(!0),i[ln].createComment("")};function nl(n){return k(function su(){return $t.lFrame.contextLView}(),jn+n)}function Dh(n,i,r){const a=Ye();return rs(a,Gr(),i)&&function gs(n,i,r,a,u,f,g,M){const T=w(i,r);let H,N=i.inputs;!M&&null!=N&&(H=N[a])?(sp(n,r,H,a,u),Bo(i)&&function u0(n,i){const r=Y(i,n);16&r[hn]||(r[hn]|=64)}(r,i.index)):3&i.type&&(a=function _g(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(a),u=null!=g?g(u,i.value||"",a):u,f.setProperty(T,a,u))}(Nt(),Xn(),a,n,i,a[ln],r,!1),Dh}function xp(n,i,r,a,u){const g=u?"class":"style";sp(n,r,i.inputs[g],g,a)}function Ep(n,i,r,a){const u=Ye(),f=Nt(),g=jn+n,M=u[ln],T=f.firstCreatePass?function Vl(n,i,r,a,u,f){const g=i.consts,T=Ja(i,n,2,a,Nn(g,u));return ju(i,r,T,Nn(g,f)),null!==T.attrs&&qu(T,T.attrs,!1),null!==T.mergedAttrs&&qu(T,T.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,T),T}(g,f,u,i,r,a):f.data[g],N=Ah(f,u,T,M,i,n);u[g]=N;const H=Ho(T);return Vr(T,!0),Xa(M,N,T),32!=(32&T.flags)&&Ht()&&_l(f,u,N,T),0===function _r(){return $t.lFrame.elementDepthCount}()&&ts(N,u),function ks(){$t.lFrame.elementDepthCount++}(),H&&(Jf(f,u,T),ih(f,T,u)),null!==a&&Qf(u,T),Ep}function Sp(){let n=Lr();Nr()?function ru(){$t.lFrame.isParent=!1}():(n=n.parent,Vr(n,!1));const i=n;(function oc(n){return $t.skipHydrationRootTNode===n})(i)&&function iu(){$t.skipHydrationRootTNode=null}(),function _i(){$t.lFrame.elementDepthCount--}();const r=Nt();return r.firstCreatePass&&(v(r,n),qc(n)&&r.queries.elementEnd(n)),null!=i.classesWithoutHost&&function hc(n){return 0!=(8&n.flags)}(i)&&xp(r,i,Ye(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function fc(n){return 0!=(16&n.flags)}(i)&&xp(r,i,Ye(),i.stylesWithoutHost,!1),Sp}function bp(n,i,r,a){return Ep(n,i,r,a),Sp(),bp}let Ah=(n,i,r,a,u,f)=>(y(!0),mf(a,u,function uc(){return $t.lFrame.currentNamespace}()));function Jg(){return Ye()}function Pi(n){return!!n&&"function"==typeof n.then}function W0(n){return!!n&&"function"==typeof n.subscribe}function Dp(n,i,r,a){const u=Ye(),f=Nt(),g=Lr();return function Ap(n,i,r,a,u,f,g){const M=Ho(a),N=n.firstCreatePass&&wg(n),H=i[Ui],Z=bg(i);let ae=!0;if(3&a.type||g){const ft=w(a,i),It=g?g(ft):ft,rn=Z.length,st=g?Kn=>g(Ti(Kn[a.index])):a.index;let xn=null;if(!g&&M&&(xn=function ZM(n,i,r,a){const u=n.cleanup;if(null!=u)for(let f=0;f<u.length-1;f+=2){const g=u[f];if(g===r&&u[f+1]===a){const M=i[Fo],T=u[f+2];return M.length>T?M[T]:null}"string"==typeof g&&(f+=2)}return null}(n,i,u,a.index)),null!==xn)(xn.__ngLastListenerFn__||xn).__ngNextListenerFn__=f,xn.__ngLastListenerFn__=f,ae=!1;else{f=$0(a,i,H,f,!1);const Kn=r.listen(It,u,f);Z.push(f,Kn),N&&N.push(u,st,rn,rn+1)}}else f=$0(a,i,H,f,!1);const fe=a.outputs;let Be;if(ae&&null!==fe&&(Be=fe[u])){const ft=Be.length;if(ft)for(let It=0;It<ft;It+=2){const Ai=i[Be[It]][Be[It+1]].subscribe(f),Pa=Z.length;Z.push(f,Ai),N&&N.push(u,a.index,Pa,-(Pa+1))}}}(f,u,u[ln],g,n,i,a),Dp}function ev(n,i,r,a){try{return Us(6,i,r),!1!==r(a)}catch(u){return dh(n,u),!1}finally{Us(7,i,r)}}function $0(n,i,r,a,u){return function f(g){if(g===Function)return a;Ac(n.componentOffset>-1?Y(n.index,i):i);let T=ev(i,r,a,g),N=f.__ngNextListenerFn__;for(;N;)T=ev(i,r,N,g)&&T,N=N.__ngNextListenerFn__;return u&&!1===T&&(g.preventDefault(),g.returnValue=!1),T}}function j0(n=1){return function au(n){return($t.lFrame.contextLView=function lu(n,i){for(;n>0;)i=i[vr],n--;return i}(n,$t.lFrame.contextLView))[Ui]}(n)}function Co(n,i){return n<<17|i<<2}function Do(n){return n>>17&32767}function Rh(n){return 2|n}function Gc(n){return(131068&n)>>2}function Np(n,i){return-131069&n|i<<2}function Ph(n){return 1|n}function ed(n,i,r,a,u){const f=n[r+1],g=null===i;let M=a?Do(f):Gc(f),T=!1;for(;0!==M&&(!1===T||g);){const H=n[M+1];sv(n[M],i)&&(T=!0,n[M+1]=a?Ph(H):Rh(H)),M=a?Do(H):Gc(H)}T&&(n[r+1]=a?Rh(f):Ph(f))}function sv(n,i){return null===n||null==i||(Array.isArray(n)?n[1]:n)===i||!(!Array.isArray(n)||"string"!=typeof i)&&_c(n,i)>=0}function av(n,i,r){return na(n,i,r,!1),av}function lv(n,i){return na(n,i,null,!0),lv}function na(n,i,r,a){const u=Ye(),f=Nt(),g=function ms(n){const i=$t.lFrame,r=i.bindingIndex;return i.bindingIndex=i.bindingIndex+n,r}(2);f.firstUpdatePass&&function t_(n,i,r,a){const u=n.data;if(null===u[r+1]){const f=u[Mr()],g=function e_(n,i){return i>=n.expandoStartIndex}(n,r);(function hv(n,i){return 0!=(n.flags&(i?8:16))})(f,a)&&null===i&&!g&&(i=!1),i=function sx(n,i,r,a){const u=function lc(n){const i=$t.lFrame.currentDirectiveIndex;return-1===i?null:n[i]}(n);let f=a?i.residualClasses:i.residualStyles;if(null===u)0===(a?i.classBindings:i.styleBindings)&&(r=Fh(r=cv(null,n,i,r,a),i.attrs,a),f=null);else{const g=i.directiveStylingLast;if(-1===g||n[g]!==u)if(r=cv(u,n,i,r,a),null===f){let T=function ox(n,i,r){const a=r?i.classBindings:i.styleBindings;if(0!==Gc(a))return n[Do(a)]}(n,i,a);void 0!==T&&Array.isArray(T)&&(T=cv(null,n,i,T[1],a),T=Fh(T,i.attrs,a),function ax(n,i,r,a){n[Do(r?i.classBindings:i.styleBindings)]=a}(n,i,a,T))}else f=function lx(n,i,r){let a;const u=i.directiveEnd;for(let f=1+i.directiveStylingLast;f<u;f++)a=Fh(a,n[f].hostAttrs,r);return Fh(a,i.attrs,r)}(n,i,a)}return void 0!==f&&(a?i.residualClasses=f:i.residualStyles=f),r}(u,f,i,a),function ex(n,i,r,a,u,f){let g=f?i.classBindings:i.styleBindings,M=Do(g),T=Gc(g);n[a]=r;let H,N=!1;if(Array.isArray(r)?(H=r[1],(null===H||_c(r,H)>0)&&(N=!0)):H=r,u)if(0!==T){const ae=Do(n[M+1]);n[a+1]=Co(ae,M),0!==ae&&(n[ae+1]=Np(n[ae+1],a)),n[M+1]=function QM(n,i){return 131071&n|i<<17}(n[M+1],a)}else n[a+1]=Co(M,0),0!==M&&(n[M+1]=Np(n[M+1],a)),M=a;else n[a+1]=Co(T,0),0===M?M=a:n[T+1]=Np(n[T+1],a),T=a;N&&(n[a+1]=Rh(n[a+1])),ed(n,H,a,!0),ed(n,H,a,!1),function rv(n,i,r,a,u){const f=u?n.residualClasses:n.residualStyles;null!=f&&"string"==typeof i&&_c(f,i)>=0&&(r[a+1]=Ph(r[a+1]))}(i,H,n,a,f),g=Co(M,T),f?i.classBindings=g:i.styleBindings=g}(u,f,i,r,g,a)}}(f,n,g,a),i!==An&&rs(u,g,i)&&function uv(n,i,r,a,u,f,g,M){if(!(3&i.type))return;const T=n.data,N=T[M+1],H=function iv(n){return 1==(1&n)}(N)?dv(T,i,r,u,Gc(N),g):void 0;Uh(H)||(Uh(f)||function Lp(n){return 2==(2&n)}(N)&&(f=dv(T,null,r,u,M,g)),function Mf(n,i,r,a,u){if(i)u?n.addClass(r,a):n.removeClass(r,a);else{let f=-1===a.indexOf("-")?void 0:Jo.DashCase;null==u?n.removeStyle(r,a,f):("string"==typeof u&&u.endsWith("!important")&&(u=u.slice(0,-10),f|=Jo.Important),n.setStyle(r,a,u,f))}}(a,g,J(Mr(),r),u,f))}(f,f.data[Mr()],u,u[ln],n,u[g+1]=function r_(n,i){return null==n||""===n||("string"==typeof i?n+=i:"object"==typeof n&&(n=wt(Qo(n)))),n}(i,r),a,g)}function cv(n,i,r,a,u){let f=null;const g=r.directiveEnd;let M=r.directiveStylingLast;for(-1===M?M=r.directiveStart:M++;M<g&&(f=i[M],a=Fh(a,f.hostAttrs,u),f!==n);)M++;return null!==n&&(r.directiveStylingLast=M),a}function Fh(n,i,r){const a=r?1:2;let u=-1;if(null!==i)for(let f=0;f<i.length;f++){const g=i[f];"number"==typeof g?u=g:u===a&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),zs(n,g,!!r||i[++f]))}return void 0===n?null:n}function dv(n,i,r,a,u,f){const g=null===i;let M;for(;u>0;){const T=n[u],N=Array.isArray(T),H=N?T[1]:T,Z=null===H;let ae=r[u+1];ae===An&&(ae=Z?qe:void 0);let fe=Z?ef(ae,a):H===a?ae:void 0;if(N&&!Uh(fe)&&(fe=ef(T,a)),Uh(fe)&&(M=fe,g))return M;const Be=n[u+1];u=g?Do(Be):Gc(Be)}if(null!==i){let T=f?i.residualClasses:i.residualStyles;null!=T&&(M=ef(T,a))}return M}function Uh(n){return void 0!==n}function fv(n,i=""){const r=Ye(),a=Nt(),u=n+jn,f=a.firstCreatePass?Ja(a,u,1,i,null):a.data[u],g=c(a,r,f,i,n);r[u]=g,Ht()&&_l(a,r,g,f),Vr(f,!1)}let c=(n,i,r,a,u)=>(y(!0),function pf(n,i){return n.createText(i)}(i[ln],a));function s(n){return o("",n,""),s}function o(n,i,r){const a=Ye(),u=function kc(n,i,r,a){return rs(n,Gr(),r)?i+je(r)+a:An}(a,n,i,r);return u!==An&&function As(n,i,r){const a=J(i,n);!function hy(n,i,r){n.setValue(i,r)}(n[ln],a,r)}(a,Mr(),u),o}const Lt=void 0;var Dn=["en",[["a","p"],["AM","PM"],Lt],[["AM","PM"],Lt,Lt],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Lt,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Lt,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Lt,"{1} 'at' {0}",Lt],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function de(n){const r=Math.floor(Math.abs(n)),a=n.toString().replace(/^[^.]*\.?/,"").length;return 1===r&&0===a?1:5}];let fn={};function tn(n){const i=function En(n){return n.toLowerCase().replace(/_/g,"-")}(n);let r=ht(i);if(r)return r;const a=i.split("-")[0];if(r=ht(a),r)return r;if("en"===a)return Dn;throw new Me(701,!1)}function ze(n){return tn(n)[Oe.PluralCase]}function ht(n){return n in fn||(fn[n]=$n.ng&&$n.ng.common&&$n.ng.common.locales&&$n.ng.common.locales[n]),fn[n]}var Oe=(()=>((Oe=Oe||{})[Oe.LocaleId=0]="LocaleId",Oe[Oe.DayPeriodsFormat=1]="DayPeriodsFormat",Oe[Oe.DayPeriodsStandalone=2]="DayPeriodsStandalone",Oe[Oe.DaysFormat=3]="DaysFormat",Oe[Oe.DaysStandalone=4]="DaysStandalone",Oe[Oe.MonthsFormat=5]="MonthsFormat",Oe[Oe.MonthsStandalone=6]="MonthsStandalone",Oe[Oe.Eras=7]="Eras",Oe[Oe.FirstDayOfWeek=8]="FirstDayOfWeek",Oe[Oe.WeekendRange=9]="WeekendRange",Oe[Oe.DateFormat=10]="DateFormat",Oe[Oe.TimeFormat=11]="TimeFormat",Oe[Oe.DateTimeFormat=12]="DateTimeFormat",Oe[Oe.NumberSymbols=13]="NumberSymbols",Oe[Oe.NumberFormats=14]="NumberFormats",Oe[Oe.CurrencyCode=15]="CurrencyCode",Oe[Oe.CurrencySymbol=16]="CurrencySymbol",Oe[Oe.CurrencyName=17]="CurrencyName",Oe[Oe.Currencies=18]="Currencies",Oe[Oe.Directionality=19]="Directionality",Oe[Oe.PluralCase=20]="PluralCase",Oe[Oe.ExtraData=21]="ExtraData",Oe))();const On="en-US";let xt=On;function c_(n,i,r,a,u){if(n=St(n),Array.isArray(n))for(let f=0;f<n.length;f++)c_(n[f],i,r,a,u);else{const f=Nt(),g=Ye();let M=Tl(n)?n:St(n.provide),T=Pf(n);const N=Lr(),H=1048575&N.providerIndexes,Z=N.directiveStart,ae=N.providerIndexes>>20;if(Tl(n)||!n.multi){const fe=new Gt(T,u,Ka),Be=d_(M,i,u?H:H+ae,Z);-1===Be?(du(uu(N,g),f,M),u_(f,n,i.length),i.push(M),N.directiveStart++,N.directiveEnd++,u&&(N.providerIndexes+=1048576),r.push(fe),g.push(fe)):(r[Be]=fe,g[Be]=fe)}else{const fe=d_(M,i,H+ae,Z),Be=d_(M,i,H,H+ae),It=Be>=0&&r[Be];if(u&&!It||!u&&!(fe>=0&&r[fe])){du(uu(N,g),f,M);const rn=function TS(n,i,r,a,u){const f=new Gt(n,r,Ka);return f.multi=[],f.index=i,f.componentProviders=0,gx(f,u,a&&!r),f}(u?wS:bS,r.length,u,a,T);!u&&It&&(r[Be].providerFactory=rn),u_(f,n,i.length,0),i.push(M),N.directiveStart++,N.directiveEnd++,u&&(N.providerIndexes+=1048576),r.push(rn),g.push(rn)}else u_(f,n,fe>-1?fe:Be,gx(r[u?Be:fe],T,!u&&a));!u&&a&&It&&r[Be].componentProviders++}}}function u_(n,i,r,a){const u=Tl(i),f=function By(n){return!!n.useClass}(i);if(u||f){const T=(f?St(i.useClass):i).prototype.ngOnDestroy;if(T){const N=n.destroyHooks||(n.destroyHooks=[]);if(!u&&i.multi){const H=N.indexOf(r);-1===H?N.push(r,[a,T]):N[H+1].push(a,T)}else N.push(r,T)}}}function gx(n,i,r){return r&&n.componentProviders++,n.multi.push(i)-1}function d_(n,i,r,a){for(let u=r;u<a;u++)if(i[u]===n)return u;return-1}function bS(n,i,r,a){return h_(this.multi,[])}function wS(n,i,r,a){const u=this.multi;let f;if(this.providerFactory){const g=this.providerFactory.componentProviders,M=Zo(r,r[At],this.providerFactory.index,a);f=M.slice(0,g),h_(u,f);for(let T=g;T<M.length;T++)f.push(M[T])}else f=[],h_(u,f);return f}function h_(n,i){for(let r=0;r<n.length;r++)i.push((0,n[r])());return i}function vx(n,i=[]){return r=>{r.providersResolver=(a,u)=>function SS(n,i,r){const a=Nt();if(a.firstCreatePass){const u=fs(n);c_(r,a.data,a.blueprint,u,!0),c_(i,a.data,a.blueprint,u,!1)}}(a,u?u(n):n,i)}}class Bh{}class yx{}function CS(n,i){return new f_(n,i??null,[])}class f_ extends Bh{constructor(i,r,a){super(),this._parent=r,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new mh(this);const u=gr(i);this._bootstrapComponents=ta(u.bootstrap),this._r3Injector=s0(i,r,[{provide:Bh,useValue:this},{provide:Ou,useValue:this.componentFactoryResolver},...a],wt(i),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(i)}get injector(){return this._r3Injector}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(r=>r()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class p_ extends yx{constructor(i){super(),this.moduleType=i}create(i){return new f_(this.moduleType,i,[])}}class _x extends Bh{constructor(i){super(),this.componentFactoryResolver=new mh(this),this.instance=null;const r=new If([...i.providers,{provide:Bh,useValue:this},{provide:Ou,useValue:this.componentFactoryResolver}],i.parent||Vd(),i.debugName,new Set(["environment"]));this.injector=r,i.runEnvironmentInitializers&&r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(i){this.injector.onDestroy(i)}}function Mx(n,i,r=null){return new _x({providers:n,parent:i,debugName:r,runEnvironmentInitializers:!0}).injector}let AS=(()=>{class n{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r.id)){const a=Xm(0,r.type),u=a.length>0?Mx([a],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r.id,u)}return this.cachedInjectors.get(r.id)}ngOnDestroy(){try{for(const r of this.cachedInjectors.values())null!==r&&r.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=ei({token:n,providedIn:"environment",factory:()=>new n(Wi(wa))}),n})();function xx(n){n.getStandaloneInjector=i=>i.get(AS).getOrCreateStandaloneInjector(n)}function Bp(n,i){const r=n[i];return r===An?void 0:r}function Lx(n,i){const r=Nt();let a;const u=n+jn;r.firstCreatePass?(a=function YS(n,i){if(i)for(let r=i.length-1;r>=0;r--){const a=i[r];if(n===a.name)return a}}(i,r.pipeRegistry),r.data[u]=a,a.onDestroy&&(r.destroyHooks??=[]).push(u,a.onDestroy)):a=r.data[u];const f=a.factory||(a.factory=Vo(a.type)),g=Bi(Ka);try{const M=Qr(!1),T=f();return Qr(M),function qM(n,i,r,a){r>=n.data.length&&(n.data[r]=null,n.blueprint[r]=null),i[r]=a}(r,Ye(),u,T),T}finally{Bi(g)}}function Nx(n,i,r){const a=n+jn,u=Ye(),f=k(u,a);return Hp(u,a)?function Dx(n,i,r,a,u,f){const g=i+r;return rs(n,g,u)?bo(n,g+1,f?a.call(f,u):a(u)):Bp(n,g+1)}(u,Jr(),i,f.transform,r,f):f.transform(r)}function Ox(n,i,r,a,u){const f=n+jn,g=Ye(),M=k(g,f);return Hp(g,f)?function Ix(n,i,r,a,u,f,g,M){const T=i+r;return Da(n,T,u,f,g)?bo(n,T+3,M?a.call(M,u,f,g):a(u,f,g)):Bp(n,T+3)}(g,Jr(),i,M.transform,r,a,u,M):M.transform(r,a,u)}function Hp(n,i){return n[At].data[i].pure}function g_(n){return i=>{setTimeout(n,void 0,i)}}const rl=class JS extends x.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,r,a){let u=i,f=r||(()=>null),g=a;if(i&&"object"==typeof i){const T=i;u=T.next?.bind(T),f=T.error?.bind(T),g=T.complete?.bind(T)}this.__isAsync&&(f=g_(f),u&&(u=g_(u)),g&&(g=g_(g)));const M=super.subscribe({next:u,error:f,complete:g});return i instanceof pe.w0&&i.add(M),M}};function QS(){return this._results[Symbol.iterator]()}class v_{get changes(){return this._changes||(this._changes=new rl)}constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const r=v_.prototype;r[Symbol.iterator]||(r[Symbol.iterator]=QS)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,r){return this._results.reduce(i,r)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,r){const a=this;a.dirty=!1;const u=function lo(n){return n.flat(Number.POSITIVE_INFINITY)}(i);(this._changesDetected=!function Dv(n,i,r){if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++){let u=n[a],f=i[a];if(r&&(u=r(u),f=r(f)),f!==u)return!1}return!0}(a._results,u,r))&&(a._results=u,a.length=u.length,a.last=u[this.length-1],a.first=u[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let zp=(()=>{class n{}return n.__NG_ELEMENT_ID__=nb,n})();const eb=zp,tb=class extends eb{constructor(i,r,a){super(),this._declarationLView=i,this._declarationTContainer=r,this.elementRef=a}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(i,r){return this.createEmbeddedViewImpl(i,r,null)}createEmbeddedViewImpl(i,r,a){const u=this._declarationTContainer.tView,f=Il(this._declarationLView,u,i,16,null,u.declTNode,null,null,null,r||null,a||null);f[ds]=this._declarationLView[this._declarationTContainer.index];const M=this._declarationLView[ki];return null!==M&&(f[ki]=M.createEmbeddedView(u)),Pc(u,f,i),new Ol(f)}};function nb(){return gv(Lr(),Ye())}function gv(n,i){return 4&n.type?new tb(i,n,ea(n,i)):null}let vv=(()=>{class n{}return n.__NG_ELEMENT_ID__=cb,n})();function cb(){return zx(Lr(),Ye())}const ub=vv,Bx=class extends ub{constructor(i,r,a){super(),this._lContainer=i,this._hostTNode=r,this._hostLView=a}get element(){return ea(this._hostTNode,this._hostLView)}get injector(){return new Ea(this._hostTNode,this._hostLView)}get parentInjector(){const i=ja(this._hostTNode,this._hostLView);if(bv(i)){const r=pc(i,this._hostLView),a=gd(i);return new Ea(r[At].data[a+8],r)}return new Ea(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const r=Hx(this._lContainer);return null!==r&&r[i]||null}get length(){return this._lContainer.length-ji}createEmbeddedView(i,r,a){let u,f;"number"==typeof a?u=a:null!=a&&(u=a.index,f=a.injector);const M=i.createEmbeddedViewImpl(r||{},f,null);return this.insertImpl(M,u,false),M}createComponent(i,r,a,u,f){const g=i&&!function Ko(n){return"function"==typeof n}(i);let M;if(g)M=r;else{const ft=r||{};M=ft.index,a=ft.injector,u=ft.projectableNodes,f=ft.environmentInjector||ft.ngModuleRef}const T=g?i:new Fl(ni(i)),N=a||this.parentInjector;if(!f&&null==T.ngModule){const It=(g?N:this.parentInjector).get(wa,null);It&&(f=It)}ni(T.componentType??{});const fe=T.create(N,u,null,f);return this.insertImpl(fe.hostView,M,false),fe}insert(i,r){return this.insertImpl(i,r,!1)}insertImpl(i,r,a){const u=i._lView,f=u[At];if(function kt(n){return lr(n[li])}(u)){const T=this.indexOf(i);if(-1!==T)this.detach(T);else{const N=u[li],H=new Bx(N,N[Fi],N[li]);H.detach(H.indexOf(i))}}const g=this._adjustIndex(r),M=this._lContainer;if(function mM(n,i,r,a){const u=ji+a,f=r.length;a>0&&(r[u-1][ar]=i),a<f-ji?(i[ar]=r[u],qp(r,ji+a,i)):(r.push(i),i[ar]=null),i[li]=r;const g=i[ds];null!==g&&r!==g&&function gM(n,i){const r=n[ca];i[Ii]!==i[li][li][Ii]&&(n[Yl]=!0),null===r?n[ca]=[i]:r.push(i)}(g,i);const M=i[ki];null!==M&&M.insertView(n),i[hn]|=128}(f,u,M,g),!a){const T=vf(g,M),N=u[ln],H=gf(N,M[hs]);null!==H&&function hM(n,i,r,a,u,f){a[Oi]=u,a[Fi]=i,Ml(n,a,r,1,u,f)}(f,M[Fi],N,u,H,T)}return i.attachToViewContainerRef(),qp(__(M),g,i),i}move(i,r){return this.insert(i,r)}indexOf(i){const r=Hx(this._lContainer);return null!==r?r.indexOf(i):-1}remove(i){const r=this._adjustIndex(i,-1),a=ym(this._lContainer,r);a&&(Ed(__(this._lContainer),r),py(a[At],a))}detach(i){const r=this._adjustIndex(i,-1),a=ym(this._lContainer,r);return a&&null!=Ed(__(this._lContainer),r)?new Ol(a):null}_adjustIndex(i,r=0){return i??this.length+r}};function Hx(n){return n[Ba]}function __(n){return n[Ba]||(n[Ba]=[])}function zx(n,i){let r;const a=i[n.index];return lr(a)?r=a:(r=Eg(a,i,null,n),i[n.index]=r,uh(i,r)),Vx(r,i,n,a),new Bx(r,n,i)}let Vx=function Gx(n,i,r,a){if(n[hs])return;let u;u=8&r.type?Ti(a):function db(n,i){const r=n[ln],a=r.createComment(""),u=w(i,n);return Ec(r,gf(r,u),a,function MM(n,i){return n.nextSibling(i)}(r,u),!1),a}(i,r),n[hs]=u};class M_{constructor(i){this.queryList=i,this.matches=null}clone(){return new M_(this.queryList)}setDirty(){this.queryList.setDirty()}}class x_{constructor(i=[]){this.queries=i}createEmbeddedView(i){const r=i.queries;if(null!==r){const a=null!==i.contentQueries?i.contentQueries[0]:r.length,u=[];for(let f=0;f<a;f++){const g=r.getByIndex(f);u.push(this.queries[g.indexInDeclarationView].clone())}return new x_(u)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let r=0;r<this.queries.length;r++)null!==Jx(i,r).matches&&this.queries[r].setDirty()}}class Wx{constructor(i,r,a=null){this.predicate=i,this.flags=r,this.read=a}}class E_{constructor(i=[]){this.queries=i}elementStart(i,r){for(let a=0;a<this.queries.length;a++)this.queries[a].elementStart(i,r)}elementEnd(i){for(let r=0;r<this.queries.length;r++)this.queries[r].elementEnd(i)}embeddedTView(i){let r=null;for(let a=0;a<this.length;a++){const u=null!==r?r.length:0,f=this.getByIndex(a).embeddedTView(i,u);f&&(f.indexInDeclarationView=a,null!==r?r.push(f):r=[f])}return null!==r?new E_(r):null}template(i,r){for(let a=0;a<this.queries.length;a++)this.queries[a].template(i,r)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class S_{constructor(i,r=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=r}elementStart(i,r){this.isApplyingToNode(r)&&this.matchTNode(i,r)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,r){this.elementStart(i,r)}embeddedTView(i,r){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,r),new S_(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const r=this._declarationNodeIndex;let a=i.parent;for(;null!==a&&8&a.type&&a.index!==r;)a=a.parent;return r===(null!==a?a.index:-1)}return this._appliesToNextNode}matchTNode(i,r){const a=this.metadata.predicate;if(Array.isArray(a))for(let u=0;u<a.length;u++){const f=a[u];this.matchTNodeWithReadOption(i,r,pb(r,f)),this.matchTNodeWithReadOption(i,r,mu(r,i,f,!1,!1))}else a===zp?4&r.type&&this.matchTNodeWithReadOption(i,r,-1):this.matchTNodeWithReadOption(i,r,mu(r,i,a,!1,!1))}matchTNodeWithReadOption(i,r,a){if(null!==a){const u=this.metadata.read;if(null!==u)if(u===Za||u===vv||u===zp&&4&r.type)this.addMatch(r.index,-2);else{const f=mu(r,i,u,!1,!1);null!==f&&this.addMatch(r.index,f)}else this.addMatch(r.index,a)}}addMatch(i,r){null===this.matches?this.matches=[i,r]:this.matches.push(i,r)}}function pb(n,i){const r=n.localNames;if(null!==r)for(let a=0;a<r.length;a+=2)if(r[a]===i)return r[a+1];return null}function gb(n,i,r,a){return-1===r?function mb(n,i){return 11&n.type?ea(n,i):4&n.type?gv(n,i):null}(i,n):-2===r?function vb(n,i,r){return r===Za?ea(i,n):r===zp?gv(i,n):r===vv?zx(i,n):void 0}(n,i,a):Zo(n,n[At],r,i)}function $x(n,i,r,a){const u=i[ki].queries[a];if(null===u.matches){const f=n.data,g=r.matches,M=[];for(let T=0;T<g.length;T+=2){const N=g[T];M.push(N<0?null:gb(i,f[N],g[T+1],r.metadata.read))}u.matches=M}return u.matches}function b_(n,i,r,a){const u=n.queries.getByIndex(r),f=u.matches;if(null!==f){const g=$x(n,i,u,r);for(let M=0;M<f.length;M+=2){const T=f[M];if(T>0)a.push(g[M/2]);else{const N=f[M+1],H=i[-T];for(let Z=ji;Z<H.length;Z++){const ae=H[Z];ae[ds]===ae[li]&&b_(ae[At],ae,N,a)}if(null!==H[ca]){const Z=H[ca];for(let ae=0;ae<Z.length;ae++){const fe=Z[ae];b_(fe[At],fe,N,a)}}}}}return a}function jx(n){const i=Ye(),r=Nt(),a=Yh();ou(a+1);const u=Jx(r,a);if(n.dirty&&function ge(n){return 4==(4&n[hn])}(i)===(2==(2&u.metadata.flags))){if(null===u.matches)n.reset([]);else{const f=u.crossesNgTemplate?b_(r,i,a,[]):$x(r,i,u,a);n.reset(f,og),n.notifyOnChanges()}return!0}return!1}function Xx(n,i,r){const a=Nt();a.firstCreatePass&&(Kx(a,new Wx(n,i,r),-1),2==(2&i)&&(a.staticViewQueries=!0)),Zx(a,Ye(),i)}function Yx(n,i,r,a){const u=Nt();if(u.firstCreatePass){const f=Lr();Kx(u,new Wx(i,r,a),f.index),function _b(n,i){const r=n.contentQueries||(n.contentQueries=[]);i!==(r.length?r[r.length-1]:-1)&&r.push(n.queries.length-1,i)}(u,n),2==(2&r)&&(u.staticContentQueries=!0)}Zx(u,Ye(),r)}function qx(){return function yb(n,i){return n[ki].queries[i].queryList}(Ye(),Yh())}function Zx(n,i,r){const a=new v_(4==(4&r));(function c0(n,i,r,a){const u=bg(i);u.push(r),n.firstCreatePass&&wg(n).push(a,u.length-1)})(n,i,a,a.destroy),null===i[ki]&&(i[ki]=new x_),i[ki].queries.push(new M_(a))}function Kx(n,i,r){null===n.queries&&(n.queries=new E_),n.queries.track(new S_(i,r))}function Jx(n,i){return n.queries.getByIndex(i)}function Qx(n,i){return gv(n,i)}function w_(n){return!!gr(n)}const gE=new Mi("Application Initializer");let I_=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,a)=>{this.resolve=r,this.reject=a}),this.appInits=ai(gE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const r=[];for(const u of this.appInits){const f=u();if(Pi(f))r.push(f);else if(W0(f)){const g=new Promise((M,T)=>{f.subscribe({complete:M,error:T})});r.push(g)}}const a=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{a()}).catch(u=>{this.reject(u)}),0===r.length&&a(),this.initialized=!0}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ei({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vE=(()=>{class n{log(r){console.log(r)}warn(r){console.warn(r)}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ei({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const _v=new Mi("LocaleId",{providedIn:"root",factory:()=>ai(_v,nt.Optional|nt.SkipSelf)||function Hb(){return typeof $localize<"u"&&$localize.locale||On}()}),zb=new Mi("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Vb{constructor(i,r){this.ngModuleFactory=i,this.componentFactories=r}}let Gb=(()=>{class n{compileModuleSync(r){return new p_(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){const a=this.compileModuleSync(r),f=ta(gr(r).declarations).reduce((g,M)=>{const T=ni(M);return T&&g.push(new Fl(T)),g},[]);return new Vb(a,f)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ei({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jb=(()=>Promise.resolve(0))();function R_(n){typeof Zone>"u"?jb.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}function ME(...n){}class Rs{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:a=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new rl(!1),this.onMicrotaskEmpty=new rl(!1),this.onStable=new rl(!1),this.onError=new rl(!1),typeof Zone>"u")throw new Me(908,!1);Zone.assertZonePatched();const u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!a&&r,u.shouldCoalesceRunChangeDetection=a,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function Xb(){let n=$n.requestAnimationFrame,i=$n.cancelAnimationFrame;if(typeof Zone<"u"&&n&&i){const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r);const a=i[Zone.__symbol__("OriginalDelegate")];a&&(i=a)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:i}}().nativeRequestAnimationFrame,function Zb(n){const i=()=>{!function qb(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call($n,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,L_(n),n.isCheckStableRunning=!0,P_(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),L_(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(r,a,u,f,g,M)=>{try{return xE(n),r.invokeTask(u,f,g,M)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||n.shouldCoalesceRunChangeDetection)&&i(),EE(n)}},onInvoke:(r,a,u,f,g,M,T)=>{try{return xE(n),r.invoke(u,f,g,M,T)}finally{n.shouldCoalesceRunChangeDetection&&i(),EE(n)}},onHasTask:(r,a,u,f)=>{r.hasTask(u,f),a===u&&("microTask"==f.change?(n._hasPendingMicrotasks=f.microTask,L_(n),P_(n)):"macroTask"==f.change&&(n.hasPendingMacrotasks=f.macroTask))},onHandleError:(r,a,u,f)=>(r.handleError(u,f),n.runOutsideAngular(()=>n.onError.emit(f)),!1)})}(u)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Rs.isInAngularZone())throw new Me(909,!1)}static assertNotInAngularZone(){if(Rs.isInAngularZone())throw new Me(909,!1)}run(i,r,a){return this._inner.run(i,r,a)}runTask(i,r,a,u){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+u,i,Yb,ME,ME);try{return f.runTask(g,r,a)}finally{f.cancelTask(g)}}runGuarded(i,r,a){return this._inner.runGuarded(i,r,a)}runOutsideAngular(i){return this._outer.run(i)}}const Yb={};function P_(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function L_(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function xE(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function EE(n){n._nesting--,P_(n)}const SE=new Mi("",{providedIn:"root",factory:bE});function bE(){const n=ai(Rs);let i=!0;return function ut(...n){const i=(0,at.yG)(n),r=(0,at._6)(n,1/0),a=n;return a.length?1===a.length?(0,Ce.Xf)(a[0]):(0,Ve.J)(r)((0,Et.D)(a,i)):Te.E}(new Pe.y(u=>{i=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{u.next(i),u.complete()})}),new Pe.y(u=>{let f;n.runOutsideAngular(()=>{f=n.onStable.subscribe(()=>{Rs.assertNotInAngularZone(),R_(()=>{!i&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(i=!0,u.next(!0))})})});const g=n.onUnstable.subscribe(()=>{Rs.assertInAngularZone(),i&&(i=!1,n.runOutsideAngular(()=>{u.next(!1)}))});return()=>{f.unsubscribe(),g.unsubscribe()}}).pipe((0,tt.B)()))}const wE=new Mi(""),TE=new Mi("");let N_,Jb=(()=>{class n{constructor(r,a,u){this._ngZone=r,this.registry=a,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,N_||(function Qb(n){N_=n}(u),u.addToWindow(a)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Rs.assertNotInAngularZone(),R_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())R_(()=>{for(;0!==this._callbacks.length;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb(this._didWork)}this._didWork=!1});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(a=>!a.updateCb||!a.updateCb(r)||(clearTimeout(a.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,a,u){let f=-1;a&&a>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),r(this._didWork,this.getPendingTasks())},a)),this._callbacks.push({doneCb:r,timeoutId:f,updateCb:u})}whenStable(r,a,u){if(u&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,a,u),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,a,u){return[]}}return n.\u0275fac=function(r){return new(r||n)(Wi(Rs),Wi(CE),Wi(TE))},n.\u0275prov=ei({token:n,factory:n.\u0275fac}),n})(),CE=(()=>{class n{constructor(){this._applications=new Map}registerApplication(r,a){this._applications.set(r,a)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,a=!0){return N_?.findTestabilityInTree(this,r,a)??null}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ei({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),jc=null;const O_=new Mi("PlatformDestroyListeners"),F_=new Mi("appBootstrapListener");class nw{constructor(i,r){this.name=i,this.token=r}}function sw(n){try{const{rootComponent:i,appProviders:r,platformProviders:a}=n,u=function rw(n=[]){if(jc)return jc;const i=function RE(n=[],i){return $r.create({name:i,providers:[{provide:Af,useValue:"platform"},{provide:O_,useValue:new Set([()=>jc=null])},...n]})}(n);return jc=i,function AE(){!function $o(n){Js=n}(()=>{throw new Me(600,!1)})}(),function IE(n){n.get(Qm,null)?.forEach(r=>r())}(i),i}(a),f=[uw(),...r||[]],M=new _x({providers:f,parent:u,debugName:"",runEnvironmentInitializers:!1}).injector,T=M.get(Rs);return T.run(()=>{M.resolveInjectorInitializers();const N=M.get(Al,null);let H;T.runOutsideAngular(()=>{H=T.onError.subscribe({next:fe=>{N.handleError(fe)}})});const Z=()=>M.destroy(),ae=u.get(O_);return ae.add(Z),M.onDestroy(()=>{H.unsubscribe(),ae.delete(Z)}),function NE(n,i,r){try{const a=r();return Pi(a)?a.catch(u=>{throw i.runOutsideAngular(()=>n.handleError(u)),u}):a}catch(a){throw i.runOutsideAngular(()=>n.handleError(a)),a}}(N,T,()=>{const fe=M.get(I_);return fe.runInitializers(),fe.donePromise.then(()=>{!function Ut(n){Vn(n,"Expected localeId to be defined"),"string"==typeof n&&(xt=n.toLowerCase().replace(/_/g,"-"))}(M.get(_v,On)||On);const ft=M.get(Vh);return void 0!==i&&ft.bootstrap(i),ft})})})}catch(i){return Promise.reject(i)}}let Vh=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ai(UE),this.componentTypes=[],this.components=[],this.isStable=ai(SE),this._injector=ai(wa)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,a){const u=r instanceof Cc;if(!this._injector.get(I_).done)throw!u&&go(r),new Me(405,!1);let g;g=u?r:this._injector.get(Ou).resolveComponentFactory(r),this.componentTypes.push(g.componentType);const M=function tw(n){return n.isBoundToModule}(g)?void 0:this._injector.get(Bh),N=g.create($r.NULL,[],a||g.selector,M),H=N.location.nativeElement,Z=N.injector.get(wE,null);return Z?.registerApplication(H),N.onDestroy(()=>{this.detachView(N.hostView),Mv(this.components,N),Z?.unregisterApplication(H)}),this._loadComponent(N),N}tick(){if(this._runningTick)throw new Me(101,!1);try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}attachView(r){const a=r;this._views.push(a),a.attachToAppRef(this)}detachView(r){const a=r;Mv(this._views,a),a.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);const a=this._injector.get(F_,[]);a.push(...this._bootstrapListeners),a.forEach(u=>u(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Mv(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new Me(406,!1);const r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ei({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Mv(n,i){const r=n.indexOf(i);r>-1&&n.splice(r,1)}const UE=new Mi("",{providedIn:"root",factory:()=>ai(Al).handleError.bind(void 0)});function lw(){const n=ai(Rs),i=ai(Al);return r=>n.runOutsideAngular(()=>i.handleError(r))}let cw=(()=>{class n{constructor(){this.zone=ai(Rs),this.applicationRef=ai(Vh)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ei({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function kE(n){return[{provide:Rs,useFactory:n},{provide:wu,multi:!0,useFactory:()=>{const i=ai(cw,{optional:!0});return()=>i.initialize()}},{provide:UE,useFactory:lw},{provide:SE,useFactory:bE}]}function uw(n){return Tu([[],kE(()=>new Rs(function LE(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}(n)))])}let dw=(()=>{class n{}return n.__NG_ELEMENT_ID__=hw,n})();function hw(n){return function fw(n,i,r){if(Bo(n)&&!r){const a=Y(n.index,i);return new Ol(a,a)}return 47&n.type?new Ol(i[Ii],i):null}(Lr(),Ye(),16==(16&n))}class VE{constructor(){}supports(i){return Mh(i)}create(i){return new _w(i)}}const yw=(n,i)=>i;class _w{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||yw}forEachItem(i){let r;for(r=this._itHead;null!==r;r=r._next)i(r)}forEachOperation(i){let r=this._itHead,a=this._removalsHead,u=0,f=null;for(;r||a;){const g=!a||r&&r.currentIndex<WE(a,u,f)?r:a,M=WE(g,u,f),T=g.currentIndex;if(g===a)u--,a=a._nextRemoved;else if(r=r._next,null==g.previousIndex)u++;else{f||(f=[]);const N=M-u,H=T-u;if(N!=H){for(let ae=0;ae<N;ae++){const fe=ae<f.length?f[ae]:f[ae]=0,Be=fe+ae;H<=Be&&Be<N&&(f[ae]=fe+1)}f[g.previousIndex]=H-N}}M!==T&&i(g,M,T)}}forEachPreviousItem(i){let r;for(r=this._previousItHead;null!==r;r=r._nextPrevious)i(r)}forEachAddedItem(i){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)i(r)}forEachMovedItem(i){let r;for(r=this._movesHead;null!==r;r=r._nextMoved)i(r)}forEachRemovedItem(i){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)i(r)}forEachIdentityChange(i){let r;for(r=this._identityChangesHead;null!==r;r=r._nextIdentityChange)i(r)}diff(i){if(null==i&&(i=[]),!Mh(i))throw new Me(900,!1);return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let u,f,g,r=this._itHead,a=!1;if(Array.isArray(i)){this.length=i.length;for(let M=0;M<this.length;M++)f=i[M],g=this._trackByFn(M,f),null!==r&&Object.is(r.trackById,g)?(a&&(r=this._verifyReinsertion(r,f,g,M)),Object.is(r.item,f)||this._addIdentityChange(r,f)):(r=this._mismatch(r,f,g,M),a=!0),r=r._next}else u=0,function A0(n,i){if(Array.isArray(n))for(let r=0;r<n.length;r++)i(n[r]);else{const r=n[Symbol.iterator]();let a;for(;!(a=r.next()).done;)i(a.value)}}(i,M=>{g=this._trackByFn(u,M),null!==r&&Object.is(r.trackById,g)?(a&&(r=this._verifyReinsertion(r,M,g,u)),Object.is(r.item,M)||this._addIdentityChange(r,M)):(r=this._mismatch(r,M,g,u),a=!0),r=r._next,u++}),this.length=u;return this._truncate(r),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,r,a,u){let f;return null===i?f=this._itTail:(f=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null))?(Object.is(i.item,r)||this._addIdentityChange(i,r),this._reinsertAfter(i,f,u)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(a,u))?(Object.is(i.item,r)||this._addIdentityChange(i,r),this._moveAfter(i,f,u)):i=this._addAfter(new Mw(r,a),f,u),i}_verifyReinsertion(i,r,a,u){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null);return null!==f?i=this._reinsertAfter(f,i._prev,u):i.currentIndex!=u&&(i.currentIndex=u,this._addToMoves(i,u)),i}_truncate(i){for(;null!==i;){const r=i._next;this._addToRemovals(this._unlink(i)),i=r}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,r,a){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const u=i._prevRemoved,f=i._nextRemoved;return null===u?this._removalsHead=f:u._nextRemoved=f,null===f?this._removalsTail=u:f._prevRemoved=u,this._insertAfter(i,r,a),this._addToMoves(i,a),i}_moveAfter(i,r,a){return this._unlink(i),this._insertAfter(i,r,a),this._addToMoves(i,a),i}_addAfter(i,r,a){return this._insertAfter(i,r,a),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,r,a){const u=null===r?this._itHead:r._next;return i._next=u,i._prev=r,null===u?this._itTail=i:u._prev=i,null===r?this._itHead=i:r._next=i,null===this._linkedRecords&&(this._linkedRecords=new GE),this._linkedRecords.put(i),i.currentIndex=a,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const r=i._prev,a=i._next;return null===r?this._itHead=a:r._next=a,null===a?this._itTail=r:a._prev=r,i}_addToMoves(i,r){return i.previousIndex===r||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new GE),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,r){return i.item=r,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class Mw{constructor(i,r){this.item=i,this.trackById=r,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xw{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,r){let a;for(a=this._head;null!==a;a=a._nextDup)if((null===r||r<=a.currentIndex)&&Object.is(a.trackById,i))return a;return null}remove(i){const r=i._prevDup,a=i._nextDup;return null===r?this._head=a:r._nextDup=a,null===a?this._tail=r:a._prevDup=r,null===this._head}}class GE{constructor(){this.map=new Map}put(i){const r=i.trackById;let a=this.map.get(r);a||(a=new xw,this.map.set(r,a)),a.add(i)}get(i,r){const u=this.map.get(i);return u?u.get(i,r):null}remove(i){const r=i.trackById;return this.map.get(r).remove(i)&&this.map.delete(r),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function WE(n,i,r){const a=n.previousIndex;if(null===a)return a;let u=0;return r&&a<r.length&&(u=r[a]),a+i+u}class $E{constructor(){}supports(i){return i instanceof Map||ho(i)}create(){return new Ew}}class Ew{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let r;for(r=this._mapHead;null!==r;r=r._next)i(r)}forEachPreviousItem(i){let r;for(r=this._previousMapHead;null!==r;r=r._nextPrevious)i(r)}forEachChangedItem(i){let r;for(r=this._changesHead;null!==r;r=r._nextChanged)i(r)}forEachAddedItem(i){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)i(r)}forEachRemovedItem(i){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)i(r)}diff(i){if(i){if(!(i instanceof Map||ho(i)))throw new Me(900,!1)}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let r=this._mapHead;if(this._appendAfter=null,this._forEach(i,(a,u)=>{if(r&&r.key===u)this._maybeAddToChanges(r,a),this._appendAfter=r,r=r._next;else{const f=this._getOrCreateRecordForKey(u,a);r=this._insertBeforeOrAppend(r,f)}}),r){r._prev&&(r._prev._next=null),this._removalsHead=r;for(let a=r;null!==a;a=a._nextRemoved)a===this._mapHead&&(this._mapHead=null),this._records.delete(a.key),a._nextRemoved=a._next,a.previousValue=a.currentValue,a.currentValue=null,a._prev=null,a._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,r){if(i){const a=i._prev;return r._next=i,r._prev=a,i._prev=r,a&&(a._next=r),i===this._mapHead&&(this._mapHead=r),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=r,r._prev=this._appendAfter):this._mapHead=r,this._appendAfter=r,null}_getOrCreateRecordForKey(i,r){if(this._records.has(i)){const u=this._records.get(i);this._maybeAddToChanges(u,r);const f=u._prev,g=u._next;return f&&(f._next=g),g&&(g._prev=f),u._next=null,u._prev=null,u}const a=new Sw(i);return this._records.set(i,a),a.currentValue=r,this._addToAdditions(a),a}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,r){Object.is(r,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=r,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,r){i instanceof Map?i.forEach(r):Object.keys(i).forEach(a=>r(i[a],a))}}class Sw{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function jE(){return new V_([new VE])}let V_=(()=>{class n{constructor(r){this.factories=r}static create(r,a){if(null!=a){const u=a.factories.slice();r=r.concat(u)}return new n(r)}static extend(r){return{provide:n,useFactory:a=>n.create(r,a||jE()),deps:[[n,new wd,new bd]]}}find(r){const a=this.factories.find(u=>u.supports(r));if(null!=a)return a;throw new Me(901,!1)}}return n.\u0275prov=ei({token:n,providedIn:"root",factory:jE}),n})();function XE(){return new G_([new $E])}let G_=(()=>{class n{constructor(r){this.factories=r}static create(r,a){if(a){const u=a.factories.slice();r=r.concat(u)}return new n(r)}static extend(r){return{provide:n,useFactory:a=>n.create(r,a||XE()),deps:[[n,new wd,new bd]]}}find(r){const a=this.factories.find(u=>u.supports(r));if(a)return a;throw new Me(901,!1)}}return n.\u0275prov=ei({token:n,providedIn:"root",factory:XE}),n})(),Tw=(()=>{class n{constructor(r){}}return n.\u0275fac=function(r){return new(r||n)(Wi(Vh))},n.\u0275mod=mo({type:n}),n.\u0275inj=$s({}),n})(),QE=(()=>{class n{get whenAllTasksComplete(){return 0===this.collection.size&&this.complete(),this.promise}constructor(){this.taskId=0,this.collection=new Set,this.ngZone=ai(Rs),this.completed=!1,this.ngZone.runOutsideAngular(()=>{this.promise=new Promise(r=>{this.resolve=r})})}add(){if(this.completed)return-1;const r=this.taskId++;return this.collection.add(r),r}remove(r){this.completed||(this.collection.delete(r),0===this.collection.size&&this.complete())}ngOnDestroy(){this.complete(),this.collection.clear()}complete(){this.completed=!0,this.resolve()}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=ei({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ow(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function Uw(n){const i=ni(n);if(!i)return null;const r=new Fl(i);return{get selector(){return r.selector},get type(){return r.componentType},get inputs(){return r.inputs},get outputs(){return r.outputs},get ngContentSelectors(){return r.ngContentSelectors},get isStandalone(){return i.standalone}}}},6550:(Jt,$e,$)=>{$.d($e,{Cg:()=>on,Dx:()=>Ps,H7:()=>as,b2:()=>Yt});var x=$(2504),pe=$(4755);class Pe extends pe.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ve extends Pe{static makeCurrent(){(0,pe.HT)(new Ve)}onAndCancel(ce,ee,ue){return ce.addEventListener(ee,ue),()=>{ce.removeEventListener(ee,ue)}}dispatchEvent(ce,ee){ce.dispatchEvent(ee)}remove(ce){ce.parentNode&&ce.parentNode.removeChild(ce)}createElement(ce,ee){return(ee=ee||this.getDefaultDocument()).createElement(ce)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(ce){return ce.nodeType===Node.ELEMENT_NODE}isShadowRoot(ce){return ce instanceof DocumentFragment}getGlobalEventTarget(ce,ee){return"window"===ee?window:"document"===ee?ce:"body"===ee?ce.body:null}getBaseHref(ce){const ee=function Te(){return Ce=Ce||document.querySelector("base"),Ce?Ce.getAttribute("href"):null}();return null==ee?null:function Et(Ee){at=at||document.createElement("a"),at.setAttribute("href",Ee);const ce=at.pathname;return"/"===ce.charAt(0)?ce:`/${ce}`}(ee)}resetBaseElement(){Ce=null}getUserAgent(){return window.navigator.userAgent}getCookie(ce){return(0,pe.Mx)(document.cookie,ce)}}let at,Ce=null,tt=(()=>{class Ee{build(){return new XMLHttpRequest}}return Ee.\u0275fac=function(ee){return new(ee||Ee)},Ee.\u0275prov=x.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();const me=new x.OlP("EventManagerPlugins");let We=(()=>{class Ee{constructor(ee,ue){this._zone=ue,this._eventNameToPlugin=new Map,ee.forEach(rt=>{rt.manager=this}),this._plugins=ee.slice().reverse()}addEventListener(ee,ue,rt){return this._findPluginFor(ue).addEventListener(ee,ue,rt)}getZone(){return this._zone}_findPluginFor(ee){let ue=this._eventNameToPlugin.get(ee);if(ue)return ue;if(ue=this._plugins.find(oe=>oe.supports(ee)),!ue)throw new x.vHH(5101,!1);return this._eventNameToPlugin.set(ee,ue),ue}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(x.LFG(me),x.LFG(x.R0b))},Ee.\u0275prov=x.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();class wt{constructor(ce){this._doc=ce}}const pt="ng-app-id";let Wt=(()=>{class Ee{constructor(ee,ue,rt,oe={}){this.doc=ee,this.appId=ue,this.nonce=rt,this.platformId=oe,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,pe.PM)(oe),this.resetHostNodes()}addStyles(ee){for(const ue of ee)1===this.changeUsageCount(ue,1)&&this.onStyleAdded(ue)}removeStyles(ee){for(const ue of ee)this.changeUsageCount(ue,-1)<=0&&this.onStyleRemoved(ue)}ngOnDestroy(){const ee=this.styleNodesInDOM;ee&&(ee.forEach(ue=>ue.remove()),ee.clear());for(const ue of this.getAllStyles())this.onStyleRemoved(ue);this.resetHostNodes()}addHost(ee){this.hostNodes.add(ee);for(const ue of this.getAllStyles())this.addStyleToHost(ee,ue)}removeHost(ee){this.hostNodes.delete(ee)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(ee){for(const ue of this.hostNodes)this.addStyleToHost(ue,ee)}onStyleRemoved(ee){const ue=this.styleRef;ue.get(ee)?.elements?.forEach(rt=>rt.remove()),ue.delete(ee)}collectServerRenderedStyles(){const ee=this.doc.head?.querySelectorAll(`style[${pt}="${this.appId}"]`);if(ee?.length){const ue=new Map;return ee.forEach(rt=>{null!=rt.textContent&&ue.set(rt.textContent,rt)}),ue}return null}changeUsageCount(ee,ue){const rt=this.styleRef;if(rt.has(ee)){const oe=rt.get(ee);return oe.usage+=ue,oe.usage}return rt.set(ee,{usage:ue,elements:[]}),ue}getStyleElement(ee,ue){const rt=this.styleNodesInDOM,oe=rt?.get(ue);if(oe?.parentNode===ee)return rt.delete(ue),oe.removeAttribute(pt),oe;{const q=this.doc.createElement("style");return this.nonce&&q.setAttribute("nonce",this.nonce),q.textContent=ue,this.platformIsServer&&q.setAttribute(pt,this.appId),q}}addStyleToHost(ee,ue){const rt=this.getStyleElement(ee,ue);ee.appendChild(rt);const oe=this.styleRef,q=oe.get(ue)?.elements;q?q.push(rt):oe.set(ue,{elements:[rt],usage:1})}resetHostNodes(){const ee=this.hostNodes;ee.clear(),ee.add(this.doc.head)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(x.LFG(pe.K0),x.LFG(x.AFp),x.LFG(x.Ojb,8),x.LFG(x.Lbi))},Ee.\u0275prov=x.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();const Ln={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},St=/%COMP%/g,Me=new x.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function Le(Ee,ce){return ce.map(ee=>ee.replace(St,Ee))}let Je=(()=>{class Ee{constructor(ee,ue,rt,oe,q,ie,De,Qe=null){this.eventManager=ee,this.sharedStylesHost=ue,this.appId=rt,this.removeStylesOnCompDestory=oe,this.doc=q,this.platformId=ie,this.ngZone=De,this.nonce=Qe,this.rendererByCompId=new Map,this.platformIsServer=(0,pe.PM)(ie),this.defaultRenderer=new zt(ee,q,De,this.platformIsServer)}createRenderer(ee,ue){if(!ee||!ue)return this.defaultRenderer;this.platformIsServer&&ue.encapsulation===x.ifc.ShadowDom&&(ue={...ue,encapsulation:x.ifc.Emulated});const rt=this.getOrCreateRenderer(ee,ue);return rt instanceof Re?rt.applyToHost(ee):rt instanceof Se&&rt.applyStyles(),rt}getOrCreateRenderer(ee,ue){const rt=this.rendererByCompId;let oe=rt.get(ue.id);if(!oe){const q=this.doc,ie=this.ngZone,De=this.eventManager,Qe=this.sharedStylesHost,qe=this.removeStylesOnCompDestory,bt=this.platformIsServer;switch(ue.encapsulation){case x.ifc.Emulated:oe=new Re(De,Qe,ue,this.appId,qe,q,ie,bt);break;case x.ifc.ShadowDom:return new Qn(De,Qe,ee,ue,q,ie,this.nonce,bt);default:oe=new Se(De,Qe,ue,qe,q,ie,bt)}oe.onDestroy=()=>rt.delete(ue.id),rt.set(ue.id,oe)}return oe}ngOnDestroy(){this.rendererByCompId.clear()}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(x.LFG(We),x.LFG(Wt),x.LFG(x.AFp),x.LFG(Me),x.LFG(pe.K0),x.LFG(x.Lbi),x.LFG(x.R0b),x.LFG(x.Ojb))},Ee.\u0275prov=x.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();class zt{constructor(ce,ee,ue,rt){this.eventManager=ce,this.doc=ee,this.ngZone=ue,this.platformIsServer=rt,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(ce,ee){return ee?this.doc.createElementNS(Ln[ee]||ee,ce):this.doc.createElement(ce)}createComment(ce){return this.doc.createComment(ce)}createText(ce){return this.doc.createTextNode(ce)}appendChild(ce,ee){(Fn(ce)?ce.content:ce).appendChild(ee)}insertBefore(ce,ee,ue){ce&&(Fn(ce)?ce.content:ce).insertBefore(ee,ue)}removeChild(ce,ee){ce&&ce.removeChild(ee)}selectRootElement(ce,ee){let ue="string"==typeof ce?this.doc.querySelector(ce):ce;if(!ue)throw new x.vHH(5104,!1);return ee||(ue.textContent=""),ue}parentNode(ce){return ce.parentNode}nextSibling(ce){return ce.nextSibling}setAttribute(ce,ee,ue,rt){if(rt){ee=rt+":"+ee;const oe=Ln[rt];oe?ce.setAttributeNS(oe,ee,ue):ce.setAttribute(ee,ue)}else ce.setAttribute(ee,ue)}removeAttribute(ce,ee,ue){if(ue){const rt=Ln[ue];rt?ce.removeAttributeNS(rt,ee):ce.removeAttribute(`${ue}:${ee}`)}else ce.removeAttribute(ee)}addClass(ce,ee){ce.classList.add(ee)}removeClass(ce,ee){ce.classList.remove(ee)}setStyle(ce,ee,ue,rt){rt&(x.JOm.DashCase|x.JOm.Important)?ce.style.setProperty(ee,ue,rt&x.JOm.Important?"important":""):ce.style[ee]=ue}removeStyle(ce,ee,ue){ue&x.JOm.DashCase?ce.style.removeProperty(ee):ce.style[ee]=""}setProperty(ce,ee,ue){ce[ee]=ue}setValue(ce,ee){ce.nodeValue=ee}listen(ce,ee,ue){if("string"==typeof ce&&!(ce=(0,pe.q)().getGlobalEventTarget(this.doc,ce)))throw new Error(`Unsupported event target ${ce} for event ${ee}`);return this.eventManager.addEventListener(ce,ee,this.decoratePreventDefault(ue))}decoratePreventDefault(ce){return ee=>{if("__ngUnwrap__"===ee)return ce;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>ce(ee)):ce(ee))&&(ee.preventDefault(),ee.returnValue=!1)}}}function Fn(Ee){return"TEMPLATE"===Ee.tagName&&void 0!==Ee.content}class Qn extends zt{constructor(ce,ee,ue,rt,oe,q,ie,De){super(ce,oe,q,De),this.sharedStylesHost=ee,this.hostEl=ue,this.shadowRoot=ue.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Qe=Le(rt.id,rt.styles);for(const qe of Qe){const bt=document.createElement("style");ie&&bt.setAttribute("nonce",ie),bt.textContent=qe,this.shadowRoot.appendChild(bt)}}nodeOrShadowRoot(ce){return ce===this.hostEl?this.shadowRoot:ce}appendChild(ce,ee){return super.appendChild(this.nodeOrShadowRoot(ce),ee)}insertBefore(ce,ee,ue){return super.insertBefore(this.nodeOrShadowRoot(ce),ee,ue)}removeChild(ce,ee){return super.removeChild(this.nodeOrShadowRoot(ce),ee)}parentNode(ce){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(ce)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Se extends zt{constructor(ce,ee,ue,rt,oe,q,ie,De){super(ce,oe,q,ie),this.sharedStylesHost=ee,this.removeStylesOnCompDestory=rt,this.rendererUsageCount=0,this.styles=De?Le(De,ue.styles):ue.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Re extends Se{constructor(ce,ee,ue,rt,oe,q,ie,De){const Qe=rt+"-"+ue.id;super(ce,ee,ue,oe,q,ie,De,Qe),this.contentAttr=function Ft(Ee){return"_ngcontent-%COMP%".replace(St,Ee)}(Qe),this.hostAttr=function je(Ee){return"_nghost-%COMP%".replace(St,Ee)}(Qe)}applyToHost(ce){this.applyStyles(),this.setAttribute(ce,this.hostAttr,"")}createElement(ce,ee){const ue=super.createElement(ce,ee);return super.setAttribute(ue,this.contentAttr,""),ue}}let Ue=(()=>{class Ee extends wt{constructor(ee){super(ee)}supports(ee){return!0}addEventListener(ee,ue,rt){return ee.addEventListener(ue,rt,!1),()=>this.removeEventListener(ee,ue,rt)}removeEventListener(ee,ue,rt){return ee.removeEventListener(ue,rt)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(x.LFG(pe.K0))},Ee.\u0275prov=x.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();const Xe=["alt","control","meta","shift"],yt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gt={alt:Ee=>Ee.altKey,control:Ee=>Ee.ctrlKey,meta:Ee=>Ee.metaKey,shift:Ee=>Ee.shiftKey};let Kt=(()=>{class Ee extends wt{constructor(ee){super(ee)}supports(ee){return null!=Ee.parseEventName(ee)}addEventListener(ee,ue,rt){const oe=Ee.parseEventName(ue),q=Ee.eventCallback(oe.fullKey,rt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,pe.q)().onAndCancel(ee,oe.domEventName,q))}static parseEventName(ee){const ue=ee.toLowerCase().split("."),rt=ue.shift();if(0===ue.length||"keydown"!==rt&&"keyup"!==rt)return null;const oe=Ee._normalizeKey(ue.pop());let q="",ie=ue.indexOf("code");if(ie>-1&&(ue.splice(ie,1),q="code."),Xe.forEach(Qe=>{const qe=ue.indexOf(Qe);qe>-1&&(ue.splice(qe,1),q+=Qe+".")}),q+=oe,0!=ue.length||0===oe.length)return null;const De={};return De.domEventName=rt,De.fullKey=q,De}static matchEventFullKeyCode(ee,ue){let rt=yt[ee.key]||ee.key,oe="";return ue.indexOf("code.")>-1&&(rt=ee.code,oe="code."),!(null==rt||!rt)&&(rt=rt.toLowerCase()," "===rt?rt="space":"."===rt&&(rt="dot"),Xe.forEach(q=>{q!==rt&&(0,gt[q])(ee)&&(oe+=q+".")}),oe+=rt,oe===ue)}static eventCallback(ee,ue,rt){return oe=>{Ee.matchEventFullKeyCode(oe,ee)&&rt.runGuarded(()=>ue(oe))}}static _normalizeKey(ee){return"esc"===ee?"escape":ee}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(x.LFG(pe.K0))},Ee.\u0275prov=x.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();function on(Ee,ce){return(0,x.iPO)({rootComponent:Ee,...an(ce)})}function an(Ee){return{appProviders:[...$s,...Ee?.providers??[]],platformProviders:jr}}const jr=[{provide:x.Lbi,useValue:pe.bD},{provide:x.g9A,useValue:function Vn(){Ve.makeCurrent()},multi:!0},{provide:pe.K0,useFactory:function pr(){return(0,x.RDi)(document),document},deps:[]}],ei=new x.OlP(""),Ur=[{provide:x.rWj,useClass:class ut{addToWindow(ce){x.dqk.getAngularTestability=(ue,rt=!0)=>{const oe=ce.findTestabilityInTree(ue,rt);if(null==oe)throw new x.vHH(5103,!1);return oe},x.dqk.getAllAngularTestabilities=()=>ce.getAllTestabilities(),x.dqk.getAllAngularRootElements=()=>ce.getAllRootElements(),x.dqk.frameworkStabilizers||(x.dqk.frameworkStabilizers=[]),x.dqk.frameworkStabilizers.push(ue=>{const rt=x.dqk.getAllAngularTestabilities();let oe=rt.length,q=!1;const ie=function(De){q=q||De,oe--,0==oe&&ue(q)};rt.forEach(function(De){De.whenStable(ie)})})}findTestabilityInTree(ce,ee,ue){return null==ee?null:ce.getTestability(ee)??(ue?(0,pe.q)().isShadowRoot(ee)?this.findTestabilityInTree(ce,ee.host,!0):this.findTestabilityInTree(ce,ee.parentElement,!0):null)}},deps:[]},{provide:x.lri,useClass:x.dDg,deps:[x.R0b,x.eoX,x.rWj]},{provide:x.dDg,useClass:x.dDg,deps:[x.R0b,x.eoX,x.rWj]}],$s=[{provide:x.zSh,useValue:"root"},{provide:x.qLn,useFactory:function Qt(){return new x.qLn},deps:[]},{provide:me,useClass:Ue,multi:!0,deps:[pe.K0,x.R0b,x.Lbi]},{provide:me,useClass:Kt,multi:!0,deps:[pe.K0]},Je,Wt,We,{provide:x.FYo,useExisting:Je},{provide:pe.JF,useClass:tt,deps:[]},[]];let Yt=(()=>{class Ee{constructor(ee){}static withServerTransition(ee){return{ngModule:Ee,providers:[{provide:x.AFp,useValue:ee.appId}]}}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(x.LFG(ei,12))},Ee.\u0275mod=x.oAB({type:Ee}),Ee.\u0275inj=x.cJS({providers:[...$s,...Ur],imports:[pe.ez,x.hGG]}),Ee})(),Ps=(()=>{class Ee{constructor(ee){this._doc=ee}getTitle(){return this._doc.title}setTitle(ee){this._doc.title=ee||""}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(x.LFG(pe.K0))},Ee.\u0275prov=x.Yz7({token:Ee,factory:function(ee){let ue=null;return ue=ee?new ee:function Lo(){return new Ps((0,x.LFG)(pe.K0))}(),ue},providedIn:"root"}),Ee})();typeof window<"u"&&window;let as=(()=>{class Ee{}return Ee.\u0275fac=function(ee){return new(ee||Ee)},Ee.\u0275prov=x.Yz7({token:Ee,factory:function(ee){let ue=null;return ue=ee?new(ee||Ee):x.LFG(Gi),ue},providedIn:"root"}),Ee})(),Gi=(()=>{class Ee extends as{constructor(ee){super(),this._doc=ee}sanitize(ee,ue){if(null==ue)return null;switch(ee){case x.q3G.NONE:return ue;case x.q3G.HTML:return(0,x.qzn)(ue,"HTML")?(0,x.z3N)(ue):(0,x.EiD)(this._doc,String(ue)).toString();case x.q3G.STYLE:return(0,x.qzn)(ue,"Style")?(0,x.z3N)(ue):ue;case x.q3G.SCRIPT:if((0,x.qzn)(ue,"Script"))return(0,x.z3N)(ue);throw new x.vHH(5200,!1);case x.q3G.URL:return(0,x.qzn)(ue,"URL")?(0,x.z3N)(ue):(0,x.mCW)(String(ue));case x.q3G.RESOURCE_URL:if((0,x.qzn)(ue,"ResourceURL"))return(0,x.z3N)(ue);throw new x.vHH(5201,!1);default:throw new x.vHH(5202,!1)}}bypassSecurityTrustHtml(ee){return(0,x.JVY)(ee)}bypassSecurityTrustStyle(ee){return(0,x.L6k)(ee)}bypassSecurityTrustScript(ee){return(0,x.eBb)(ee)}bypassSecurityTrustUrl(ee){return(0,x.LAX)(ee)}bypassSecurityTrustResourceUrl(ee){return(0,x.pB0)(ee)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(x.LFG(pe.K0))},Ee.\u0275prov=x.Yz7({token:Ee,factory:function(ee){let ue=null;return ue=ee?new ee:function Qi(Ee){return new Gi(Ee.get(pe.K0))}(x.LFG(x.zs3)),ue},providedIn:"root"}),Ee})()},5742:(Jt,$e,$)=>{$.d($e,{OD:()=>aa,F0:()=>Pr,rH:()=>Ye,Bz:()=>xa,lC:()=>Zs});var x=$(2504),pe=$(9751),Pe=$(576),Ce=$(2076),Te=$(9646),at=$(7579);class Et extends at.x{constructor(E){super(),this._value=E}get value(){return this.getValue()}_subscribe(E){const v=super._subscribe(E);return!v.closed&&E.next(this._value),v}getValue(){const{hasError:E,thrownError:v,_value:C}=this;if(E)throw v;return this._throwIfClosed(),C}next(E){super.next(this._value=E)}}var ut=$(4742),tt=$(4671),me=$(3268),We=$(3269),wt=$(1810),pt=$(5403),Wt=$(9672);function Ln(...y){const E=(0,We.yG)(y),v=(0,We.jO)(y),{args:C,keys:L}=(0,ut.D)(y);if(0===C.length)return(0,Ce.D)([],E);const z=new pe.y(function St(y,E,v=tt.y){return C=>{In(E,()=>{const{length:L}=y,z=new Array(L);let G=L,se=L;for(let Ze=0;Ze<L;Ze++)In(E,()=>{const Ct=(0,Ce.D)(y[Ze],E);let Gt=!1;Ct.subscribe((0,pt.x)(C,hi=>{z[Ze]=hi,Gt||(Gt=!0,se--),se||C.next(v(z.slice()))},()=>{--G||C.complete()}))},C)},C)}}(C,E,L?G=>(0,wt.n)(L,G):tt.y));return v?z.pipe((0,me.Z)(v)):z}function In(y,E,v){y?(0,Wt.f)(v,y,E):E()}var Jn=$(6805),ui=$(7272),Ot=$(8421);function Me(y){return new pe.y(E=>{(0,Ot.Xf)(y()).subscribe(E)})}var Ft=$(9635);function je(y,E){const v=(0,Pe.m)(y)?y:()=>y,C=L=>L.error(v());return new pe.y(E?L=>E.schedule(C,0,L):C)}var Le=$(515),Je=$(727),zt=$(4482);function Tt(){return(0,zt.e)((y,E)=>{let v=null;y._refCount++;const C=(0,pt.x)(E,void 0,void 0,void 0,()=>{if(!y||y._refCount<=0||0<--y._refCount)return void(v=null);const L=y._connection,z=v;v=null,L&&(!z||L===z)&&L.unsubscribe(),E.unsubscribe()});y.subscribe(C),C.closed||(v=y.connect())})}class wn extends pe.y{constructor(E,v){super(),this.source=E,this.subjectFactory=v,this._subject=null,this._refCount=0,this._connection=null,(0,zt.A)(E)&&(this.lift=E.lift)}_subscribe(E){return this.getSubject().subscribe(E)}getSubject(){const E=this._subject;return(!E||E.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:E}=this;this._subject=this._connection=null,E?.unsubscribe()}connect(){let E=this._connection;if(!E){E=this._connection=new Je.w0;const v=this.getSubject();E.add(this.source.subscribe((0,pt.x)(v,void 0,()=>{this._teardown(),v.complete()},C=>{this._teardown(),v.error(C)},()=>this._teardown()))),E.closed&&(this._connection=null,E=Je.w0.EMPTY)}return E}refCount(){return Tt()(this)}}var Fn=$(4755),Qn=$(4004),Se=$(3900),Re=$(5698),Xe=$(9300),yt=$(5577),gt=$(590),Kt=$(4351),on=$(8505);function Un(y){return(0,zt.e)((E,v)=>{let z,C=null,L=!1;C=E.subscribe((0,pt.x)(v,void 0,void 0,G=>{z=(0,Ot.Xf)(y(G,Un(y)(E))),C?(C.unsubscribe(),C=null,z.subscribe(v)):L=!0})),L&&(C.unsubscribe(),C=null,z.subscribe(v))})}var Vn=$(6590);function Qt(y){return y<=0?()=>Le.E:(0,zt.e)((E,v)=>{let C=[];E.subscribe((0,pt.x)(v,L=>{C.push(L),y<C.length&&C.shift()},()=>{for(const L of C)v.next(L);v.complete()},void 0,()=>{C=null}))})}var pr=$(8068),Xr=$(9718),ei=$(8746),Ur=$(8189),$s=$(6550);const Yt="primary",os=Symbol("RouteTitle");class Po{constructor(E){this.params=E||{}}has(E){return Object.prototype.hasOwnProperty.call(this.params,E)}get(E){if(this.has(E)){const v=this.params[E];return Array.isArray(v)?v[0]:v}return null}getAll(E){if(this.has(E)){const v=this.params[E];return Array.isArray(v)?v:[v]}return[]}get keys(){return Object.keys(this.params)}}function _s(y){return new Po(y)}function Lo(y,E,v){const C=v.path.split("/");if(C.length>y.length||"full"===v.pathMatch&&(E.hasChildren()||C.length<y.length))return null;const L={};for(let z=0;z<C.length;z++){const G=C[z],se=y[z];if(G.startsWith(":"))L[G.substring(1)]=se;else if(G!==se.path)return null}return{consumed:y.slice(0,C.length),posParams:L}}function Ni(y,E){const v=y?Object.keys(y):void 0,C=E?Object.keys(E):void 0;if(!v||!C||v.length!=C.length)return!1;let L;for(let z=0;z<v.length;z++)if(L=v[z],!wr(y[L],E[L]))return!1;return!0}function wr(y,E){if(Array.isArray(y)&&Array.isArray(E)){if(y.length!==E.length)return!1;const v=[...y].sort(),C=[...E].sort();return v.every((L,z)=>C[z]===L)}return y===E}function pi(y){return y.length>0?y[y.length-1]:null}function nt(y){return function Ve(y){return!!y&&(y instanceof pe.y||(0,Pe.m)(y.lift)&&(0,Pe.m)(y.subscribe))}(y)?y:(0,x.QGY)(y)?(0,Ce.D)(Promise.resolve(y)):(0,Te.of)(y)}const un={exact:function js(y,E,v){if(!Qi(y.segments,E.segments)||!ti(y.segments,E.segments,v)||y.numberOfChildren!==E.numberOfChildren)return!1;for(const C in E.children)if(!y.children[C]||!js(y.children[C],E.children[C],v))return!1;return!0},subset:La},Ji={exact:function Tr(y,E){return Ni(y,E)},subset:function $n(y,E){return Object.keys(E).length<=Object.keys(y).length&&Object.keys(E).every(v=>wr(y[v],E[v]))},ignored:()=>!0};function Bi(y,E,v){return un[v.paths](y.root,E.root,v.matrixParams)&&Ji[v.queryParams](y.queryParams,E.queryParams)&&!("exact"===v.fragment&&y.fragment!==E.fragment)}function La(y,E,v){return Si(y,E,E.segments,v)}function Si(y,E,v,C){if(y.segments.length>v.length){const L=y.segments.slice(0,v.length);return!(!Qi(L,v)||E.hasChildren()||!ti(L,v,C))}if(y.segments.length===v.length){if(!Qi(y.segments,v)||!ti(y.segments,v,C))return!1;for(const L in E.children)if(!y.children[L]||!La(y.children[L],E.children[L],C))return!1;return!0}{const L=v.slice(0,y.segments.length),z=v.slice(y.segments.length);return!!(Qi(y.segments,L)&&ti(y.segments,L,C)&&y.children[Yt])&&Si(y.children[Yt],E,z,C)}}function ti(y,E,v){return E.every((C,L)=>Ji[v](y[L].parameters,C.parameters))}class dn{constructor(E=new kn([],{}),v={},C=null){this.root=E,this.queryParams=v,this.fragment=C}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=_s(this.queryParams)),this._queryParamMap}toString(){return Xs.serialize(this)}}class kn{constructor(E,v){this.segments=E,this.children=v,this.parent=null,Object.values(v).forEach(C=>C.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Dr(this)}}class or{constructor(E,v){this.path=E,this.parameters=v}get parameterMap(){return this._parameterMap||(this._parameterMap=_s(this.parameters)),this._parameterMap}toString(){return ue(this)}}function Qi(y,E){return y.length===E.length&&y.every((v,C)=>v.path===E[C].path)}let Cr=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:function(){return new ri},providedIn:"root"}),y})();class ri{parse(E){const v=new mr(E);return new dn(v.parseRootSegment(),v.parseQueryParams(),v.parseFragment())}serialize(E){const v=`/${ls(E.root,!0)}`,C=function oe(y){const E=Object.keys(y).map(v=>{const C=y[v];return Array.isArray(C)?C.map(L=>`${si(v)}=${si(L)}`).join("&"):`${si(v)}=${si(C)}`}).filter(v=>!!v);return E.length?`?${E.join("&")}`:""}(E.queryParams);return`${v}${C}${"string"==typeof E.fragment?`#${function ai(y){return encodeURI(y)}(E.fragment)}`:""}`}}const Xs=new ri;function Dr(y){return y.segments.map(E=>ue(E)).join("/")}function ls(y,E){if(!y.hasChildren())return Dr(y);if(E){const v=y.children[Yt]?ls(y.children[Yt],!1):"",C=[];return Object.entries(y.children).forEach(([L,z])=>{L!==Yt&&C.push(`${L}:${ls(z,!1)}`)}),C.length>0?`${v}(${C.join("//")})`:v}{const v=function Gi(y,E){let v=[];return Object.entries(y.children).forEach(([C,L])=>{C===Yt&&(v=v.concat(E(L,C)))}),Object.entries(y.children).forEach(([C,L])=>{C!==Yt&&(v=v.concat(E(L,C)))}),v}(y,(C,L)=>L===Yt?[ls(y.children[Yt],!1)]:[`${L}:${ls(C,!1)}`]);return 1===Object.keys(y.children).length&&null!=y.children[Yt]?`${Dr(y)}/${v[0]}`:`${Dr(y)}/(${v.join("//")})`}}function Wi(y){return encodeURIComponent(y).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function si(y){return Wi(y).replace(/%3B/gi,";")}function Ee(y){return Wi(y).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ce(y){return decodeURIComponent(y)}function ee(y){return ce(y.replace(/\+/g,"%20"))}function ue(y){return`${Ee(y.path)}${function rt(y){return Object.keys(y).map(E=>`;${Ee(E)}=${Ee(y[E])}`).join("")}(y.parameters)}`}const q=/^[^\/()?;#]+/;function ie(y){const E=y.match(q);return E?E[0]:""}const De=/^[^\/()?;=#]+/,qe=/^[^=?&#]+/,mi=/^[^&#]+/;class mr{constructor(E){this.url=E,this.remaining=E}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new kn([],{}):new kn([],this.parseChildren())}parseQueryParams(){const E={};if(this.consumeOptional("?"))do{this.parseQueryParam(E)}while(this.consumeOptional("&"));return E}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const E=[];for(this.peekStartsWith("(")||E.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),E.push(this.parseSegment());let v={};this.peekStartsWith("/(")&&(this.capture("/"),v=this.parseParens(!0));let C={};return this.peekStartsWith("(")&&(C=this.parseParens(!1)),(E.length>0||Object.keys(v).length>0)&&(C[Yt]=new kn(E,v)),C}parseSegment(){const E=ie(this.remaining);if(""===E&&this.peekStartsWith(";"))throw new x.vHH(4009,!1);return this.capture(E),new or(ce(E),this.parseMatrixParams())}parseMatrixParams(){const E={};for(;this.consumeOptional(";");)this.parseParam(E);return E}parseParam(E){const v=function Qe(y){const E=y.match(De);return E?E[0]:""}(this.remaining);if(!v)return;this.capture(v);let C="";if(this.consumeOptional("=")){const L=ie(this.remaining);L&&(C=L,this.capture(C))}E[ce(v)]=ce(C)}parseQueryParam(E){const v=function bt(y){const E=y.match(qe);return E?E[0]:""}(this.remaining);if(!v)return;this.capture(v);let C="";if(this.consumeOptional("=")){const G=function gn(y){const E=y.match(mi);return E?E[0]:""}(this.remaining);G&&(C=G,this.capture(C))}const L=ee(v),z=ee(C);if(E.hasOwnProperty(L)){let G=E[L];Array.isArray(G)||(G=[G],E[L]=G),G.push(z)}else E[L]=z}parseParens(E){const v={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const C=ie(this.remaining),L=this.remaining[C.length];if("/"!==L&&")"!==L&&";"!==L)throw new x.vHH(4010,!1);let z;C.indexOf(":")>-1?(z=C.slice(0,C.indexOf(":")),this.capture(z),this.capture(":")):E&&(z=Yt);const G=this.parseChildren();v[z]=1===Object.keys(G).length?G[Yt]:new kn([],G),this.consumeOptional("//")}return v}peekStartsWith(E){return this.remaining.startsWith(E)}consumeOptional(E){return!!this.peekStartsWith(E)&&(this.remaining=this.remaining.substring(E.length),!0)}capture(E){if(!this.consumeOptional(E))throw new x.vHH(4011,!1)}}function gi(y){return y.segments.length>0?new kn([],{[Yt]:y}):y}function Vi(y){const E={};for(const C of Object.keys(y.children)){const z=Vi(y.children[C]);if(C===Yt&&0===z.segments.length&&z.hasChildren())for(const[G,se]of Object.entries(z.children))E[G]=se;else(z.segments.length>0||z.hasChildren())&&(E[C]=z)}return function Ar(y){if(1===y.numberOfChildren&&y.children[Yt]){const E=y.children[Yt];return new kn(y.segments.concat(E.segments),E.children)}return y}(new kn(y.segments,E))}function er(y){return y instanceof dn}function Ls(y){let E;const L=gi(function v(z){const G={};for(const Ze of z.children){const Ct=v(Ze);G[Ze.outlet]=Ct}const se=new kn(z.url,G);return z===y&&(E=se),se}(y.root));return E??L}function Ys(y,E,v,C){let L=y;for(;L.parent;)L=L.parent;if(0===E.length)return bi(L,L,L,v,C);const z=function $i(y){if("string"==typeof y[0]&&1===y.length&&"/"===y[0])return new Ms(!0,0,y);let E=0,v=!1;const C=y.reduce((L,z,G)=>{if("object"==typeof z&&null!=z){if(z.outlets){const se={};return Object.entries(z.outlets).forEach(([Ze,Ct])=>{se[Ze]="string"==typeof Ct?Ct.split("/"):Ct}),[...L,{outlets:se}]}if(z.segmentPath)return[...L,z.segmentPath]}return"string"!=typeof z?[...L,z]:0===G?(z.split("/").forEach((se,Ze)=>{0==Ze&&"."===se||(0==Ze&&""===se?v=!0:".."===se?E++:""!=se&&L.push(se))}),L):[...L,z]},[]);return new Ms(v,E,C)}(E);if(z.toRoot())return bi(L,L,new kn([],{}),v,C);const G=function Ir(y,E,v){if(y.isAbsolute)return new xs(E,!0,0);if(!v)return new xs(E,!1,NaN);if(null===v.parent)return new xs(v,!0,0);const C=Yr(y.commands[0])?0:1;return function ra(y,E,v){let C=y,L=E,z=v;for(;z>L;){if(z-=L,C=C.parent,!C)throw new x.vHH(4005,!1);L=C.segments.length}return new xs(C,!1,L-z)}(v,v.segments.length-1+C,y.numberOfDoubleDots)}(z,L,y),se=G.processChildren?No(G.segmentGroup,G.index,z.commands):Na(G.segmentGroup,G.index,z.commands);return bi(L,G.segmentGroup,se,v,C)}function Yr(y){return"object"==typeof y&&null!=y&&!y.outlets&&!y.segmentPath}function di(y){return"object"==typeof y&&null!=y&&y.outlets}function bi(y,E,v,C,L){let G,z={};C&&Object.entries(C).forEach(([Ze,Ct])=>{z[Ze]=Array.isArray(Ct)?Ct.map(Gt=>`${Gt}`):`${Ct}`}),G=y===E?v:us(y,E,v);const se=gi(Vi(G));return new dn(se,z,L)}function us(y,E,v){const C={};return Object.entries(y.children).forEach(([L,z])=>{C[L]=z===E?v:us(z,E,v)}),new kn(y.segments,C)}class Ms{constructor(E,v,C){if(this.isAbsolute=E,this.numberOfDoubleDots=v,this.commands=C,E&&C.length>0&&Yr(C[0]))throw new x.vHH(4003,!1);const L=C.find(di);if(L&&L!==pi(C))throw new x.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class xs{constructor(E,v,C){this.segmentGroup=E,this.processChildren=v,this.index=C}}function Na(y,E,v){if(y||(y=new kn([],{})),0===y.segments.length&&y.hasChildren())return No(y,E,v);const C=function Xc(y,E,v){let C=0,L=E;const z={match:!1,pathIndex:0,commandIndex:0};for(;L<y.segments.length;){if(C>=v.length)return z;const G=y.segments[L],se=v[C];if(di(se))break;const Ze=`${se}`,Ct=C<v.length-1?v[C+1]:null;if(L>0&&void 0===Ze)break;if(Ze&&Ct&&"object"==typeof Ct&&void 0===Ct.outlets){if(!oa(Ze,Ct,G))return z;C+=2}else{if(!oa(Ze,{},G))return z;C++}L++}return{match:!0,pathIndex:L,commandIndex:C}}(y,E,v),L=v.slice(C.commandIndex);if(C.match&&C.pathIndex<y.segments.length){const z=new kn(y.segments.slice(0,C.pathIndex),{});return z.children[Yt]=new kn(y.segments.slice(C.pathIndex),y.children),No(z,0,L)}return C.match&&0===L.length?new kn(y.segments,{}):C.match&&!y.hasChildren()?sa(y,E,v):C.match?No(y,0,L):sa(y,E,v)}function No(y,E,v){if(0===v.length)return new kn(y.segments,{});{const C=function sl(y){return di(y[0])?y[0].outlets:{[Yt]:y}}(v),L={};if(!C[Yt]&&y.children[Yt]&&1===y.numberOfChildren&&0===y.children[Yt].segments.length){const z=No(y.children[Yt],E,v);return new kn(y.segments,z.children)}return Object.entries(C).forEach(([z,G])=>{"string"==typeof G&&(G=[G]),null!==G&&(L[z]=Na(y.children[z],E,G))}),Object.entries(y.children).forEach(([z,G])=>{void 0===C[z]&&(L[z]=G)}),new kn(y.segments,L)}}function sa(y,E,v){const C=y.segments.slice(0,E);let L=0;for(;L<v.length;){const z=v[L];if(di(z)){const Ze=ol(z.outlets);return new kn(C,Ze)}if(0===L&&Yr(v[0])){C.push(new or(y.segments[E].path,Oa(v[0]))),L++;continue}const G=di(z)?z.outlets[Yt]:`${z}`,se=L<v.length-1?v[L+1]:null;G&&se&&Yr(se)?(C.push(new or(G,Oa(se))),L+=2):(C.push(new or(G,{})),L++)}return new kn(C,{})}function ol(y){const E={};return Object.entries(y).forEach(([v,C])=>{"string"==typeof C&&(C=[C]),null!==C&&(E[v]=sa(new kn([],{}),0,C))}),E}function Oa(y){const E={};return Object.entries(y).forEach(([v,C])=>E[v]=`${C}`),E}function oa(y,E,v){return y==v.path&&Ni(E,v.parameters)}const qs="imperative";class qr{constructor(E,v){this.id=E,this.url=v}}class aa extends qr{constructor(E,v,C="imperative",L=null){super(E,v),this.type=0,this.navigationTrigger=C,this.restoredState=L}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class po extends qr{constructor(E,v,C){super(E,v),this.urlAfterRedirects=C,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Oo extends qr{constructor(E,v,C,L){super(E,v),this.reason=C,this.code=L,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class mo extends qr{constructor(E,v,C,L){super(E,v),this.reason=C,this.code=L,this.type=16}}class al extends qr{constructor(E,v,C,L){super(E,v),this.error=C,this.target=L,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Wl extends qr{constructor(E,v,C,L){super(E,v),this.urlAfterRedirects=C,this.state=L,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $l extends qr{constructor(E,v,C,L){super(E,v),this.urlAfterRedirects=C,this.state=L,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class kr extends qr{constructor(E,v,C,L,z){super(E,v),this.urlAfterRedirects=C,this.state=L,this.shouldActivate=z,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ni extends qr{constructor(E,v,C,L){super(E,v),this.urlAfterRedirects=C,this.state=L,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class qi extends qr{constructor(E,v,C,L){super(E,v),this.urlAfterRedirects=C,this.state=L,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rr{constructor(E){this.route=E,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class go{constructor(E){this.route=E,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class gr{constructor(E){this.snapshot=E,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ll{constructor(E){this.snapshot=E,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class jl{constructor(E){this.snapshot=E,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fa{constructor(E){this.snapshot=E,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xl{constructor(E,v,C){this.routerEvent=E,this.position=v,this.anchor=C,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Oi{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new At,this.attachRef=null}}let At=(()=>{class y{constructor(){this.contexts=new Map}onChildOutletCreated(v,C){const L=this.getOrCreateContext(v);L.outlet=C,this.contexts.set(v,L)}onChildOutletDestroyed(v){const C=this.getContext(v);C&&(C.outlet=null,C.attachRef=null)}onOutletDeactivated(){const v=this.contexts;return this.contexts=new Map,v}onOutletReAttached(v){this.contexts=v}getOrCreateContext(v){let C=this.getContext(v);return C||(C=new Oi,this.contexts.set(v,C)),C}getContext(v){return this.contexts.get(v)||null}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();class hn{constructor(E){this._root=E}get root(){return this._root.value}parent(E){const v=this.pathFromRoot(E);return v.length>1?v[v.length-2]:null}children(E){const v=li(E,this._root);return v?v.children.map(C=>C.value):[]}firstChild(E){const v=li(E,this._root);return v&&v.children.length>0?v.children[0].value:null}siblings(E){const v=ar(E,this._root);return v.length<2?[]:v[v.length-2].children.map(L=>L.value).filter(L=>L!==E)}pathFromRoot(E){return ar(E,this._root).map(v=>v.value)}}function li(y,E){if(y===E.value)return E;for(const v of E.children){const C=li(y,v);if(C)return C}return null}function ar(y,E){if(y===E.value)return[E];for(const v of E.children){const C=ar(y,v);if(C.length)return C.unshift(E),C}return[]}class tr{constructor(E,v){this.value=E,this.children=v}toString(){return`TreeNode(${this.value})`}}function Fi(y){const E={};return y&&y.children.forEach(v=>E[v.value.outlet]=v),E}class Fo extends hn{constructor(E,v){super(E),this.snapshot=v,Ii(this,E)}toString(){return this.snapshot.toString()}}function Ui(y,E){const v=function Uo(y,E){const G=new vo([],{},{},"",{},Yt,E,null,{});return new vr("",new tr(G,[]))}(0,E),C=new Et([new or("",{})]),L=new Et({}),z=new Et({}),G=new Et({}),se=new Et(""),Ze=new Br(C,L,G,se,z,Yt,E,v.root);return Ze.snapshot=v.root,new Fo(new tr(Ze,[]),v)}class Br{constructor(E,v,C,L,z,G,se,Ze){this.urlSubject=E,this.paramsSubject=v,this.queryParamsSubject=C,this.fragmentSubject=L,this.dataSubject=z,this.outlet=G,this.component=se,this._futureSnapshot=Ze,this.title=this.dataSubject?.pipe((0,Qn.U)(Ct=>Ct[os]))??(0,Te.of)(void 0),this.url=E,this.params=v,this.queryParams=C,this.fragment=L,this.data=z}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Qn.U)(E=>_s(E)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Qn.U)(E=>_s(E)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ln(y,E="emptyOnly"){const v=y.pathFromRoot;let C=0;if("always"!==E)for(C=v.length-1;C>=1;){const L=v[C],z=v[C-1];if(L.routeConfig&&""===L.routeConfig.path)C--;else{if(z.component)break;C--}}return function la(y){return y.reduce((E,v)=>({params:{...E.params,...v.params},data:{...E.data,...v.data},resolve:{...v.data,...E.resolve,...v.routeConfig?.data,...v._resolvedData}}),{params:{},data:{},resolve:{}})}(v.slice(C))}class vo{get title(){return this.data?.[os]}constructor(E,v,C,L,z,G,se,Ze,Ct){this.url=E,this.params=v,this.queryParams=C,this.fragment=L,this.data=z,this.outlet=G,this.component=se,this.routeConfig=Ze,this._resolve=Ct}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=_s(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=_s(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(C=>C.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class vr extends hn{constructor(E,v){super(v),this.url=E,Ii(this,v)}toString(){return ds(this._root)}}function Ii(y,E){E.value._routerState=y,E.children.forEach(v=>Ii(y,v))}function ds(y){const E=y.children.length>0?` { ${y.children.map(ds).join(", ")} } `:"";return`${y.value}${E}`}function _n(y){if(y.snapshot){const E=y.snapshot,v=y._futureSnapshot;y.snapshot=v,Ni(E.queryParams,v.queryParams)||y.queryParamsSubject.next(v.queryParams),E.fragment!==v.fragment&&y.fragmentSubject.next(v.fragment),Ni(E.params,v.params)||y.paramsSubject.next(v.params),function Ps(y,E){if(y.length!==E.length)return!1;for(let v=0;v<y.length;++v)if(!Ni(y[v],E[v]))return!1;return!0}(E.url,v.url)||y.urlSubject.next(v.url),Ni(E.data,v.data)||y.dataSubject.next(v.data)}else y.snapshot=y._futureSnapshot,y.dataSubject.next(y._futureSnapshot.data)}function ki(y,E){const v=Ni(y.params,E.params)&&function as(y,E){return Qi(y,E)&&y.every((v,C)=>Ni(v.parameters,E[C].parameters))}(y.url,E.url);return v&&!(!y.parent!=!E.parent)&&(!y.parent||ki(y.parent,E.parent))}let Zs=(()=>{class y{constructor(){this.activated=null,this._activatedRoute=null,this.name=Yt,this.activateEvents=new x.vpe,this.deactivateEvents=new x.vpe,this.attachEvents=new x.vpe,this.detachEvents=new x.vpe,this.parentContexts=(0,x.f3M)(At),this.location=(0,x.f3M)(x.s_b),this.changeDetector=(0,x.f3M)(x.sBO),this.environmentInjector=(0,x.f3M)(x.lqb),this.inputBinder=(0,x.f3M)(Hr,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(v){if(v.name){const{firstChange:C,previousValue:L}=v.name;if(C)return;this.isTrackedInParentContexts(L)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(L)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(v){return this.parentContexts.getContext(v)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const v=this.parentContexts.getContext(this.name);v?.route&&(v.attachRef?this.attach(v.attachRef,v.route):this.activateWith(v.route,v.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new x.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new x.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new x.vHH(4012,!1);this.location.detach();const v=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(v.instance),v}attach(v,C){this.activated=v,this._activatedRoute=C,this.location.insert(v.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(v.instance)}deactivate(){if(this.activated){const v=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(v)}}activateWith(v,C){if(this.isActivated)throw new x.vHH(4013,!1);this._activatedRoute=v;const L=this.location,G=v.snapshot.component,se=this.parentContexts.getOrCreateContext(this.name).children,Ze=new Yc(v,se,L.injector);this.activated=L.createComponent(G,{index:L.length,injector:Ze,environmentInjector:C??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275dir=x.lG2({type:y,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[x.TTD]}),y})();class Yc{constructor(E,v,C){this.route=E,this.childContexts=v,this.parent=C}get(E,v){return E===Br?this.route:E===At?this.childContexts:this.parent.get(E,v)}}const Hr=new x.OlP("");let Ks=(()=>{class y{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(v){this.unsubscribeFromRouteData(v),this.subscribeToRouteData(v)}unsubscribeFromRouteData(v){this.outletDataSubscriptions.get(v)?.unsubscribe(),this.outletDataSubscriptions.delete(v)}subscribeToRouteData(v){const{activatedRoute:C}=v,L=Ln([C.queryParams,C.params,C.data]).pipe((0,Se.w)(([z,G,se],Ze)=>(se={...z,...G,...se},0===Ze?(0,Te.of)(se):Promise.resolve(se)))).subscribe(z=>{if(!v.isActivated||!v.activatedComponentRef||v.activatedRoute!==C||null===C.component)return void this.unsubscribeFromRouteData(v);const G=(0,x.qFp)(C.component);if(G)for(const{templateName:se}of G.inputs)v.activatedComponentRef.setInput(se,z[se]);else this.unsubscribeFromRouteData(v)});this.outletDataSubscriptions.set(v,L)}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac}),y})();function ko(y,E,v){if(v&&y.shouldReuseRoute(E.value,v.value.snapshot)){const C=v.value;C._futureSnapshot=E.value;const L=function jn(y,E,v){return E.children.map(C=>{for(const L of v.children)if(y.shouldReuseRoute(C.value,L.value.snapshot))return ko(y,C,L);return ko(y,C)})}(y,E,v);return new tr(C,L)}{if(y.shouldAttach(E.value)){const z=y.retrieve(E.value);if(null!==z){const G=z.route;return G.value._futureSnapshot=E.value,G.children=E.children.map(se=>ko(y,se)),G}}const C=function Gp(y){return new Br(new Et(y.url),new Et(y.params),new Et(y.queryParams),new Et(y.fragment),new Et(y.data),y.outlet,y.component,y)}(E.value),L=E.children.map(z=>ko(y,z));return new tr(C,L)}}const ka="ngNavigationCancelingError";function Yl(y,E){const{redirectTo:v,navigationBehaviorOptions:C}=er(E)?{redirectTo:E,navigationBehaviorOptions:void 0}:E,L=hs(!1,0,E);return L.url=v,L.navigationBehaviorOptions=C,L}function hs(y,E,v){const C=new Error("NavigationCancelingError: "+(y||""));return C[ka]=!0,C.cancellationCode=E,v&&(C.url=v),C}function Ba(y){return ca(y)&&er(y.url)}function ca(y){return y&&y[ka]}let ua=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275cmp=x.Xpm({type:y,selectors:[["ng-component"]],standalone:!0,features:[x.jDz],decls:1,vars:0,template:function(v,C){1&v&&x._UZ(0,"router-outlet")},dependencies:[Zs],encapsulation:2}),y})();function ql(y){const E=y.children&&y.children.map(ql),v=E?{...y,children:E}:{...y};return!v.component&&!v.loadComponent&&(E||v.loadChildren)&&v.outlet&&v.outlet!==Yt&&(v.component=ua),v}function Ns(y){return y.outlet||Yt}function Ha(y){if(!y)return null;if(y.routeConfig?._injector)return y.routeConfig._injector;for(let E=y.parent;E;E=E.parent){const v=E.routeConfig;if(v?._loadedInjector)return v._loadedInjector;if(v?._injector)return v._injector}return null}class ha{constructor(E,v,C,L,z){this.routeReuseStrategy=E,this.futureState=v,this.currState=C,this.forwardEvent=L,this.inputBindingEnabled=z}activate(E){const v=this.futureState._root,C=this.currState?this.currState._root:null;this.deactivateChildRoutes(v,C,E),_n(this.futureState.root),this.activateChildRoutes(v,C,E)}deactivateChildRoutes(E,v,C){const L=Fi(v);E.children.forEach(z=>{const G=z.value.outlet;this.deactivateRoutes(z,L[G],C),delete L[G]}),Object.values(L).forEach(z=>{this.deactivateRouteAndItsChildren(z,C)})}deactivateRoutes(E,v,C){const L=E.value,z=v?v.value:null;if(L===z)if(L.component){const G=C.getContext(L.outlet);G&&this.deactivateChildRoutes(E,v,G.children)}else this.deactivateChildRoutes(E,v,C);else z&&this.deactivateRouteAndItsChildren(v,C)}deactivateRouteAndItsChildren(E,v){E.value.component&&this.routeReuseStrategy.shouldDetach(E.value.snapshot)?this.detachAndStoreRouteSubtree(E,v):this.deactivateRouteAndOutlet(E,v)}detachAndStoreRouteSubtree(E,v){const C=v.getContext(E.value.outlet),L=C&&E.value.component?C.children:v,z=Fi(E);for(const G of Object.keys(z))this.deactivateRouteAndItsChildren(z[G],L);if(C&&C.outlet){const G=C.outlet.detach(),se=C.children.onOutletDeactivated();this.routeReuseStrategy.store(E.value.snapshot,{componentRef:G,route:E,contexts:se})}}deactivateRouteAndOutlet(E,v){const C=v.getContext(E.value.outlet),L=C&&E.value.component?C.children:v,z=Fi(E);for(const G of Object.keys(z))this.deactivateRouteAndItsChildren(z[G],L);C&&(C.outlet&&(C.outlet.deactivate(),C.children.onOutletDeactivated()),C.attachRef=null,C.route=null)}activateChildRoutes(E,v,C){const L=Fi(v);E.children.forEach(z=>{this.activateRoutes(z,L[z.value.outlet],C),this.forwardEvent(new Fa(z.value.snapshot))}),E.children.length&&this.forwardEvent(new ll(E.value.snapshot))}activateRoutes(E,v,C){const L=E.value,z=v?v.value:null;if(_n(L),L===z)if(L.component){const G=C.getOrCreateContext(L.outlet);this.activateChildRoutes(E,v,G.children)}else this.activateChildRoutes(E,v,C);else if(L.component){const G=C.getOrCreateContext(L.outlet);if(this.routeReuseStrategy.shouldAttach(L.snapshot)){const se=this.routeReuseStrategy.retrieve(L.snapshot);this.routeReuseStrategy.store(L.snapshot,null),G.children.onOutletReAttached(se.contexts),G.attachRef=se.componentRef,G.route=se.route.value,G.outlet&&G.outlet.attach(se.componentRef,se.route.value),_n(se.route.value),this.activateChildRoutes(E,null,G.children)}else{const se=Ha(L.snapshot);G.attachRef=null,G.route=L,G.injector=se,G.outlet&&G.outlet.activateWith(L,G.injector),this.activateChildRoutes(E,null,G.children)}}else this.activateChildRoutes(E,null,C)}}class yr{constructor(E){this.path=E,this.route=this.path[this.path.length-1]}}class za{constructor(E,v){this.component=E,this.route=v}}function zo(y,E,v){const C=y._root;return wi(C,E?E._root:null,v,[C.value])}function nr(y,E){const v=Symbol(),C=E.get(y,v);return C===v?"function"!=typeof y||(0,x.Z0I)(y)?E.get(y):y:C}function wi(y,E,v,C,L={canDeactivateChecks:[],canActivateChecks:[]}){const z=Fi(E);return y.children.forEach(G=>{(function Kl(y,E,v,C,L={canDeactivateChecks:[],canActivateChecks:[]}){const z=y.value,G=E?E.value:null,se=v?v.getContext(y.value.outlet):null;if(G&&z.routeConfig===G.routeConfig){const Ze=function ld(y,E,v){if("function"==typeof v)return v(y,E);switch(v){case"pathParamsChange":return!Qi(y.url,E.url);case"pathParamsOrQueryParamsChange":return!Qi(y.url,E.url)||!Ni(y.queryParams,E.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ki(y,E)||!Ni(y.queryParams,E.queryParams);default:return!ki(y,E)}}(G,z,z.routeConfig.runGuardsAndResolvers);Ze?L.canActivateChecks.push(new yr(C)):(z.data=G.data,z._resolvedData=G._resolvedData),wi(y,E,z.component?se?se.children:null:v,C,L),Ze&&se&&se.outlet&&se.outlet.isActivated&&L.canDeactivateChecks.push(new za(se.outlet.component,G))}else G&&Va(E,se,L),L.canActivateChecks.push(new yr(C)),wi(y,null,z.component?se?se.children:null:v,C,L)})(G,z[G.value.outlet],v,C.concat([G.value]),L),delete z[G.value.outlet]}),Object.entries(z).forEach(([G,se])=>Va(se,v.getContext(G),L)),L}function Va(y,E,v){const C=Fi(y),L=y.value;Object.entries(C).forEach(([z,G])=>{Va(G,L.component?E?E.children.getContext(z):null:E,v)}),v.canDeactivateChecks.push(new za(L.component&&E&&E.outlet&&E.outlet.isActivated?E.outlet.component:null,L))}function Es(y){return"function"==typeof y}function Ql(y){return y instanceof Jn.K||"EmptyError"===y?.name}const pa=Symbol("INITIAL_VALUE");function yo(){return(0,Se.w)(y=>Ln(y.map(E=>E.pipe((0,Re.q)(1),function Ue(...y){const E=(0,We.yG)(y);return(0,zt.e)((v,C)=>{(E?(0,ui.z)(y,v,E):(0,ui.z)(y,v)).subscribe(C)})}(pa)))).pipe((0,Qn.U)(E=>{for(const v of E)if(!0!==v){if(v===pa)return pa;if(!1===v||v instanceof dn)return v}return!0}),(0,Xe.h)(E=>E!==pa),(0,Re.q)(1)))}function Go(y){return(0,Ft.z)((0,on.b)(E=>{if(er(E))throw Yl(0,E)}),(0,Qn.U)(E=>!0===E))}class Os{constructor(E){this.segmentGroup=E||null}}class Wo{constructor(E){this.urlTree=E}}function Js(y){return je(new Os(y))}function Fs(y){return je(new Wo(y))}class nc{constructor(E,v){this.urlSerializer=E,this.urlTree=v}noMatchError(E){return new x.vHH(4002,!1)}lineralizeSegments(E,v){let C=[],L=v.root;for(;;){if(C=C.concat(L.segments),0===L.numberOfChildren)return(0,Te.of)(C);if(L.numberOfChildren>1||!L.children[Yt])return je(new x.vHH(4e3,!1));L=L.children[Yt]}}applyRedirectCommands(E,v,C){return this.applyRedirectCreateUrlTree(v,this.urlSerializer.parse(v),E,C)}applyRedirectCreateUrlTree(E,v,C,L){const z=this.createSegmentGroup(E,v.root,C,L);return new dn(z,this.createQueryParams(v.queryParams,this.urlTree.queryParams),v.fragment)}createQueryParams(E,v){const C={};return Object.entries(E).forEach(([L,z])=>{if("string"==typeof z&&z.startsWith(":")){const se=z.substring(1);C[L]=v[se]}else C[L]=z}),C}createSegmentGroup(E,v,C,L){const z=this.createSegments(E,v.segments,C,L);let G={};return Object.entries(v.children).forEach(([se,Ze])=>{G[se]=this.createSegmentGroup(E,Ze,C,L)}),new kn(z,G)}createSegments(E,v,C,L){return v.map(z=>z.path.startsWith(":")?this.findPosParam(E,z,L):this.findOrReturn(z,C))}findPosParam(E,v,C){const L=C[v.path.substring(1)];if(!L)throw new x.vHH(4001,!1);return L}findOrReturn(E,v){let C=0;for(const L of v){if(L.path===E.path)return v.splice(C),L;C++}return E}}const va={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function ud(y,E,v,C,L){const z=Qc(y,E,v);return z.matched?(C=function ji(y,E){return y.providers&&!y._injector&&(y._injector=(0,x.MMx)(y.providers,E,`Route: ${y.path}`)),y._injector??E}(E,C),function ga(y,E,v,C){const L=E.canMatch;if(!L||0===L.length)return(0,Te.of)(!0);const z=L.map(G=>{const se=nr(G,y);return nt(function Jl(y){return y&&Es(y.canMatch)}(se)?se.canMatch(E,v):y.runInContext(()=>se(E,v)))});return(0,Te.of)(z).pipe(yo(),Go())}(C,E,v).pipe((0,Qn.U)(G=>!0===G?z:{...va}))):(0,Te.of)(z)}function Qc(y,E,v){if(""===E.path)return"full"===E.pathMatch&&(y.hasChildren()||v.length>0)?{...va}:{matched:!0,consumedSegments:[],remainingSegments:v,parameters:{},positionalParamSegments:{}};const L=(E.matcher||Lo)(v,y,E);if(!L)return{...va};const z={};Object.entries(L.posParams??{}).forEach(([se,Ze])=>{z[se]=Ze.path});const G=L.consumed.length>0?{...z,...L.consumed[L.consumed.length-1].parameters}:z;return{matched:!0,consumedSegments:L.consumed,remainingSegments:v.slice(L.consumed.length),parameters:G,positionalParamSegments:L.posParams??{}}}function ic(y,E,v,C){return v.length>0&&function _o(y,E,v){return v.some(C=>Qs(y,E,C)&&Ns(C)!==Yt)}(y,v,C)?{segmentGroup:new kn(E,Ss(C,new kn(v,y.children))),slicedSegments:[]}:0===v.length&&function dl(y,E,v){return v.some(C=>Qs(y,E,C))}(y,v,C)?{segmentGroup:new kn(y.segments,dd(y,0,v,C,y.children)),slicedSegments:v}:{segmentGroup:new kn(y.segments,y.children),slicedSegments:v}}function dd(y,E,v,C,L){const z={};for(const G of C)if(Qs(y,v,G)&&!L[Ns(G)]){const se=new kn([],{});z[Ns(G)]=se}return{...L,...z}}function Ss(y,E){const v={};v[Yt]=E;for(const C of y)if(""===C.path&&Ns(C)!==Yt){const L=new kn([],{});v[Ns(C)]=L}return v}function Qs(y,E,v){return(!(y.hasChildren()||E.length>0)||"full"!==v.pathMatch)&&""===v.path}class vi{constructor(E,v,C,L,z,G,se){this.injector=E,this.configLoader=v,this.rootComponentType=C,this.config=L,this.urlTree=z,this.paramsInheritanceStrategy=G,this.urlSerializer=se,this.allowRedirects=!0,this.applyRedirects=new nc(this.urlSerializer,this.urlTree)}noMatchError(E){return new x.vHH(4002,!1)}recognize(){const E=ic(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,E,Yt).pipe(Un(v=>{if(v instanceof Wo)return this.allowRedirects=!1,this.urlTree=v.urlTree,this.match(v.urlTree);throw v instanceof Os?this.noMatchError(v):v}),(0,Qn.U)(v=>{const C=new vo([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Yt,this.rootComponentType,null,{}),L=new tr(C,v),z=new vr("",L),G=function cs(y,E,v=null,C=null){return Ys(Ls(y),E,v,C)}(C,[],this.urlTree.queryParams,this.urlTree.fragment);return G.queryParams=this.urlTree.queryParams,z.url=this.urlSerializer.serialize(G),this.inheritParamsAndData(z._root),{state:z,tree:G}}))}match(E){return this.processSegmentGroup(this.injector,this.config,E.root,Yt).pipe(Un(C=>{throw C instanceof Os?this.noMatchError(C):C}))}inheritParamsAndData(E){const v=E.value,C=ln(v,this.paramsInheritanceStrategy);v.params=Object.freeze(C.params),v.data=Object.freeze(C.data),E.children.forEach(L=>this.inheritParamsAndData(L))}processSegmentGroup(E,v,C,L){return 0===C.segments.length&&C.hasChildren()?this.processChildren(E,v,C):this.processSegment(E,v,C,C.segments,L,!0)}processChildren(E,v,C){const L=[];for(const z of Object.keys(C.children))"primary"===z?L.unshift(z):L.push(z);return(0,Ce.D)(L).pipe((0,Kt.b)(z=>{const G=C.children[z],se=function Gh(y,E){const v=y.filter(C=>Ns(C)===E);return v.push(...y.filter(C=>Ns(C)!==E)),v}(v,z);return this.processSegmentGroup(E,se,G,z)}),function Ei(y,E){return(0,zt.e)(function an(y,E,v,C,L){return(z,G)=>{let se=v,Ze=E,Ct=0;z.subscribe((0,pt.x)(G,Gt=>{const hi=Ct++;Ze=se?y(Ze,Gt,hi):(se=!0,Gt),C&&G.next(Ze)},L&&(()=>{se&&G.next(Ze),G.complete()})))}}(y,E,arguments.length>=2,!0))}((z,G)=>(z.push(...G),z)),(0,Vn.d)(null),function jr(y,E){const v=arguments.length>=2;return C=>C.pipe(y?(0,Xe.h)((L,z)=>y(L,z,C)):tt.y,Qt(1),v?(0,Vn.d)(E):(0,pr.T)(()=>new Jn.K))}(),(0,yt.z)(z=>{if(null===z)return Js(C);const G=Us(z);return function to(y){y.sort((E,v)=>E.value.outlet===Yt?-1:v.value.outlet===Yt?1:E.value.outlet.localeCompare(v.value.outlet))}(G),(0,Te.of)(G)}))}processSegment(E,v,C,L,z,G){return(0,Ce.D)(v).pipe((0,Kt.b)(se=>this.processSegmentAgainstRoute(se._injector??E,v,se,C,L,z,G).pipe(Un(Ze=>{if(Ze instanceof Os)return(0,Te.of)(null);throw Ze}))),(0,gt.P)(se=>!!se),Un(se=>{if(Ql(se))return function rc(y,E,v){return 0===E.length&&!y.children[v]}(C,L,z)?(0,Te.of)([]):Js(C);throw se}))}processSegmentAgainstRoute(E,v,C,L,z,G,se){return function hl(y,E,v,C){return!!(Ns(y)===C||C!==Yt&&Qs(E,v,y))&&("**"===y.path||Qc(E,y,v).matched)}(C,L,z,G)?void 0===C.redirectTo?this.matchSegmentAgainstRoute(E,L,C,z,G,se):se&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(E,L,v,C,z,G):Js(L):Js(L)}expandSegmentAgainstRouteUsingRedirect(E,v,C,L,z,G){return"**"===L.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(E,C,L,G):this.expandRegularSegmentAgainstRouteUsingRedirect(E,v,C,L,z,G)}expandWildCardWithParamsAgainstRouteUsingRedirect(E,v,C,L){const z=this.applyRedirects.applyRedirectCommands([],C.redirectTo,{});return C.redirectTo.startsWith("/")?Fs(z):this.applyRedirects.lineralizeSegments(C,z).pipe((0,yt.z)(G=>{const se=new kn(G,{});return this.processSegment(E,v,se,G,L,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(E,v,C,L,z,G){const{matched:se,consumedSegments:Ze,remainingSegments:Ct,positionalParamSegments:Gt}=Qc(v,L,z);if(!se)return Js(v);const hi=this.applyRedirects.applyRedirectCommands(Ze,L.redirectTo,Gt);return L.redirectTo.startsWith("/")?Fs(hi):this.applyRedirects.lineralizeSegments(L,hi).pipe((0,yt.z)(Bs=>this.processSegment(E,C,v,Bs.concat(Ct),G,!1)))}matchSegmentAgainstRoute(E,v,C,L,z,G){let se;if("**"===C.path){const Ze=L.length>0?pi(L).parameters:{},Ct=new vo(L,Ze,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,tu(C),Ns(C),C.component??C._loadedComponent??null,C,Ti(C));se=(0,Te.of)({snapshot:Ct,consumedSegments:[],remainingSegments:[]}),v.children={}}else se=ud(v,C,L,E).pipe((0,Qn.U)(({matched:Ze,consumedSegments:Ct,remainingSegments:Gt,parameters:hi})=>Ze?{snapshot:new vo(Ct,hi,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,tu(C),Ns(C),C.component??C._loadedComponent??null,C,Ti(C)),consumedSegments:Ct,remainingSegments:Gt}:null));return se.pipe((0,Se.w)(Ze=>null===Ze?Js(v):this.getChildConfig(E=C._injector??E,C,L).pipe((0,Se.w)(({routes:Ct})=>{const Gt=C._loadedInjector??E,{snapshot:hi,consumedSegments:Bs,remainingSegments:dc}=Ze,{segmentGroup:gl,slicedSegments:hc}=ic(v,Bs,dc,Ct);if(0===hc.length&&gl.hasChildren())return this.processChildren(Gt,Ct,gl).pipe((0,Qn.U)(md=>null===md?null:[new tr(hi,md)]));if(0===Ct.length&&0===hc.length)return(0,Te.of)([new tr(hi,[])]);const fc=Ns(C)===z;return this.processSegment(Gt,Ct,gl,hc,fc?Yt:z,!0).pipe((0,Qn.U)(md=>[new tr(hi,md)]))}))))}getChildConfig(E,v,C){return v.children?(0,Te.of)({routes:v.children,injector:E}):v.loadChildren?void 0!==v._loadedRoutes?(0,Te.of)({routes:v._loadedRoutes,injector:v._loadedInjector}):function ma(y,E,v,C){const L=E.canLoad;if(void 0===L||0===L.length)return(0,Te.of)(!0);const z=L.map(G=>{const se=nr(G,y);return nt(function cd(y){return y&&Es(y.canLoad)}(se)?se.canLoad(E,v):y.runInContext(()=>se(E,v)))});return(0,Te.of)(z).pipe(yo(),Go())}(E,v,C).pipe((0,yt.z)(L=>L?this.configLoader.loadChildren(E,v).pipe((0,on.b)(z=>{v._loadedRoutes=z.routes,v._loadedInjector=z.injector})):function jo(y){return je(hs(!1,3))}())):(0,Te.of)({routes:[],injector:E})}}function sc(y){const E=y.value.routeConfig;return E&&""===E.path}function Us(y){const E=[],v=new Set;for(const C of y){if(!sc(C)){E.push(C);continue}const L=E.find(z=>C.value.routeConfig===z.value.routeConfig);void 0!==L?(L.children.push(...C.children),v.add(L)):E.push(C)}for(const C of v){const L=Us(C.children);E.push(new tr(C.value,L))}return E.filter(C=>!v.has(C))}function tu(y){return y.data||{}}function Ti(y){return y.resolve||{}}function Y(y){return"string"==typeof y.title||null===y.title}function ge(y){return(0,Se.w)(E=>{const v=y(E);return v?(0,Ce.D)(v).pipe((0,Qn.U)(()=>E)):(0,Te.of)(E)})}const xe=new x.OlP("ROUTES");let kt=(()=>{class y{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,x.f3M)(x.Sil)}loadComponent(v){if(this.componentLoaders.get(v))return this.componentLoaders.get(v);if(v._loadedComponent)return(0,Te.of)(v._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(v);const C=nt(v.loadComponent()).pipe((0,Qn.U)(Hn),(0,on.b)(z=>{this.onLoadEndListener&&this.onLoadEndListener(v),v._loadedComponent=z}),(0,ei.x)(()=>{this.componentLoaders.delete(v)})),L=new wn(C,()=>new at.x).pipe(Tt());return this.componentLoaders.set(v,L),L}loadChildren(v,C){if(this.childrenLoaders.get(C))return this.childrenLoaders.get(C);if(C._loadedRoutes)return(0,Te.of)({routes:C._loadedRoutes,injector:C._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(C);const z=this.loadModuleFactoryOrRoutes(C.loadChildren).pipe((0,Qn.U)(se=>{this.onLoadEndListener&&this.onLoadEndListener(C);let Ze,Ct;return Array.isArray(se)?Ct=se:(Ze=se.create(v).injector,Ct=Ze.get(xe,[],x.XFs.Self|x.XFs.Optional).flat()),{routes:Ct.map(ql),injector:Ze}}),(0,ei.x)(()=>{this.childrenLoaders.delete(C)})),G=new wn(z,()=>new at.x).pipe(Tt());return this.childrenLoaders.set(C,G),G}loadModuleFactoryOrRoutes(v){return nt(v()).pipe((0,Qn.U)(Hn),(0,yt.z)(C=>C instanceof x.YKP||Array.isArray(C)?(0,Te.of)(C):(0,Ce.D)(this.compiler.compileModuleAsync(C))))}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();function Hn(y){return function Nn(y){return y&&"object"==typeof y&&"default"in y}(y)?y.default:y}let Rn=(()=>{class y{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new at.x,this.configLoader=(0,x.f3M)(kt),this.environmentInjector=(0,x.f3M)(x.lqb),this.urlSerializer=(0,x.f3M)(Cr),this.rootContexts=(0,x.f3M)(At),this.inputBindingEnabled=null!==(0,x.f3M)(Hr,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Te.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=L=>this.events.next(new go(L)),this.configLoader.onLoadStartListener=L=>this.events.next(new Rr(L))}complete(){this.transitions?.complete()}handleNavigationRequest(v){const C=++this.navigationId;this.transitions?.next({...this.transitions.value,...v,id:C})}setupNavigations(v){return this.transitions=new Et({id:0,currentUrlTree:v.currentUrlTree,currentRawUrl:v.currentUrlTree,extractedUrl:v.urlHandlingStrategy.extract(v.currentUrlTree),urlAfterRedirects:v.urlHandlingStrategy.extract(v.currentUrlTree),rawUrl:v.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:qs,restoredState:null,currentSnapshot:v.routerState.snapshot,targetSnapshot:null,currentRouterState:v.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,Xe.h)(C=>0!==C.id),(0,Qn.U)(C=>({...C,extractedUrl:v.urlHandlingStrategy.extract(C.rawUrl)})),(0,Se.w)(C=>{let L=!1,z=!1;return(0,Te.of)(C).pipe((0,on.b)(G=>{this.currentNavigation={id:G.id,initialUrl:G.rawUrl,extractedUrl:G.extractedUrl,trigger:G.source,extras:G.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Se.w)(G=>{const se=v.browserUrlTree.toString(),Ze=!v.navigated||G.extractedUrl.toString()!==se||se!==v.currentUrlTree.toString();if(!Ze&&"reload"!==(G.extras.onSameUrlNavigation??v.onSameUrlNavigation)){const Gt="";return this.events.next(new mo(G.id,v.serializeUrl(C.rawUrl),Gt,0)),v.rawUrlTree=G.rawUrl,G.resolve(null),Le.E}if(v.urlHandlingStrategy.shouldProcessUrl(G.rawUrl))return Mn(G.source)&&(v.browserUrlTree=G.extractedUrl),(0,Te.of)(G).pipe((0,Se.w)(Gt=>{const hi=this.transitions?.getValue();return this.events.next(new aa(Gt.id,this.urlSerializer.serialize(Gt.extractedUrl),Gt.source,Gt.restoredState)),hi!==this.transitions?.getValue()?Le.E:Promise.resolve(Gt)}),function Zr(y,E,v,C,L,z){return(0,yt.z)(G=>function eo(y,E,v,C,L,z,G="emptyOnly"){return new vi(y,E,v,C,L,G,z).recognize()}(y,E,v,C,G.extractedUrl,L,z).pipe((0,Qn.U)(({state:se,tree:Ze})=>({...G,targetSnapshot:se,urlAfterRedirects:Ze}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,v.config,this.urlSerializer,v.paramsInheritanceStrategy),(0,on.b)(Gt=>{if(C.targetSnapshot=Gt.targetSnapshot,C.urlAfterRedirects=Gt.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:Gt.urlAfterRedirects},"eager"===v.urlUpdateStrategy){if(!Gt.extras.skipLocationChange){const Bs=v.urlHandlingStrategy.merge(Gt.urlAfterRedirects,Gt.rawUrl);v.setBrowserUrl(Bs,Gt)}v.browserUrlTree=Gt.urlAfterRedirects}const hi=new Wl(Gt.id,this.urlSerializer.serialize(Gt.extractedUrl),this.urlSerializer.serialize(Gt.urlAfterRedirects),Gt.targetSnapshot);this.events.next(hi)}));if(Ze&&v.urlHandlingStrategy.shouldProcessUrl(v.rawUrlTree)){const{id:Gt,extractedUrl:hi,source:Bs,restoredState:dc,extras:gl}=G,hc=new aa(Gt,this.urlSerializer.serialize(hi),Bs,dc);this.events.next(hc);const fc=Ui(0,this.rootComponentType).snapshot;return C={...G,targetSnapshot:fc,urlAfterRedirects:hi,extras:{...gl,skipLocationChange:!1,replaceUrl:!1}},(0,Te.of)(C)}{const Gt="";return this.events.next(new mo(G.id,v.serializeUrl(C.extractedUrl),Gt,1)),v.rawUrlTree=G.rawUrl,G.resolve(null),Le.E}}),(0,on.b)(G=>{const se=new $l(G.id,this.urlSerializer.serialize(G.extractedUrl),this.urlSerializer.serialize(G.urlAfterRedirects),G.targetSnapshot);this.events.next(se)}),(0,Qn.U)(G=>C={...G,guards:zo(G.targetSnapshot,G.currentSnapshot,this.rootContexts)}),function ec(y,E){return(0,yt.z)(v=>{const{targetSnapshot:C,currentSnapshot:L,guards:{canActivateChecks:z,canDeactivateChecks:G}}=v;return 0===G.length&&0===z.length?(0,Te.of)({...v,guardsResult:!0}):function Jc(y,E,v,C){return(0,Ce.D)(y).pipe((0,yt.z)(L=>function Gn(y,E,v,C,L){const z=E&&E.routeConfig?E.routeConfig.canDeactivate:null;if(!z||0===z.length)return(0,Te.of)(!0);const G=z.map(se=>{const Ze=Ha(E)??L,Ct=nr(se,Ze);return nt(function Vo(y){return y&&Es(y.canDeactivate)}(Ct)?Ct.canDeactivate(y,E,v,C):Ze.runInContext(()=>Ct(y,E,v,C))).pipe((0,gt.P)())});return(0,Te.of)(G).pipe(yo())}(L.component,L.route,v,E,C)),(0,gt.P)(L=>!0!==L,!0))}(G,C,L,y).pipe((0,yt.z)(se=>se&&function Zc(y){return"boolean"==typeof y}(se)?function tc(y,E,v,C){return(0,Ce.D)(E).pipe((0,Kt.b)(L=>(0,ui.z)(function Cn(y,E){return null!==y&&E&&E(new gr(y)),(0,Te.of)(!0)}(L.route.parent,C),function Ri(y,E){return null!==y&&E&&E(new jl(y)),(0,Te.of)(!0)}(L.route,C),function et(y,E,v){const C=E[E.length-1],z=E.slice(0,E.length-1).reverse().map(G=>function fa(y){const E=y.routeConfig?y.routeConfig.canActivateChild:null;return E&&0!==E.length?{node:y,guards:E}:null}(G)).filter(G=>null!==G).map(G=>Me(()=>{const se=G.guards.map(Ze=>{const Ct=Ha(G.node)??v,Gt=nr(Ze,Ct);return nt(function Kc(y){return y&&Es(y.canActivateChild)}(Gt)?Gt.canActivateChild(C,y):Ct.runInContext(()=>Gt(C,y))).pipe((0,gt.P)())});return(0,Te.of)(se).pipe(yo())}));return(0,Te.of)(z).pipe(yo())}(y,L.path,v),function Xi(y,E,v){const C=E.routeConfig?E.routeConfig.canActivate:null;if(!C||0===C.length)return(0,Te.of)(!0);const L=C.map(z=>Me(()=>{const G=Ha(E)??v,se=nr(z,G);return nt(function Hi(y){return y&&Es(y.canActivate)}(se)?se.canActivate(E,y):G.runInContext(()=>se(E,y))).pipe((0,gt.P)())}));return(0,Te.of)(L).pipe(yo())}(y,L.route,v))),(0,gt.P)(L=>!0!==L,!0))}(C,z,y,E):(0,Te.of)(se)),(0,Qn.U)(se=>({...v,guardsResult:se})))})}(this.environmentInjector,G=>this.events.next(G)),(0,on.b)(G=>{if(C.guardsResult=G.guardsResult,er(G.guardsResult))throw Yl(0,G.guardsResult);const se=new kr(G.id,this.urlSerializer.serialize(G.extractedUrl),this.urlSerializer.serialize(G.urlAfterRedirects),G.targetSnapshot,!!G.guardsResult);this.events.next(se)}),(0,Xe.h)(G=>!!G.guardsResult||(v.restoreHistory(G),this.cancelNavigationTransition(G,"",3),!1)),ge(G=>{if(G.guards.canActivateChecks.length)return(0,Te.of)(G).pipe((0,on.b)(se=>{const Ze=new ni(se.id,this.urlSerializer.serialize(se.extractedUrl),this.urlSerializer.serialize(se.urlAfterRedirects),se.targetSnapshot);this.events.next(Ze)}),(0,Se.w)(se=>{let Ze=!1;return(0,Te.of)(se).pipe(function J(y,E){return(0,yt.z)(v=>{const{targetSnapshot:C,guards:{canActivateChecks:L}}=v;if(!L.length)return(0,Te.of)(v);let z=0;return(0,Ce.D)(L).pipe((0,Kt.b)(G=>function w(y,E,v,C){const L=y.routeConfig,z=y._resolve;return void 0!==L?.title&&!Y(L)&&(z[os]=L.title),function F(y,E,v,C){const L=function A(y){return[...Object.keys(y),...Object.getOwnPropertySymbols(y)]}(y);if(0===L.length)return(0,Te.of)({});const z={};return(0,Ce.D)(L).pipe((0,yt.z)(G=>function k(y,E,v,C){const L=Ha(E)??C,z=nr(y,L);return nt(z.resolve?z.resolve(E,v):L.runInContext(()=>z(E,v)))}(y[G],E,v,C).pipe((0,gt.P)(),(0,on.b)(se=>{z[G]=se}))),Qt(1),(0,Xr.h)(z),Un(G=>Ql(G)?Le.E:je(G)))}(z,y,E,C).pipe((0,Qn.U)(G=>(y._resolvedData=G,y.data=ln(y,v).resolve,L&&Y(L)&&(y.data[os]=L.title),null)))}(G.route,C,y,E)),(0,on.b)(()=>z++),Qt(1),(0,yt.z)(G=>z===L.length?(0,Te.of)(v):Le.E))})}(v.paramsInheritanceStrategy,this.environmentInjector),(0,on.b)({next:()=>Ze=!0,complete:()=>{Ze||(v.restoreHistory(se),this.cancelNavigationTransition(se,"",2))}}))}),(0,on.b)(se=>{const Ze=new qi(se.id,this.urlSerializer.serialize(se.extractedUrl),this.urlSerializer.serialize(se.urlAfterRedirects),se.targetSnapshot);this.events.next(Ze)}))}),ge(G=>{const se=Ze=>{const Ct=[];Ze.routeConfig?.loadComponent&&!Ze.routeConfig._loadedComponent&&Ct.push(this.configLoader.loadComponent(Ze.routeConfig).pipe((0,on.b)(Gt=>{Ze.component=Gt}),(0,Qn.U)(()=>{})));for(const Gt of Ze.children)Ct.push(...se(Gt));return Ct};return Ln(se(G.targetSnapshot.root)).pipe((0,Vn.d)(),(0,Re.q)(1))}),ge(()=>this.afterPreactivation()),(0,Qn.U)(G=>{const se=function Ua(y,E,v){const C=ko(y,E._root,v?v._root:void 0);return new Fo(C,E)}(v.routeReuseStrategy,G.targetSnapshot,G.currentRouterState);return C={...G,targetRouterState:se}}),(0,on.b)(G=>{v.currentUrlTree=G.urlAfterRedirects,v.rawUrlTree=v.urlHandlingStrategy.merge(G.urlAfterRedirects,G.rawUrl),v.routerState=G.targetRouterState,"deferred"===v.urlUpdateStrategy&&(G.extras.skipLocationChange||v.setBrowserUrl(v.rawUrlTree,G),v.browserUrlTree=G.urlAfterRedirects)}),((y,E,v,C)=>(0,Qn.U)(L=>(new ha(E,L.targetRouterState,L.currentRouterState,v,C).activate(y),L)))(this.rootContexts,v.routeReuseStrategy,G=>this.events.next(G),this.inputBindingEnabled),(0,Re.q)(1),(0,on.b)({next:G=>{L=!0,this.lastSuccessfulNavigation=this.currentNavigation,v.navigated=!0,this.events.next(new po(G.id,this.urlSerializer.serialize(G.extractedUrl),this.urlSerializer.serialize(v.currentUrlTree))),v.titleStrategy?.updateTitle(G.targetRouterState.snapshot),G.resolve(!0)},complete:()=>{L=!0}}),(0,ei.x)(()=>{L||z||this.cancelNavigationTransition(C,"",1),this.currentNavigation?.id===C.id&&(this.currentNavigation=null)}),Un(G=>{if(z=!0,ca(G)){Ba(G)||(v.navigated=!0,v.restoreHistory(C,!0));const se=new Oo(C.id,this.urlSerializer.serialize(C.extractedUrl),G.message,G.cancellationCode);if(this.events.next(se),Ba(G)){const Ze=v.urlHandlingStrategy.merge(G.url,v.rawUrlTree),Ct={skipLocationChange:C.extras.skipLocationChange,replaceUrl:"eager"===v.urlUpdateStrategy||Mn(C.source)};v.scheduleNavigation(Ze,qs,null,Ct,{resolve:C.resolve,reject:C.reject,promise:C.promise})}else C.resolve(!1)}else{v.restoreHistory(C,!0);const se=new al(C.id,this.urlSerializer.serialize(C.extractedUrl),G,C.targetSnapshot??void 0);this.events.next(se);try{C.resolve(v.errorHandler(G))}catch(Ze){C.reject(Ze)}}return Le.E}))}))}cancelNavigationTransition(v,C,L){const z=new Oo(v.id,this.urlSerializer.serialize(v.extractedUrl),C,L);this.events.next(z),v.resolve(!1)}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();function Mn(y){return y!==qs}let yi=(()=>{class y{buildTitle(v){let C,L=v.root;for(;void 0!==L;)C=this.getResolvedTitleForRoute(L)??C,L=L.children.find(z=>z.outlet===Yt);return C}getResolvedTitleForRoute(v){return v.data[os]}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:function(){return(0,x.f3M)(ci)},providedIn:"root"}),y})(),ci=(()=>{class y extends yi{constructor(v){super(),this.title=v}updateTitle(v){const C=this.buildTitle(v);void 0!==C&&this.title.setTitle(C)}}return y.\u0275fac=function(v){return new(v||y)(x.LFG($s.Dx))},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})(),zi=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:function(){return(0,x.f3M)(Kr)},providedIn:"root"}),y})();class $t{shouldDetach(E){return!1}store(E,v){}shouldAttach(E){return!1}retrieve(E){return null}shouldReuseRoute(E,v){return E.routeConfig===v.routeConfig}}let Kr=(()=>{class y extends $t{}return y.\u0275fac=function(){let E;return function(C){return(E||(E=x.n5z(y)))(C||y)}}(),y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();const no=new x.OlP("",{providedIn:"root",factory:()=>({})});let _r=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:function(){return(0,x.f3M)(ks)},providedIn:"root"}),y})(),ks=(()=>{class y{shouldProcessUrl(v){return!0}extract(v){return v}merge(v,C){return v}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();var _i=(()=>((_i=_i||{})[_i.COMPLETE=0]="COMPLETE",_i[_i.FAILED=1]="FAILED",_i[_i.REDIRECTING=2]="REDIRECTING",_i))();function cr(y,E){y.events.pipe((0,Xe.h)(v=>v instanceof po||v instanceof Oo||v instanceof al||v instanceof mo),(0,Qn.U)(v=>v instanceof po||v instanceof mo?_i.COMPLETE:v instanceof Oo&&(0===v.code||1===v.code)?_i.REDIRECTING:_i.FAILED),(0,Xe.h)(v=>v!==_i.REDIRECTING),(0,Re.q)(1)).subscribe(()=>{E()})}function Xo(y){throw y}function oc(y,E,v){return E.parse("/")}const Yo={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},nu={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Pr=(()=>{class y{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,x.f3M)(x.c2e),this.isNgZoneEnabled=!1,this.options=(0,x.f3M)(no,{optional:!0})||{},this.pendingTasks=(0,x.f3M)(x.HDt),this.errorHandler=this.options.errorHandler||Xo,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||oc,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,x.f3M)(_r),this.routeReuseStrategy=(0,x.f3M)(zi),this.titleStrategy=(0,x.f3M)(yi),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,x.f3M)(xe,{optional:!0})?.flat()??[],this.navigationTransitions=(0,x.f3M)(Rn),this.urlSerializer=(0,x.f3M)(Cr),this.location=(0,x.f3M)(Fn.Ye),this.componentInputBindingEnabled=!!(0,x.f3M)(Hr,{optional:!0}),this.isNgZoneEnabled=(0,x.f3M)(x.R0b)instanceof x.R0b&&x.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new dn,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Ui(0,null),this.navigationTransitions.setupNavigations(this).subscribe(v=>{this.lastSuccessfulId=v.id,this.currentPageId=this.browserPageId??0},v=>{this.console.warn(`Unhandled Navigation Error: ${v}`)})}resetRootComponentType(v){this.routerState.root.component=v,this.navigationTransitions.rootComponentType=v}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const v=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),qs,v)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(v=>{const C="popstate"===v.type?"popstate":"hashchange";"popstate"===C&&setTimeout(()=>{this.navigateToSyncWithBrowser(v.url,C,v.state)},0)}))}navigateToSyncWithBrowser(v,C,L){const z={replaceUrl:!0},G=L?.navigationId?L:null;if(L){const Ze={...L};delete Ze.navigationId,delete Ze.\u0275routerPageId,0!==Object.keys(Ze).length&&(z.state=Ze)}const se=this.parseUrl(v);this.scheduleNavigation(se,C,G,z)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(v){this.config=v.map(ql),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(v,C={}){const{relativeTo:L,queryParams:z,fragment:G,queryParamsHandling:se,preserveFragment:Ze}=C,Ct=Ze?this.currentUrlTree.fragment:G;let hi,Gt=null;switch(se){case"merge":Gt={...this.currentUrlTree.queryParams,...z};break;case"preserve":Gt=this.currentUrlTree.queryParams;break;default:Gt=z||null}null!==Gt&&(Gt=this.removeEmptyProps(Gt));try{hi=Ls(L?L.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof v[0]||!v[0].startsWith("/"))&&(v=[]),hi=this.currentUrlTree.root}return Ys(hi,v,Gt,Ct??null)}navigateByUrl(v,C={skipLocationChange:!1}){const L=er(v)?v:this.parseUrl(v),z=this.urlHandlingStrategy.merge(L,this.rawUrlTree);return this.scheduleNavigation(z,qs,null,C)}navigate(v,C={skipLocationChange:!1}){return function iu(y){for(let E=0;E<y.length;E++)if(null==y[E])throw new x.vHH(4008,!1)}(v),this.navigateByUrl(this.createUrlTree(v,C),C)}serializeUrl(v){return this.urlSerializer.serialize(v)}parseUrl(v){let C;try{C=this.urlSerializer.parse(v)}catch(L){C=this.malformedUriErrorHandler(L,this.urlSerializer,v)}return C}isActive(v,C){let L;if(L=!0===C?{...Yo}:!1===C?{...nu}:C,er(v))return Bi(this.currentUrlTree,v,L);const z=this.parseUrl(v);return Bi(this.currentUrlTree,z,L)}removeEmptyProps(v){return Object.keys(v).reduce((C,L)=>{const z=v[L];return null!=z&&(C[L]=z),C},{})}scheduleNavigation(v,C,L,z,G){if(this.disposed)return Promise.resolve(!1);let se,Ze,Ct;G?(se=G.resolve,Ze=G.reject,Ct=G.promise):Ct=new Promise((hi,Bs)=>{se=hi,Ze=Bs});const Gt=this.pendingTasks.add();return cr(this,()=>{Promise.resolve().then(()=>this.pendingTasks.remove(Gt))}),this.navigationTransitions.handleNavigationRequest({source:C,restoredState:L,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:v,extras:z,resolve:se,reject:Ze,promise:Ct,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ct.catch(hi=>Promise.reject(hi))}setBrowserUrl(v,C){const L=this.urlSerializer.serialize(v);if(this.location.isCurrentPathEqualTo(L)||C.extras.replaceUrl){const G={...C.extras.state,...this.generateNgRouterState(C.id,this.browserPageId)};this.location.replaceState(L,"",G)}else{const z={...C.extras.state,...this.generateNgRouterState(C.id,(this.browserPageId??0)+1)};this.location.go(L,"",z)}}restoreHistory(v,C=!1){if("computed"===this.canceledNavigationResolution){const z=this.currentPageId-(this.browserPageId??this.currentPageId);0!==z?this.location.historyGo(z):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===z&&(this.resetState(v),this.browserUrlTree=v.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(C&&this.resetState(v),this.resetUrlToCurrentUrlTree())}resetState(v){this.routerState=v.currentRouterState,this.currentUrlTree=v.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,v.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(v,C){return"computed"===this.canceledNavigationResolution?{navigationId:v,\u0275routerPageId:C}:{navigationId:v}}}return y.\u0275fac=function(v){return new(v||y)},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})(),Ye=(()=>{class y{constructor(v,C,L,z,G,se){this.router=v,this.route=C,this.tabIndexAttribute=L,this.renderer=z,this.el=G,this.locationStrategy=se,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new at.x;const Ze=G.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===Ze||"area"===Ze,this.isAnchorElement?this.subscription=v.events.subscribe(Ct=>{Ct instanceof po&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(v){this._preserveFragment=(0,x.D6c)(v)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(v){this._skipLocationChange=(0,x.D6c)(v)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(v){this._replaceUrl=(0,x.D6c)(v)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(v){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",v)}ngOnChanges(v){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(v){null!=v?(this.commands=Array.isArray(v)?v:[v],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(v,C,L,z,G){return!!(null===this.urlTree||this.isAnchorElement&&(0!==v||C||L||z||G||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const v=null===this.href?null:(0,x.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",v)}applyAttributeValue(v,C){const L=this.renderer,z=this.el.nativeElement;null!==C?L.setAttribute(z,v,C):L.removeAttribute(z,v)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return y.\u0275fac=function(v){return new(v||y)(x.Y36(Pr),x.Y36(Br),x.$8M("tabindex"),x.Y36(x.Qsj),x.Y36(x.SBq),x.Y36(Fn.S$))},y.\u0275dir=x.lG2({type:y,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(v,C){1&v&&x.NdJ("click",function(z){return C.onClick(z.button,z.ctrlKey,z.shiftKey,z.altKey,z.metaKey)}),2&v&&x.uIk("target",C.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[x.TTD]}),y})();class ps{}let bs=(()=>{class y{constructor(v,C,L,z,G){this.router=v,this.injector=L,this.preloadingStrategy=z,this.loader=G}setUpPreloading(){this.subscription=this.router.events.pipe((0,Xe.h)(v=>v instanceof po),(0,Kt.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(v,C){const L=[];for(const z of C){z.providers&&!z._injector&&(z._injector=(0,x.MMx)(z.providers,v,`Route: ${z.path}`));const G=z._injector??v,se=z._loadedInjector??G;(z.loadChildren&&!z._loadedRoutes&&void 0===z.canLoad||z.loadComponent&&!z._loadedComponent)&&L.push(this.preloadConfig(G,z)),(z.children||z._loadedRoutes)&&L.push(this.processRoutes(se,z.children??z._loadedRoutes))}return(0,Ce.D)(L).pipe((0,Ur.J)())}preloadConfig(v,C){return this.preloadingStrategy.preload(C,()=>{let L;L=C.loadChildren&&void 0===C.canLoad?this.loader.loadChildren(v,C):(0,Te.of)(null);const z=L.pipe((0,yt.z)(G=>null===G?(0,Te.of)(void 0):(C._loadedRoutes=G.routes,C._loadedInjector=G.injector,this.processRoutes(G.injector??v,G.routes))));if(C.loadComponent&&!C._loadedComponent){const G=this.loader.loadComponent(C);return(0,Ce.D)([z,G]).pipe((0,Ur.J)())}return z})}}return y.\u0275fac=function(v){return new(v||y)(x.LFG(Pr),x.LFG(x.Sil),x.LFG(x.lqb),x.LFG(ps),x.LFG(kt))},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})();const Vr=new x.OlP("");let Nr=(()=>{class y{constructor(v,C,L,z,G={}){this.urlSerializer=v,this.transitions=C,this.viewportScroller=L,this.zone=z,this.options=G,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},G.scrollPositionRestoration=G.scrollPositionRestoration||"disabled",G.anchorScrolling=G.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(v=>{v instanceof aa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=v.navigationTrigger,this.restoredId=v.restoredState?v.restoredState.navigationId:0):v instanceof po?(this.lastId=v.id,this.scheduleScrollEvent(v,this.urlSerializer.parse(v.urlAfterRedirects).fragment)):v instanceof mo&&0===v.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(v,this.urlSerializer.parse(v.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(v=>{v instanceof Xl&&(v.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(v.position):v.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(v.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(v,C){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Xl(v,"popstate"===this.lastSource?this.store[this.restoredId]:null,C))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return y.\u0275fac=function(v){x.$Z()},y.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac}),y})();function qo(y,E){return{\u0275kind:y,\u0275providers:E}}function Gr(){const y=(0,x.f3M)(x.zs3);return E=>{const v=y.get(x.z2F);if(E!==v.components[0])return;const C=y.get(Pr),L=y.get(ms);1===y.get(_a)&&C.initialNavigation(),y.get(fl,null,x.XFs.Optional)?.setUpPreloading(),y.get(Vr,null,x.XFs.Optional)?.init(),C.resetRootComponentType(v.componentTypes[0]),L.closed||(L.next(),L.complete(),L.unsubscribe())}}const ms=new x.OlP("",{factory:()=>new at.x}),_a=new x.OlP("",{providedIn:"root",factory:()=>1}),fl=new x.OlP("");function lc(y){return qo(0,[{provide:fl,useExisting:bs},{provide:ps,useExisting:y}])}const pl=new x.OlP("ROUTER_FORROOT_GUARD"),ro=[Fn.Ye,{provide:Cr,useClass:ri},Pr,At,{provide:Br,useFactory:function su(y){return y.routerState.root},deps:[Pr]},kt,[]];function Ma(){return new x.PXZ("Router",Pr)}let xa=(()=>{class y{constructor(v){}static forRoot(v,C){return{ngModule:y,providers:[ro,[],{provide:xe,multi:!0,useValue:v},{provide:pl,useFactory:Mr,deps:[[Pr,new x.FiY,new x.tp0]]},{provide:no,useValue:C||{}},C?.useHash?{provide:Fn.S$,useClass:Fn.Do}:{provide:Fn.S$,useClass:Fn.b0},{provide:Vr,useFactory:()=>{const y=(0,x.f3M)(Fn.EM),E=(0,x.f3M)(x.R0b),v=(0,x.f3M)(no),C=(0,x.f3M)(Rn),L=(0,x.f3M)(Cr);return v.scrollOffset&&y.setOffset(v.scrollOffset),new Nr(L,C,y,E,v)}},C?.preloadingStrategy?lc(C.preloadingStrategy).\u0275providers:[],{provide:x.PXZ,multi:!0,useFactory:Ma},C?.initialNavigation?so(C):[],C?.bindToComponentInputs?qo(8,[Ks,{provide:Hr,useExisting:Ks}]).\u0275providers:[],[{provide:Xn,useFactory:Gr},{provide:x.tb,multi:!0,useExisting:Xn}]]}}static forChild(v){return{ngModule:y,providers:[{provide:xe,multi:!0,useValue:v}]}}}return y.\u0275fac=function(v){return new(v||y)(x.LFG(pl,8))},y.\u0275mod=x.oAB({type:y}),y.\u0275inj=x.cJS({}),y})();function Mr(y){return"guarded"}function so(y){return["disabled"===y.initialNavigation?qo(3,[{provide:x.ip1,multi:!0,useFactory:()=>{const E=(0,x.f3M)(Pr);return()=>{E.setUpLocationChangeListener()}}},{provide:_a,useValue:2}]).\u0275providers:[],"enabledBlocking"===y.initialNavigation?qo(2,[{provide:_a,useValue:0},{provide:x.ip1,multi:!0,deps:[x.zs3],useFactory:E=>{const v=E.get(Fn.V_,Promise.resolve());return()=>v.then(()=>new Promise(C=>{const L=E.get(Pr),z=E.get(ms);cr(L,()=>{C(!0)}),E.get(Rn).afterPreactivation=()=>(C(!0),z.closed?(0,Te.of)(void 0):z),L.initialNavigation()}))}}]).\u0275providers:[]]}const Xn=new x.OlP("")}},Jt=>{Jt(Jt.s=1130)}]);